<!DOCTYPE HTML><html><head><title>hasktorch - Typed Tensors</title><meta charset="utf-8"><meta content="summary" name="twitter:card"><meta content="https://s3-eu-west-1.amazonaws.com/worldwideapps/assets/tintin-blue.png" name="twitter:site"><meta content="hasktorch - Typed Tensors" name="twitter:title"><meta content="Functional differentiable programming in Haskell" name="twitter:description"><meta content="Hasktorch Contributor Team" name="twitter:creator"><meta content="https://s3-eu-west-1.amazonaws.com/worldwideapps/assets/tintin-blue.png" name="twitter:image"><meta itemprop="og:type" content="website"><meta itemprop="og:site_name" content="theam"><meta itemprop="og:title" content="hasktorch - Typed Tensors"><meta itemprop="og:image" content="https://s3-eu-west-1.amazonaws.com/worldwideapps/assets/tintin-blue.png"><meta itemprop="og:description" content="Functional differentiable programming in Haskell"><link href="https://fonts.googleapis.com/css?family=IBM+Plex+Sans|Montserrat:500" rel="stylesheet"><link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/tomorrow-night.min.css" rel="stylesheet"><link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css" rel="stylesheet"><link href="https://s3-eu-west-1.amazonaws.com/worldwideapps/assets/favicon-blue.ico" rel="shortcut icon"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.0-alpha/dist/katex.min.css" rel="stylesheet"><style>
html
{
  height     : 100%;
  min-height : 100%;
}

body
{
  height      : 100%;
  min-height  : 100%;
  font-family : "IBM+Plex+Sans", sans-serif;
  font-size   : 1em;
  overflow-x  : hidden;
}

body a
{
  color : rgba(104,136,163,77.0);
}

body a:hover
{
  color : rgba(134,174,209,26.0);
}

h1
{
  font-family : "Montserrat", sans-serif;
  font-weight : 500;
  font-size   : 1em;
}

h2
{
  font-family : "Montserrat", sans-serif;
  font-weight : 500;
  font-size   : 2.44099em;
}

h3
{
  font-family : "Montserrat", sans-serif;
  font-weight : 500;
  font-size   : 5.95848em;
}

h1
{
  font-size : 2.44099em;
}

h2
{
  font-size : 1.953em;
}

h3
{
  font-size : 1.56299em;
}

blockquote
{
  border-left  : solid 4px #dddddd;
  padding-left : 1rem;
  color        : #777777;
}

.next-prev
{
  margin-top    : 5%;
  margin-bottom : 5%;
}

#header-container
{
  margin-top    : 5rem;
  margin-bottom : 5rem;
  text-align    : center;
}

#header-container img
{
  max-height : 7rem;
}

.cover-heading
{
  font-size     : 800%;
  margin-bottom : 1.56299rem;
}

.cover-container
{
  background-color : #94c1e8;
}

.watermark
{
  position    : absolute;
  top         : 0px;
  left        : 0px;
  max-height  : 1.25039rem;
  margin-top  : 1.25039rem;
  margin-left : 1.25039rem;
}

.cover-heading-subtitle
{
  margin-top : 3rem;
  font-size  : 1.953rem;
  color      : #212529;
}

.vertical-auto
{
  margin-top    : auto;
  margin-bottom : auto;
}

.content
{
  margin-top    : 5%;
  margin-bottom : 5%;
}

#wrapper
{
  padding-left       : 0px;
  -webkit-transition : all 0.5s ease 0.0s;
  -moz-transition    : all 0.5s ease 0.0s;
  -ms-transition     : all 0.5s ease 0.0s;
  -o-transition      : all 0.5s ease 0.0s;
  transition         : all 0.5s ease 0.0s;
}

#wrapper.toggled
{
  padding-left : 250px;
}

#wrapper.toggled #sidebar-wrapper
{
  width : 250px;
}

#page-content-wrapper#wrapper.toggled
{
  position     : absolute;
  margin-right : -250px;
}

#page-content-wrapper
{
  width      : 100%;
  position   : absolute;
  margin-top : 3rem;
  padding    : 15px 15px 15px 15px;
}

#page-content-wrapper img
{
  max-width : 100%;
}

#sidebar-wrapper
{
  z-index            : 1000;
  position           : fixed;
  left               : 250px;
  width              : 0px;
  margin-left        : -250px;
  overflow-y         : hidden;
  overflow-x         : hidden;
  -webkit-transition : all 0.5s ease 0.0s;
  -moz-transition    : all 0.5s ease 0.0s;
  -ms-transition     : all 0.5s ease 0.0s;
  -o-transition      : all 0.5s ease 0.0s;
  transition         : all 0.5s ease 0.0s;
}

.sidebar-nav
{
  position        : absolute;
  top             : 0px;
  width           : 250px;
  margin          : 0px 0px 0px 0px;
  padding         : 0px 0px 0px 0px;
  list-style-type : none;
}

.sidebar-nav li
{
  text-indent : 20px;
  line-height : 40px;
}

.sidebar-nav li a
{
  display         : block;
  text-decoration : none;
  font-weight     : bold;
  color           : rgba(60,78,93,153.0);
}

.sidebar-nav li a:hover
{
  text-decoration : none;
  color           : rgba(45,58,70,178.0);
}

.sidebar-nav li .tintin-fg-active
{
  color : #ffffff;
}

#menu-toggle
{
  position : absolute;
}

#menu-toggle img
{
  position : absolute;
  left     : 0px;
}

#menu-toggle .rotateIn
{
  z-index : 999;
}

.tintin-doc-topbar
{
  height : 3rem;
}

.tintin-doc-topbar a
{
  margin-left : 1rem;
  margin-top  : 0rem;
  width       : 1.5rem;
}

.filter-gray
{
  position     : relative;
  bottom       : 3px;
  margin-left  : 0.25rem;
  margin-right : 1rem;
  height       : 1rem;
}

.footer-theam
{
  position    : relative;
  bottom      : 1px;
  margin-left : -0.25rem;
  height      : 1.75rem;
}

.tintin-doc-footer
{
  bottom : 0px;
  height : -15rem;
  width  : 100%;
  color  : rgba(0,0,0,0.3);
}

.main-container
{
  min-height : 100%;
  position   : relative;
}

#content
{
  min-height : 95%;
}

.sidebar-nav > .sidebar-brand
{
  height         : 3rem;
  font-size      : 2rem;
  font-family    : "Montserrat", sans-serif;
  font-weight    : 500;
  padding-top    : 2.5rem;
  padding-bottom : 2.5rem;
  margin-bottom  : 1.5rem;
}

.sidebar-nav > .sidebar-brand img
{
  height : 1.5rem;
}

.tintin-navbar
{
  font-weight      : bold;
  background-color : rgba(119,155,186,51.0);
}

.tintin-navbar .left-part
{
  padding-left : 0px !important;
}

.tintin-navbar ul
{
  margin-top      : 1rem;
  list-style-type : none;
}

.tintin-navbar ul li
{
  margin-right : 1rem;
  display      : inline;
}

.tintin-navbar ul li a
{
  color : rgba(60,78,93,153.0);
}

.tintin-navbar ul li a:hover
{
  text-decoration : none;
  color           : rgba(45,58,70,178.0);
}


.tintin-navbar .tintin-navbar-active a
{
  color : #212529;
}

.tintin-navbar .tintin-navbar-active a:hover
{
  text-decoration : none;
  color           : rgba(77,80,83,51.0);
}

.tintin-bg-70
{
  background-color : rgba(119,155,186,51.0);
}

.tintin-bg-blue
{
  background-color : #94c1e8;
}

.tintin-fg-blue
{
  color : #94c1e8;
}

.tintin-fg-active
{
  color : #ffffff;
}

.tintin-fg-disabled
{
  color : #000000;
}

footer
{
  position         : relative;
  bottom           : 0px;
  left             : 0px;
  width            : 100%;
  padding-top      : 30px;
  padding-bottom   : 30px;
  color            : #212529;
  background-color : rgba(119,155,186,51.0);
  text-align       : center;
}

footer a
{
  color : rgba(60,78,93,153.0);
}

footer a:hover
{
  text-decoration : none;
  color           : rgba(45,58,70,178.0);
}

footer .author
{
  margin-top : 1.19999em;
  font-size  : 1.19999em;
}

footer .site-generated-message
{
  font-size     : 0.8em;
  margin-top    : 3em;
  margin-bottom : 3em;
}

.container
{
  max-width : 50rem;
}

@media screen and (min-width: 768px)
{

#wrapper
{
  padding-left : 0px;
}

#wrapper .toggled
{
  padding-left : 250px;
}

#wrapper .toggled #sidebar-wrapper
{
  width : 250px;
}

#wrapper .toggled #page-content-wrapper
{
  position     : relative;
  margin-right : 0px;
}

#sidebar-wrapper
{
  width : 0px;
}

#page-content-wrapper
{
  padding  : 20px 20px 20px 20px;
  position : relative;
}

}

/* Generated with Clay, http://fvisser.nl/clay */</style></head><body class="h-100 tintin-fg-black tintin-bg-white"><div id="main-container" class="h-100"><section id="content"><div id="wrapper" class="toggled"><div id="sidebar-wrapper" class="h-100 tintin-bg-blue"><div class="h-100 tintin-bg-70"><p></p></div><ul class="sidebar-nav"><li class="sidebar-brand d-flex tintin-bg-blue"><a href="index.html" class="align-self-center tintin-fg-white">hasktorch</a></li><li><a href="01-getting-started.html" class="tintin-fg-disabled">Getting Started</a></li><li><a href="02-tensors.html" class="tintin-fg-disabled">Tensors</a></li><li><a href="03-randomness.html" class="tintin-fg-disabled">Randomness</a></li><li><a href="04-automatic-differentiation.html" class="tintin-fg-disabled">Automatic Differentiation</a></li><li><a href="05-differentiable-programs.html" class="tintin-fg-disabled">Differentiable Programs</a></li><li><a href="06-linear-regression.html" class="tintin-fg-disabled">Linear Regression</a></li><li><a href="07-typed-tensors.html" class="tintin-fg-active">Typed Tensors</a></li></ul></div><nav class="navbar navbar-expand-lg tintin-doc-topbar tintin-fg-white"><a href="#menu-toggle" id="menu-toggle" class><img src="https://s3-eu-west-1.amazonaws.com/worldwideapps/assets/menu.png" class="img-fluid animated rotateOut"><img src="https://s3-eu-west-1.amazonaws.com/worldwideapps/assets/close.png" class="img-fluid animated rotateIn"></a></nav><div id="page-content-wrapper"><div class="container"><div class="col"><div class="animated fadeIn"><h1>Typed Tensors</h1>
<p>Typed tensors provide an alternative API for which tensor
characteristics are encoded in the type of the tensor. The Hasktorch
library is layered such that [ TODO ]</p>
<p>Using typed tensors increases the expressiveness of program invariants
that can be automatically checked by GHC at the cost of needing to be
more explicit in writing code and also requiring working with
Haskell&#39;s type-level machinery. Type-level Haskell programming has
arisen through progressive compiler iteration leading to mechanisms
that have a higher degree of complexity compared to value-level
Haskell code or other languages such as Idris which were designed with
type-level computations from inception. In spite of these compromises,
Haskell offers enough capability to express powerful type-level
representations of models that is matched by few other languages used
for production applications.</p>
<p>Things we can do in typed Hasktorch:</p>
<ul>
<li><p>specify, check, and infer tensor shapes at compile time</p></li>
<li><p>specify, check, and infer tensor data types at compile time</p></li>
<li><p>specify, check, and infer tensor compute devices at compile time</p></li>
</ul>
<p>We can encode all Hasktorch tensor shapes on the type level using
type-level lists and natural numbers:</p>
<pre class="haskell"><code>type EmptyShape = &#39;[]
type OneDimensionalShape (a :: Nat) = &#39;[a]
type TwoDimensionalShape (a :: Nat) (b :: Nat) = &#39;[a, b]
...
</code></pre>
<p>Tensor data types and compute device types are lifted to the type
level using the <code>DataKinds</code> language extension:</p>
<pre class="haskell"><code>type BooleanCPUTensor (shape :: [Nat]) = Tensor &#39;(CPU,  0) &#39;Bool  shape
type IntCUDATensor    (shape :: [Nat]) = Tensor &#39;(CUDA, 1) &#39;Int64 shape
</code></pre>
<p>Devices are represented as tuples consisting of a <code>DeviceType</code> (here
<code>CPU</code> for the CPU and <code>CUDA</code> for a CUDA device, respectively) and a
device id (here the <code>Nat</code>s <code>0</code> and <code>1</code>, respectively).</p>
<p>It is a common misconception that specifying tensor properties at
compile time is only possible if all tensor properties are constants
and are statically known. If this were the case, then we could only
write functions over fully specified tensors, say,</p>
<pre class="haskell"><code>boring :: BooleanCPUTensor &#39;[] -&gt; BooleanCPUTensor &#39;[]
boring = id
</code></pre>
<p>Fortunately, Haskell has the ability to reason about type variables.
This feature is called parametric polymorphism. Consider this simple
example of a function:</p>
<pre class="haskell"><code>tensorNoOp
  :: forall (shape :: [Nat]) (dtype :: DType) (device :: (DeviceType, Nat))
   . Tensor device dtype shape
  -&gt; Tensor device dtype shape
tensorNoOp = id
</code></pre>
<p>Here, <code>shape</code>, <code>dtype</code>, and <code>device</code> are type variables that have been
constrained to be of kind shape, data type, and device, respectively.
The universal quantifier <code>forall</code> implies that this function is
well-defined for all inhabitants of the types that are compatible with
the type variables and their constraints.</p>
<p>The <code>tensorNoOp</code> function may seem trivial, and that is because its
type is very strongly constrained: Given any typed tensor, it must
return a tensor of the same shape and with the same data type and on
the same device. Besides by means of the identity, <code>id</code>, there are not
many ways in which this function can be implemented.</p>
<p>There is a connection between a type signature of a function and
mathematical proofs. We can say that the fact that a function exists
is witnessed by its implementation. The implementation, <code>tensorNoOp =
id</code>, is the proof of the theorem stated by <code>tensorNoOp</code>&#39;s type
signature. And here we have a proof that we can run this function on
any device and for any data type and tensor shape.</p>
<p>This is the essence of typed Hasktorch. As soon as the compiler gives
its OK, we hold a proof that our program will run without shape or
CUDA errors.</p>
</div></div></div></div></div></section><div class="tintin-doc-footer clear-fix"><div class="row next-prev"><div class="col-md-4 offset-md-4"><a href="06-linear-regression.html">&lt; Previous: Linear Regression</a></div></div><footer><div class="container"><div class="row"><div class="col"><p class="author">Developed by <span>Hasktorch Contributor Team</span></p><p class="site-generated-message">Site generated with <a href="https://theam.github.io/tintin" class="tintin-logo"><img src="https://s3-eu-west-1.amazonaws.com/worldwideapps/assets/logo.svg" class="filter-gray"></a><span>&mdash; &copy; 2019 </span><a href="https://www.theagilemonkeys.com">The Agile Monkeys</a></p></div></div></div></footer></div></div><script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/haskell.min.js"></script><script src="https://cdn.rawgit.com/icons8/bower-webicon/v0.10.7/jquery-webicon.min.js"></script><script>hljs.initHighlightingOnLoad()</script><script>$(function () {$("#menu-toggle").click(function(e) {e.preventDefault();$("#wrapper").toggleClass("toggled");$("#menu-toggle img").toggleClass("rotateIn rotateOut");})});</script><script src="https://cdn.jsdelivr.net/npm/katex@0.10.0-alpha/dist/katex.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/contrib/auto-render.min.js"></script><script>renderMathInElement(document.body);</script></body></html>