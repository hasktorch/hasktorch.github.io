<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE NoStarIsType #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.Typed.Vision</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a><span> </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a><span class="hs-special">)</span><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/System.IO.Unsafe.html"><span class="hs-identifier">System.IO.Unsafe</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///nix/store/8xa1kljnfc6d2hmnsxnjbk5dk25jfmcx-zlib-0.6.2.1-doc/share/doc/zlib-0.6.2.1/html/src/Codec.Compression.GZip.html"><span class="hs-identifier">Codec.Compression.GZip</span></a><span>        </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">GZip</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.html"><span class="hs-identifier">Data.ByteString</span></a><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Lazy.html"><span class="hs-identifier">Data.ByteString.Lazy</span></a><span>          </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BS.Lazy</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Internal.html"><span class="hs-identifier">Data.ByteString.Internal</span></a><span>      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">BSI</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span>           </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.TypeLits.html"><span class="hs-identifier">GHC.TypeLits</span></a><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span>           </span><a href="../../../libtorch-ffi-1.4.0.0/html/src/Torch.Internal.Cast.html"><span class="hs-identifier">Torch.Internal.Cast</span></a><span>
</span><a name="line-18"></a><span class="hs-keyword">import</span><span>           </span><a href="Torch.Typed.Aux.html"><span class="hs-identifier">Torch.Typed.Aux</span></a><span>
</span><a name="line-19"></a><span class="hs-keyword">import</span><span>           </span><a href="Torch.Typed.Tensor.html"><span class="hs-identifier">Torch.Typed.Tensor</span></a><span>
</span><a name="line-20"></a><span class="hs-keyword">import</span><span>           </span><a href="Torch.Typed.Functional.html"><span class="hs-identifier">Torch.Typed.Functional</span></a><span>
</span><a name="line-21"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Torch.DType.html"><span class="hs-identifier">Torch.DType</span></a><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">D</span><span>
</span><a name="line-22"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Torch.Tensor.html"><span class="hs-identifier">Torch.Tensor</span></a><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">D</span><span>
</span><a name="line-23"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="Torch.TensorOptions.html"><span class="hs-identifier">Torch.TensorOptions</span></a><span>           </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">D</span><span>
</span><a name="line-24"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Foreign.ForeignPtr.html"><span class="hs-identifier">Foreign.ForeignPtr</span></a><span>            </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-25"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Foreign.Ptr.html"><span class="hs-identifier">Foreign.Ptr</span></a><span>                   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-26"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><a href="../../../libtorch-ffi-1.4.0.0/html/src/Torch.Internal.Managed.TensorFactories.html"><span class="hs-identifier">Torch.Internal.Managed.TensorFactories</span></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LibTorch</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span class="hs-keyword">data</span><span> </span><a name="MnistData"><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier">MnistData</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-29"></a><span>  </span><a name="MnistData"><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier">MnistData</span></a></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-special">{</span><span> </span><a name="images"><a href="Torch.Typed.Vision.html#images"><span class="hs-identifier">images</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-special">,</span><span> </span><a name="labels"><a href="Torch.Typed.Vision.html#labels"><span class="hs-identifier">labels</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a><span>
</span><a name="line-32"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">type</span><span> </span><a name="Rows"><a href="Torch.Typed.Vision.html#Rows"><span class="hs-identifier">Rows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">28</span><span>
</span><a name="line-35"></a><span class="hs-keyword">type</span><span> </span><a name="Cols"><a href="Torch.Typed.Vision.html#Cols"><span class="hs-identifier">Cols</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">28</span><span>
</span><a name="line-36"></a><span class="hs-keyword">type</span><span> </span><a name="DataDim"><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier">DataDim</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.TypeNats.html#%2A"><span class="hs-identifier hs-type">Rows</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.TypeNats.html#%2A"><span class="hs-operator hs-type">*</span></a><span> </span><a href="Torch.Typed.Vision.html#Cols"><span class="hs-identifier hs-type">Cols</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">type</span><span> </span><a name="ClassDim"><a href="Torch.Typed.Vision.html#ClassDim"><span class="hs-identifier">ClassDim</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-identifier">getLabels</span><span>
</span><a name="line-40"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679407967"><a href="#local-6989586621679407967"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.TypeNats.html#KnownNat"><span class="hs-identifier hs-type">KnownNat</span></a><span> </span><a href="#local-6989586621679407967"><span class="hs-identifier hs-type">n</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Torch.Typed.Tensor.html#CPUTensor"><span class="hs-identifier hs-type">CPUTensor</span></a><span> </span><span class="hs-special">'</span><a href="Torch.DType.html#Int64"><span class="hs-identifier hs-type">D.Int64</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><a href="#local-6989586621679407967"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-41"></a><a name="getLabels"><a href="Torch.Typed.Vision.html#getLabels"><span class="hs-identifier">getLabels</span></a></a><span> </span><a name="local-6989586621679407968"><a href="#local-6989586621679407968"><span class="hs-identifier">mnist</span></a></a><span> </span><a name="local-6989586621679407969"><a href="#local-6989586621679407969"><span class="hs-identifier">imageIdxs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-42"></a><span>  </span><a href="Torch.Typed.Tensor.html#UnsafeMkTensor"><span class="hs-identifier hs-var">UnsafeMkTensor</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="Torch.Tensor.html#asTensor"><span class="hs-identifier hs-var">D.asTensor</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><span class="hs-special">(</span><a href="Torch.Typed.Vision.html#getLabel"><span class="hs-identifier hs-var">getLabel</span></a><span> </span><a href="#local-6989586621679407968"><span class="hs-identifier hs-var">mnist</span></a><span class="hs-special">)</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span> </span><span class="hs-special">(</span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679407967"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679407969"><span class="hs-identifier hs-var">imageIdxs</span></a><span>
</span><a name="line-43"></a><span>
</span><a name="line-44"></a><span class="hs-identifier">getLabel</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-45"></a><a name="getLabel"><a href="Torch.Typed.Vision.html#getLabel"><span class="hs-identifier">getLabel</span></a></a><span> </span><a name="local-6989586621679407970"><a href="#local-6989586621679407970"><span class="hs-identifier">mnist</span></a></a><span> </span><a name="local-6989586621679407971"><a href="#local-6989586621679407971"><span class="hs-identifier">imageIdx</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-46"></a><span>  </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.html#index"><span class="hs-identifier hs-var">BS.index</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">labels</span><span> </span><a href="#local-6989586621679407970"><span class="hs-identifier hs-var">mnist</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679407971"><span class="hs-identifier hs-var">imageIdx</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">8</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>
</span><a name="line-48"></a><span class="hs-identifier">getImage</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Torch.Typed.Tensor.html#CPUTensor"><span class="hs-identifier hs-type">CPUTensor</span></a><span> </span><span class="hs-special">'</span><a href="Torch.DType.html#Float"><span class="hs-identifier hs-type">D.Float</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">]</span><span>
</span><a name="line-49"></a><a name="getImage"><a href="Torch.Typed.Vision.html#getImage"><span class="hs-identifier">getImage</span></a></a><span> </span><a name="local-6989586621679407972"><a href="#local-6989586621679407972"><span class="hs-identifier">mnist</span></a></a><span> </span><a name="local-6989586621679407973"><a href="#local-6989586621679407973"><span class="hs-identifier">imageIdx</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-50"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679407974"><a href="#local-6989586621679407974"><span class="hs-identifier">imageBS</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-51"></a><span>          </span><span class="hs-special">[</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.html#index"><span class="hs-identifier hs-var">BS.index</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">images</span><span> </span><a href="#local-6989586621679407972"><span class="hs-identifier hs-var">mnist</span></a><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>                                    </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679407973"><span class="hs-identifier hs-var">imageIdx</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#%5E"><span class="hs-operator hs-var">^</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">16</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679407976"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span>          </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679407976"><a href="#local-6989586621679407976"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">28</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#%5E"><span class="hs-operator hs-var">^</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-54"></a><span>          </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Float"><span class="hs-identifier hs-type">Float</span></a><span class="hs-special">]</span><span>
</span><a name="line-55"></a><span>      </span><span class="hs-special">(</span><a name="local-6989586621679407975"><a href="#local-6989586621679407975"><span class="hs-identifier">tensor</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Torch.Typed.Tensor.html#CPUTensor"><span class="hs-identifier hs-type">CPUTensor</span></a><span> </span><span class="hs-special">'</span><a href="Torch.DType.html#Float"><span class="hs-identifier hs-type">D.Float</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-56"></a><span>          </span><a href="Torch.Typed.Tensor.html#UnsafeMkTensor"><span class="hs-identifier hs-var">UnsafeMkTensor</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Torch.Tensor.html#asTensor"><span class="hs-identifier hs-var">D.asTensor</span></a><span> </span><a href="#local-6989586621679407974"><span class="hs-identifier hs-var">imageBS</span></a><span>
</span><a name="line-57"></a><span>  </span><span class="hs-keyword">in</span><span>  </span><a href="#local-6989586621679407975"><span class="hs-identifier hs-var">tensor</span></a><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-identifier">getImages'</span><span>
</span><a name="line-60"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679407966"><a href="#local-6989586621679407966"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-61"></a><span>   </span><span class="hs-operator">.</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.TypeNats.html#KnownNat"><span class="hs-identifier hs-type">KnownNat</span></a><span> </span><a href="#local-6989586621679407966"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-62"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span>
</span><a name="line-63"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">]</span><span>
</span><a name="line-64"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Torch.Typed.Tensor.html#CPUTensor"><span class="hs-identifier hs-type">CPUTensor</span></a><span> </span><span class="hs-special">'</span><a href="Torch.DType.html#Float"><span class="hs-identifier hs-type">D.Float</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><a href="#local-6989586621679407966"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">]</span><span>
</span><a name="line-65"></a><a name="getImages%27"><a href="Torch.Typed.Vision.html#getImages%27"><span class="hs-identifier">getImages'</span></a></a><span> </span><a name="local-6989586621679407977"><a href="#local-6989586621679407977"><span class="hs-identifier">mnist</span></a></a><span> </span><a name="local-6989586621679407978"><a href="#local-6989586621679407978"><span class="hs-identifier">imageIdxs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Torch.Typed.Tensor.html#UnsafeMkTensor"><span class="hs-identifier hs-var">UnsafeMkTensor</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Torch.Tensor.html#asTensor"><span class="hs-identifier hs-var">D.asTensor</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a><span> </span><a href="#local-6989586621679407979"><span class="hs-identifier hs-var">image</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.List.html#take"><span class="hs-identifier hs-var">take</span></a><span>
</span><a name="line-66"></a><span>  </span><span class="hs-special">(</span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679407966"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>  </span><a href="#local-6989586621679407978"><span class="hs-identifier hs-var">imageIdxs</span></a><span>
</span><a name="line-68"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-69"></a><span>  </span><a name="local-6989586621679407979"><a href="#local-6989586621679407979"><span class="hs-identifier">image</span></a></a><span> </span><a name="local-6989586621679407980"><a href="#local-6989586621679407980"><span class="hs-identifier">idx</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-70"></a><span>    </span><span class="hs-special">[</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span>
</span><a name="line-71"></a><span>        </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.html#index"><span class="hs-identifier hs-var">BS.index</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">images</span><span> </span><a href="#local-6989586621679407977"><span class="hs-identifier hs-var">mnist</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="#local-6989586621679407980"><span class="hs-identifier hs-var">idx</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><span> </span><span class="hs-number">28</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#%5E"><span class="hs-operator hs-var">^</span></a><span> </span><span class="hs-number">2</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><span class="hs-number">16</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span> </span><a href="#local-6989586621679407981"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a name="local-6989586621679407981"><a href="#local-6989586621679407981"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-number">28</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#%5E"><span class="hs-operator hs-var">^</span></a><span> </span><span class="hs-number">2</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-73"></a><span>    </span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Float"><span class="hs-identifier hs-type">Float</span></a><span class="hs-special">]</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-identifier">getImages</span><span>
</span><a name="line-76"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679407965"><a href="#local-6989586621679407965"><span class="hs-identifier">n</span></a></a><span>
</span><a name="line-77"></a><span>   </span><span class="hs-operator">.</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.TypeNats.html#KnownNat"><span class="hs-identifier hs-type">KnownNat</span></a><span> </span><a href="#local-6989586621679407965"><span class="hs-identifier hs-type">n</span></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span>
</span><a name="line-79"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">]</span><span>
</span><a name="line-80"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Torch.Typed.Tensor.html#CPUTensor"><span class="hs-identifier hs-type">CPUTensor</span></a><span> </span><span class="hs-special">'</span><a href="Torch.DType.html#Float"><span class="hs-identifier hs-type">D.Float</span></a><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><a href="#local-6989586621679407965"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">]</span><span>
</span><a name="line-81"></a><a name="getImages"><a href="Torch.Typed.Vision.html#getImages"><span class="hs-identifier">getImages</span></a></a><span> </span><a name="local-6989586621679407982"><a href="#local-6989586621679407982"><span class="hs-identifier">mnist</span></a></a><span> </span><a name="local-6989586621679407983"><a href="#local-6989586621679407983"><span class="hs-identifier">imageIdxs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Torch.Typed.Tensor.html#UnsafeMkTensor"><span class="hs-identifier hs-var">UnsafeMkTensor</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.IO.Unsafe.html#unsafePerformIO"><span class="hs-identifier hs-var">unsafePerformIO</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-82"></a><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Internal.html#PS"><span class="hs-identifier hs-var">BSI.PS</span></a><span> </span><a name="local-6989586621679407984"><a href="#local-6989586621679407984"><span class="hs-identifier">fptr</span></a></a><span> </span><a name="local-6989586621679407985"><a href="#local-6989586621679407985"><span class="hs-identifier">off</span></a></a><span> </span><a name="local-6989586621679407986"><a href="#local-6989586621679407986"><span class="hs-identifier">len</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">images</span><span> </span><a href="#local-6989586621679407982"><span class="hs-identifier hs-var">mnist</span></a><span>
</span><a name="line-83"></a><span>  </span><a name="local-6989586621679407987"><a href="#local-6989586621679407987"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><a href="../../../libtorch-ffi-1.4.0.0/html/src/Torch.Internal.Cast.html#cast2"><span class="hs-identifier hs-var">cast2</span></a><span> </span><a href="../../../libtorch-ffi-1.4.0.0/html/src/Torch.Internal.Managed.TensorFactories.html#empty_lo"><span class="hs-identifier hs-var">LibTorch.empty_lo</span></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Torch.TensorOptions.html#TensorOptions"><span class="hs-identifier hs-type">D.TensorOptions</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="Torch.Tensor.html#Tensor"><span class="hs-identifier hs-type">D.Tensor</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>         </span><span class="hs-special">[</span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679407965"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">,</span><span> </span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">]</span><span>
</span><a name="line-85"></a><span>         </span><span class="hs-special">(</span><a href="Torch.TensorOptions.html#withDType"><span class="hs-identifier hs-var">D.withDType</span></a><span> </span><a href="Torch.DType.html#UInt8"><span class="hs-identifier hs-var">D.UInt8</span></a><span> </span><a href="Torch.TensorOptions.html#defaultOpts"><span class="hs-identifier hs-var">D.defaultOpts</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>  </span><a href="Torch.Tensor.html#withTensor"><span class="hs-identifier hs-var">D.withTensor</span></a><span> </span><a href="#local-6989586621679407987"><span class="hs-identifier hs-var">t</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679407988"><a href="#local-6989586621679407988"><span class="hs-identifier">ptr1</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-87"></a><span>    </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Foreign.ForeignPtr.Imp.html#withForeignPtr"><span class="hs-identifier hs-var">F.withForeignPtr</span></a><span> </span><a href="#local-6989586621679407984"><span class="hs-identifier hs-var">fptr</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679407989"><a href="#local-6989586621679407989"><span class="hs-identifier">ptr2</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-88"></a><span>      </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Foldable.html#forM_"><span class="hs-identifier hs-var">forM_</span></a><span> </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="#local-6989586621679407965"><span class="hs-identifier hs-type">n</span></a><span class="hs-special">)</span><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><a href="#local-6989586621679407983"><span class="hs-identifier hs-var">imageIdxs</span></a><span class="hs-special">)</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679407990"><a href="#local-6989586621679407990"><span class="hs-identifier">i</span></a></a><span class="hs-special">,</span><a name="local-6989586621679407991"><a href="#local-6989586621679407991"><span class="hs-identifier">idx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-89"></a><span>        </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Internal.html#memcpy"><span class="hs-identifier hs-var">BSI.memcpy</span></a><span>
</span><a name="line-90"></a><span>          </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">F.plusPtr</span></a><span> </span><a href="#local-6989586621679407988"><span class="hs-identifier hs-var">ptr1</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">)</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679407990"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>          </span><span class="hs-special">(</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Ptr.html#plusPtr"><span class="hs-identifier hs-var">F.plusPtr</span></a><span> </span><a href="#local-6989586621679407989"><span class="hs-identifier hs-var">ptr2</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679407985"><span class="hs-identifier hs-var">off</span></a><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-number">16</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a><span class="hs-special">(</span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">)</span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a><a href="#local-6989586621679407991"><span class="hs-identifier hs-var">idx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>          </span><span class="hs-special">(</span><a href="Torch.Typed.Aux.html#natValI"><span class="hs-identifier hs-var">natValI</span></a><span> </span><span class="hs-glyph">@</span><a href="Torch.Typed.Vision.html#DataDim"><span class="hs-identifier hs-type">DataDim</span></a><span class="hs-special">)</span><span>
</span><a name="line-93"></a><span>  </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="Torch.Tensor.html#toType"><span class="hs-identifier hs-var">D.toType</span></a><span> </span><a href="Torch.DType.html#Float"><span class="hs-identifier hs-var">D.Float</span></a><span> </span><a href="#local-6989586621679407987"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">length</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span>
</span><a name="line-96"></a><a name="length"><a href="Torch.Typed.Vision.html#length"><span class="hs-identifier">length</span></a></a><span> </span><a name="local-6989586621679407992"><a href="#local-6989586621679407992"><span class="hs-identifier">mnist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.html#length"><span class="hs-identifier hs-var">BS.length</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">labels</span><span> </span><a href="#local-6989586621679407992"><span class="hs-identifier hs-var">mnist</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">8</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-identifier">decompressFile</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Internal.html#ByteString"><span class="hs-identifier hs-type">BS.ByteString</span></a><span>
</span><a name="line-99"></a><a name="decompressFile"><a href="Torch.Typed.Vision.html#decompressFile"><span class="hs-identifier">decompressFile</span></a></a><span> </span><a name="local-6989586621679407993"><a href="#local-6989586621679407993"><span class="hs-identifier">path</span></a></a><span> </span><a name="local-6989586621679407994"><a href="#local-6989586621679407994"><span class="hs-identifier">file</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679407995"><span class="hs-identifier hs-var">decompress'</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.html#readFile"><span class="hs-identifier hs-var">BS.readFile</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679407993"><span class="hs-identifier hs-var">path</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><span class="hs-string">&quot;/&quot;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a><span> </span><a href="#local-6989586621679407994"><span class="hs-identifier hs-var">file</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-101"></a><span>    </span><a name="local-6989586621679407995"><a href="#local-6989586621679407995"><span class="hs-identifier">decompress'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.html#concat"><span class="hs-identifier hs-var">BS.concat</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Lazy.html#toChunks"><span class="hs-identifier hs-var">BS.Lazy.toChunks</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///nix/store/8xa1kljnfc6d2hmnsxnjbk5dk25jfmcx-zlib-0.6.2.1-doc/share/doc/zlib-0.6.2.1/html/src/Codec.Compression.GZip.html#decompress"><span class="hs-identifier hs-var">GZip.decompress</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/bytestring-0.10.8.2/src/Data.ByteString.Lazy.html#fromStrict"><span class="hs-identifier hs-var">BS.Lazy.fromStrict</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-identifier">initMnist</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/ghc-prim-0.5.3/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a><span> </span><span class="hs-special">(</span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span class="hs-special">,</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-type">MnistData</span></a><span class="hs-special">)</span><span>
</span><a name="line-104"></a><a name="initMnist"><a href="Torch.Typed.Vision.html#initMnist"><span class="hs-identifier">initMnist</span></a></a><span> </span><a name="local-6989586621679407996"><a href="#local-6989586621679407996"><span class="hs-identifier">path</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-105"></a><span>  </span><a name="local-6989586621679407997"><a href="#local-6989586621679407997"><span class="hs-identifier">imagesBS</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Torch.Typed.Vision.html#decompressFile"><span class="hs-identifier hs-var">decompressFile</span></a><span> </span><a href="#local-6989586621679407996"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-string">&quot;train-images-idx3-ubyte.gz&quot;</span><span>
</span><a name="line-106"></a><span>  </span><a name="local-6989586621679407998"><a href="#local-6989586621679407998"><span class="hs-identifier">labelsBS</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Torch.Typed.Vision.html#decompressFile"><span class="hs-identifier hs-var">decompressFile</span></a><span> </span><a href="#local-6989586621679407996"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-string">&quot;train-labels-idx1-ubyte.gz&quot;</span><span>
</span><a name="line-107"></a><span>  </span><a name="local-6989586621679407999"><a href="#local-6989586621679407999"><span class="hs-identifier">testImagesBS</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Torch.Typed.Vision.html#decompressFile"><span class="hs-identifier hs-var">decompressFile</span></a><span> </span><a href="#local-6989586621679407996"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-string">&quot;t10k-images-idx3-ubyte.gz&quot;</span><span>
</span><a name="line-108"></a><span>  </span><a name="local-6989586621679408000"><a href="#local-6989586621679408000"><span class="hs-identifier">testLabelsBS</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Torch.Typed.Vision.html#decompressFile"><span class="hs-identifier hs-var">decompressFile</span></a><span> </span><a href="#local-6989586621679407996"><span class="hs-identifier hs-var">path</span></a><span> </span><span class="hs-string">&quot;t10k-labels-idx1-ubyte.gz&quot;</span><span>
</span><a name="line-109"></a><span>  </span><a href="file:///nix/store/wxc91qn3x7zvxz65925aq4zhn6vmjlr7-ghc-8.6.5-doc/share/doc/ghc/html/libraries/base-4.12.0.0/src/GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-var">MnistData</span></a><span> </span><a href="#local-6989586621679407997"><span class="hs-identifier hs-var">imagesBS</span></a><span> </span><a href="#local-6989586621679407998"><span class="hs-identifier hs-var">labelsBS</span></a><span class="hs-special">,</span><span> </span><a href="Torch.Typed.Vision.html#MnistData"><span class="hs-identifier hs-var">MnistData</span></a><span> </span><a href="#local-6989586621679407999"><span class="hs-identifier hs-var">testImagesBS</span></a><span> </span><a href="#local-6989586621679408000"><span class="hs-identifier hs-var">testLabelsBS</span></a><span class="hs-special">)</span><span>
</span><a name="line-110"></a></pre></body></html>