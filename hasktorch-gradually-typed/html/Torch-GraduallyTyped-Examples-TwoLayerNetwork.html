<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Torch.GraduallyTyped.Examples.TwoLayerNetwork</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">hasktorch-gradually-typed-0.2.0.0: experimental project for hasktorch</span><ul class="links" id="page-menu"><li><a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html">Source</a></li><li><a href="../../share/doc/index.html">Contents</a></li><li><a href="../../share/doc/doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Torch.GraduallyTyped.Examples.TwoLayerNetwork</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:sinc">sinc</a> :: Floating a =&gt; a -&gt; a</li><li class="src short"><a href="#v:noisySinc">noisySinc</a> :: (Floating a, <a href="file:///nix/store/fv40valsp1qi9dy3snb8jgiq0a9h8rjk-random-lib-random-1.2.0-haddock-doc/share/doc/random/html/System-Random.html#t:Random" title="System.Random">Random</a> a, <a href="file:///nix/store/fv40valsp1qi9dy3snb8jgiq0a9h8rjk-random-lib-random-1.2.0-haddock-doc/share/doc/random/html/System-Random.html#t:RandomGen" title="System.Random">RandomGen</a> g) =&gt; a -&gt; a -&gt; g -&gt; (a, g)</li><li class="src short"><span class="keyword">data</span> <a href="#t:SincData">SincData</a> = <a href="#v:SincData">SincData</a> {<ul class="subs"><li><a href="#v:name">name</a> :: <a href="file:///nix/store/3h7vpkicndpfn5x6n81qafgaiq3iiv5y-foldl-lib-foldl-1.4.11-haddock-doc/share/doc/foldl/html/Control-Foldl-Text.html#t:Text" title="Control.Foldl.Text">Text</a></li><li><a href="#v:unSincData">unSincData</a> :: [(Float, Float)]</li></ul>}</li><li class="src short"><a href="#v:mkSincData">mkSincData</a> :: (<a href="file:///nix/store/fv40valsp1qi9dy3snb8jgiq0a9h8rjk-random-lib-random-1.2.0-haddock-doc/share/doc/random/html/System-Random.html#t:RandomGen" title="System.Random">RandomGen</a> g, Monad m) =&gt; <a href="file:///nix/store/3h7vpkicndpfn5x6n81qafgaiq3iiv5y-foldl-lib-foldl-1.4.11-haddock-doc/share/doc/foldl/html/Control-Foldl-Text.html#t:Text" title="Control.Foldl.Text">Text</a> -&gt; Int -&gt; <a href="file:///nix/store/fqj5vnwj2np2vx8f3i3932v2k29il49m-lens-family-core-lib-lens-family-core-2.1.0-haddock-doc/share/doc/lens-family-core/html/Lens-Family-State-Lazy.html#t:StateT" title="Lens.Family.State.Lazy">StateT</a> g m <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a></li><li class="src short"><span class="keyword">newtype</span> <a href="#t:TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer = <a href="#v:TwoLayerNetwork">TwoLayerNetwork</a> (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelStack" title="Torch.GraduallyTyped.NN.Class">ModelStack</a> '[fstLayer, activation, dropout, sndLayer])</li><li class="src short"><span class="keyword">type</span> <a href="#t:TwoLayerNetworkF">TwoLayerNetworkF</a> gradient hasDropout device dataType inputDim outputDim hiddenDim = <a href="Torch-GraduallyTyped-NN-Class.html#t:NamedModel" title="Torch.GraduallyTyped.NN.Class">NamedModel</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> (<a href="Torch-GraduallyTyped-NN-Class.html#t:NamedModel" title="Torch.GraduallyTyped.NN.Class">NamedModel</a> (<a href="Torch-GraduallyTyped-NN-Linear.html#t:GLinearF" title="Torch.GraduallyTyped.NN.Linear">GLinearF</a> '<a href="Torch-GraduallyTyped-NN-Type.html#v:WithBias" title="Torch.GraduallyTyped.NN.Type">WithBias</a> gradient device dataType inputDim hiddenDim)) <a href="Torch-GraduallyTyped-NN-Activation.html#t:Tanh" title="Torch.GraduallyTyped.NN.Activation">Tanh</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TLNDropoutF" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TLNDropoutF</a> hasDropout) (<a href="Torch-GraduallyTyped-NN-Class.html#t:NamedModel" title="Torch.GraduallyTyped.NN.Class">NamedModel</a> (<a href="Torch-GraduallyTyped-NN-Linear.html#t:GLinearF" title="Torch.GraduallyTyped.NN.Linear">GLinearF</a> '<a href="Torch-GraduallyTyped-NN-Type.html#v:WithBias" title="Torch.GraduallyTyped.NN.Type">WithBias</a> gradient device dataType hiddenDim outputDim)))</li><li class="src short"><span class="keyword">type family</span> <a href="#t:TLNDropoutF">TLNDropoutF</a> hasDropout <span class="keyword">where ...</span></li><li class="src short"><a href="#v:twoLayerNetworkSpec">twoLayerNetworkSpec</a> :: <span class="keyword">forall</span> gradient hasDropout device dataType inputDim outputDim hiddenDim. <a href="Torch-GraduallyTyped-RequiresGradient.html#t:SGradient" title="Torch.GraduallyTyped.RequiresGradient">SGradient</a> gradient -&gt; <a href="Torch-GraduallyTyped-NN-Type.html#t:SHasDropout" title="Torch.GraduallyTyped.NN.Type">SHasDropout</a> hasDropout -&gt; <a href="Torch-GraduallyTyped-Device.html#t:SDevice" title="Torch.GraduallyTyped.Device">SDevice</a> device -&gt; <a href="Torch-GraduallyTyped-DType.html#t:SDataType" title="Torch.GraduallyTyped.DType">SDataType</a> dataType -&gt; <a href="Torch-GraduallyTyped-Shape-Type.html#t:SDim" title="Torch.GraduallyTyped.Shape.Type">SDim</a> inputDim -&gt; <a href="Torch-GraduallyTyped-Shape-Type.html#t:SDim" title="Torch.GraduallyTyped.Shape.Type">SDim</a> outputDim -&gt; <a href="Torch-GraduallyTyped-Shape-Type.html#t:SDim" title="Torch.GraduallyTyped.Shape.Type">SDim</a> hiddenDim -&gt; Double -&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetworkF" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetworkF</a> gradient hasDropout device dataType inputDim outputDim hiddenDim)</li><li class="src short"><span class="keyword">data</span> <a href="#t:Monitor">Monitor</a><ul class="subs"><li>= <a href="#v:TrainingMonitor">TrainingMonitor</a> { <ul class="subs"><li><a href="#v:mtLoss">mtLoss</a> :: Float</li><li><a href="#v:mtEpoch">mtEpoch</a> :: Int</li></ul> }</li><li>| <a href="#v:EvaluationMonitor">EvaluationMonitor</a> { <ul class="subs"><li><a href="#v:meLoss">meLoss</a> :: Float</li><li><a href="#v:meEpoch">meEpoch</a> :: Int</li></ul> }</li></ul></li><li class="src short"><a href="#v:monitor">monitor</a> :: <a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes.html#t:MonadIO" title="Pipes">MonadIO</a> m =&gt; <a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes-Core.html#t:Consumer" title="Pipes.Core">Consumer</a> <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:Monitor" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">Monitor</a> m r</li><li class="src short"><a href="#v:collate">collate</a> :: <span class="keyword">forall</span> device r input target. (input ~ <a href="Torch-GraduallyTyped-Tensor-Type.html#t:Tensor" title="Torch.GraduallyTyped.Tensor.Type">Tensor</a> ('<a href="Torch-GraduallyTyped-RequiresGradient.html#v:Gradient" title="Torch.GraduallyTyped.RequiresGradient">Gradient</a> '<a href="Torch-GraduallyTyped-RequiresGradient.html#v:WithoutGradient" title="Torch.GraduallyTyped.RequiresGradient">WithoutGradient</a>) ('<a href="Torch-GraduallyTyped-Layout.html#v:Layout" title="Torch.GraduallyTyped.Layout">Layout</a> '<a href="Torch-GraduallyTyped-Layout.html#v:Dense" title="Torch.GraduallyTyped.Layout">Dense</a>) device ('<a href="Torch-GraduallyTyped-DType.html#v:DataType" title="Torch.GraduallyTyped.DType">DataType</a> '<a href="Torch-GraduallyTyped-DType.html#v:Float" title="Torch.GraduallyTyped.DType">Float</a>) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Shape" title="Torch.GraduallyTyped.Shape.Type">Shape</a> '['<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) '<a href="Torch-GraduallyTyped-Shape-Type.html#v:UncheckedSize" title="Torch.GraduallyTyped.Shape.Type">UncheckedSize</a>, '<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Size" title="Torch.GraduallyTyped.Shape.Type">Size</a> 1)]), target ~ <a href="Torch-GraduallyTyped-Tensor-Type.html#t:Tensor" title="Torch.GraduallyTyped.Tensor.Type">Tensor</a> ('<a href="Torch-GraduallyTyped-RequiresGradient.html#v:Gradient" title="Torch.GraduallyTyped.RequiresGradient">Gradient</a> '<a href="Torch-GraduallyTyped-RequiresGradient.html#v:WithoutGradient" title="Torch.GraduallyTyped.RequiresGradient">WithoutGradient</a>) ('<a href="Torch-GraduallyTyped-Layout.html#v:Layout" title="Torch.GraduallyTyped.Layout">Layout</a> '<a href="Torch-GraduallyTyped-Layout.html#v:Dense" title="Torch.GraduallyTyped.Layout">Dense</a>) device ('<a href="Torch-GraduallyTyped-DType.html#v:DataType" title="Torch.GraduallyTyped.DType">DataType</a> '<a href="Torch-GraduallyTyped-DType.html#v:Float" title="Torch.GraduallyTyped.DType">Float</a>) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Shape" title="Torch.GraduallyTyped.Shape.Type">Shape</a> '['<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) '<a href="Torch-GraduallyTyped-Shape-Type.html#v:UncheckedSize" title="Torch.GraduallyTyped.Shape.Type">UncheckedSize</a>, '<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Size" title="Torch.GraduallyTyped.Shape.Type">Size</a> 1)])) =&gt; <a href="Torch-GraduallyTyped-Device.html#t:SDevice" title="Torch.GraduallyTyped.Device">SDevice</a> device -&gt; Int -&gt; <a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes.html#t:ListT" title="Pipes">ListT</a> IO (Float, Float) -&gt; ContT r IO (<a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes.html#t:ListT" title="Pipes">ListT</a> IO (input, target))</li><li class="src short"><a href="#v:runTwoLayerNetworkExample">runTwoLayerNetworkExample</a> :: IO ()</li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:sinc" class="def">sinc</a> :: Floating a =&gt; a -&gt; a <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#sinc" class="link">Source</a> <a href="#v:sinc" class="selflink">#</a></p><div class="doc"><p>Compute the sine cardinal (sinc) function,
 see <a href="https://mathworld.wolfram.com/SincFunction.html">https://mathworld.wolfram.com/SincFunction.html</a>.</p></div></div><div class="top"><p class="src"><a id="v:noisySinc" class="def">noisySinc</a> :: (Floating a, <a href="file:///nix/store/fv40valsp1qi9dy3snb8jgiq0a9h8rjk-random-lib-random-1.2.0-haddock-doc/share/doc/random/html/System-Random.html#t:Random" title="System.Random">Random</a> a, <a href="file:///nix/store/fv40valsp1qi9dy3snb8jgiq0a9h8rjk-random-lib-random-1.2.0-haddock-doc/share/doc/random/html/System-Random.html#t:RandomGen" title="System.Random">RandomGen</a> g) =&gt; a -&gt; a -&gt; g -&gt; (a, g) <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#noisySinc" class="link">Source</a> <a href="#v:noisySinc" class="selflink">#</a></p><div class="doc"><p>Compute the sine cardinal (sinc) function and add normally distributed noise
 of strength epsilon. We use the <code><a href="file:///nix/store/h1pd6gy8cjy2zwwf9bl5ni48j4q56732-normaldistribution-lib-normaldistribution-1.1.0.3-haddock-doc/share/doc/normaldistribution/html/Data-Random-Normal.html#v:normal" title="Data.Random.Normal">normal</a></code> function from <code><a href="Data-Random.html#v:Normal" title="Data.Random">Normal</a></code>
 which requires a random number generator with <code><a href="file:///nix/store/fv40valsp1qi9dy3snb8jgiq0a9h8rjk-random-lib-random-1.2.0-haddock-doc/share/doc/random/html/System-Random.html#t:RandomGen" title="System.Random">RandomGen</a></code> instance.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:SincData" class="def">SincData</a> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#SincData" class="link">Source</a> <a href="#t:SincData" class="selflink">#</a></p><div class="doc"><p>Datatype to represent a dataset of sine cardinal (sinc) inputs and outputs.
 The <code><a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#v:name" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">name</a></code> field is used to identify the split of the dataset.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:SincData" class="def">SincData</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:name" class="def">name</a> :: <a href="file:///nix/store/3h7vpkicndpfn5x6n81qafgaiq3iiv5y-foldl-lib-foldl-1.4.11-haddock-doc/share/doc/foldl/html/Control-Foldl-Text.html#t:Text" title="Control.Foldl.Text">Text</a></dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:unSincData" class="def">unSincData</a> :: [(Float, Float)]</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:SincData">Instances</h4><details id="i:SincData" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SincData:Eq:1"></span> Eq <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a></span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-51" class="link">Source</a> <a href="#t:SincData" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SincData:Eq:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:-61--61-">(==)</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Bool</p><p class="src"><a href="#v:-47--61-">(/=)</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Bool</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SincData:Ord:2"></span> Ord <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a></span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-51" class="link">Source</a> <a href="#t:SincData" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:SincData:Ord:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:compare">compare</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Ordering</p><p class="src"><a href="#v:-60-">(&lt;)</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Bool</p><p class="src"><a href="#v:-60--61-">(&lt;=)</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Bool</p><p class="src"><a href="#v:-62-">(&gt;)</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Bool</p><p class="src"><a href="#v:-62--61-">(&gt;=)</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Bool</p><p class="src"><a href="#v:max">max</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a></p><p class="src"><a href="#v:min">min</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:SincData:Dataset:3"></span> <a href="../../hasktorch/html/Torch-Data-Pipeline.html#t:Dataset" title="Torch.Data.Pipeline">Dataset</a> IO <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> Int (Float, Float)</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-70" class="link">Source</a> <a href="#t:SincData" class="selflink">#</a></td><td class="doc"><p><code><a href="../../hasktorch/html/Torch-Data-Pipeline.html#t:Dataset" title="Torch.Data.Pipeline">Dataset</a></code> instance used for streaming sine cardinal (sinc) examples.</p></td></tr><tr><td colspan="2"><details id="i:id:SincData:Dataset:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:getItem">getItem</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Int -&gt; IO (Float, Float) <a href="../../hasktorch/html/src" class="link">Source</a> <a href="#v:getItem" class="selflink">#</a></p><p class="src"><a href="#v:keys">keys</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a> -&gt; Set Int <a href="../../hasktorch/html/src" class="link">Source</a> <a href="#v:keys" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:mkSincData" class="def">mkSincData</a> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#mkSincData" class="link">Source</a> <a href="#v:mkSincData" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="file:///nix/store/fv40valsp1qi9dy3snb8jgiq0a9h8rjk-random-lib-random-1.2.0-haddock-doc/share/doc/random/html/System-Random.html#t:RandomGen" title="System.Random">RandomGen</a> g, Monad m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; <a href="file:///nix/store/3h7vpkicndpfn5x6n81qafgaiq3iiv5y-foldl-lib-foldl-1.4.11-haddock-doc/share/doc/foldl/html/Control-Foldl-Text.html#t:Text" title="Control.Foldl.Text">Text</a></td><td class="doc"><p>name of the dataset</p></td></tr><tr><td class="src">-&gt; Int</td><td class="doc"><p>number of samples</p></td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/fqj5vnwj2np2vx8f3i3932v2k29il49m-lens-family-core-lib-lens-family-core-2.1.0-haddock-doc/share/doc/lens-family-core/html/Lens-Family-State-Lazy.html#t:StateT" title="Lens.Family.State.Lazy">StateT</a> g m <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:SincData" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">SincData</a></td><td class="doc"><p>dataset in the state monad over the random generator</p></td></tr></table></div><div class="doc"><p>Create a dataset of noisy sine cardinal (sinc) values of a desired size.</p></div></div><div class="top"><p class="src"><span class="keyword">newtype</span> <a id="t:TwoLayerNetwork" class="def">TwoLayerNetwork</a> fstLayer activation dropout sndLayer <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#TwoLayerNetwork" class="link">Source</a> <a href="#t:TwoLayerNetwork" class="selflink">#</a></p><div class="doc"><p>Data type to represent a simple two-layer neural network.
 It is a product type of two layer types, <code>fstLayer</code> and <code>sndLayer</code>,
 an activation function, <code>activation</code>, and a dropout layer, <code>dropout</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TwoLayerNetwork" class="def">TwoLayerNetwork</a> (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelStack" title="Torch.GraduallyTyped.NN.Class">ModelStack</a> '[fstLayer, activation, dropout, sndLayer])</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:TwoLayerNetwork">Instances</h4><details id="i:TwoLayerNetwork" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TwoLayerNetwork:Generic:1"></span> Generic (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer)</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-79" class="link">Source</a> <a href="#t:TwoLayerNetwork" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TwoLayerNetwork:Generic:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> Rep (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) :: <a href="Torch-GraduallyTyped-Prelude.html#t:Type" title="Torch.GraduallyTyped.Prelude">Type</a> -&gt; <a href="Torch-GraduallyTyped-Prelude.html#t:Type" title="Torch.GraduallyTyped.Prelude">Type</a></p></div> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:from">from</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer -&gt; Rep (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) x</p><p class="src"><a href="#v:to">to</a> :: Rep (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) x -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer</p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TwoLayerNetwork:HasStateDict:2"></span> (<a href="Torch-GraduallyTyped-NN-Class.html#t:HasStateDict" title="Torch.GraduallyTyped.NN.Class">HasStateDict</a> fstLayer, <a href="Torch-GraduallyTyped-NN-Class.html#t:HasStateDict" title="Torch.GraduallyTyped.NN.Class">HasStateDict</a> activation, <a href="Torch-GraduallyTyped-NN-Class.html#t:HasStateDict" title="Torch.GraduallyTyped.NN.Class">HasStateDict</a> dropout, <a href="Torch-GraduallyTyped-NN-Class.html#t:HasStateDict" title="Torch.GraduallyTyped.NN.Class">HasStateDict</a> sndLayer) =&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:HasStateDict" title="Torch.GraduallyTyped.NN.Class">HasStateDict</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer)</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-116" class="link">Source</a> <a href="#t:TwoLayerNetwork" class="selflink">#</a></td><td class="doc"><p><code>HasStateDict</code> instance for a two-layer network.
 It allows for conversion of a two-layer network into a state dictionary and back.</p><p>To create a two-layer network from a state dictionary,
 we need to first create its two neural layers, the activation function, and the dropout layer from the state dictionary.
 Afterwards, we combine the four components into a single network.</p><p>The state dictionary of the two-layer network is the union of the
 state dictionaries its layers.</p></td></tr><tr><td colspan="2"><details id="i:id:TwoLayerNetwork:HasStateDict:2"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:fromStateDict">fromStateDict</a> :: (<a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes.html#t:MonadIO" title="Pipes">MonadIO</a> m, <a href="file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m, <a href="file:///nix/store/fjfffhaxkqkya7bkxwbgi5lhcv8scjb2-adjunctions-lib-adjunctions-4.4-haddock-doc/share/doc/adjunctions/html/Control-Monad-Representable-State.html#t:MonadState" title="Control.Monad.Representable.State">MonadState</a> <a href="Torch-GraduallyTyped-NN-Class.html#t:StateDict" title="Torch.GraduallyTyped.NN.Class">StateDict</a> m) =&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) -&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:StateDictKey" title="Torch.GraduallyTyped.NN.Class">StateDictKey</a> -&gt; m (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) <a href="src/Torch.GraduallyTyped.NN.Class.html#fromStateDict" class="link">Source</a> <a href="#v:fromStateDict" class="selflink">#</a></p><p class="src"><a href="#v:toStateDict">toStateDict</a> :: (<a href="file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m, <a href="file:///nix/store/fjfffhaxkqkya7bkxwbgi5lhcv8scjb2-adjunctions-lib-adjunctions-4.4-haddock-doc/share/doc/adjunctions/html/Control-Monad-Representable-State.html#t:MonadState" title="Control.Monad.Representable.State">MonadState</a> <a href="Torch-GraduallyTyped-NN-Class.html#t:StateDict" title="Torch.GraduallyTyped.NN.Class">StateDict</a> m) =&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:StateDictKey" title="Torch.GraduallyTyped.NN.Class">StateDictKey</a> -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer -&gt; m () <a href="src/Torch.GraduallyTyped.NN.Class.html#toStateDict" class="link">Source</a> <a href="#v:toStateDict" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TwoLayerNetwork:HasInitialize:3"></span> <a href="Torch-GraduallyTyped-NN-Class.html#t:HasInitialize" title="Torch.GraduallyTyped.NN.Class">HasInitialize</a> (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelStack" title="Torch.GraduallyTyped.NN.Class">ModelStack</a> '[fstLayer, activation, dropout, sndLayer]) generatorDevice (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelStack" title="Torch.GraduallyTyped.NN.Class">ModelStack</a> '[fstLayer', activation', dropout', sndLayer']) generatorOutputDevice =&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:HasInitialize" title="Torch.GraduallyTyped.NN.Class">HasInitialize</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) generatorDevice (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer' activation' dropout' sndLayer') generatorOutputDevice</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-95" class="link">Source</a> <a href="#t:TwoLayerNetwork" class="selflink">#</a></td><td class="doc"><p>To initialize a two-layer network,
 we need its specification and a random generator.
 The random generator is used to initialize the weights of the network.
 The specification is used to determine the properties of the two neural layers,
 the activation function, and the dropout layer.
 The four components are initialized separately and then combined into a single
 network.</p></td></tr><tr><td colspan="2"><details id="i:id:TwoLayerNetwork:HasInitialize:3"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:initialize">initialize</a> :: <a href="file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m =&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) -&gt; <a href="Torch-GraduallyTyped-Random.html#t:Generator" title="Torch.GraduallyTyped.Random">Generator</a> generatorDevice -&gt; m (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer' activation' dropout' sndLayer', <a href="Torch-GraduallyTyped-Random.html#t:Generator" title="Torch.GraduallyTyped.Random">Generator</a> generatorOutputDevice) <a href="src/Torch.GraduallyTyped.NN.Class.html#initialize" class="link">Source</a> <a href="#v:initialize" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TwoLayerNetwork:HasForward:4"></span> (<a href="Torch-GraduallyTyped-NN-Class.html#t:HasForward" title="Torch.GraduallyTyped.NN.Class">HasForward</a> (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelStack" title="Torch.GraduallyTyped.NN.Class">ModelStack</a> '[fstLayer, activation, dropout, sndLayer]) input generatorDevice prediction generatorOutputDevice, <a href="Torch-GraduallyTyped-NN-Class.html#t:HasForward" title="Torch.GraduallyTyped.NN.Class">HasForward</a> <a href="Torch-GraduallyTyped-NN-Loss.html#t:MSELoss" title="Torch.GraduallyTyped.NN.Loss">MSELoss</a> (prediction, target) generatorOutputDevice output generatorOutputDevice) =&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:HasForward" title="Torch.GraduallyTyped.NN.Class">HasForward</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) (input, target) generatorDevice output generatorOutputDevice</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-175" class="link">Source</a> <a href="#t:TwoLayerNetwork" class="selflink">#</a></td><td class="doc"><p><code><a href="Torch-GraduallyTyped-NN-Class.html#t:HasForward" title="Torch.GraduallyTyped.NN.Class">HasForward</a></code> instance used to define the forward pass of the model.
 The forward pass is defined as the composition of the forward passes of the two layers.
 A forward pass is a function that takes a two-layer network, an input tensor, and a random generator,
 and returns the output tensor and the updated generator.
 A nonlinearity, <code>tanh</code>, is applied to the output of the first layer.
 The input to the second layer is the output of the nonlinearity.</p></td></tr><tr><td colspan="2"><details id="i:id:TwoLayerNetwork:HasForward:4"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:forward">forward</a> :: <a href="file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/Control-Monad-Catch.html#t:MonadThrow" title="Control.Monad.Catch">MonadThrow</a> m =&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer -&gt; (input, target) -&gt; <a href="Torch-GraduallyTyped-Random.html#t:Generator" title="Torch.GraduallyTyped.Random">Generator</a> generatorDevice -&gt; m (output, <a href="Torch-GraduallyTyped-Random.html#t:Generator" title="Torch.GraduallyTyped.Random">Generator</a> generatorOutputDevice) <a href="src/Torch.GraduallyTyped.NN.Class.html#forward" class="link">Source</a> <a href="#v:forward" class="selflink">#</a></p></div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TwoLayerNetwork:Rep:5"></span> <span class="keyword">type</span> Rep (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer)</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-79" class="link">Source</a> <a href="#t:TwoLayerNetwork" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:TwoLayerNetwork:Rep:5"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="src"><span class="keyword">type</span> Rep (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) = D1 ('MetaData &quot;TwoLayerNetwork&quot; &quot;Torch.GraduallyTyped.Examples.TwoLayerNetwork&quot; &quot;hasktorch-gradually-typed-0.2.0.0-KptyTfWwQbxFdDlMBFuNaD&quot; 'True) (C1 ('MetaCons &quot;TwoLayerNetwork&quot; 'PrefixI 'False) (S1 ('MetaSel ('Nothing :: Maybe <a href="file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/Data-Singletons-TypeLits.html#t:Symbol" title="Data.Singletons.TypeLits">Symbol</a>) '<a href="file:///nix/store/7s89xm3d8vgjndqazcvpba4vcb9r85br-generics-sop-lib-generics-sop-0.5.1.1-haddock-doc/share/doc/generics-sop/html/Generics-SOP-Metadata.html#v:NoSourceUnpackedness" title="Generics.SOP.Metadata">NoSourceUnpackedness</a> '<a href="file:///nix/store/7s89xm3d8vgjndqazcvpba4vcb9r85br-generics-sop-lib-generics-sop-0.5.1.1-haddock-doc/share/doc/generics-sop/html/Generics-SOP-Metadata.html#v:NoSourceStrictness" title="Generics.SOP.Metadata">NoSourceStrictness</a> '<a href="file:///nix/store/7s89xm3d8vgjndqazcvpba4vcb9r85br-generics-sop-lib-generics-sop-0.5.1.1-haddock-doc/share/doc/generics-sop/html/Generics-SOP-Metadata.html#v:DecidedLazy" title="Generics.SOP.Metadata">DecidedLazy</a>) (Rec0 (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelStack" title="Torch.GraduallyTyped.NN.Class">ModelStack</a> '[fstLayer, activation, dropout, sndLayer]))))</div></details></td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:TwoLayerNetwork:ModelSpec:6"></span> <span class="keyword">type</span> <a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer)</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-84" class="link">Source</a> <a href="#t:TwoLayerNetwork" class="selflink">#</a></td><td class="doc"><p>The specification of a two-layer network is the product of the
 specifications of its two layers and the activation function.</p></td></tr><tr><td colspan="2"><details id="i:id:TwoLayerNetwork:ModelSpec:6"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="src"><span class="keyword">type</span> <a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> fstLayer activation dropout sndLayer) = <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> fstLayer) (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> activation) (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> dropout) (<a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> sndLayer)</div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:TwoLayerNetworkF" class="def">TwoLayerNetworkF</a> gradient hasDropout device dataType inputDim outputDim hiddenDim = <a href="Torch-GraduallyTyped-NN-Class.html#t:NamedModel" title="Torch.GraduallyTyped.NN.Class">NamedModel</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetwork" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetwork</a> (<a href="Torch-GraduallyTyped-NN-Class.html#t:NamedModel" title="Torch.GraduallyTyped.NN.Class">NamedModel</a> (<a href="Torch-GraduallyTyped-NN-Linear.html#t:GLinearF" title="Torch.GraduallyTyped.NN.Linear">GLinearF</a> '<a href="Torch-GraduallyTyped-NN-Type.html#v:WithBias" title="Torch.GraduallyTyped.NN.Type">WithBias</a> gradient device dataType inputDim hiddenDim)) <a href="Torch-GraduallyTyped-NN-Activation.html#t:Tanh" title="Torch.GraduallyTyped.NN.Activation">Tanh</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TLNDropoutF" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TLNDropoutF</a> hasDropout) (<a href="Torch-GraduallyTyped-NN-Class.html#t:NamedModel" title="Torch.GraduallyTyped.NN.Class">NamedModel</a> (<a href="Torch-GraduallyTyped-NN-Linear.html#t:GLinearF" title="Torch.GraduallyTyped.NN.Linear">GLinearF</a> '<a href="Torch-GraduallyTyped-NN-Type.html#v:WithBias" title="Torch.GraduallyTyped.NN.Type">WithBias</a> gradient device dataType hiddenDim outputDim))) <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#TwoLayerNetworkF" class="link">Source</a> <a href="#t:TwoLayerNetworkF" class="selflink">#</a></p><div class="doc"><p>Specifies the type of the two-layer network.</p></div></div><div class="top"><p class="src"><span class="keyword">type family</span> <a id="t:TLNDropoutF" class="def">TLNDropoutF</a> hasDropout <span class="keyword">where ...</span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#TLNDropoutF" class="link">Source</a> <a href="#t:TLNDropoutF" class="selflink">#</a></p><div class="doc"><p>Specifies the type of the dropout layer</p></div><div class="subs equations"><p class="caption">Equations</p><table><tr><td class="src"><a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TLNDropoutF" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TLNDropoutF</a> '<a href="Torch-GraduallyTyped-NN-Type.html#v:WithDropout" title="Torch.GraduallyTyped.NN.Type">WithDropout</a> = <a href="Torch-GraduallyTyped-NN-Dropout.html#t:Dropout" title="Torch.GraduallyTyped.NN.Dropout">Dropout</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TLNDropoutF" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TLNDropoutF</a> '<a href="Torch-GraduallyTyped-NN-Type.html#v:WithoutDropout" title="Torch.GraduallyTyped.NN.Type">WithoutDropout</a> = ()</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><a id="v:twoLayerNetworkSpec" class="def">twoLayerNetworkSpec</a> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#twoLayerNetworkSpec" class="link">Source</a> <a href="#v:twoLayerNetworkSpec" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <span class="keyword">forall</span> gradient hasDropout device dataType inputDim outputDim hiddenDim. <a href="Torch-GraduallyTyped-RequiresGradient.html#t:SGradient" title="Torch.GraduallyTyped.RequiresGradient">SGradient</a> gradient</td><td class="doc"><p>whether or not to compute gradients for the parametrs</p></td></tr><tr><td class="src">-&gt; <a href="Torch-GraduallyTyped-NN-Type.html#t:SHasDropout" title="Torch.GraduallyTyped.NN.Type">SHasDropout</a> hasDropout</td><td class="doc"><p>whether or not to use dropout</p></td></tr><tr><td class="src">-&gt; <a href="Torch-GraduallyTyped-Device.html#t:SDevice" title="Torch.GraduallyTyped.Device">SDevice</a> device</td><td class="doc"><p>which device to use</p></td></tr><tr><td class="src">-&gt; <a href="Torch-GraduallyTyped-DType.html#t:SDataType" title="Torch.GraduallyTyped.DType">SDataType</a> dataType</td><td class="doc"><p>which data type to use</p></td></tr><tr><td class="src">-&gt; <a href="Torch-GraduallyTyped-Shape-Type.html#t:SDim" title="Torch.GraduallyTyped.Shape.Type">SDim</a> inputDim</td><td class="doc"><p>input dimension</p></td></tr><tr><td class="src">-&gt; <a href="Torch-GraduallyTyped-Shape-Type.html#t:SDim" title="Torch.GraduallyTyped.Shape.Type">SDim</a> outputDim</td><td class="doc"><p>output dimension</p></td></tr><tr><td class="src">-&gt; <a href="Torch-GraduallyTyped-Shape-Type.html#t:SDim" title="Torch.GraduallyTyped.Shape.Type">SDim</a> hiddenDim</td><td class="doc"><p>hidden dimension</p></td></tr><tr><td class="src">-&gt; Double</td><td class="doc"><p>dropout rate</p></td></tr><tr><td class="src">-&gt; <a href="Torch-GraduallyTyped-NN-Class.html#t:ModelSpec" title="Torch.GraduallyTyped.NN.Class">ModelSpec</a> (<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:TwoLayerNetworkF" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">TwoLayerNetworkF</a> gradient hasDropout device dataType inputDim outputDim hiddenDim)</td><td class="doc"><p>specification for the network</p></td></tr></table></div><div class="doc"><p>Creates a value that specifies the parameters of a two-layer neural network.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:Monitor" class="def">Monitor</a> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#Monitor" class="link">Source</a> <a href="#t:Monitor" class="selflink">#</a></p><div class="doc"><p>Data type for monitoring the training and evaluation losses.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TrainingMonitor" class="def">TrainingMonitor</a></td><td class="doc"><p>monitor for training loss</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:mtLoss" class="def">mtLoss</a> :: Float</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:mtEpoch" class="def">mtEpoch</a> :: Int</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:EvaluationMonitor" class="def">EvaluationMonitor</a></td><td class="doc"><p>monitor for evaluation loss</p></td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:meLoss" class="def">meLoss</a> :: Float</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:meEpoch" class="def">meEpoch</a> :: Int</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:Monitor">Instances</h4><details id="i:Monitor" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:Monitor:Show:1"></span> Show <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:Monitor" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">Monitor</a></span> <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#line-201" class="link">Source</a> <a href="#t:Monitor" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:Monitor:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html">Torch.GraduallyTyped.Examples.TwoLayerNetwork</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: Int -&gt; <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:Monitor" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">Monitor</a> -&gt; <a href="file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/Data-Singletons-Prelude.html#t:ShowS" title="Data.Singletons.Prelude">ShowS</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:Monitor" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">Monitor</a> -&gt; String</p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:Monitor" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">Monitor</a>] -&gt; <a href="file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/Data-Singletons-Prelude.html#t:ShowS" title="Data.Singletons.Prelude">ShowS</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:monitor" class="def">monitor</a> :: <a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes.html#t:MonadIO" title="Pipes">MonadIO</a> m =&gt; <a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes-Core.html#t:Consumer" title="Pipes.Core">Consumer</a> <a href="Torch-GraduallyTyped-Examples-TwoLayerNetwork.html#t:Monitor" title="Torch.GraduallyTyped.Examples.TwoLayerNetwork">Monitor</a> m r <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#monitor" class="link">Source</a> <a href="#v:monitor" class="selflink">#</a></p><div class="doc"><p>A simple monitor that prints the training and evaluation losses to stdout.</p></div></div><div class="top"><p class="src"><a id="v:collate" class="def">collate</a> :: <span class="keyword">forall</span> device r input target. (input ~ <a href="Torch-GraduallyTyped-Tensor-Type.html#t:Tensor" title="Torch.GraduallyTyped.Tensor.Type">Tensor</a> ('<a href="Torch-GraduallyTyped-RequiresGradient.html#v:Gradient" title="Torch.GraduallyTyped.RequiresGradient">Gradient</a> '<a href="Torch-GraduallyTyped-RequiresGradient.html#v:WithoutGradient" title="Torch.GraduallyTyped.RequiresGradient">WithoutGradient</a>) ('<a href="Torch-GraduallyTyped-Layout.html#v:Layout" title="Torch.GraduallyTyped.Layout">Layout</a> '<a href="Torch-GraduallyTyped-Layout.html#v:Dense" title="Torch.GraduallyTyped.Layout">Dense</a>) device ('<a href="Torch-GraduallyTyped-DType.html#v:DataType" title="Torch.GraduallyTyped.DType">DataType</a> '<a href="Torch-GraduallyTyped-DType.html#v:Float" title="Torch.GraduallyTyped.DType">Float</a>) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Shape" title="Torch.GraduallyTyped.Shape.Type">Shape</a> '['<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) '<a href="Torch-GraduallyTyped-Shape-Type.html#v:UncheckedSize" title="Torch.GraduallyTyped.Shape.Type">UncheckedSize</a>, '<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Size" title="Torch.GraduallyTyped.Shape.Type">Size</a> 1)]), target ~ <a href="Torch-GraduallyTyped-Tensor-Type.html#t:Tensor" title="Torch.GraduallyTyped.Tensor.Type">Tensor</a> ('<a href="Torch-GraduallyTyped-RequiresGradient.html#v:Gradient" title="Torch.GraduallyTyped.RequiresGradient">Gradient</a> '<a href="Torch-GraduallyTyped-RequiresGradient.html#v:WithoutGradient" title="Torch.GraduallyTyped.RequiresGradient">WithoutGradient</a>) ('<a href="Torch-GraduallyTyped-Layout.html#v:Layout" title="Torch.GraduallyTyped.Layout">Layout</a> '<a href="Torch-GraduallyTyped-Layout.html#v:Dense" title="Torch.GraduallyTyped.Layout">Dense</a>) device ('<a href="Torch-GraduallyTyped-DType.html#v:DataType" title="Torch.GraduallyTyped.DType">DataType</a> '<a href="Torch-GraduallyTyped-DType.html#v:Float" title="Torch.GraduallyTyped.DType">Float</a>) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Shape" title="Torch.GraduallyTyped.Shape.Type">Shape</a> '['<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) '<a href="Torch-GraduallyTyped-Shape-Type.html#v:UncheckedSize" title="Torch.GraduallyTyped.Shape.Type">UncheckedSize</a>, '<a href="Torch-GraduallyTyped-Shape-Type.html#v:Dim" title="Torch.GraduallyTyped.Shape.Type">Dim</a> ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Name" title="Torch.GraduallyTyped.Shape.Type">Name</a> &quot;*&quot;) ('<a href="Torch-GraduallyTyped-Shape-Type.html#v:Size" title="Torch.GraduallyTyped.Shape.Type">Size</a> 1)])) =&gt; <a href="Torch-GraduallyTyped-Device.html#t:SDevice" title="Torch.GraduallyTyped.Device">SDevice</a> device -&gt; Int -&gt; <a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes.html#t:ListT" title="Pipes">ListT</a> IO (Float, Float) -&gt; ContT r IO (<a href="file:///nix/store/2275zkfvd9na2mx7hmkq7wzrgjyxz84l-pipes-lib-pipes-4.3.15-haddock-doc/share/doc/pipes/html/Pipes.html#t:ListT" title="Pipes">ListT</a> IO (input, target)) <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#collate" class="link">Source</a> <a href="#v:collate" class="selflink">#</a></p><div class="doc"><p>Collate a stream of examples into batches.
 The returned batches are of the form <code>(input, target)</code>,
 where <code>(input, target)</code> is a pair of tensors.
 <code>input</code> and <code>target</code> are both of shape:</p><pre>Dim (SName @&quot;*&quot;) (UncheckedSize batchSize) :|: Dim (SName @&quot;*&quot;) (SSize @1) :|: SNil</pre><p>where <code>batchSize</code> is the number of examples in the batch.</p></div></div><div class="top"><p class="src"><a id="v:runTwoLayerNetworkExample" class="def">runTwoLayerNetworkExample</a> :: IO () <a href="src/Torch.GraduallyTyped.Examples.TwoLayerNetwork.html#runTwoLayerNetworkExample" class="link">Source</a> <a href="#v:runTwoLayerNetworkExample" class="selflink">#</a></p><div class="doc"><p>Run the two-layer network training loop on a toy dataset.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.0</p></div></body></html>