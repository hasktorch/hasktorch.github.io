<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# OPTIONS_GHC -v2 #-}</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.BART.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">Control.Monad.Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">MonadThrow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier">SDType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDeviceType"><span class="hs-identifier">SDeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier">initialize</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier">EDTDecoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier">EDTEncoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier">EDTHeadF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier">EDTSharedEmbeddingF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier">GEncoderDecoderTransformer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier">encoderDecoderTransformerSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier">SWithLMHead</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier">SBART</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier">ShiftRight</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier">BART</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier">mkTransformerInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier">MkAbsPos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier">MkTransformerPaddingMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier">MkTransformerAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html"><span class="hs-identifier">Torch.GraduallyTyped.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier">sMkGenerator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SRequiresGradient"><span class="hs-identifier">SRequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier">SName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier">SSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator">(:&amp;:)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Creation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html#sOnes"><span class="hs-identifier">sOnes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier">SGetDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier">TensorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | BART dType.</span><span>
</span><span id="line-46"></span><span class="hs-keyword">type</span><span> </span><span id="BARTDType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDType"><span class="hs-identifier hs-var">BARTDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | BART dType singleton.</span><span>
</span><span id="line-49"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDType"><span class="hs-identifier hs-type">bartDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier hs-type">SDType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDType"><span class="hs-identifier hs-type">BARTDType</span></a></span><span>
</span><span id="line-50"></span><span id="bartDType"><span class="annot"><span class="annottext">bartDType :: SDType BARTDType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDType"><span class="hs-identifier hs-var hs-var">bartDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI BARTDType =&gt; Sing BARTDType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDType"><span class="hs-identifier hs-type">BARTDType</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | BART data type.</span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span id="BARTDataType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-var">BARTDataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDType"><span class="hs-identifier hs-type">BARTDType</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | BART data type singleton.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-type">bartDataType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span>
</span><span id="line-57"></span><span id="bartDataType"><span class="annot"><span class="annottext">bartDataType :: SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var hs-var">bartDataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI BARTDataType =&gt; Sing BARTDataType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | BART dropout rate.</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- 'dropout_rate = 0.1'</span><span>
</span><span id="line-61"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDropoutP"><span class="hs-identifier hs-type">bartDropoutP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-62"></span><span id="bartDropoutP"><span class="annot"><span class="annottext">bartDropoutP :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDropoutP"><span class="hs-identifier hs-var hs-var">bartDropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | BART positional encoding dimension.</span><span>
</span><span id="line-65"></span><span class="hs-keyword">type</span><span> </span><span id="BARTPosEncDim"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTPosEncDim"><span class="hs-identifier hs-var">BARTPosEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">1026</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | BART positional encoding dimension singleton.</span><span>
</span><span id="line-68"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPosEncDim"><span class="hs-identifier hs-type">bartPosEncDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTPosEncDim"><span class="hs-identifier hs-type">BARTPosEncDim</span></a></span><span>
</span><span id="line-69"></span><span id="bartPosEncDim"><span class="annot"><span class="annottext">bartPosEncDim :: SDim BARTPosEncDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPosEncDim"><span class="hs-identifier hs-var hs-var">bartPosEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI BARTPosEncDim =&gt; Sing BARTPosEncDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTPosEncDim"><span class="hs-identifier hs-type">BARTPosEncDim</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | BART layer-norm epsilon.</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEps"><span class="hs-identifier hs-type">bartEps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-73"></span><span id="bartEps"><span class="annot"><span class="annottext">bartEps :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEps"><span class="hs-identifier hs-var hs-var">bartEps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-5</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | BART maximum number of position embeddings.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- 'max_position_embeddings = 1024'</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartMaxPositionEmbeddings"><span class="hs-identifier hs-type">bartMaxPositionEmbeddings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-78"></span><span id="bartMaxPositionEmbeddings"><span class="annot"><span class="annottext">bartMaxPositionEmbeddings :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartMaxPositionEmbeddings"><span class="hs-identifier hs-var hs-var">bartMaxPositionEmbeddings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1024</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | BART padding token id.</span><span>
</span><span id="line-81"></span><span class="hs-comment">-- 'pad_token_id = 1'</span><span>
</span><span id="line-82"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPadTokenId"><span class="hs-identifier hs-type">bartPadTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-83"></span><span id="bartPadTokenId"><span class="annot"><span class="annottext">bartPadTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPadTokenId"><span class="hs-identifier hs-var hs-var">bartPadTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-84"></span><span>
</span><span id="line-85"></span><span class="hs-comment">-- | BART begin-of-sentence token id.</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- 'bos_token_id = 0'</span><span>
</span><span id="line-87"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartBOSTokenId"><span class="hs-identifier hs-type">bartBOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-88"></span><span id="bartBOSTokenId"><span class="annot"><span class="annottext">bartBOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartBOSTokenId"><span class="hs-identifier hs-var hs-var">bartBOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-comment">-- | BART end-of-sentence token id.</span><span>
</span><span id="line-91"></span><span class="hs-comment">-- 'eos_token_id = 2'</span><span>
</span><span id="line-92"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEOSTokenId"><span class="hs-identifier hs-type">bartEOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-93"></span><span id="bartEOSTokenId"><span class="annot"><span class="annottext">bartEOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEOSTokenId"><span class="hs-identifier hs-var hs-var">bartEOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="hs-comment">-- | BART attention mask bias</span><span>
</span><span id="line-96"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-type">bartAttentionMaskBias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-97"></span><span id="bartAttentionMaskBias"><span class="annot"><span class="annottext">bartAttentionMaskBias :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-var hs-var">bartAttentionMaskBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10000</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-comment">-- | Specifies the BART model.</span><span>
</span><span id="line-100"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-101"></span><span>  </span><span id="BARTModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTModelF"><span class="hs-identifier hs-var">BARTModelF</span></a></span></span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585391"><span class="annot"><a href="#local-6989586621679585391"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585390"><span class="annot"><a href="#local-6989586621679585390"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585389"><span class="annot"><a href="#local-6989586621679585389"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585388"><span class="annot"><a href="#local-6989586621679585388"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585387"><span class="annot"><a href="#local-6989586621679585387"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585386"><span class="annot"><a href="#local-6989586621679585386"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585385"><span class="annot"><a href="#local-6989586621679585385"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585384"><span class="annot"><a href="#local-6989586621679585384"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585383"><span class="annot"><a href="#local-6989586621679585383"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679585382"><span class="annot"><a href="#local-6989586621679585382"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-114"></span><span>  </span><span id="BARTModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTModelF"><span class="hs-identifier hs-var">BARTModelF</span></a></span></span><span> </span><span id="local-6989586621679585381"><span class="annot"><a href="#local-6989586621679585381"><span class="hs-identifier hs-type hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679585380"><span class="annot"><a href="#local-6989586621679585380"><span class="hs-identifier hs-type hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679585379"><span class="annot"><a href="#local-6989586621679585379"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679585378"><span class="annot"><a href="#local-6989586621679585378"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679585377"><span class="annot"><a href="#local-6989586621679585377"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679585376"><span class="annot"><a href="#local-6989586621679585376"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679585375"><span class="annot"><a href="#local-6989586621679585375"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679585374"><span class="annot"><a href="#local-6989586621679585374"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679585373"><span class="annot"><a href="#local-6989586621679585373"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679585372"><span class="annot"><a href="#local-6989586621679585372"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-117"></span><span>          </span><span class="annot"><a href="#local-6989586621679585374"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-118"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-type">EDTEncoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585380"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585378"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585377"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585376"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585375"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585374"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585373"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTPosEncDim"><span class="hs-identifier hs-type">BARTPosEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-type">EDTDecoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585380"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585378"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585377"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585376"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585375"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585374"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585373"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTPosEncDim"><span class="hs-identifier hs-type">BARTPosEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-type">EDTSharedEmbeddingF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585378"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585374"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585372"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-type">EDTHeadF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585381"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585378"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585374"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585372"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier hs-type">MkAbsPos</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier hs-type">MkAbsPos</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-type">MkTransformerPaddingMask</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-type">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-type">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-type">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTDataType"><span class="hs-identifier hs-type">BARTDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-comment">-- | Specifies the parameters of a BART model.</span><span>
</span><span id="line-131"></span><span class="hs-comment">--</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- - @transformerHead@: the head of the BART model.</span><span>
</span><span id="line-133"></span><span class="hs-comment">-- - @numLayers@: the number of layers in the BART model.</span><span>
</span><span id="line-134"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the BART model.</span><span>
</span><span id="line-135"></span><span class="hs-comment">-- - @device@: the computational device on which the BART model parameters are to be allocated.</span><span>
</span><span id="line-136"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartModelSpec"><span class="hs-identifier hs-type">bartModelSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679585370"><span class="annot"><a href="#local-6989586621679585370"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679585369"><span class="annot"><a href="#local-6989586621679585369"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679585368"><span class="annot"><a href="#local-6989586621679585368"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679585367"><span class="annot"><a href="#local-6989586621679585367"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679585366"><span class="annot"><a href="#local-6989586621679585366"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679585365"><span class="annot"><a href="#local-6989586621679585365"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679585364"><span class="annot"><a href="#local-6989586621679585364"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679585363"><span class="annot"><a href="#local-6989586621679585363"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679585362"><span class="annot"><a href="#local-6989586621679585362"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679585361"><span class="annot"><a href="#local-6989586621679585361"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585366"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585365"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585364"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585363"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585362"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585361"><span class="hs-identifier hs-type">vocabDim</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585370"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585369"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585368"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585367"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#BARTModelF"><span class="hs-identifier hs-type">BARTModelF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585370"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585369"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585368"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585367"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585366"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585365"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585364"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585363"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585362"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585361"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span id="bartModelSpec"><span class="annot"><span class="annottext">bartModelSpec :: STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; ModelSpec
     (BARTModelF
        transformerHead
        numLayers
        gradient
        device
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        vocabDim)
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartModelSpec"><span class="hs-identifier hs-var hs-var">bartModelSpec</span></a></span></span><span> </span><span id="local-6989586621679585360"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679585360"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679585359"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679585359"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679585358"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679585358"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679585357"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679585357"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-151"></span><span>  </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim
  (NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              BARTDataType
              BARTPosEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device BARTDataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                BARTDataType
                                ('Shape '[inputEmbedDim])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                BARTDataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              BARTDataType
              BARTPosEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device BARTDataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                BARTDataType
                                ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                BARTDataType
                                ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                BARTDataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ()))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        BARTDataType
        vocabDim
        inputEmbedDim
        'Nothing))
  (ModelSpec
     (EDTHeadF
        'BART
        transformerHead
        gradient
        device
        BARTDataType
        inputEmbedDim
        vocabDim))
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; MkAbsPos
-&gt; MkAbsPos
-&gt; MkTransformerPaddingMask
-&gt; MkTransformerAttentionMask BARTDataType
-&gt; MkTransformerCrossAttentionMask BARTDataType
-&gt; MkTransformerDecoderAttentionMask BARTDataType
-&gt; GSimplifiedEncoderDecoderTransformer
     (GEncoderDecoderTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    BARTDataType
                    BARTPosEncDim
                    inputEmbedDim
                    'Nothing))
              ()
              (NamedModel
                 (LayerNormSpec
                    'WithBias gradient device BARTDataType ('Shape '[inputEmbedDim])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim])))))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[ffnDim])))))
                                Gelu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim])))))))))
              ()
              ()))
        (NamedModel
           (GTransformer
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    BARTDataType
                    BARTPosEncDim
                    inputEmbedDim
                    'Nothing))
              ()
              (NamedModel
                 (LayerNormSpec
                    'WithBias gradient device BARTDataType ('Shape '[inputEmbedDim])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim])))))
                          (NamedModel
                             (GCrossAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  BARTDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim])))))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[ffnDim])))))
                                Gelu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            BARTDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      BARTDataType
                                      ('Shape '[inputEmbedDim])))))))))
              ()
              ()))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              BARTDataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EDTHeadF
              'BART
              transformerHead
              gradient
              device
              BARTDataType
              inputEmbedDim
              vocabDim)))
     MkAbsPos
     MkAbsPos
     MkTransformerPaddingMask
     (MkTransformerAttentionMask BARTDataType)
     (MkTransformerCrossAttentionMask BARTDataType)
     (MkTransformerDecoderAttentionMask BARTDataType)
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType BARTDataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim BARTPosEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           'BART
           numLayers
           gradient
           device
           BARTDataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           BARTPosEncDim)
        (EDTDecoderF
           'BART
           numLayers
           gradient
           device
           BARTDataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           BARTPosEncDim)
        (EDTSharedEmbeddingF
           'BART gradient device BARTDataType inputEmbedDim vocabDim)
        (EDTHeadF
           'BART
           transformerHead
           gradient
           device
           BARTDataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numEncoderLayers :: Nat)
       (numDecoderLayers :: Nat) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           style
           numEncoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTDecoderF
           style
           numDecoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTSharedEmbeddingF
           style gradient device dataType inputEmbedDim vocabDim)
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var">encoderDecoderTransformerSpec</span></a></span><span>
</span><span id="line-153"></span><span>        </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679585360"><span class="hs-identifier hs-var">transformerHead</span></a></span><span>
</span><span id="line-155"></span><span>        </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679585359"><span class="hs-identifier hs-var">numLayers</span></a></span><span>
</span><span id="line-156"></span><span>        </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679585359"><span class="hs-identifier hs-var">numLayers</span></a></span><span>
</span><span id="line-157"></span><span>        </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679585358"><span class="hs-identifier hs-var">gradient</span></a></span><span>
</span><span id="line-158"></span><span>        </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679585357"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-159"></span><span>        </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span>
</span><span id="line-160"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headDim =&gt; Sing headDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679585366"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headEmbedDim =&gt; Sing headEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679585365"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI embedDim =&gt; Sing embedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679585364"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI inputEmbedDim =&gt; Sing inputEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679585363"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI ffnDim =&gt; Sing ffnDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679585362"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>        </span><span class="annot"><span class="annottext">SDim BARTPosEncDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPosEncDim"><span class="hs-identifier hs-var">bartPosEncDim</span></a></span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI vocabDim =&gt; Sing vocabDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679585361"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDropoutP"><span class="hs-identifier hs-var">bartDropoutP</span></a></span><span>
</span><span id="line-168"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEps"><span class="hs-identifier hs-var">bartEps</span></a></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEOSTokenId"><span class="hs-identifier hs-var">bartEOSTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkAbsPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPosWithOffset"><span class="hs-identifier hs-var">MkAbsPosWithOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkAbsPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPosWithOffset"><span class="hs-identifier hs-var">MkAbsPosWithOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPadTokenId"><span class="hs-identifier hs-var">bartPadTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; Double -&gt; MkTransformerAttentionMask BARTDataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-var">bartAttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask BARTDataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-var">bartAttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask BARTDataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-var">bartAttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#mkBARTInput"><span class="hs-identifier hs-type">mkBARTInput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679585348"><span class="annot"><a href="#local-6989586621679585348"><span class="hs-identifier hs-type">batchDim</span></a></span></span><span> </span><span id="local-6989586621679585347"><span class="annot"><a href="#local-6989586621679585347"><span class="hs-identifier hs-type">seqDim</span></a></span></span><span> </span><span id="local-6989586621679585346"><span class="annot"><a href="#local-6989586621679585346"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679585345"><span class="annot"><a href="#local-6989586621679585345"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679585344"><span class="annot"><a href="#local-6989586621679585344"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier hs-type">MonadThrow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585345"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585348"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585347"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679585348"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679585347"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-185"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span>
</span><span id="line-186"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-187"></span><span>              </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-188"></span><span>                 </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span>
</span><span id="line-189"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-190"></span><span>              </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679585348"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679585347"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-191"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679585348"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679585347"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="#local-6989586621679585344"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-195"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithoutGradient"><span class="hs-identifier hs-type">WithoutGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>          </span><span class="annot"><a href="#local-6989586621679585346"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-198"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679585348"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679585347"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585348"><span class="hs-identifier hs-type">batchDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585347"><span class="hs-identifier hs-type">seqDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585346"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="#local-6989586621679585345"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679585344"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-206"></span><span id="mkBARTInput"><span class="annot"><span class="annottext">mkBARTInput :: SDim batchDim
-&gt; SDim seqDim -&gt; SDevice device -&gt; [[Int]] -&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#mkBARTInput"><span class="hs-identifier hs-var hs-var">mkBARTInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
forall (batchDim :: Dim (Name Symbol) (Size Nat))
       (seqDim :: Dim (Name Symbol) (Size Nat))
       (device :: Device (DeviceType Nat)) (m :: * -&gt; *) output.
(MonadThrow m, SGetDim batchDim, SGetDim seqDim,
 'Shape '[batchDim, seqDim]
 ~ Seq
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize,
           'Dim ('Name &quot;*&quot;) 'UncheckedSize]
      &lt;+&gt; 'Shape '[batchDim, seqDim])
     ('Shape '[batchDim, seqDim]),
 output
 ~ Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     device
     ('DataType 'Int64)
     ('Shape '[batchDim, seqDim])) =&gt;
Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier hs-var">mkTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPadTokenId"><span class="hs-identifier hs-var">bartPadTokenId</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#testBart"><span class="hs-identifier hs-type">testBart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-209"></span><span id="testBart"><span class="annot"><span class="annottext">testBart :: IO
  ((EncoderDecoderTransformerOutput
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         BARTDataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
               'Dim ('Name &quot;*&quot;) ('Size 32128)]))
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         BARTDataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
               'Dim ('Name &quot;*&quot;) ('Size 512)])),
    SimplifiedEncoderDecoderTransformerOutput
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         BARTDataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
               'Dim ('Name &quot;*&quot;) ('Size 32128)]))
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         BARTDataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
               'Dim ('Name &quot;*&quot;) ('Size 512)]))
      (Tensor
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         ('DataType 'Bool)
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))),
   Generator ('Device 'CPU))
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#testBart"><span class="hs-identifier hs-var hs-var">testBart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679585342"><span class="annot"><span class="annottext">gradient :: SGradient ('Gradient 'WithGradient)
</span><a href="#local-6989586621679585342"><span class="hs-identifier hs-var hs-var">gradient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
-&gt; SGradient ('Gradient 'WithGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithGradient"><span class="hs-identifier hs-var">SWithGradient</span></a></span><span>
</span><span id="line-211"></span><span>      </span><span id="local-6989586621679585339"><span class="annot"><span class="annottext">device :: SDevice ('Device 'CPU)
</span><a href="#local-6989586621679585339"><span class="hs-identifier hs-var hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDeviceType 'CPU -&gt; SDevice ('Device 'CPU)
forall (deviceType :: DeviceType Nat).
SDeviceType deviceType -&gt; SDevice ('Device deviceType)
</span><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-var">SDevice</span></a></span><span> </span><span class="annot"><span class="annottext">SDeviceType 'CPU
</span><a href="Torch.GraduallyTyped.Device.html#SCPU"><span class="hs-identifier hs-var">SCPU</span></a></span><span>
</span><span id="line-212"></span><span>      </span><span id="local-6989586621679585336"><span class="annot"><span class="annottext">headDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
</span><a href="#local-6989586621679585336"><span class="hs-identifier hs-var hs-var">headDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 8) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 8 =&gt; SSize ('Size 8)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-213"></span><span>      </span><span id="local-6989586621679585333"><span class="annot"><span class="annottext">headEmbedDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
</span><a href="#local-6989586621679585333"><span class="hs-identifier hs-var hs-var">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 64) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 64 =&gt; SSize ('Size 64)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-214"></span><span>      </span><span id="local-6989586621679585332"><span class="annot"><span class="annottext">embedDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679585332"><span class="hs-identifier hs-var hs-var">embedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 512) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 512 =&gt; SSize ('Size 512)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">512</span></span><span>
</span><span id="line-215"></span><span>      </span><span id="local-6989586621679585331"><span class="annot"><span class="annottext">inputEmbedDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679585331"><span class="hs-identifier hs-var hs-var">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 512) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 512 =&gt; SSize ('Size 512)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">512</span></span><span>
</span><span id="line-216"></span><span>      </span><span id="local-6989586621679585330"><span class="annot"><span class="annottext">ffnDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
</span><a href="#local-6989586621679585330"><span class="hs-identifier hs-var hs-var">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 2048) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 2048 =&gt; SSize ('Size 2048)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2048</span></span><span>
</span><span id="line-217"></span><span>      </span><span id="local-6989586621679585329"><span class="annot"><span class="annottext">vocabDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
</span><a href="#local-6989586621679585329"><span class="hs-identifier hs-var hs-var">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 32128) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 32128 =&gt; SSize ('Size 32128)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">32128</span></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679585328"><span class="annot"><span class="annottext">g :: Generator ('Device 'CPU)
</span><a href="#local-6989586621679585328"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU) -&gt; Word64 -&gt; Generator ('Device 'CPU)
forall (device :: Device (DeviceType Nat)).
SDevice device -&gt; Word64 -&gt; Generator device
</span><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier hs-var">sMkGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679585339"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679585327"><span class="annot"><span class="annottext">batchDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679585327"><span class="hs-identifier hs-var hs-var">batchDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 3) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 3 =&gt; SSize ('Size 3)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-220"></span><span>      </span><span id="local-6989586621679585326"><span class="annot"><span class="annottext">seqDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679585326"><span class="hs-identifier hs-var hs-var">seqDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 13) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 13 =&gt; SSize ('Size 13)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">13</span></span><span>
</span><span id="line-221"></span><span>      </span><span id="local-6989586621679585325"><span class="annot"><span class="annottext">decoderSeqDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679585325"><span class="hs-identifier hs-var hs-var">decoderSeqDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 7) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 7 =&gt; SSize ('Size 7)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">7</span></span><span>
</span><span id="line-222"></span><span>      </span><span id="local-6989586621679585324"><span class="annot"><span class="annottext">sOnes' :: SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var hs-var">sOnes'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TensorSpec
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  dataType
  shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
TensorSpec gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Creation.html#sOnes"><span class="hs-identifier hs-var">sOnes</span></a></span><span> </span><span class="annot"><span class="annottext">(TensorSpec
   ('Gradient 'WithoutGradient)
   ('Layout 'Dense)
   ('Device 'CPU)
   dataType
   shape
 -&gt; Tensor
      ('Gradient 'WithoutGradient)
      ('Layout 'Dense)
      ('Device 'CPU)
      dataType
      shape)
-&gt; (SShape shape
    -&gt; TensorSpec
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         dataType
         shape)
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((SShape shape
  -&gt; TensorSpec
       ('Gradient 'WithoutGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       dataType
       shape)
 -&gt; SShape shape
 -&gt; Tensor
      ('Gradient 'WithoutGradient)
      ('Layout 'Dense)
      ('Device 'CPU)
      dataType
      shape)
-&gt; (SDataType dataType
    -&gt; SShape shape
    -&gt; TensorSpec
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         dataType
         shape)
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithoutGradient)
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice ('Device 'CPU)
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; TensorSpec
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; TensorSpec gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier hs-var">TensorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
-&gt; SGradient ('Gradient 'WithoutGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithoutGradient"><span class="hs-identifier hs-var">SWithoutGradient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679585339"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span id="local-6989586621679585318"><span class="annot"><span class="annottext">edtInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679585318"><span class="hs-identifier hs-var hs-var">edtInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679585327"><span class="hs-identifier hs-var">batchDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679585326"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>      </span><span id="local-6989586621679585313"><span class="annot"><span class="annottext">edtAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679585313"><span class="hs-identifier hs-var hs-var">edtAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
     'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
      'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
            'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 13), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679585326"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 13), 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679585326"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>      </span><span id="local-6989586621679585312"><span class="annot"><span class="annottext">edtDecoderInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679585312"><span class="hs-identifier hs-var hs-var">edtDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679585327"><span class="hs-identifier hs-var">batchDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679585325"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>      </span><span id="local-6989586621679585311"><span class="annot"><span class="annottext">edtDecoderAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679585311"><span class="hs-identifier hs-var hs-var">edtDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
     'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
      'Dim ('Name &quot;*&quot;) ('Size 7)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
            'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679585325"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679585325"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>      </span><span id="local-6989586621679585310"><span class="annot"><span class="annottext">edtCrossAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679585310"><span class="hs-identifier hs-var hs-var">edtCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
     'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
      'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
            'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679585325"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679585326"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679585309"><span class="annot"><span class="annottext">spec :: ModelSpec
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (EDTEncoderF
        'BART
        4
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 8))
        ('Dim ('Name &quot;*&quot;) ('Size 64))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 2048))
        BARTPosEncDim)
     (EDTDecoderF
        'BART
        4
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 8))
        ('Dim ('Name &quot;*&quot;) ('Size 64))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 2048))
        BARTPosEncDim)
     (EDTSharedEmbeddingF
        'BART
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 32128)))
     (EDTHeadF
        'BART
        'WithLMHead
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 32128))))
</span><a href="#local-6989586621679585309"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; STransformerHead 'WithLMHead
-&gt; SNat 4
-&gt; SNat 4
-&gt; SGradient ('Gradient 'WithGradient)
-&gt; SDevice ('Device 'CPU)
-&gt; SDataType BARTDataType
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
-&gt; SDim BARTPosEncDim
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        (EDTEncoderF
           'BART
           4
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 8))
           ('Dim ('Name &quot;*&quot;) ('Size 64))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 2048))
           BARTPosEncDim)
        (EDTDecoderF
           'BART
           4
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 8))
           ('Dim ('Name &quot;*&quot;) ('Size 64))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 2048))
           BARTPosEncDim)
        (EDTSharedEmbeddingF
           'BART
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 32128)))
        (EDTHeadF
           'BART
           'WithLMHead
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 32128))))
forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numEncoderLayers :: Nat)
       (numDecoderLayers :: Nat) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           style
           numEncoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTDecoderF
           style
           numDecoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTSharedEmbeddingF
           style gradient device dataType inputEmbedDim vocabDim)
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var">encoderDecoderTransformerSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead 'WithLMHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat 4 =&gt; SNat 4
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNat</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat 4 =&gt; SNat 4
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNat</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithGradient)
</span><a href="#local-6989586621679585342"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679585339"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
</span><a href="#local-6989586621679585336"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
</span><a href="#local-6989586621679585333"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679585332"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679585331"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
</span><a href="#local-6989586621679585330"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim BARTPosEncDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPosEncDim"><span class="hs-identifier hs-var">bartPosEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
</span><a href="#local-6989586621679585329"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDropoutP"><span class="hs-identifier hs-var">bartDropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEps"><span class="hs-identifier hs-var">bartEps</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679585308"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                       'Dim ('Name &quot;*&quot;) ('Size 32128)]))))))
</span><a href="#local-6989586621679585308"><span class="hs-identifier hs-var">sedtModel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679585307"><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679585307"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GCrossAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       BARTDataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                          'Dim ('Name &quot;*&quot;) ('Size 32128)])))))))
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (GEncoderDecoderTransformer
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        (NamedModel
           (GTransformer
              (NamedModel
                 (Embedding
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    BARTPosEncDim
                    ('Dim ('Name &quot;*&quot;) ('Size 512))
                    'Nothing))
              ()
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (Vector
                       4
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 8))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 512))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                                Gelu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
              ()
              ()))
        (NamedModel
           (GTransformer
              (NamedModel
                 (Embedding
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    BARTPosEncDim
                    ('Dim ('Name &quot;*&quot;) ('Size 512))
                    'Nothing))
              ()
              (NamedModel
                 (LayerNorm
                    'WithBias
                    ('Gradient 'WithGradient)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (Vector
                       4
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 8))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 512))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          (NamedModel
                             (GCrossAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 8))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 512))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  BARTDataType
                                                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                                Gelu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
              ()
              ()))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              ('Dim ('Name &quot;*&quot;) ('Size 32128))
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        (NamedModel
           (GLMHead
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              ()
              ()
              ()
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          BARTDataType
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                    (NamedModel ())))
              (GBias
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       BARTDataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                             'Dim ('Name &quot;*&quot;) ('Size 32128)])))))),
      Generator ('Device 'CPU))
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GCrossAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       BARTDataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                          'Dim ('Name &quot;*&quot;) ('Size 32128)])))))))
GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (EmbeddingSpec
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (TensorSpec
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                       'Dim ('Name &quot;*&quot;) ('Size 32128)]))))))
</span><a href="#local-6989586621679585309"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679585328"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679585306"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
</span><a href="#local-6989586621679585306"><span class="hs-identifier hs-var">bartOutput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679585305"><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679585305"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679585304"><span class="annot"><span class="annottext">edtPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679585304"><span class="hs-identifier hs-var hs-var">edtPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679585326"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>        </span><span id="local-6989586621679585303"><span class="annot"><span class="annottext">edtDecoderPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679585303"><span class="hs-identifier hs-var hs-var">edtDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679585324"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
 -&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679585325"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                       'Dim ('Name &quot;*&quot;) ('Size 32128)]))))))
-&gt; EncoderDecoderTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
              'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
              'Dim ('Name &quot;*&quot;) ('Size 7)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
              'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (EncoderDecoderTransformerOutput
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
                 'Dim ('Name &quot;*&quot;) ('Size 32128)]))
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                 'Dim ('Name &quot;*&quot;) ('Size 512)])),
      Generator ('Device 'CPU))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                       'Dim ('Name &quot;*&quot;) ('Size 32128)]))))))
</span><a href="#local-6989586621679585308"><span class="hs-identifier hs-var">sedtModel</span></a></span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerInput :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
input
-&gt; decoderInput
-&gt; pos
-&gt; decoderPos
-&gt; attentionMask
-&gt; decoderAttentionMask
-&gt; crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtCrossAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
edtAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
edtPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
edtInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 7)])
edtPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 13)])
edtCrossAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
edtDecoderInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
edtAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  BARTDataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtCrossAttentionMask"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679585307"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679585293"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Bool)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
</span><a href="#local-6989586621679585293"><span class="hs-identifier hs-var">bartOutput'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679585292"><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679585292"><span class="hs-identifier hs-var">g'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679585291"><span class="annot"><span class="annottext">sedtDecoderInputShift :: ShiftRight Int
</span><a href="#local-6989586621679585291"><span class="hs-identifier hs-var hs-var">sedtDecoderInputShift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartEOSTokenId"><span class="hs-identifier hs-var">bartEOSTokenId</span></a></span><span>
</span><span id="line-236"></span><span>        </span><span id="local-6989586621679585290"><span class="annot"><span class="annottext">sedtPaddingMaskShift :: ShiftRight Int
</span><a href="#local-6989586621679585290"><span class="hs-identifier hs-var hs-var">sedtPaddingMaskShift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-237"></span><span>        </span><span id="local-6989586621679585289"><span class="annot"><span class="annottext">sedtMkPos :: MkAbsPos
</span><a href="#local-6989586621679585289"><span class="hs-identifier hs-var hs-var">sedtMkPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MkAbsPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPosWithOffset"><span class="hs-identifier hs-var">MkAbsPosWithOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-238"></span><span>        </span><span id="local-6989586621679585288"><span class="annot"><span class="annottext">sedtMkDecoderPos :: MkAbsPos
</span><a href="#local-6989586621679585288"><span class="hs-identifier hs-var hs-var">sedtMkDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MkAbsPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPosWithOffset"><span class="hs-identifier hs-var">MkAbsPosWithOffset</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-239"></span><span>        </span><span id="local-6989586621679585287"><span class="annot"><span class="annottext">sedtMkPaddingMask :: MkTransformerPaddingMask
</span><a href="#local-6989586621679585287"><span class="hs-identifier hs-var hs-var">sedtMkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartPadTokenId"><span class="hs-identifier hs-var">bartPadTokenId</span></a></span><span>
</span><span id="line-240"></span><span>        </span><span id="local-6989586621679585286"><span class="annot"><span class="annottext">sedtMkAttentionMask :: MkTransformerAttentionMask BARTDataType
</span><a href="#local-6989586621679585286"><span class="hs-identifier hs-var hs-var">sedtMkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; Double -&gt; MkTransformerAttentionMask BARTDataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-var">bartAttentionMaskBias</span></a></span><span>
</span><span id="line-241"></span><span>        </span><span id="local-6989586621679585285"><span class="annot"><span class="annottext">sedtMkCrossAttentionMask :: MkTransformerCrossAttentionMask BARTDataType
</span><a href="#local-6989586621679585285"><span class="hs-identifier hs-var hs-var">sedtMkCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask BARTDataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-var">bartAttentionMaskBias</span></a></span><span>
</span><span id="line-242"></span><span>        </span><span id="local-6989586621679585284"><span class="annot"><span class="annottext">sedtMkDecoderAttentionMask :: MkTransformerDecoderAttentionMask BARTDataType
</span><a href="#local-6989586621679585284"><span class="hs-identifier hs-var hs-var">sedtMkDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask BARTDataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType BARTDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartDataType"><span class="hs-identifier hs-var">bartDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.BART.Common.html#bartAttentionMaskBias"><span class="hs-identifier hs-var">bartAttentionMaskBias</span></a></span><span>
</span><span id="line-243"></span><span>        </span><span id="local-6989586621679585283"><span class="annot"><span class="annottext">model :: GSimplifiedEncoderDecoderTransformer
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GCrossAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       BARTDataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                          'Dim ('Name &quot;*&quot;) ('Size 32128)])))))))
  MkAbsPos
  MkAbsPos
  MkTransformerPaddingMask
  (MkTransformerAttentionMask BARTDataType)
  (MkTransformerCrossAttentionMask BARTDataType)
  (MkTransformerDecoderAttentionMask BARTDataType)
</span><a href="#local-6989586621679585283"><span class="hs-identifier hs-var hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ShiftRight Int
MkTransformerCrossAttentionMask BARTDataType
MkTransformerDecoderAttentionMask BARTDataType
MkTransformerAttentionMask BARTDataType
MkTransformerPaddingMask
MkAbsPos
GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                       'Dim ('Name &quot;*&quot;) ('Size 32128)]))))))
sedtMkDecoderAttentionMask :: MkTransformerDecoderAttentionMask BARTDataType
sedtMkCrossAttentionMask :: MkTransformerCrossAttentionMask BARTDataType
sedtMkAttentionMask :: MkTransformerAttentionMask BARTDataType
sedtMkPaddingMask :: MkTransformerPaddingMask
sedtMkDecoderPos :: MkAbsPos
sedtMkPos :: MkAbsPos
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                       'Dim ('Name &quot;*&quot;) ('Size 32128)]))))))
sedtMkDecoderAttentionMask :: MkTransformerDecoderAttentionMask BARTDataType
sedtMkCrossAttentionMask :: MkTransformerCrossAttentionMask BARTDataType
sedtMkAttentionMask :: MkTransformerAttentionMask BARTDataType
sedtMkPaddingMask :: MkTransformerPaddingMask
sedtMkDecoderPos :: MkAbsPos
sedtMkPos :: MkAbsPos
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              BARTDataType
              BARTPosEncDim
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        ()
        (NamedModel
           (LayerNorm
              'WithBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              BARTDataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            BARTDataType
                                            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      BARTDataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                BARTDataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
        ()
        ()))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        BARTDataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                       'Dim ('Name &quot;*&quot;) ('Size 32128)]))))))
</span><a href="#local-6989586621679585274"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-244"></span><span>        </span><span id="local-6989586621679585273"><span class="annot"><span class="annottext">inputs :: SimplifiedEncoderDecoderTransformerInput
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
</span><a href="#local-6989586621679585273"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; SimplifiedEncoderDecoderTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
forall input decoderInput.
input
-&gt; decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679585318"><span class="hs-identifier hs-var">edtInput</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679585312"><span class="hs-identifier hs-var">edtDecoderInput</span></a></span><span>
</span><span id="line-245"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GCrossAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       BARTDataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                          'Dim ('Name &quot;*&quot;) ('Size 32128)])))))))
  MkAbsPos
  MkAbsPos
  MkTransformerPaddingMask
  (MkTransformerAttentionMask BARTDataType)
  (MkTransformerCrossAttentionMask BARTDataType)
  (MkTransformerDecoderAttentionMask BARTDataType)
-&gt; SimplifiedEncoderDecoderTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (SimplifiedEncoderDecoderTransformerOutput
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
                 'Dim ('Name &quot;*&quot;) ('Size 32128)]))
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                 'Dim ('Name &quot;*&quot;) ('Size 512)]))
        (Tensor
           ('Gradient 'WithoutGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           ('DataType 'Bool)
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])),
      Generator ('Device 'CPU))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (GTransformer
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 BARTDataType
                 BARTPosEncDim
                 ('Dim ('Name &quot;*&quot;) ('Size 512))
                 'Nothing))
           ()
           (NamedModel
              (LayerNorm
                 'WithBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 BARTDataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GCrossAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               BARTDataType
                                               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 2048)])))))
                             Gelu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         BARTDataType
                                         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   BARTDataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))))))))
           ()
           ()))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           BARTDataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       BARTDataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    BARTDataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 1),
                          'Dim ('Name &quot;*&quot;) ('Size 32128)])))))))
  MkAbsPos
  MkAbsPos
  MkTransformerPaddingMask
  (MkTransformerAttentionMask BARTDataType)
  (MkTransformerCrossAttentionMask BARTDataType)
  (MkTransformerDecoderAttentionMask BARTDataType)
</span><a href="#local-6989586621679585283"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
</span><a href="#local-6989586621679585273"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679585305"><span class="hs-identifier hs-var">g''</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><span class="annottext">((EncoderDecoderTransformerOutput
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       BARTDataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
             'Dim ('Name &quot;*&quot;) ('Size 32128)]))
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       BARTDataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
             'Dim ('Name &quot;*&quot;) ('Size 512)])),
  SimplifiedEncoderDecoderTransformerOutput
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       BARTDataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
             'Dim ('Name &quot;*&quot;) ('Size 32128)]))
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       BARTDataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
             'Dim ('Name &quot;*&quot;) ('Size 512)]))
    (Tensor
       ('Gradient 'WithoutGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       ('DataType 'Bool)
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))),
 Generator ('Device 'CPU))
-&gt; IO
     ((EncoderDecoderTransformerOutput
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            BARTDataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
                  'Dim ('Name &quot;*&quot;) ('Size 32128)]))
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            BARTDataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                  'Dim ('Name &quot;*&quot;) ('Size 512)])),
       SimplifiedEncoderDecoderTransformerOutput
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            BARTDataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
                  'Dim ('Name &quot;*&quot;) ('Size 32128)]))
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            BARTDataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                  'Dim ('Name &quot;*&quot;) ('Size 512)]))
         (Tensor
            ('Gradient 'WithoutGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            ('DataType 'Bool)
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))),
      Generator ('Device 'CPU))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
</span><a href="#local-6989586621679585306"><span class="hs-identifier hs-var">bartOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     BARTDataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Bool)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
</span><a href="#local-6989586621679585293"><span class="hs-identifier hs-var">bartOutput'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679585292"><span class="hs-identifier hs-var">g'''</span></a></span><span class="hs-special">)</span></pre></body></html>