<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GBlock</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GCrossAttention</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CADropoutF"><span class="hs-identifier">CADropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CAFinalLayerNormF"><span class="hs-identifier">CAFinalLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CAInitialLayerNormF"><span class="hs-identifier">CAInitialLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CAMultiheadAttentionF"><span class="hs-identifier">CAMultiheadAttentionF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#GCrossAttention"><span class="hs-identifier">GCrossAttention</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#crossAttentionSpec"><span class="hs-identifier">crossAttentionSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier">FFNActivationDropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier">FFNActivationF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier">FFNInputLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier">FFNInputTransformationF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputDropoutF"><span class="hs-identifier">FFNOutputDropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier">FFNOutputLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier">FFNOutputProjectionF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier">GTransformerFeedForwardNetwork</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#transformerFeedForwardNetworkSpec"><span class="hs-identifier">transformerFeedForwardNetworkSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GSelfAttention</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#GSelfAttention"><span class="hs-identifier">GSelfAttention</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SADropoutF"><span class="hs-identifier">SADropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAFinalLayerNormF"><span class="hs-identifier">SAFinalLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAInitialLayerNormF"><span class="hs-identifier">SAInitialLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAMultiheadAttentionF"><span class="hs-identifier">SAMultiheadAttentionF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#selfAttentionSpec"><span class="hs-identifier">selfAttentionSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Generic transformer encoder block consisting of self-attention, cross-attention, and a feed-forward network.</span><span>
</span><span id="line-31"></span><span class="hs-comment">--</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- - @selfAttention@ is a self-attention layer.</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- - @crossAttention@ is a cross-attention layer.</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- - @feedForwardNetwork@ is a feed-forward layer.</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- TODO: Some transformers use LayerDrop, see https://arxiv.org/abs/1909.11556, during training.</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- To support this, we will need a layer wrapper that is either the identity function or the wrapped layer</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- based on a uniformly random draw from a supplied generator.</span><span>
</span><span id="line-39"></span><span class="hs-keyword">data</span><span>
</span><span id="line-40"></span><span>  </span><span id="GTransformerBlock"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-var">GTransformerBlock</span></a></span></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554104"><span class="annot"><a href="#local-6989586621679554104"><span class="hs-identifier hs-type">selfAttention</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554103"><span class="annot"><a href="#local-6989586621679554103"><span class="hs-identifier hs-type">crossAttention</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554102"><span class="annot"><a href="#local-6989586621679554102"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-45"></span><span>  </span><span id="GTransformerBlock"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-var">GTransformerBlock</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679554272"><span class="annot"><a href="#local-6989586621679554272"><span class="hs-identifier hs-type">selfAttention</span></a></span></span><span> </span><span id="local-6989586621679554271"><span class="annot"><a href="#local-6989586621679554271"><span class="hs-identifier hs-type">crossAttention</span></a></span></span><span> </span><span id="local-6989586621679554270"><span class="annot"><a href="#local-6989586621679554270"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | self-attention layer</span><span>
</span><span id="line-48"></span><span>      </span><span id="tbSelfAttention"><span class="annot"><span class="annottext">GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; selfAttention
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#tbSelfAttention"><span class="hs-identifier hs-var hs-var">tbSelfAttention</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679554272"><span class="hs-identifier hs-type">selfAttention</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>      </span><span class="hs-comment">-- | cross-attention layer</span><span>
</span><span id="line-50"></span><span>      </span><span id="tbCrossAttention"><span class="annot"><span class="annottext">GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; crossAttention
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#tbCrossAttention"><span class="hs-identifier hs-var hs-var">tbCrossAttention</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679554271"><span class="hs-identifier hs-type">crossAttention</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>      </span><span class="hs-comment">-- | feed-forward network</span><span>
</span><span id="line-52"></span><span>      </span><span id="tbFeedForwardNetwork"><span class="annot"><span class="annottext">GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; feedForwardNetwork
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#tbFeedForwardNetwork"><span class="hs-identifier hs-var hs-var">tbFeedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679554270"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554272"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554271"><span class="hs-identifier hs-type">crossAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554270"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span>
</span><span id="line-55"></span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-57"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span id="local-6989586621679554097"><span class="annot"><a href="#local-6989586621679554097"><span class="hs-identifier hs-type hs-type">selfAttention</span></a></span></span><span> </span><span id="local-6989586621679554096"><span class="annot"><a href="#local-6989586621679554096"><span class="hs-identifier hs-type hs-type">crossAttention</span></a></span></span><span> </span><span id="local-6989586621679554095"><span class="annot"><a href="#local-6989586621679554095"><span class="hs-identifier hs-type hs-type">feedForwardNetwork</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554097"><span class="hs-identifier hs-type">selfAttention</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554096"><span class="hs-identifier hs-type">crossAttention</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554095"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-61"></span><span>  </span><span id="EncoderBlockSelfAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockSelfAttentionF"><span class="hs-identifier hs-var">EncoderBlockSelfAttentionF</span></a></span></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554094"><span class="annot"><a href="#local-6989586621679554094"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554093"><span class="annot"><a href="#local-6989586621679554093"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554092"><span class="annot"><a href="#local-6989586621679554092"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554091"><span class="annot"><a href="#local-6989586621679554091"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554090"><span class="annot"><a href="#local-6989586621679554090"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554089"><span class="annot"><a href="#local-6989586621679554089"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554088"><span class="annot"><a href="#local-6989586621679554088"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554087"><span class="annot"><a href="#local-6989586621679554087"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>  </span><span id="EncoderBlockSelfAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockSelfAttentionF"><span class="hs-identifier hs-var">EncoderBlockSelfAttentionF</span></a></span></span><span> </span><span id="local-6989586621679554086"><span class="annot"><a href="#local-6989586621679554086"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679554085"><span class="annot"><a href="#local-6989586621679554085"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679554084"><span class="annot"><a href="#local-6989586621679554084"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679554083"><span class="annot"><a href="#local-6989586621679554083"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679554082"><span class="annot"><a href="#local-6989586621679554082"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679554081"><span class="annot"><a href="#local-6989586621679554081"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679554080"><span class="annot"><a href="#local-6989586621679554080"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679554079"><span class="annot"><a href="#local-6989586621679554079"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#GSelfAttention"><span class="hs-identifier hs-type">GSelfAttention</span></a></span><span>
</span><span id="line-75"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAInitialLayerNormF"><span class="hs-identifier hs-type">SAInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554086"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554085"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554084"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554083"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554079"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAMultiheadAttentionF"><span class="hs-identifier hs-type">SAMultiheadAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554086"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554085"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554084"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554083"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554082"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554081"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554080"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554079"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SADropoutF"><span class="hs-identifier hs-type">SADropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554086"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAFinalLayerNormF"><span class="hs-identifier hs-type">SAFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554086"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554085"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554084"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554083"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554079"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="EncoderBlockCrossAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockCrossAttentionF"><span class="hs-identifier hs-var">EncoderBlockCrossAttentionF</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>  </span><span id="EncoderBlockCrossAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockCrossAttentionF"><span class="hs-identifier hs-var">EncoderBlockCrossAttentionF</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-85"></span><span>  </span><span id="EncoderBlockFeedForwardNetworkF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-var">EncoderBlockFeedForwardNetworkF</span></a></span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554078"><span class="annot"><a href="#local-6989586621679554078"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554077"><span class="annot"><a href="#local-6989586621679554077"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554076"><span class="annot"><a href="#local-6989586621679554076"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554075"><span class="annot"><a href="#local-6989586621679554075"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554074"><span class="annot"><a href="#local-6989586621679554074"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554073"><span class="annot"><a href="#local-6989586621679554073"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="EncoderBlockFeedForwardNetworkF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-var">EncoderBlockFeedForwardNetworkF</span></a></span></span><span> </span><span id="local-6989586621679554072"><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679554071"><span class="annot"><a href="#local-6989586621679554071"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679554070"><span class="annot"><a href="#local-6989586621679554070"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679554069"><span class="annot"><a href="#local-6989586621679554069"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679554068"><span class="annot"><a href="#local-6989586621679554068"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679554067"><span class="annot"><a href="#local-6989586621679554067"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-97"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-type">FFNInputLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554071"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554070"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554069"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554068"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier hs-type">FFNInputTransformationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554071"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554070"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554069"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554068"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554067"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-type">FFNOutputProjectionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554071"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554070"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554069"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554068"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554067"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputDropoutF"><span class="hs-identifier hs-type">FFNOutputDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-type">FFNOutputLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554072"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554071"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554070"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554069"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554068"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#encoderBlockSpec"><span class="hs-identifier hs-type">encoderBlockSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679554065"><span class="annot"><a href="#local-6989586621679554065"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679554064"><span class="annot"><a href="#local-6989586621679554064"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679554063"><span class="annot"><a href="#local-6989586621679554063"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679554062"><span class="annot"><a href="#local-6989586621679554062"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679554061"><span class="annot"><a href="#local-6989586621679554061"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679554060"><span class="annot"><a href="#local-6989586621679554060"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679554059"><span class="annot"><a href="#local-6989586621679554059"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679554058"><span class="annot"><a href="#local-6989586621679554058"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679554057"><span class="annot"><a href="#local-6989586621679554057"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554065"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554064"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554063"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554062"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554061"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554060"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554059"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554058"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554057"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span>
</span><span id="line-121"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockSelfAttentionF"><span class="hs-identifier hs-type">EncoderBlockSelfAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554065"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554064"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554063"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554062"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554061"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554060"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554059"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554058"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockCrossAttentionF"><span class="hs-identifier hs-type">EncoderBlockCrossAttentionF</span></a></span><span>
</span><span id="line-123"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-type">EncoderBlockFeedForwardNetworkF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554065"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554064"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554063"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554062"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554058"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554057"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span id="encoderBlockSpec"><span class="annot"><span class="annottext">encoderBlockSpec :: STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerBlock
        (EncoderBlockSelfAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim)
        EncoderBlockCrossAttentionF
        (EncoderBlockFeedForwardNetworkF
           style gradient device dataType queryEmbedDim ffnDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#encoderBlockSpec"><span class="hs-identifier hs-var hs-var">encoderBlockSpec</span></a></span></span><span> </span><span id="local-6989586621679554056"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554056"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679554055"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679554055"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679554054"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679554054"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679554053"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679554053"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679554052"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679554052"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679554051"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679554051"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679554050"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679554050"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679554049"><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679554049"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679554048"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679554048"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679554047"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679554047"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679554046"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679554046"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679554045"><span class="annot"><span class="annottext">saSpec :: STransformerStyle style
-&gt; NamedModel
     (GSelfAttention
        (ModelSpec
           (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (ModelSpec
                 (QInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (KInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (VInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (OutProjF style gradient device dataType embedDim queryEmbedDim))
              Dropout))
        Dropout
        (ModelSpec
           (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679554045"><span class="hs-identifier hs-var hs-var">saSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.0.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel ())))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GSelfAttention
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel ())))
               Dropout))
         Dropout
         ()))
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF 'T5 gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'T5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'T5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'T5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'T5 gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'T5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-127"></span><span>      </span><span class="annot"><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.0.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel ())))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GSelfAttention
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel ())))
               Dropout))
         Dropout
         ()))
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'ByT5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'ByT5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'ByT5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'ByT5 gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GSelfAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF 'BART gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'BART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'BART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'BART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'BART gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'BART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GSelfAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF
           'MBART gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'MBART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'MBART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'MBART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'MBART gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'MBART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GSelfAttention
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         ()))
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF
                 'Pegasus gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF
                 'Pegasus gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF
                 'Pegasus gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF
                 'Pegasus gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;attention.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GSelfAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF 'BERT gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'BERT gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'BERT gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'BERT gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'BERT gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'BERT gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="annot"><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;attention.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GSelfAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF
           'RoBERTa gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF
                 'RoBERTa gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF
                 'RoBERTa gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF
                 'RoBERTa gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF
                 'RoBERTa gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF
           'RoBERTa gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span>
</span><span id="line-133"></span><span>      </span><span class="annot"><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-134"></span><span>      </span><span id="local-6989586621679554033"><span class="annot"><span class="annottext">caSpec :: p -&gt; ()
</span><a href="#local-6989586621679554033"><span class="hs-identifier hs-var hs-var">caSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>      </span><span id="local-6989586621679554032"><span class="annot"><span class="annottext">ffnSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (ModelSpec
           (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
        (ModelSpec
           (FFNInputTransformationF
              style gradient device dataType queryEmbedDim ffnDim))
        (ModelSpec (FFNActivationF style))
        (ModelSpec (FFNActivationDropoutF style))
        (ModelSpec
           (FFNOutputProjectionF
              style gradient device dataType queryEmbedDim ffnDim))
        Dropout
        (ModelSpec
           (FFNOutputLayerNormF
              style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679554032"><span class="hs-identifier hs-var hs-var">ffnSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel ())))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel ())))
   Relu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel ())))
   Dropout
   ()
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel ())))
         Relu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel ())))
         Dropout
         ()))
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel ())))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'T5 gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'T5 gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'T5))
     (ModelSpec (FFNActivationDropoutF 'T5))
     (ModelSpec
        (FFNOutputProjectionF
           'T5 gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF 'T5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-136"></span><span>      </span><span class="annot"><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (GGate
      (NamedModel
         (GLinear
            (NamedModel
               (TensorSpec
                  gradient
                  ('Layout 'Dense)
                  device
                  dataType
                  ('Shape '[ffnDim, queryEmbedDim])))
            (NamedModel ())))
      GeluNew
      (NamedModel
         (GLinear
            (NamedModel
               (TensorSpec
                  gradient
                  ('Layout 'Dense)
                  device
                  dataType
                  ('Shape '[ffnDim, queryEmbedDim])))
            (NamedModel ()))))
   GeluNew
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel ())))
   Dropout
   ()
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (GGate
            (NamedModel
               (GLinear
                  (NamedModel
                     (TensorSpec
                        gradient
                        ('Layout 'Dense)
                        device
                        dataType
                        ('Shape '[ffnDim, queryEmbedDim])))
                  (NamedModel ())))
            GeluNew
            (NamedModel
               (GLinear
                  (NamedModel
                     (TensorSpec
                        gradient
                        ('Layout 'Dense)
                        device
                        dataType
                        ('Shape '[ffnDim, queryEmbedDim])))
                  (NamedModel ()))))
         GeluNew
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel ())))
         Dropout
         ()))
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'ByT5 gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'ByT5))
     (ModelSpec (FFNActivationDropoutF 'ByT5))
     (ModelSpec
        (FFNOutputProjectionF
           'ByT5 gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Gelu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Gelu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'BART gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'BART gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'BART))
     (ModelSpec (FFNActivationDropoutF 'BART))
     (ModelSpec
        (FFNOutputProjectionF
           'BART gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF 'BART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Gelu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Gelu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'MBART gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'MBART gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'MBART))
     (ModelSpec (FFNActivationDropoutF 'MBART))
     (ModelSpec
        (FFNOutputProjectionF
           'MBART gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           'MBART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Relu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   ()
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Relu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         ()))
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'Pegasus gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'Pegasus))
     (ModelSpec (FFNActivationDropoutF 'Pegasus))
     (ModelSpec
        (FFNOutputProjectionF
           'Pegasus gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span class="annot"><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Gelu
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Gelu
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'BERT gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'BERT gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'BERT))
     (ModelSpec (FFNActivationDropoutF 'BERT))
     (ModelSpec
        (FFNOutputProjectionF
           'BERT gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF 'BERT gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Gelu
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Gelu
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF
           'RoBERTa gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'RoBERTa gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'RoBERTa))
     (ModelSpec (FFNActivationDropoutF 'RoBERTa))
     (ModelSpec
        (FFNOutputProjectionF
           'RoBERTa gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           'RoBERTa gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span>
</span><span id="line-142"></span><span>      </span><span class="annot"><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-143"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
-&gt; ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (ModelSpec
           (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
        (ModelSpec
           (FFNInputTransformationF
              style gradient device dataType queryEmbedDim ffnDim))
        (ModelSpec (FFNActivationF style))
        (ModelSpec (FFNActivationDropoutF style))
        (ModelSpec
           (FFNOutputProjectionF
              style gradient device dataType queryEmbedDim ffnDim))
        Dropout
        (ModelSpec
           (FFNOutputLayerNormF
              style gradient device dataType queryEmbedDim)))
-&gt; GTransformerBlock
     (NamedModel
        (GSelfAttention
           (ModelSpec
              (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
           (NamedModel
              (GMultiHeadAttention
                 headDim
                 headEmbedDim
                 embedDim
                 (ModelSpec
                    (QInProjF style gradient device dataType queryEmbedDim embedDim))
                 (ModelSpec
                    (KInProjF style gradient device dataType queryEmbedDim embedDim))
                 (ModelSpec
                    (VInProjF style gradient device dataType queryEmbedDim embedDim))
                 (ModelSpec
                    (OutProjF style gradient device dataType embedDim queryEmbedDim))
                 Dropout))
           Dropout
           (ModelSpec
              (SAFinalLayerNormF style gradient device dataType queryEmbedDim))))
     ()
     (NamedModel
        (GTransformerFeedForwardNetwork
           (ModelSpec
              (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
           (ModelSpec
              (FFNInputTransformationF
                 style gradient device dataType queryEmbedDim ffnDim))
           (ModelSpec (FFNActivationF style))
           (ModelSpec (FFNActivationDropoutF style))
           (ModelSpec
              (FFNOutputProjectionF
                 style gradient device dataType queryEmbedDim ffnDim))
           Dropout
           (ModelSpec
              (FFNOutputLayerNormF
                 style gradient device dataType queryEmbedDim))))
forall selfAttention crossAttention feedForwardNetwork.
selfAttention
-&gt; crossAttention
-&gt; feedForwardNetwork
-&gt; GTransformerBlock
     selfAttention crossAttention feedForwardNetwork
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-var">GTransformerBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GSelfAttention
        (ModelSpec
           (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (ModelSpec
                 (QInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (KInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (VInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (OutProjF style gradient device dataType embedDim queryEmbedDim))
              Dropout))
        Dropout
        (ModelSpec
           (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679554045"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554056"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; ()
forall p. p -&gt; ()
</span><a href="#local-6989586621679554033"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554056"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (ModelSpec
           (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
        (ModelSpec
           (FFNInputTransformationF
              style gradient device dataType queryEmbedDim ffnDim))
        (ModelSpec (FFNActivationF style))
        (ModelSpec (FFNActivationDropoutF style))
        (ModelSpec
           (FFNOutputProjectionF
              style gradient device dataType queryEmbedDim ffnDim))
        Dropout
        (ModelSpec
           (FFNOutputLayerNormF
              style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679554032"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554056"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="#local-6989586621679554042"><span class="hs-identifier hs-type">saSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679554042"><span class="annot"><span class="annottext">saSpec' :: STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554042"><span class="hs-identifier hs-var hs-var">saSpec'</span></a></span></span><span> </span><span id="local-6989586621679554030"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554030"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GSelfAttention
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim)
        (SAMultiheadAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim)
        (SADropoutF style)
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GSelfAttention
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim)
        (SAMultiheadAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim)
        (SADropoutF style)
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#selfAttentionSpec"><span class="hs-identifier hs-var">selfAttentionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554030"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679554055"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679554054"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679554053"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679554052"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679554051"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679554050"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679554049"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679554047"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679554046"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="#local-6989586621679554031"><span class="hs-identifier hs-type">ffnSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-148"></span><span>    </span><span id="local-6989586621679554031"><span class="annot"><span class="annottext">ffnSpec' :: STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679554031"><span class="hs-identifier hs-var hs-var">ffnSpec'</span></a></span></span><span> </span><span id="local-6989586621679554029"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554029"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerFeedForwardNetwork
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputDropoutF style)
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerFeedForwardNetwork
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputDropoutF style)
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#transformerFeedForwardNetworkSpec"><span class="hs-identifier hs-var">transformerFeedForwardNetworkSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679554029"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679554055"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679554054"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679554053"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679554049"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679554048"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679554047"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679554046"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-151"></span><span>  </span><span id="DecoderBlockSelfAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockSelfAttentionF"><span class="hs-identifier hs-var">DecoderBlockSelfAttentionF</span></a></span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554028"><span class="annot"><a href="#local-6989586621679554028"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554027"><span class="annot"><a href="#local-6989586621679554027"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554026"><span class="annot"><a href="#local-6989586621679554026"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554025"><span class="annot"><a href="#local-6989586621679554025"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554024"><span class="annot"><a href="#local-6989586621679554024"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554023"><span class="annot"><a href="#local-6989586621679554023"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554022"><span class="annot"><a href="#local-6989586621679554022"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554021"><span class="annot"><a href="#local-6989586621679554021"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-162"></span><span>  </span><span id="DecoderBlockSelfAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockSelfAttentionF"><span class="hs-identifier hs-var">DecoderBlockSelfAttentionF</span></a></span></span><span> </span><span id="local-6989586621679554020"><span class="annot"><a href="#local-6989586621679554020"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679554019"><span class="annot"><a href="#local-6989586621679554019"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679554018"><span class="annot"><a href="#local-6989586621679554018"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679554017"><span class="annot"><a href="#local-6989586621679554017"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679554016"><span class="annot"><a href="#local-6989586621679554016"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679554015"><span class="annot"><a href="#local-6989586621679554015"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679554014"><span class="annot"><a href="#local-6989586621679554014"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679554013"><span class="annot"><a href="#local-6989586621679554013"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-164"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#GSelfAttention"><span class="hs-identifier hs-type">GSelfAttention</span></a></span><span>
</span><span id="line-165"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAInitialLayerNormF"><span class="hs-identifier hs-type">SAInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554020"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554019"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554018"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554017"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554013"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAMultiheadAttentionF"><span class="hs-identifier hs-type">SAMultiheadAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554020"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554019"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554018"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554017"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554016"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554015"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554014"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554013"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SADropoutF"><span class="hs-identifier hs-type">SADropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554020"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#SAFinalLayerNormF"><span class="hs-identifier hs-type">SAFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554020"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554019"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554018"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554017"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554013"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-172"></span><span>  </span><span id="DecoderBlockCrossAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockCrossAttentionF"><span class="hs-identifier hs-var">DecoderBlockCrossAttentionF</span></a></span></span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554012"><span class="annot"><a href="#local-6989586621679554012"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554011"><span class="annot"><a href="#local-6989586621679554011"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554010"><span class="annot"><a href="#local-6989586621679554010"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554009"><span class="annot"><a href="#local-6989586621679554009"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554008"><span class="annot"><a href="#local-6989586621679554008"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554007"><span class="annot"><a href="#local-6989586621679554007"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554006"><span class="annot"><a href="#local-6989586621679554006"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554005"><span class="annot"><a href="#local-6989586621679554005"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679554004"><span class="annot"><a href="#local-6989586621679554004"><span class="hs-identifier hs-type">keyEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>  </span><span id="DecoderBlockCrossAttentionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockCrossAttentionF"><span class="hs-identifier hs-var">DecoderBlockCrossAttentionF</span></a></span></span><span> </span><span id="local-6989586621679554003"><span class="annot"><a href="#local-6989586621679554003"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679554002"><span class="annot"><a href="#local-6989586621679554002"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679554001"><span class="annot"><a href="#local-6989586621679554001"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679554000"><span class="annot"><a href="#local-6989586621679554000"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679553999"><span class="annot"><a href="#local-6989586621679553999"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679553998"><span class="annot"><a href="#local-6989586621679553998"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553997"><span class="annot"><a href="#local-6989586621679553997"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679553996"><span class="annot"><a href="#local-6989586621679553996"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553995"><span class="annot"><a href="#local-6989586621679553995"><span class="hs-identifier hs-type hs-type">keyEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#GCrossAttention"><span class="hs-identifier hs-type">GCrossAttention</span></a></span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CAInitialLayerNormF"><span class="hs-identifier hs-type">CAInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554003"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554002"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554001"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554000"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553996"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CAMultiheadAttentionF"><span class="hs-identifier hs-type">CAMultiheadAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554003"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554002"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554001"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554000"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553999"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553998"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553997"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553996"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553995"><span class="hs-identifier hs-type">keyEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CADropoutF"><span class="hs-identifier hs-type">CADropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554003"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#CAFinalLayerNormF"><span class="hs-identifier hs-type">CAFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554003"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554002"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554001"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679554000"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553996"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-194"></span><span>  </span><span id="DecoderBlockFeedForwardNetworkF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-var">DecoderBlockFeedForwardNetworkF</span></a></span></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679553994"><span class="annot"><a href="#local-6989586621679553994"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679553993"><span class="annot"><a href="#local-6989586621679553993"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679553992"><span class="annot"><a href="#local-6989586621679553992"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679553991"><span class="annot"><a href="#local-6989586621679553991"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679553990"><span class="annot"><a href="#local-6989586621679553990"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679553989"><span class="annot"><a href="#local-6989586621679553989"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-201"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-202"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-203"></span><span>  </span><span id="DecoderBlockFeedForwardNetworkF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-var">DecoderBlockFeedForwardNetworkF</span></a></span></span><span> </span><span id="local-6989586621679553988"><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679553987"><span class="annot"><a href="#local-6989586621679553987"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679553986"><span class="annot"><a href="#local-6989586621679553986"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679553985"><span class="annot"><a href="#local-6989586621679553985"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679553984"><span class="annot"><a href="#local-6989586621679553984"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553983"><span class="annot"><a href="#local-6989586621679553983"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-206"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-type">FFNInputLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553987"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553986"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553985"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553984"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier hs-type">FFNInputTransformationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553987"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553986"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553985"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553984"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553983"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-type">FFNOutputProjectionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553987"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553986"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553985"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553984"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553983"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputDropoutF"><span class="hs-identifier hs-type">FFNOutputDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-type">FFNOutputLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553988"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553987"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553986"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553985"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553984"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#decoderBlockSpec"><span class="hs-identifier hs-type">decoderBlockSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679553981"><span class="annot"><a href="#local-6989586621679553981"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679553980"><span class="annot"><a href="#local-6989586621679553980"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679553979"><span class="annot"><a href="#local-6989586621679553979"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679553978"><span class="annot"><a href="#local-6989586621679553978"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679553977"><span class="annot"><a href="#local-6989586621679553977"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679553976"><span class="annot"><a href="#local-6989586621679553976"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553975"><span class="annot"><a href="#local-6989586621679553975"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679553974"><span class="annot"><a href="#local-6989586621679553974"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553973"><span class="annot"><a href="#local-6989586621679553973"><span class="hs-identifier hs-type">keyEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553972"><span class="annot"><a href="#local-6989586621679553972"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553981"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553980"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553979"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553978"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553977"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553976"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553975"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553974"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553973"><span class="hs-identifier hs-type">keyEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553972"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span>
</span><span id="line-231"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockSelfAttentionF"><span class="hs-identifier hs-type">DecoderBlockSelfAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553981"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553980"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553979"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553978"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553977"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553976"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553975"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553974"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockCrossAttentionF"><span class="hs-identifier hs-type">DecoderBlockCrossAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553981"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553980"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553979"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553978"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553977"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553976"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553975"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553974"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553973"><span class="hs-identifier hs-type">keyEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-type">DecoderBlockFeedForwardNetworkF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553981"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553980"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553979"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553978"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553974"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553972"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span id="decoderBlockSpec"><span class="annot"><span class="annottext">decoderBlockSpec :: STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim keyEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerBlock
        (DecoderBlockSelfAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim)
        (DecoderBlockCrossAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim
           keyEmbedDim)
        (DecoderBlockFeedForwardNetworkF
           style gradient device dataType queryEmbedDim ffnDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#decoderBlockSpec"><span class="hs-identifier hs-var hs-var">decoderBlockSpec</span></a></span></span><span> </span><span id="local-6989586621679553971"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553971"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679553970"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679553970"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679553969"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679553969"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679553968"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679553968"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679553967"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679553967"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679553966"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679553966"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553965"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679553965"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679553964"><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679553964"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553963"><span class="annot"><span class="annottext">SDim keyEmbedDim
</span><a href="#local-6989586621679553963"><span class="hs-identifier hs-var">keyEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679553962"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679553962"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679553961"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553961"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679553960"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553960"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553959"><span class="annot"><span class="annottext">saSpec :: STransformerStyle style
-&gt; NamedModel
     (GSelfAttention
        (ModelSpec
           (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (ModelSpec
                 (QInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (KInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (VInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (OutProjF style gradient device dataType embedDim queryEmbedDim))
              Dropout))
        Dropout
        (ModelSpec
           (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679553959"><span class="hs-identifier hs-var hs-var">saSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.0.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel ())))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GSelfAttention
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel ())))
               Dropout))
         Dropout
         ()))
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF 'T5 gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'T5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'T5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'T5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'T5 gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'T5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553958"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.0.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel ())))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GSelfAttention
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel ())))
               Dropout))
         Dropout
         ()))
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'ByT5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'ByT5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'ByT5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'ByT5 gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553958"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GSelfAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF 'BART gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'BART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'BART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'BART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'BART gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'BART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553958"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GSelfAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GSelfAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GSelfAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF
           'MBART gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'MBART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'MBART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'MBART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'MBART gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF 'MBART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553958"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GSelfAttention
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GSelfAttention
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         ()))
-&gt; GSelfAttention
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GSelfAttention
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF
                 'Pegasus gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF
                 'Pegasus gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF
                 'Pegasus gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF
                 'Pegasus gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553958"><span class="hs-identifier hs-var">saSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-244"></span><span>      </span><span id="local-6989586621679553957"><span class="annot"><span class="annottext">caSpec :: STransformerStyle style
-&gt; NamedModel
     (GCrossAttention
        (ModelSpec
           (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (ModelSpec
                 (QInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (KInProjF style gradient device dataType keyEmbedDim embedDim))
              (ModelSpec
                 (VInProjF style gradient device dataType keyEmbedDim embedDim))
              (ModelSpec
                 (OutProjF style gradient device dataType embedDim queryEmbedDim))
              Dropout))
        Dropout
        (ModelSpec
           (CAFinalLayerNormF style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679553957"><span class="hs-identifier hs-var hs-var">caSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GCrossAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GCrossAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GCrossAttention
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel ())))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GCrossAttention
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel ())))
               Dropout))
         Dropout
         ()))
-&gt; GCrossAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GCrossAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF 'T5 gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'T5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'T5 gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'T5 gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'T5 gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF 'T5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553956"><span class="hs-identifier hs-var">caSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GCrossAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GCrossAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GCrossAttention
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel ())))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel ())))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GCrossAttention
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel ())))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel ())))
               Dropout))
         Dropout
         ()))
-&gt; GCrossAttention
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel ())))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel ())))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GCrossAttention
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel ())))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel ())))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'ByT5 gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'ByT5 gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'ByT5 gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'ByT5 gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553956"><span class="hs-identifier hs-var">caSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GCrossAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GCrossAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GCrossAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GCrossAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GCrossAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GCrossAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF 'BART gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'BART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'BART gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'BART gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'BART gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF 'BART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553956"><span class="hs-identifier hs-var">caSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GCrossAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GCrossAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GCrossAttention
   ()
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GCrossAttention
         ()
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GCrossAttention
     ()
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GCrossAttention
        ()
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF
           'MBART gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF 'MBART gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'MBART gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'MBART gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF 'MBART gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF 'MBART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553956"><span class="hs-identifier hs-var">caSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GCrossAttention
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GCrossAttention
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GCrossAttention
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GMultiHeadAttention
         headDim
         headEmbedDim
         embedDim
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[embedDim, keyEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, embedDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout))
   Dropout
   ()
 -&gt; NamedModel
      (GCrossAttention
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GMultiHeadAttention
               headDim
               headEmbedDim
               embedDim
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, queryEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[embedDim, keyEmbedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim, embedDim])))
                     (NamedModel
                        (TensorSpec
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[queryEmbedDim])))))
               Dropout))
         Dropout
         ()))
-&gt; GCrossAttention
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, queryEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[embedDim, keyEmbedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim, embedDim])))
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[queryEmbedDim])))))
           Dropout))
     Dropout
     ()
-&gt; NamedModel
     (GCrossAttention
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, queryEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[embedDim, keyEmbedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
              (NamedModel
                 (GLinear
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim, embedDim])))
                    (NamedModel
                       (TensorSpec
                          gradient
                          ('Layout 'Dense)
                          device
                          dataType
                          ('Shape '[queryEmbedDim])))))
              Dropout))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF
                 'Pegasus gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF 'Pegasus gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF 'Pegasus gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF
                 'Pegasus gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553956"><span class="hs-identifier hs-var">caSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-252"></span><span>      </span><span id="local-6989586621679553955"><span class="annot"><span class="annottext">ffnSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (ModelSpec
           (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
        (ModelSpec
           (FFNInputTransformationF
              style gradient device dataType queryEmbedDim ffnDim))
        (ModelSpec (FFNActivationF style))
        (ModelSpec (FFNActivationDropoutF style))
        (ModelSpec
           (FFNOutputProjectionF
              style gradient device dataType queryEmbedDim ffnDim))
        Dropout
        (ModelSpec
           (FFNOutputLayerNormF
              style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679553955"><span class="hs-identifier hs-var hs-var">ffnSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel ())))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.2.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel ())))
   Relu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel ())))
   Dropout
   ()
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel ())))
         Relu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel ())))
         Dropout
         ()))
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel ())))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'T5 gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'T5 gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'T5))
     (ModelSpec (FFNActivationDropoutF 'T5))
     (ModelSpec
        (FFNOutputProjectionF
           'T5 gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF 'T5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553954"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer.2.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
   (GGate
      (NamedModel
         (GLinear
            (NamedModel
               (TensorSpec
                  gradient
                  ('Layout 'Dense)
                  device
                  dataType
                  ('Shape '[ffnDim, queryEmbedDim])))
            (NamedModel ())))
      GeluNew
      (NamedModel
         (GLinear
            (NamedModel
               (TensorSpec
                  gradient
                  ('Layout 'Dense)
                  device
                  dataType
                  ('Shape '[ffnDim, queryEmbedDim])))
            (NamedModel ()))))
   GeluNew
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel ())))
   Dropout
   ()
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
         (GGate
            (NamedModel
               (GLinear
                  (NamedModel
                     (TensorSpec
                        gradient
                        ('Layout 'Dense)
                        device
                        dataType
                        ('Shape '[ffnDim, queryEmbedDim])))
                  (NamedModel ())))
            GeluNew
            (NamedModel
               (GLinear
                  (NamedModel
                     (TensorSpec
                        gradient
                        ('Layout 'Dense)
                        device
                        dataType
                        ('Shape '[ffnDim, queryEmbedDim])))
                  (NamedModel ()))))
         GeluNew
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel ())))
         Dropout
         ()))
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       gradient
                       ('Layout 'Dense)
                       device
                       dataType
                       ('Shape '[ffnDim, queryEmbedDim])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel ())))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'ByT5 gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'ByT5))
     (ModelSpec (FFNActivationDropoutF 'ByT5))
     (ModelSpec
        (FFNOutputProjectionF
           'ByT5 gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF 'ByT5 gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553954"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Gelu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Gelu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'BART gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'BART gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'BART))
     (ModelSpec (FFNActivationDropoutF 'BART))
     (ModelSpec
        (FFNOutputProjectionF
           'BART gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF 'BART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553954"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Gelu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Gelu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))))
-&gt; GTransformerFeedForwardNetwork
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Gelu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Gelu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF 'MBART gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'MBART gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'MBART))
     (ModelSpec (FFNActivationDropoutF 'MBART))
     (ModelSpec
        (FFNOutputProjectionF
           'MBART gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           'MBART gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553954"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
   Relu
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
   Dropout
   ()
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[ffnDim, queryEmbedDim])))
               (NamedModel
                  (TensorSpec
                     gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
         Relu
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim, ffnDim])))
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[queryEmbedDim])))))
         Dropout
         ()))
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel
              (TensorSpec
                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
     Relu
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim, ffnDim])))
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[queryEmbedDim])))))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[queryEmbedDim])))
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[ffnDim, queryEmbedDim])))
              (NamedModel
                 (TensorSpec
                    gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
        Relu
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim, ffnDim])))
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[queryEmbedDim])))))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           'Pegasus gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF 'Pegasus))
     (ModelSpec (FFNActivationDropoutF 'Pegasus))
     (ModelSpec
        (FFNOutputProjectionF
           'Pegasus gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           'Pegasus gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553954"><span class="hs-identifier hs-var">ffnSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-258"></span><span>      </span><span class="annot"><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF
           style gradient device dataType queryEmbedDim)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-260"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
-&gt; NamedModel
     (GCrossAttention
        (ModelSpec
           (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (ModelSpec
                 (QInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (KInProjF style gradient device dataType keyEmbedDim embedDim))
              (ModelSpec
                 (VInProjF style gradient device dataType keyEmbedDim embedDim))
              (ModelSpec
                 (OutProjF style gradient device dataType embedDim queryEmbedDim))
              Dropout))
        Dropout
        (ModelSpec
           (CAFinalLayerNormF style gradient device dataType queryEmbedDim)))
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (ModelSpec
           (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
        (ModelSpec
           (FFNInputTransformationF
              style gradient device dataType queryEmbedDim ffnDim))
        (ModelSpec (FFNActivationF style))
        (ModelSpec (FFNActivationDropoutF style))
        (ModelSpec
           (FFNOutputProjectionF
              style gradient device dataType queryEmbedDim ffnDim))
        Dropout
        (ModelSpec
           (FFNOutputLayerNormF
              style gradient device dataType queryEmbedDim)))
-&gt; GTransformerBlock
     (NamedModel
        (GSelfAttention
           (ModelSpec
              (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
           (NamedModel
              (GMultiHeadAttention
                 headDim
                 headEmbedDim
                 embedDim
                 (ModelSpec
                    (QInProjF style gradient device dataType queryEmbedDim embedDim))
                 (ModelSpec
                    (KInProjF style gradient device dataType queryEmbedDim embedDim))
                 (ModelSpec
                    (VInProjF style gradient device dataType queryEmbedDim embedDim))
                 (ModelSpec
                    (OutProjF style gradient device dataType embedDim queryEmbedDim))
                 Dropout))
           Dropout
           (ModelSpec
              (SAFinalLayerNormF style gradient device dataType queryEmbedDim))))
     (NamedModel
        (GCrossAttention
           (ModelSpec
              (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
           (NamedModel
              (GMultiHeadAttention
                 headDim
                 headEmbedDim
                 embedDim
                 (ModelSpec
                    (QInProjF style gradient device dataType queryEmbedDim embedDim))
                 (ModelSpec
                    (KInProjF style gradient device dataType keyEmbedDim embedDim))
                 (ModelSpec
                    (VInProjF style gradient device dataType keyEmbedDim embedDim))
                 (ModelSpec
                    (OutProjF style gradient device dataType embedDim queryEmbedDim))
                 Dropout))
           Dropout
           (ModelSpec
              (CAFinalLayerNormF style gradient device dataType queryEmbedDim))))
     (NamedModel
        (GTransformerFeedForwardNetwork
           (ModelSpec
              (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
           (ModelSpec
              (FFNInputTransformationF
                 style gradient device dataType queryEmbedDim ffnDim))
           (ModelSpec (FFNActivationF style))
           (ModelSpec (FFNActivationDropoutF style))
           (ModelSpec
              (FFNOutputProjectionF
                 style gradient device dataType queryEmbedDim ffnDim))
           Dropout
           (ModelSpec
              (FFNOutputLayerNormF
                 style gradient device dataType queryEmbedDim))))
forall selfAttention crossAttention feedForwardNetwork.
selfAttention
-&gt; crossAttention
-&gt; feedForwardNetwork
-&gt; GTransformerBlock
     selfAttention crossAttention feedForwardNetwork
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-var">GTransformerBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GSelfAttention
        (ModelSpec
           (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (ModelSpec
                 (QInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (KInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (VInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (OutProjF style gradient device dataType embedDim queryEmbedDim))
              Dropout))
        Dropout
        (ModelSpec
           (SAFinalLayerNormF style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679553959"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553971"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GCrossAttention
        (ModelSpec
           (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
        (NamedModel
           (GMultiHeadAttention
              headDim
              headEmbedDim
              embedDim
              (ModelSpec
                 (QInProjF style gradient device dataType queryEmbedDim embedDim))
              (ModelSpec
                 (KInProjF style gradient device dataType keyEmbedDim embedDim))
              (ModelSpec
                 (VInProjF style gradient device dataType keyEmbedDim embedDim))
              (ModelSpec
                 (OutProjF style gradient device dataType embedDim queryEmbedDim))
              Dropout))
        Dropout
        (ModelSpec
           (CAFinalLayerNormF style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679553957"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553971"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (ModelSpec
           (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
        (ModelSpec
           (FFNInputTransformationF
              style gradient device dataType queryEmbedDim ffnDim))
        (ModelSpec (FFNActivationF style))
        (ModelSpec (FFNActivationDropoutF style))
        (ModelSpec
           (FFNOutputProjectionF
              style gradient device dataType queryEmbedDim ffnDim))
        Dropout
        (ModelSpec
           (FFNOutputLayerNormF
              style gradient device dataType queryEmbedDim)))
</span><a href="#local-6989586621679553955"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553971"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="#local-6989586621679553958"><span class="hs-identifier hs-type">saSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621679553958"><span class="annot"><span class="annottext">saSpec' :: STransformerStyle style
-&gt; GSelfAttention
     (ModelSpec
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553958"><span class="hs-identifier hs-var hs-var">saSpec'</span></a></span></span><span> </span><span id="local-6989586621679553953"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553953"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GSelfAttention
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim)
        (SAMultiheadAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim)
        (SADropoutF style)
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GSelfAttention
        (SAInitialLayerNormF style gradient device dataType queryEmbedDim)
        (SAMultiheadAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim)
        (SADropoutF style)
        (SAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GSelfAttention.html#selfAttentionSpec"><span class="hs-identifier hs-var">selfAttentionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553953"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679553970"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679553969"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679553968"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679553967"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679553966"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679553965"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679553964"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553961"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553960"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="#local-6989586621679553956"><span class="hs-identifier hs-type">caSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621679553956"><span class="annot"><span class="annottext">caSpec' :: STransformerStyle style
-&gt; GCrossAttention
     (ModelSpec
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim))
     (NamedModel
        (GMultiHeadAttention
           headDim
           headEmbedDim
           embedDim
           (ModelSpec
              (QInProjF style gradient device dataType queryEmbedDim embedDim))
           (ModelSpec
              (KInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (VInProjF style gradient device dataType keyEmbedDim embedDim))
           (ModelSpec
              (OutProjF style gradient device dataType embedDim queryEmbedDim))
           Dropout))
     Dropout
     (ModelSpec
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553956"><span class="hs-identifier hs-var hs-var">caSpec'</span></a></span></span><span> </span><span id="local-6989586621679553952"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553952"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim keyEmbedDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GCrossAttention
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim)
        (CAMultiheadAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim
           keyEmbedDim)
        (CADropoutF style)
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (keyEmbedDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim keyEmbedDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GCrossAttention
        (CAInitialLayerNormF style gradient device dataType queryEmbedDim)
        (CAMultiheadAttentionF
           style
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           queryEmbedDim
           keyEmbedDim)
        (CADropoutF style)
        (CAFinalLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GCrossAttention.html#crossAttentionSpec"><span class="hs-identifier hs-var">crossAttentionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553952"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679553970"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679553969"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679553968"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679553967"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679553966"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679553965"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679553964"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim keyEmbedDim
</span><a href="#local-6989586621679553963"><span class="hs-identifier hs-var">keyEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553961"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553960"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="#local-6989586621679553954"><span class="hs-identifier hs-type">ffnSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679553954"><span class="annot"><span class="annottext">ffnSpec' :: STransformerStyle style
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="#local-6989586621679553954"><span class="hs-identifier hs-var hs-var">ffnSpec'</span></a></span></span><span> </span><span id="local-6989586621679553951"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553951"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerFeedForwardNetwork
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputDropoutF style)
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerFeedForwardNetwork
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputDropoutF style)
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#transformerFeedForwardNetworkSpec"><span class="hs-identifier hs-var">transformerFeedForwardNetworkSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679553951"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679553970"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679553969"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679553968"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679553964"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679553962"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553961"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679553960"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span id="local-6989586621679553947"><span id="local-6989586621679553948"><span id="local-6989586621679553949"><span id="local-6989586621679553950"><span class="hs-keyword">instance</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553950"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553950"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-271"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553948"><span class="hs-identifier hs-type">crossAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553948"><span class="hs-identifier hs-type">crossAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553947"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553947"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553950"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553948"><span class="hs-identifier hs-type">crossAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553947"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553950"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553948"><span class="hs-identifier hs-type">crossAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553947"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="#local-6989586621679553949"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621679553944"><span class="annot"><span class="annottext">initialize :: ModelSpec
  (GTransformerBlock selfAttention crossAttention feedForwardNetwork)
-&gt; Generator generatorDevice
-&gt; m (GTransformerBlock
        selfAttention crossAttention feedForwardNetwork,
      Generator generatorDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span id="local-6989586621679553942"><span class="annot"><a href="#local-6989586621679553942"><span class="hs-identifier hs-var">saSpec</span></a></span></span><span> </span><span id="local-6989586621679553941"><span class="annot"><a href="#local-6989586621679553941"><span class="hs-identifier hs-var">caSpec</span></a></span></span><span> </span><span id="local-6989586621679553940"><span class="annot"><a href="#local-6989586621679553940"><span class="hs-identifier hs-var">ffnSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679553939"><span class="annot"><span class="annottext">selfAttention :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  selfAttention
</span><a href="#local-6989586621679553939"><span class="hs-identifier hs-var hs-var">selfAttention</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (selfAttention, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     selfAttention
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (selfAttention, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      selfAttention)
-&gt; (ModelSpec selfAttention
    -&gt; Generator generatorDevice
    -&gt; m (selfAttention, Generator generatorDevice))
-&gt; ModelSpec selfAttention
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     selfAttention
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec selfAttention
-&gt; Generator generatorDevice
-&gt; m (selfAttention, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec selfAttention
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      selfAttention)
-&gt; ModelSpec selfAttention
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     selfAttention
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec selfAttention
</span><a href="#local-6989586621679553942"><span class="hs-identifier hs-var">saSpec</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span id="local-6989586621679553936"><span class="annot"><span class="annottext">crossAttention :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttention
</span><a href="#local-6989586621679553936"><span class="hs-identifier hs-var hs-var">crossAttention</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (crossAttention, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttention
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (crossAttention, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      crossAttention)
-&gt; (ModelSpec crossAttention
    -&gt; Generator generatorDevice
    -&gt; m (crossAttention, Generator generatorDevice))
-&gt; ModelSpec crossAttention
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttention
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec crossAttention
-&gt; Generator generatorDevice
-&gt; m (crossAttention, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec crossAttention
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      crossAttention)
-&gt; ModelSpec crossAttention
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttention
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec crossAttention
</span><a href="#local-6989586621679553941"><span class="hs-identifier hs-var">caSpec</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span id="local-6989586621679553935"><span class="annot"><span class="annottext">feedForwardNetwork :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  feedForwardNetwork
</span><a href="#local-6989586621679553935"><span class="hs-identifier hs-var hs-var">feedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (feedForwardNetwork, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     feedForwardNetwork
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (feedForwardNetwork, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      feedForwardNetwork)
-&gt; (ModelSpec feedForwardNetwork
    -&gt; Generator generatorDevice
    -&gt; m (feedForwardNetwork, Generator generatorDevice))
-&gt; ModelSpec feedForwardNetwork
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     feedForwardNetwork
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec feedForwardNetwork
-&gt; Generator generatorDevice
-&gt; m (feedForwardNetwork, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec feedForwardNetwork
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      feedForwardNetwork)
-&gt; ModelSpec feedForwardNetwork
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     feedForwardNetwork
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec feedForwardNetwork
</span><a href="#local-6989586621679553940"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span>
</span><span id="line-284"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (GTransformerBlock selfAttention crossAttention feedForwardNetwork)
-&gt; Generator generatorDevice
-&gt; m (GTransformerBlock
        selfAttention crossAttention feedForwardNetwork,
      Generator generatorDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorDevice)
   (GTransformerBlock selfAttention crossAttention feedForwardNetwork)
 -&gt; Generator generatorDevice
 -&gt; m (GTransformerBlock
         selfAttention crossAttention feedForwardNetwork,
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GTransformerBlock selfAttention crossAttention feedForwardNetwork)
-&gt; Generator generatorDevice
-&gt; m (GTransformerBlock
        selfAttention crossAttention feedForwardNetwork,
      Generator generatorDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">selfAttention
-&gt; crossAttention
-&gt; feedForwardNetwork
-&gt; GTransformerBlock
     selfAttention crossAttention feedForwardNetwork
forall selfAttention crossAttention feedForwardNetwork.
selfAttention
-&gt; crossAttention
-&gt; feedForwardNetwork
-&gt; GTransformerBlock
     selfAttention crossAttention feedForwardNetwork
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-var">GTransformerBlock</span></a></span><span> </span><span class="annot"><span class="annottext">(selfAttention
 -&gt; crossAttention
 -&gt; feedForwardNetwork
 -&gt; GTransformerBlock
      selfAttention crossAttention feedForwardNetwork)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     selfAttention
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (crossAttention
      -&gt; feedForwardNetwork
      -&gt; GTransformerBlock
           selfAttention crossAttention feedForwardNetwork)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  selfAttention
</span><a href="#local-6989586621679553939"><span class="hs-identifier hs-var">selfAttention</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (crossAttention
   -&gt; feedForwardNetwork
   -&gt; GTransformerBlock
        selfAttention crossAttention feedForwardNetwork)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttention
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (feedForwardNetwork
      -&gt; GTransformerBlock
           selfAttention crossAttention feedForwardNetwork)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttention
</span><a href="#local-6989586621679553936"><span class="hs-identifier hs-var">crossAttention</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (feedForwardNetwork
   -&gt; GTransformerBlock
        selfAttention crossAttention feedForwardNetwork)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     feedForwardNetwork
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GTransformerBlock selfAttention crossAttention feedForwardNetwork)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  feedForwardNetwork
</span><a href="#local-6989586621679553935"><span class="hs-identifier hs-var">feedForwardNetwork</span></a></span></span></span></span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span id="local-6989586621679553931"><span id="local-6989586621679553932"><span id="local-6989586621679553933"><span class="hs-keyword">instance</span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553933"><span class="hs-identifier hs-type">selfAttention</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-288"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553932"><span class="hs-identifier hs-type">crossAttention</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553931"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553933"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553932"><span class="hs-identifier hs-type">crossAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553931"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-293"></span><span>  </span><span id="local-6989586621679553927"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec
  (GTransformerBlock selfAttention crossAttention feedForwardNetwork)
-&gt; Text
-&gt; m (GTransformerBlock
        selfAttention crossAttention feedForwardNetwork)
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span id="local-6989586621679553925"><span class="annot"><a href="#local-6989586621679553925"><span class="hs-identifier hs-var">saSpec</span></a></span></span><span> </span><span id="local-6989586621679553924"><span class="annot"><a href="#local-6989586621679553924"><span class="hs-identifier hs-var">caSpec</span></a></span></span><span> </span><span id="local-6989586621679553923"><span class="annot"><a href="#local-6989586621679553923"><span class="hs-identifier hs-var">ffnSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679553922"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553922"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="annottext">selfAttention
-&gt; crossAttention
-&gt; feedForwardNetwork
-&gt; GTransformerBlock
     selfAttention crossAttention feedForwardNetwork
forall selfAttention crossAttention feedForwardNetwork.
selfAttention
-&gt; crossAttention
-&gt; feedForwardNetwork
-&gt; GTransformerBlock
     selfAttention crossAttention feedForwardNetwork
</span><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-var">GTransformerBlock</span></a></span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">(selfAttention
 -&gt; crossAttention
 -&gt; feedForwardNetwork
 -&gt; GTransformerBlock
      selfAttention crossAttention feedForwardNetwork)
-&gt; m selfAttention
-&gt; m (crossAttention
      -&gt; feedForwardNetwork
      -&gt; GTransformerBlock
           selfAttention crossAttention feedForwardNetwork)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec selfAttention -&gt; Text -&gt; m selfAttention
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec selfAttention
</span><a href="#local-6989586621679553925"><span class="hs-identifier hs-var">saSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553922"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><span class="annottext">m (crossAttention
   -&gt; feedForwardNetwork
   -&gt; GTransformerBlock
        selfAttention crossAttention feedForwardNetwork)
-&gt; m crossAttention
-&gt; m (feedForwardNetwork
      -&gt; GTransformerBlock
           selfAttention crossAttention feedForwardNetwork)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec crossAttention -&gt; Text -&gt; m crossAttention
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec crossAttention
</span><a href="#local-6989586621679553924"><span class="hs-identifier hs-var">caSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553922"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><span class="annottext">m (feedForwardNetwork
   -&gt; GTransformerBlock
        selfAttention crossAttention feedForwardNetwork)
-&gt; m feedForwardNetwork
-&gt; m (GTransformerBlock
        selfAttention crossAttention feedForwardNetwork)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec feedForwardNetwork -&gt; Text -&gt; m feedForwardNetwork
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec feedForwardNetwork
</span><a href="#local-6989586621679553923"><span class="hs-identifier hs-var">ffnSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553922"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span id="local-6989586621679553920"><span class="annot"><span class="annottext">toStateDict :: Text
-&gt; GTransformerBlock
     selfAttention crossAttention feedForwardNetwork
-&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679553918"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553918"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679553915"><span id="local-6989586621679553916"><span id="local-6989586621679553917"><span class="annot"><span class="annottext">selfAttention
crossAttention
feedForwardNetwork
tbFeedForwardNetwork :: feedForwardNetwork
tbCrossAttention :: crossAttention
tbSelfAttention :: selfAttention
tbFeedForwardNetwork :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; feedForwardNetwork
tbCrossAttention :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; crossAttention
tbSelfAttention :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; selfAttention
</span><a href="#local-6989586621679553915"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; selfAttention -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553918"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">selfAttention
</span><a href="#local-6989586621679553917"><span class="hs-identifier hs-var">tbSelfAttention</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; crossAttention -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553918"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">crossAttention
</span><a href="#local-6989586621679553916"><span class="hs-identifier hs-var">tbCrossAttention</span></a></span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; feedForwardNetwork -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679553918"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">feedForwardNetwork
</span><a href="#local-6989586621679553915"><span class="hs-identifier hs-var">tbFeedForwardNetwork</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformerBlock' in an encoder configuration.</span><span>
</span><span id="line-305"></span><span class="hs-comment">--</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-307"></span><span class="hs-comment">--      &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-308"></span><span class="hs-comment">--      &#9474; query &#9474;  &#9474; attentionBias &#9474;</span><span>
</span><span id="line-309"></span><span class="hs-comment">--      &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-310"></span><span class="hs-comment">--          &#9474;              &#9474;</span><span>
</span><span id="line-311"></span><span class="hs-comment">--          &#9660;              &#9474;</span><span>
</span><span id="line-312"></span><span class="hs-comment">--   tbSelfAttention&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-313"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- tbFeedForwardNetwork</span><span>
</span><span id="line-315"></span><span class="hs-comment">--          &#9474;</span><span>
</span><span id="line-316"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-317"></span><span class="hs-comment">--      &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-318"></span><span class="hs-comment">--      &#9474; query &#9474;</span><span>
</span><span id="line-319"></span><span class="hs-comment">--      &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-321"></span><span id="local-6989586621679553906"><span id="local-6989586621679553907"><span id="local-6989586621679553908"><span id="local-6989586621679553909"><span id="local-6989586621679553910"><span id="local-6989586621679553911"><span id="local-6989586621679553912"><span id="local-6989586621679553913"><span id="local-6989586621679553914"><span class="hs-keyword">instance</span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><a href="#local-6989586621679553914"><span class="hs-identifier hs-type">selfAttention</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553913"><span class="hs-identifier hs-type">query</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553912"><span class="hs-identifier hs-type">attentionBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><a href="#local-6989586621679553911"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><a href="#local-6989586621679553910"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><a href="#local-6989586621679553909"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><a href="#local-6989586621679553908"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><a href="#local-6989586621679553910"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-331"></span><span>      </span><span class="annot"><a href="#local-6989586621679553909"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-332"></span><span>      </span><span class="annot"><a href="#local-6989586621679553907"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><a href="#local-6989586621679553906"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-335"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553914"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679553908"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553913"><span class="hs-identifier hs-type">query</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553912"><span class="hs-identifier hs-type">attentionBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><a href="#local-6989586621679553911"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><a href="#local-6989586621679553907"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="annot"><a href="#local-6989586621679553906"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-342"></span><span>  </span><span id="local-6989586621679553903"><span class="annot"><span class="annottext">forward :: GTransformerBlock selfAttention () feedForwardNetwork
-&gt; (query, attentionBias)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679553899"><span id="local-6989586621679553900"><span id="local-6989586621679553901"><span class="annot"><span class="annottext">selfAttention
feedForwardNetwork
()
tbFeedForwardNetwork :: feedForwardNetwork
tbCrossAttention :: ()
tbSelfAttention :: selfAttention
tbFeedForwardNetwork :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; feedForwardNetwork
tbCrossAttention :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; crossAttention
tbSelfAttention :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; selfAttention
</span><a href="#local-6989586621679553899"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679553898"><span class="annot"><span class="annottext">query
</span><a href="#local-6989586621679553898"><span class="hs-identifier hs-var">query</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553897"><span class="annot"><span class="annottext">attentionBias
</span><a href="#local-6989586621679553897"><span class="hs-identifier hs-var">attentionBias</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-343"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="annottext">(query, attentionBias)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (query, attentionBias)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">query
</span><a href="#local-6989586621679553898"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attentionBias
</span><a href="#local-6989586621679553897"><span class="hs-identifier hs-var">attentionBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (query, attentionBias)
-&gt; ((query, attentionBias)
    -&gt; IxStateT
         m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (tensor0, Generator generatorDevice0))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (tensor0, Generator generatorDevice0))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; ((query, attentionBias)
    -&gt; Generator generatorDevice
    -&gt; m (tensor0, Generator generatorDevice0))
-&gt; (query, attentionBias)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">selfAttention
-&gt; (query, attentionBias)
-&gt; Generator generatorDevice
-&gt; m (tensor0, Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">selfAttention
</span><a href="#local-6989586621679553901"><span class="hs-identifier hs-var">tbSelfAttention</span></a></span><span>
</span><span id="line-346"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice0) tensor0
-&gt; (tensor0
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor0
    -&gt; Generator generatorDevice0
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor0
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">feedForwardNetwork
-&gt; tensor0
-&gt; Generator generatorDevice0
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">feedForwardNetwork
</span><a href="#local-6989586621679553899"><span class="hs-identifier hs-var">tbFeedForwardNetwork</span></a></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformerBlock' in a decoder configuration.</span><span>
</span><span id="line-349"></span><span class="hs-comment">--</span><span>
</span><span id="line-350"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- &#9474; decoderAttentionBias &#9474;  &#9474; query &#9474;  &#9474; key &#9474;  &#9474; crossAttentionBias &#9474;</span><span>
</span><span id="line-353"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9516;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-354"></span><span class="hs-comment">--            &#9474;                  &#9474;         &#9474;               &#9474;</span><span>
</span><span id="line-355"></span><span class="hs-comment">--            &#9474;                  &#9660;         &#9474;               &#9474;</span><span>
</span><span id="line-356"></span><span class="hs-comment">--            &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;tdbSelfAttention &#9474;               &#9474;</span><span>
</span><span id="line-357"></span><span class="hs-comment">--                               &#9474;         &#9474;               &#9474;</span><span>
</span><span id="line-358"></span><span class="hs-comment">--                               &#9660;         &#9660;               &#9474;</span><span>
</span><span id="line-359"></span><span class="hs-comment">--                            tdbCrossAttention&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-360"></span><span class="hs-comment">--                               &#9474;</span><span>
</span><span id="line-361"></span><span class="hs-comment">--                               &#9660;</span><span>
</span><span id="line-362"></span><span class="hs-comment">--                     tdbFeedForwardNetwork</span><span>
</span><span id="line-363"></span><span class="hs-comment">--                               &#9474;</span><span>
</span><span id="line-364"></span><span class="hs-comment">--                               &#9660;</span><span>
</span><span id="line-365"></span><span class="hs-comment">--                           &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-366"></span><span class="hs-comment">--                           &#9474; query &#9474;</span><span>
</span><span id="line-367"></span><span class="hs-comment">--                           &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-369"></span><span id="local-6989586621679553883"><span id="local-6989586621679553884"><span id="local-6989586621679553885"><span id="local-6989586621679553886"><span id="local-6989586621679553887"><span id="local-6989586621679553888"><span id="local-6989586621679553889"><span id="local-6989586621679553890"><span id="local-6989586621679553891"><span id="local-6989586621679553892"><span id="local-6989586621679553893"><span id="local-6989586621679553894"><span id="local-6989586621679553895"><span id="local-6989586621679553896"><span class="hs-keyword">instance</span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-371"></span><span>      </span><span class="annot"><a href="#local-6989586621679553896"><span class="hs-identifier hs-type">selfAttention</span></a></span><span>
</span><span id="line-372"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553895"><span class="hs-identifier hs-type">query</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553894"><span class="hs-identifier hs-type">attentionBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>      </span><span class="annot"><a href="#local-6989586621679553893"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><a href="#local-6989586621679553892"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><a href="#local-6989586621679553891"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><a href="#local-6989586621679553890"><span class="hs-identifier hs-type">crossAttention</span></a></span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553892"><span class="hs-identifier hs-type">tensor0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553889"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553888"><span class="hs-identifier hs-type">crossAttentionBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><a href="#local-6989586621679553891"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><a href="#local-6989586621679553887"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><a href="#local-6989586621679553886"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-382"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-383"></span><span>      </span><span class="annot"><a href="#local-6989586621679553885"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><a href="#local-6989586621679553887"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><a href="#local-6989586621679553886"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><a href="#local-6989586621679553884"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><a href="#local-6989586621679553883"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553896"><span class="hs-identifier hs-type">selfAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553890"><span class="hs-identifier hs-type">crossAttention</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679553885"><span class="hs-identifier hs-type">feedForwardNetwork</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679553895"><span class="hs-identifier hs-type">query</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553889"><span class="hs-identifier hs-type">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553894"><span class="hs-identifier hs-type">attentionBias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679553888"><span class="hs-identifier hs-type">crossAttentionBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span class="annot"><a href="#local-6989586621679553893"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="#local-6989586621679553884"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-394"></span><span>    </span><span class="annot"><a href="#local-6989586621679553883"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-396"></span><span>  </span><span id="local-6989586621679553881"><span class="annot"><span class="annottext">forward :: GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; (query, key, attentionBias, crossAttentionBias)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679553881"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679553878"><span id="local-6989586621679553879"><span id="local-6989586621679553880"><span class="annot"><span class="annottext">selfAttention
crossAttention
feedForwardNetwork
tbFeedForwardNetwork :: feedForwardNetwork
tbCrossAttention :: crossAttention
tbSelfAttention :: selfAttention
tbFeedForwardNetwork :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; feedForwardNetwork
tbCrossAttention :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; crossAttention
tbSelfAttention :: forall selfAttention crossAttention feedForwardNetwork.
GTransformerBlock selfAttention crossAttention feedForwardNetwork
-&gt; selfAttention
</span><a href="#local-6989586621679553878"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679553877"><span class="annot"><span class="annottext">query
</span><a href="#local-6989586621679553877"><span class="hs-identifier hs-var">query</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553876"><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679553876"><span class="hs-identifier hs-var">key</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553875"><span class="annot"><span class="annottext">attentionBias
</span><a href="#local-6989586621679553875"><span class="hs-identifier hs-var">attentionBias</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679553874"><span class="annot"><span class="annottext">crossAttentionBias
</span><a href="#local-6989586621679553874"><span class="hs-identifier hs-var">crossAttentionBias</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-397"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><span class="annottext">(query, attentionBias)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (query, attentionBias)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">query
</span><a href="#local-6989586621679553877"><span class="hs-identifier hs-var">query</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attentionBias
</span><a href="#local-6989586621679553875"><span class="hs-identifier hs-var">attentionBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (query, attentionBias)
-&gt; ((query, attentionBias)
    -&gt; IxStateT
         m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (tensor0, Generator generatorDevice0))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (tensor0, Generator generatorDevice0))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; ((query, attentionBias)
    -&gt; Generator generatorDevice
    -&gt; m (tensor0, Generator generatorDevice0))
-&gt; (query, attentionBias)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">selfAttention
-&gt; (query, attentionBias)
-&gt; Generator generatorDevice
-&gt; m (tensor0, Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">selfAttention
</span><a href="#local-6989586621679553880"><span class="hs-identifier hs-var">tbSelfAttention</span></a></span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice0) tensor0
-&gt; (tensor0
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679553873"><span class="annot"><span class="annottext">tensor0
</span><a href="#local-6989586621679553873"><span class="hs-identifier hs-var">query'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; ((tensor0, key, crossAttentionBias)
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; (tensor0, key, crossAttentionBias)
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">crossAttention
-&gt; (tensor0, key, crossAttentionBias)
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">crossAttention
</span><a href="#local-6989586621679553879"><span class="hs-identifier hs-var">tbCrossAttention</span></a></span><span> </span><span class="annot"><span class="annottext">((tensor0, key, crossAttentionBias)
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (tensor0, key, crossAttentionBias)
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tensor0
</span><a href="#local-6989586621679553873"><span class="hs-identifier hs-var">query'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">key
</span><a href="#local-6989586621679553876"><span class="hs-identifier hs-var">key</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">crossAttentionBias
</span><a href="#local-6989586621679553874"><span class="hs-identifier hs-var">crossAttentionBias</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor1
    -&gt; Generator generatorDevice1
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor1
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">feedForwardNetwork
-&gt; tensor1
-&gt; Generator generatorDevice1
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">feedForwardNetwork
</span><a href="#local-6989586621679553878"><span class="hs-identifier hs-var">tbFeedForwardNetwork</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-402"></span></pre></body></html>