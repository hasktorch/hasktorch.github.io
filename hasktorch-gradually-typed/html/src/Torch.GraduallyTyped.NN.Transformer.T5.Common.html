<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilyDependencies #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# OPTIONS_GHC -v2 #-}</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.T5.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">Control.Monad.Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">MonadThrow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier">SDType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDeviceType"><span class="hs-identifier">SDeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier">EDTDecoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier">EDTEncoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier">EDTHeadF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier">EDTSharedEmbeddingF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier">GEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier">encoderDecoderTransformerSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier">MkRelPos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier">MkTransformerAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier">MkTransformerPaddingMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier">SWithLMHead</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier">SByT5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier">ST5</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier">ShiftRight</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier">ByT5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier">T5</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier">mkTransformerInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html"><span class="hs-identifier">Torch.GraduallyTyped.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier">sMkGenerator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SRequiresGradient"><span class="hs-identifier">SRequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier">SName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier">SSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator">(:&amp;:)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Creation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html#sOnes"><span class="hs-identifier">sOnes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier">SGetDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier">TensorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | T5 dType.</span><span>
</span><span id="line-49"></span><span class="hs-keyword">type</span><span> </span><span id="T5DType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-var">T5DType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | T5 dType singleton.</span><span>
</span><span id="line-52"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DType"><span class="hs-identifier hs-type">t5DType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier hs-type">SDType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-type">T5DType</span></a></span><span>
</span><span id="line-53"></span><span id="t5DType"><span class="annot"><span class="annottext">t5DType :: SDType T5DType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DType"><span class="hs-identifier hs-var hs-var">t5DType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI T5DType =&gt; Sing T5DType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-type">T5DType</span></a></span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | T5 data type.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">type</span><span> </span><span id="T5DataType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-var">T5DataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-type">T5DType</span></a></span><span>
</span><span id="line-57"></span><span>
</span><span id="line-58"></span><span class="hs-comment">-- | T5 data type singleton.</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-type">t5DataType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span>
</span><span id="line-60"></span><span id="t5DataType"><span class="annot"><span class="annottext">t5DataType :: SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var hs-var">t5DataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI T5DataType =&gt; Sing T5DataType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | T5 dropout rate.</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- 'dropout_rate = 0.1'</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DropoutP"><span class="hs-identifier hs-type">t5DropoutP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-65"></span><span id="t5DropoutP"><span class="annot"><span class="annottext">t5DropoutP :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DropoutP"><span class="hs-identifier hs-var hs-var">t5DropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | T5 relative positional encoding bucket dimension.</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- 'relative_attention_num_buckets = 32'</span><span>
</span><span id="line-69"></span><span class="hs-keyword">type</span><span> </span><span id="T5RelPosEncBucketDim"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-var">T5RelPosEncBucketDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-comment">-- | T5 relative positional encoding bucket dimension singleton.</span><span>
</span><span id="line-72"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-type">t5RelPosEncBucketDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span>
</span><span id="line-73"></span><span id="t5RelPosEncBucketDim"><span class="annot"><span class="annottext">t5RelPosEncBucketDim :: SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var hs-var">t5RelPosEncBucketDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI T5RelPosEncBucketDim =&gt; Sing T5RelPosEncBucketDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-comment">-- | T5 layer-norm epsilon.</span><span>
</span><span id="line-76"></span><span class="hs-comment">-- 'layer_norm_epsilon = 1e-06'</span><span>
</span><span id="line-77"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5Eps"><span class="hs-identifier hs-type">t5Eps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-78"></span><span id="t5Eps"><span class="annot"><span class="annottext">t5Eps :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5Eps"><span class="hs-identifier hs-var hs-var">t5Eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-6</span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- | T5 maximum distance for relative positional encoding.</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-type">t5MaxDistance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-82"></span><span id="t5MaxDistance"><span class="annot"><span class="annottext">t5MaxDistance :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var hs-var">t5MaxDistance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">128</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | T5 padding token id.</span><span>
</span><span id="line-85"></span><span class="hs-comment">-- 'pad_token_id = 0'</span><span>
</span><span id="line-86"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-type">t5PadTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-87"></span><span id="t5PadTokenId"><span class="annot"><span class="annottext">t5PadTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var hs-var">t5PadTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-comment">-- | T5 begin-of-sentence token id.</span><span>
</span><span id="line-90"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-type">t5BOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-91"></span><span id="t5BOSTokenId"><span class="annot"><span class="annottext">t5BOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-var hs-var">t5BOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-comment">-- | T5 end-of-sentence token id.</span><span>
</span><span id="line-94"></span><span class="hs-comment">-- 'eos_token_id = 1'</span><span>
</span><span id="line-95"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5EOSTokenId"><span class="hs-identifier hs-type">t5EOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-96"></span><span id="t5EOSTokenId"><span class="annot"><span class="annottext">t5EOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5EOSTokenId"><span class="hs-identifier hs-var hs-var">t5EOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-comment">-- | T5 attention mask bias</span><span>
</span><span id="line-99"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-type">t5AttentionMaskBias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-100"></span><span id="t5AttentionMaskBias"><span class="annot"><span class="annottext">t5AttentionMaskBias :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var hs-var">t5AttentionMaskBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10000</span></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-comment">-- | Specifies a T5 or ByT5 model.</span><span>
</span><span id="line-103"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-type">T5ModelF</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-117"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-118"></span><span>  </span><span id="T5ModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-var">T5ModelF</span></a></span></span><span> </span><span id="local-6989586621679587319"><span class="annot"><a href="#local-6989586621679587319"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679587318"><span class="annot"><a href="#local-6989586621679587318"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679587317"><span class="annot"><a href="#local-6989586621679587317"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587316"><span class="annot"><a href="#local-6989586621679587316"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587315"><span class="annot"><a href="#local-6989586621679587315"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679587314"><span class="annot"><a href="#local-6989586621679587314"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679587313"><span class="annot"><a href="#local-6989586621679587313"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679587312"><span class="annot"><a href="#local-6989586621679587312"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587311"><span class="annot"><a href="#local-6989586621679587311"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679587310"><span class="annot"><a href="#local-6989586621679587310"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587309"><span class="annot"><a href="#local-6989586621679587309"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679587308"><span class="annot"><a href="#local-6989586621679587308"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span id="T5ModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-var">T5ModelF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679587307"><span class="annot"><a href="#local-6989586621679587307"><span class="hs-identifier hs-type hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679587306"><span class="annot"><a href="#local-6989586621679587306"><span class="hs-identifier hs-type hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587305"><span class="annot"><a href="#local-6989586621679587305"><span class="hs-identifier hs-type hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587304"><span class="annot"><a href="#local-6989586621679587304"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679587303"><span class="annot"><a href="#local-6989586621679587303"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679587302"><span class="annot"><a href="#local-6989586621679587302"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679587301"><span class="annot"><a href="#local-6989586621679587301"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587300"><span class="annot"><a href="#local-6989586621679587300"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679587299"><span class="annot"><a href="#local-6989586621679587299"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587298"><span class="annot"><a href="#local-6989586621679587298"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679587297"><span class="annot"><a href="#local-6989586621679587297"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-123"></span><span>          </span><span class="annot"><a href="#local-6989586621679587299"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-124"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-type">EDTEncoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587306"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587304"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587303"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587302"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587301"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587300"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587299"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587298"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-type">EDTDecoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587305"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587304"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587303"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587302"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587301"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587300"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587299"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587298"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-type">EDTSharedEmbeddingF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587304"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587303"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587299"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587297"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-type">EDTHeadF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587307"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587304"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587303"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587299"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587297"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-type">MkTransformerPaddingMask</span></a></span><span>
</span><span id="line-132"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-type">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-type">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-type">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>  </span><span id="T5ModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-var">T5ModelF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679587296"><span class="annot"><a href="#local-6989586621679587296"><span class="hs-identifier hs-type hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679587295"><span class="annot"><a href="#local-6989586621679587295"><span class="hs-identifier hs-type hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587294"><span class="annot"><a href="#local-6989586621679587294"><span class="hs-identifier hs-type hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587293"><span class="annot"><a href="#local-6989586621679587293"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679587292"><span class="annot"><a href="#local-6989586621679587292"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679587291"><span class="annot"><a href="#local-6989586621679587291"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679587290"><span class="annot"><a href="#local-6989586621679587290"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587289"><span class="annot"><a href="#local-6989586621679587289"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679587288"><span class="annot"><a href="#local-6989586621679587288"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587287"><span class="annot"><a href="#local-6989586621679587287"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679587286"><span class="annot"><a href="#local-6989586621679587286"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-138"></span><span>          </span><span class="annot"><a href="#local-6989586621679587288"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-139"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-type">EDTEncoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587295"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587293"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587292"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587291"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587290"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587289"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587288"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587287"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-type">EDTDecoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587294"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587293"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587292"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587291"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587290"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587289"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587288"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587287"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-type">EDTSharedEmbeddingF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587293"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587292"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587288"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587286"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-type">EDTHeadF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587296"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587293"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587292"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587288"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587286"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-type">MkTransformerPaddingMask</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-type">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-type">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-type">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-comment">-- | Specifies the parameters of a T5 or ByT5 model.</span><span>
</span><span id="line-152"></span><span class="hs-comment">--</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- - @transformerHead@: the head of the T5 or ByT5 model.</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- - @numLayers@: the number of layers in the T5 or ByT5 model.</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the T5 or ByT5 model.</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- - @device@: the computational device on which the T5 or ByT5 model parameters are to be allocated.</span><span>
</span><span id="line-157"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5ModelSpec"><span class="hs-identifier hs-type">t5ModelSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679587284"><span class="annot"><a href="#local-6989586621679587284"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679587283"><span class="annot"><a href="#local-6989586621679587283"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679587282"><span class="annot"><a href="#local-6989586621679587282"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587281"><span class="annot"><a href="#local-6989586621679587281"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587280"><span class="annot"><a href="#local-6989586621679587280"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679587279"><span class="annot"><a href="#local-6989586621679587279"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679587278"><span class="annot"><a href="#local-6989586621679587278"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679587277"><span class="annot"><a href="#local-6989586621679587277"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587276"><span class="annot"><a href="#local-6989586621679587276"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679587275"><span class="annot"><a href="#local-6989586621679587275"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679587274"><span class="annot"><a href="#local-6989586621679587274"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679587273"><span class="annot"><a href="#local-6989586621679587273"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587278"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587277"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587276"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587275"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587274"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587273"><span class="hs-identifier hs-type">vocabDim</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587284"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587283"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587282"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587281"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587280"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587279"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-172"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-type">T5ModelF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587284"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587283"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587282"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587281"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587280"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587279"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587278"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587277"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587276"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587275"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587274"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587273"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span id="t5ModelSpec"><span class="annot"><span class="annottext">t5ModelSpec :: STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; ModelSpec
     (T5ModelF
        style
        transformerHead
        numEncoderLayers
        numDecoderLayers
        gradient
        device
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        vocabDim)
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5ModelSpec"><span class="hs-identifier hs-var hs-var">t5ModelSpec</span></a></span></span><span> </span><span id="local-6989586621679587272"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679587272"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679587271"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679587271"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679587270"><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679587270"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587269"><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679587269"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679587268"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679587268"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679587267"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679587267"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679587272"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-176"></span><span>      </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        Dropout))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        T5DataType
        vocabDim
        inputEmbedDim
        'Nothing))
  (ModelSpec
     (EDTHeadF
        'T5
        transformerHead
        gradient
        device
        T5DataType
        inputEmbedDim
        vocabDim))
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkTransformerPaddingMask
-&gt; MkTransformerAttentionMask T5DataType
-&gt; MkTransformerCrossAttentionMask T5DataType
-&gt; MkTransformerDecoderAttentionMask T5DataType
-&gt; GSimplifiedEncoderDecoderTransformer
     (GEncoderDecoderTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numEncoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel ())))
                                Relu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              Dropout))
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numDecoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GCrossAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel ())))
                                Relu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              Dropout))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EDTHeadF
              'T5
              transformerHead
              gradient
              device
              T5DataType
              inputEmbedDim
              vocabDim)))
     (MkRelPos T5RelPosEncBucketDim)
     (MkRelPos T5RelPosEncBucketDim)
     MkTransformerPaddingMask
     (MkTransformerAttentionMask T5DataType)
     (MkTransformerCrossAttentionMask T5DataType)
     (MkTransformerDecoderAttentionMask T5DataType)
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 'T5 gradient device T5DataType inputEmbedDim T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 'T5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF 'T5))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF 'T5 gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'T5)
                             (FFNActivationDropoutF 'T5)
                             (FFNOutputProjectionF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                'T5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF 'T5))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 'T5 gradient device T5DataType inputEmbedDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 'T5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF 'T5))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF 'T5 gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF 'T5 gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (CAFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'T5)
                             (FFNActivationDropoutF 'T5)
                             (FFNOutputProjectionF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                'T5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF 'T5))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           'T5
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF style))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (CAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF style))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
</span><a href="#local-6989586621679587265"><span class="hs-identifier hs-var">modelSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-var">t5BOSTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-var">MkRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkDecoderRelPos"><span class="hs-identifier hs-var">MkDecoderRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-187"></span><span>      </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        Dropout))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        T5DataType
        vocabDim
        inputEmbedDim
        'Nothing))
  (ModelSpec
     (EDTHeadF
        'ByT5
        transformerHead
        gradient
        device
        T5DataType
        inputEmbedDim
        vocabDim))
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkTransformerPaddingMask
-&gt; MkTransformerAttentionMask T5DataType
-&gt; MkTransformerCrossAttentionMask T5DataType
-&gt; MkTransformerDecoderAttentionMask T5DataType
-&gt; GSimplifiedEncoderDecoderTransformer
     (GEncoderDecoderTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numEncoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (GGate
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ())))
                                   GeluNew
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ()))))
                                GeluNew
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              Dropout))
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numDecoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GCrossAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (GGate
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ())))
                                   GeluNew
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ()))))
                                GeluNew
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              Dropout))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EDTHeadF
              'ByT5
              transformerHead
              gradient
              device
              T5DataType
              inputEmbedDim
              vocabDim)))
     (MkRelPos T5RelPosEncBucketDim)
     (MkRelPos T5RelPosEncBucketDim)
     MkTransformerPaddingMask
     (MkTransformerAttentionMask T5DataType)
     (MkTransformerCrossAttentionMask T5DataType)
     (MkTransformerDecoderAttentionMask T5DataType)
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-188"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 'ByT5
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 'ByT5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF 'ByT5))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      'ByT5 gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'ByT5)
                             (FFNActivationDropoutF 'ByT5)
                             (FFNOutputProjectionF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF 'ByT5))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 'ByT5
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 'ByT5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF 'ByT5))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      'ByT5 gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      'ByT5 gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (CAFinalLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'ByT5)
                             (FFNActivationDropoutF 'ByT5)
                             (FFNOutputProjectionF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF 'ByT5))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           'ByT5
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF style))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (CAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF style))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
</span><a href="#local-6989586621679587265"><span class="hs-identifier hs-var">modelSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-var">t5BOSTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-var">MkRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkDecoderRelPos"><span class="hs-identifier hs-var">MkDecoderRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">STransformerStyle style
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (T5ModelF
     style
     transformerHead
     numEncoderLayers
     numDecoderLayers
     gradient
     device
     headDim
     headEmbedDim
     embedDim
     inputEmbedDim
     ffnDim
     vocabDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="#local-6989586621679587265"><span class="hs-identifier hs-type">modelSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-200"></span><span>    </span><span id="local-6989586621679587265"><span class="annot"><span class="annottext">modelSpec' :: STransformerStyle style
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF style))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (CAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF style))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
</span><a href="#local-6989586621679587265"><span class="hs-identifier hs-var hs-var">modelSpec'</span></a></span></span><span> </span><span id="local-6989586621679587256"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679587256"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType T5DataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim T5RelPosEncBucketDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           style
           numEncoderLayers
           gradient
           device
           T5DataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           T5RelPosEncBucketDim)
        (EDTDecoderF
           style
           numDecoderLayers
           gradient
           device
           T5DataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           T5RelPosEncBucketDim)
        (EDTSharedEmbeddingF
           style gradient device T5DataType inputEmbedDim vocabDim)
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numEncoderLayers :: Nat)
       (numDecoderLayers :: Nat) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           style
           numEncoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTDecoderF
           style
           numDecoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTSharedEmbeddingF
           style gradient device dataType inputEmbedDim vocabDim)
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var">encoderDecoderTransformerSpec</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679587256"><span class="hs-identifier hs-var">style'</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679587271"><span class="hs-identifier hs-var">transformerHead</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679587270"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679587269"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679587268"><span class="hs-identifier hs-var">gradient</span></a></span><span>
</span><span id="line-207"></span><span>        </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679587267"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span>
</span><span id="line-209"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headDim =&gt; Sing headDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679587278"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headEmbedDim =&gt; Sing headEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679587277"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI embedDim =&gt; Sing embedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679587276"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI inputEmbedDim =&gt; Sing inputEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679587275"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI ffnDim =&gt; Sing ffnDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679587274"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>        </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI vocabDim =&gt; Sing vocabDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679587273"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DropoutP"><span class="hs-identifier hs-var">t5DropoutP</span></a></span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5Eps"><span class="hs-identifier hs-var">t5Eps</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#mkT5Input"><span class="hs-identifier hs-type">mkT5Input</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679587254"><span class="annot"><a href="#local-6989586621679587254"><span class="hs-identifier hs-type">batchDim</span></a></span></span><span> </span><span id="local-6989586621679587253"><span class="annot"><a href="#local-6989586621679587253"><span class="hs-identifier hs-type">seqDim</span></a></span></span><span> </span><span id="local-6989586621679587252"><span class="annot"><a href="#local-6989586621679587252"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679587251"><span class="annot"><a href="#local-6989586621679587251"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679587250"><span class="annot"><a href="#local-6989586621679587250"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier hs-type">MonadThrow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587251"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587254"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587253"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679587254"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679587253"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-225"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span>
</span><span id="line-226"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-227"></span><span>              </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-228"></span><span>                 </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span>
</span><span id="line-229"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-230"></span><span>              </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679587254"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679587253"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679587254"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679587253"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><a href="#local-6989586621679587250"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-235"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithoutGradient"><span class="hs-identifier hs-type">WithoutGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>          </span><span class="annot"><a href="#local-6989586621679587252"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-238"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679587254"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679587253"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587254"><span class="hs-identifier hs-type">batchDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587253"><span class="hs-identifier hs-type">seqDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587252"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="#local-6989586621679587251"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679587250"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-246"></span><span id="mkT5Input"><span class="annot"><span class="annottext">mkT5Input :: SDim batchDim
-&gt; SDim seqDim -&gt; SDevice device -&gt; [[Int]] -&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#mkT5Input"><span class="hs-identifier hs-var hs-var">mkT5Input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
forall (batchDim :: Dim (Name Symbol) (Size Nat))
       (seqDim :: Dim (Name Symbol) (Size Nat))
       (device :: Device (DeviceType Nat)) (m :: * -&gt; *) output.
(MonadThrow m, SGetDim batchDim, SGetDim seqDim,
 'Shape '[batchDim, seqDim]
 ~ Seq
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize,
           'Dim ('Name &quot;*&quot;) 'UncheckedSize]
      &lt;+&gt; 'Shape '[batchDim, seqDim])
     ('Shape '[batchDim, seqDim]),
 output
 ~ Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     device
     ('DataType 'Int64)
     ('Shape '[batchDim, seqDim])) =&gt;
Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier hs-var">mkTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#testT5"><span class="hs-identifier hs-type">testT5</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-249"></span><span id="testT5"><span class="annot"><span class="annottext">testT5 :: IO
  ((EncoderDecoderTransformerOutput
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         T5DataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
               'Dim ('Name &quot;*&quot;) ('Size 32128)]))
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         T5DataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
               'Dim ('Name &quot;*&quot;) ('Size 512)])),
    SimplifiedEncoderDecoderTransformerOutput
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         T5DataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
               'Dim ('Name &quot;*&quot;) ('Size 32128)]))
      (Tensor
         ('Gradient 'WithGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         T5DataType
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
               'Dim ('Name &quot;*&quot;) ('Size 512)]))
      (Tensor
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         ('DataType 'Bool)
         ('Shape
            '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))),
   Generator ('Device 'CPU))
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#testT5"><span class="hs-identifier hs-var hs-var">testT5</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679587248"><span class="annot"><span class="annottext">gradient :: SGradient ('Gradient 'WithGradient)
</span><a href="#local-6989586621679587248"><span class="hs-identifier hs-var hs-var">gradient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
-&gt; SGradient ('Gradient 'WithGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithGradient"><span class="hs-identifier hs-var">SWithGradient</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span id="local-6989586621679587245"><span class="annot"><span class="annottext">device :: SDevice ('Device 'CPU)
</span><a href="#local-6989586621679587245"><span class="hs-identifier hs-var hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDeviceType 'CPU -&gt; SDevice ('Device 'CPU)
forall (deviceType :: DeviceType Nat).
SDeviceType deviceType -&gt; SDevice ('Device deviceType)
</span><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-var">SDevice</span></a></span><span> </span><span class="annot"><span class="annottext">SDeviceType 'CPU
</span><a href="Torch.GraduallyTyped.Device.html#SCPU"><span class="hs-identifier hs-var">SCPU</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span id="local-6989586621679587242"><span class="annot"><span class="annottext">headDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
</span><a href="#local-6989586621679587242"><span class="hs-identifier hs-var hs-var">headDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 8) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 8 =&gt; SSize ('Size 8)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">8</span></span><span>
</span><span id="line-253"></span><span>      </span><span id="local-6989586621679587239"><span class="annot"><span class="annottext">headEmbedDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
</span><a href="#local-6989586621679587239"><span class="hs-identifier hs-var hs-var">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 64) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 64 =&gt; SSize ('Size 64)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">64</span></span><span>
</span><span id="line-254"></span><span>      </span><span id="local-6989586621679587238"><span class="annot"><span class="annottext">embedDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679587238"><span class="hs-identifier hs-var hs-var">embedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 512) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 512 =&gt; SSize ('Size 512)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">512</span></span><span>
</span><span id="line-255"></span><span>      </span><span id="local-6989586621679587237"><span class="annot"><span class="annottext">inputEmbedDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679587237"><span class="hs-identifier hs-var hs-var">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 512) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 512 =&gt; SSize ('Size 512)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">512</span></span><span>
</span><span id="line-256"></span><span>      </span><span id="local-6989586621679587236"><span class="annot"><span class="annottext">ffnDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
</span><a href="#local-6989586621679587236"><span class="hs-identifier hs-var hs-var">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 2048) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 2048 =&gt; SSize ('Size 2048)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2048</span></span><span>
</span><span id="line-257"></span><span>      </span><span id="local-6989586621679587235"><span class="annot"><span class="annottext">vocabDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
</span><a href="#local-6989586621679587235"><span class="hs-identifier hs-var hs-var">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 32128) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 32128 =&gt; SSize ('Size 32128)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">32128</span></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679587234"><span class="annot"><span class="annottext">g :: Generator ('Device 'CPU)
</span><a href="#local-6989586621679587234"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU) -&gt; Word64 -&gt; Generator ('Device 'CPU)
forall (device :: Device (DeviceType Nat)).
SDevice device -&gt; Word64 -&gt; Generator device
</span><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier hs-var">sMkGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679587245"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679587233"><span class="annot"><span class="annottext">batchDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679587233"><span class="hs-identifier hs-var hs-var">batchDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 3) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 3 =&gt; SSize ('Size 3)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-260"></span><span>      </span><span id="local-6989586621679587232"><span class="annot"><span class="annottext">seqDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679587232"><span class="hs-identifier hs-var hs-var">seqDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 13) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 13 =&gt; SSize ('Size 13)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">13</span></span><span>
</span><span id="line-261"></span><span>      </span><span id="local-6989586621679587231"><span class="annot"><span class="annottext">decoderSeqDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679587231"><span class="hs-identifier hs-var hs-var">decoderSeqDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 7) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 7 =&gt; SSize ('Size 7)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">7</span></span><span>
</span><span id="line-262"></span><span>      </span><span id="local-6989586621679587230"><span class="annot"><span class="annottext">sOnes' :: SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var hs-var">sOnes'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TensorSpec
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  dataType
  shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
TensorSpec gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Creation.html#sOnes"><span class="hs-identifier hs-var">sOnes</span></a></span><span> </span><span class="annot"><span class="annottext">(TensorSpec
   ('Gradient 'WithoutGradient)
   ('Layout 'Dense)
   ('Device 'CPU)
   dataType
   shape
 -&gt; Tensor
      ('Gradient 'WithoutGradient)
      ('Layout 'Dense)
      ('Device 'CPU)
      dataType
      shape)
-&gt; (SShape shape
    -&gt; TensorSpec
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         dataType
         shape)
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((SShape shape
  -&gt; TensorSpec
       ('Gradient 'WithoutGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       dataType
       shape)
 -&gt; SShape shape
 -&gt; Tensor
      ('Gradient 'WithoutGradient)
      ('Layout 'Dense)
      ('Device 'CPU)
      dataType
      shape)
-&gt; (SDataType dataType
    -&gt; SShape shape
    -&gt; TensorSpec
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         dataType
         shape)
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithoutGradient)
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice ('Device 'CPU)
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; TensorSpec
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; TensorSpec gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier hs-var">TensorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
-&gt; SGradient ('Gradient 'WithoutGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithoutGradient"><span class="hs-identifier hs-var">SWithoutGradient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679587245"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span id="local-6989586621679587224"><span class="annot"><span class="annottext">edtInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679587224"><span class="hs-identifier hs-var hs-var">edtInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679587233"><span class="hs-identifier hs-var">batchDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679587232"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>      </span><span id="local-6989586621679587219"><span class="annot"><span class="annottext">edtAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679587219"><span class="hs-identifier hs-var hs-var">edtAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
     'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
      'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
            'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 13), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679587232"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 13), 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679587232"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>      </span><span id="local-6989586621679587218"><span class="annot"><span class="annottext">edtDecoderInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679587218"><span class="hs-identifier hs-var hs-var">edtDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679587233"><span class="hs-identifier hs-var">batchDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679587231"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>      </span><span id="local-6989586621679587217"><span class="annot"><span class="annottext">edtDecoderAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679587217"><span class="hs-identifier hs-var hs-var">edtDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
     'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
      'Dim ('Name &quot;*&quot;) ('Size 7)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
            'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679587231"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679587231"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>      </span><span id="local-6989586621679587216"><span class="annot"><span class="annottext">edtCrossAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679587216"><span class="hs-identifier hs-var hs-var">edtCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
     'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
      'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
            'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679587231"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679587232"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679587215"><span class="annot"><span class="annottext">spec :: ModelSpec
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (EDTEncoderF
        'T5
        4
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 8))
        ('Dim ('Name &quot;*&quot;) ('Size 64))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 2048))
        T5RelPosEncBucketDim)
     (EDTDecoderF
        'T5
        4
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 8))
        ('Dim ('Name &quot;*&quot;) ('Size 64))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 2048))
        T5RelPosEncBucketDim)
     (EDTSharedEmbeddingF
        'T5
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 32128)))
     (EDTHeadF
        'T5
        'WithLMHead
        ('Gradient 'WithGradient)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ('Dim ('Name &quot;*&quot;) ('Size 32128))))
</span><a href="#local-6989586621679587215"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; STransformerHead 'WithLMHead
-&gt; SNat 4
-&gt; SNat 4
-&gt; SGradient ('Gradient 'WithGradient)
-&gt; SDevice ('Device 'CPU)
-&gt; SDataType T5DataType
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
-&gt; SDim T5RelPosEncBucketDim
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        (EDTEncoderF
           'T5
           4
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 8))
           ('Dim ('Name &quot;*&quot;) ('Size 64))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 2048))
           T5RelPosEncBucketDim)
        (EDTDecoderF
           'T5
           4
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 8))
           ('Dim ('Name &quot;*&quot;) ('Size 64))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 2048))
           T5RelPosEncBucketDim)
        (EDTSharedEmbeddingF
           'T5
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 32128)))
        (EDTHeadF
           'T5
           'WithLMHead
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ('Dim ('Name &quot;*&quot;) ('Size 32128))))
forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numEncoderLayers :: Nat)
       (numDecoderLayers :: Nat) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           style
           numEncoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTDecoderF
           style
           numDecoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTSharedEmbeddingF
           style gradient device dataType inputEmbedDim vocabDim)
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var">encoderDecoderTransformerSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead 'WithLMHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat 4 =&gt; SNat 4
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNat</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">KnownNat 4 =&gt; SNat 4
forall (n :: Nat). KnownNat n =&gt; SNat n
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNat</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">4</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithGradient)
</span><a href="#local-6989586621679587248"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679587245"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 8))
</span><a href="#local-6989586621679587242"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 64))
</span><a href="#local-6989586621679587239"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679587238"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 512))
</span><a href="#local-6989586621679587237"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 2048))
</span><a href="#local-6989586621679587236"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 32128))
</span><a href="#local-6989586621679587235"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DropoutP"><span class="hs-identifier hs-var">t5DropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5Eps"><span class="hs-identifier hs-var">t5Eps</span></a></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679587213"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias ())))
</span><a href="#local-6989586621679587213"><span class="hs-identifier hs-var">sedtModel</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679587212"><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679587212"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GCrossAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       T5DataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias ()))))
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (GEncoderDecoderTransformer
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (Embedding
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    T5RelPosEncBucketDim
                    ('Dim ('Name &quot;*&quot;) ('Size 8))
                    'Nothing))
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (Vector
                       4
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 8))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 512))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Relu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                      (NamedModel ())))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNorm
                    'WithoutBias
                    ('Gradient 'WithGradient)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              Dropout))
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (Embedding
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    T5RelPosEncBucketDim
                    ('Dim ('Name &quot;*&quot;) ('Size 8))
                    'Nothing))
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (Vector
                       4
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 8))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 512))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GCrossAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      ('Dim ('Name &quot;*&quot;) ('Size 8))
                                      ('Dim ('Name &quot;*&quot;) ('Size 64))
                                      ('Dim ('Name &quot;*&quot;) ('Size 512))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  ('Gradient 'WithGradient)
                                                  ('Layout 'Dense)
                                                  ('Device 'CPU)
                                                  T5DataType
                                                  ('Shape
                                                     '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                        'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                            (NamedModel ())))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      ('Gradient 'WithGradient)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Relu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                      (NamedModel ())))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNorm
                    'WithoutBias
                    ('Gradient 'WithGradient)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              Dropout))
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              ('Dim ('Name &quot;*&quot;) ('Size 32128))
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              'Nothing))
        (NamedModel
           (GLMHead
              ('Dim ('Name &quot;*&quot;) ('Size 512))
              ()
              ()
              ()
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          T5DataType
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                    (NamedModel ())))
              (GBias ()))),
      Generator ('Device 'CPU))
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GCrossAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       T5DataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias ()))))
GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (EmbeddingSpec
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias ())))
</span><a href="#local-6989586621679587215"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679587234"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679587210"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
</span><a href="#local-6989586621679587210"><span class="hs-identifier hs-var">t5Output</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679587209"><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679587209"><span class="hs-identifier hs-var">g''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679587208"><span class="annot"><span class="annottext">edtPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679587208"><span class="hs-identifier hs-var hs-var">edtPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
     'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
      'Dim ('Name &quot;*&quot;) ('Size 13)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
            'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 13)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 13), 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679587232"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 13), 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
</span><a href="#local-6989586621679587232"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 13))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 13)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>        </span><span id="local-6989586621679587207"><span class="annot"><span class="annottext">edtDecoderPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679587207"><span class="hs-identifier hs-var hs-var">edtDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Int64)
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679587230"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDType 'Int64 -&gt; SDataType ('DataType 'Int64)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Int64
</span><a href="Torch.GraduallyTyped.DType.html#SInt64"><span class="hs-identifier hs-var">SInt64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
     'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
      'Dim ('Name &quot;*&quot;) ('Size 7)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
            'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 7)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679587231"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7), 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
</span><a href="#local-6989586621679587231"><span class="hs-identifier hs-var">decoderSeqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 7))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 7)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias ())))
-&gt; EncoderDecoderTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
              'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
              'Dim ('Name &quot;*&quot;) ('Size 7)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
              'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
              'Dim ('Name &quot;*&quot;) ('Size 7)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
              'Dim ('Name &quot;*&quot;) ('Size 13)]))
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (EncoderDecoderTransformerOutput
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
                 'Dim ('Name &quot;*&quot;) ('Size 32128)]))
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                 'Dim ('Name &quot;*&quot;) ('Size 512)])),
      Generator ('Device 'CPU))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias ())))
</span><a href="#local-6989586621679587213"><span class="hs-identifier hs-var">sedtModel</span></a></span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerInput :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
input
-&gt; decoderInput
-&gt; pos
-&gt; decoderPos
-&gt; attentionMask
-&gt; decoderAttentionMask
-&gt; crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtCrossAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
edtAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
edtPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
edtInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
edtPos :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtCrossAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtDecoderAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 7),
        'Dim ('Name &quot;*&quot;) ('Size 7)])
edtDecoderInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
edtAttentionMask :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  T5DataType
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 13),
        'Dim ('Name &quot;*&quot;) ('Size 13)])
edtInput :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtCrossAttentionMask"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679587212"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679587197"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Bool)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
</span><a href="#local-6989586621679587197"><span class="hs-identifier hs-var">t5Output'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679587196"><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679587196"><span class="hs-identifier hs-var">g'''</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679587195"><span class="annot"><span class="annottext">sedtDecoderInputShift :: ShiftRight Int
</span><a href="#local-6989586621679587195"><span class="hs-identifier hs-var hs-var">sedtDecoderInputShift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-var">t5BOSTokenId</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span id="local-6989586621679587194"><span class="annot"><span class="annottext">sedtPaddingMaskShift :: ShiftRight Int
</span><a href="#local-6989586621679587194"><span class="hs-identifier hs-var hs-var">sedtPaddingMaskShift</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-277"></span><span>        </span><span id="local-6989586621679587193"><span class="annot"><span class="annottext">sedtMkPos :: MkRelPos T5RelPosEncBucketDim
</span><a href="#local-6989586621679587193"><span class="hs-identifier hs-var hs-var">sedtMkPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-var">MkRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span id="local-6989586621679587192"><span class="annot"><span class="annottext">sedtMkDecoderPos :: MkRelPos T5RelPosEncBucketDim
</span><a href="#local-6989586621679587192"><span class="hs-identifier hs-var hs-var">sedtMkDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkDecoderRelPos"><span class="hs-identifier hs-var">MkDecoderRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span>
</span><span id="line-279"></span><span>        </span><span id="local-6989586621679587191"><span class="annot"><span class="annottext">sedtMkPaddingMask :: MkTransformerPaddingMask
</span><a href="#local-6989586621679587191"><span class="hs-identifier hs-var hs-var">sedtMkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span>
</span><span id="line-280"></span><span>        </span><span id="local-6989586621679587190"><span class="annot"><span class="annottext">sedtMkAttentionMask :: MkTransformerAttentionMask T5DataType
</span><a href="#local-6989586621679587190"><span class="hs-identifier hs-var hs-var">sedtMkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span>
</span><span id="line-281"></span><span>        </span><span id="local-6989586621679587189"><span class="annot"><span class="annottext">sedtMkCrossAttentionMask :: MkTransformerCrossAttentionMask T5DataType
</span><a href="#local-6989586621679587189"><span class="hs-identifier hs-var hs-var">sedtMkCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span id="local-6989586621679587188"><span class="annot"><span class="annottext">sedtMkDecoderAttentionMask :: MkTransformerDecoderAttentionMask T5DataType
</span><a href="#local-6989586621679587188"><span class="hs-identifier hs-var hs-var">sedtMkDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span>
</span><span id="line-283"></span><span>        </span><span id="local-6989586621679587187"><span class="annot"><span class="annottext">model :: GSimplifiedEncoderDecoderTransformer
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GCrossAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       T5DataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias ()))))
  (MkRelPos T5RelPosEncBucketDim)
  (MkRelPos T5RelPosEncBucketDim)
  MkTransformerPaddingMask
  (MkTransformerAttentionMask T5DataType)
  (MkTransformerCrossAttentionMask T5DataType)
  (MkTransformerDecoderAttentionMask T5DataType)
</span><a href="#local-6989586621679587187"><span class="hs-identifier hs-var hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">ShiftRight Int
MkTransformerCrossAttentionMask T5DataType
MkTransformerDecoderAttentionMask T5DataType
MkTransformerAttentionMask T5DataType
MkTransformerPaddingMask
MkRelPos T5RelPosEncBucketDim
GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias ())))
sedtMkDecoderAttentionMask :: MkTransformerDecoderAttentionMask T5DataType
sedtMkCrossAttentionMask :: MkTransformerCrossAttentionMask T5DataType
sedtMkAttentionMask :: MkTransformerAttentionMask T5DataType
sedtMkPaddingMask :: MkTransformerPaddingMask
sedtMkDecoderPos :: MkRelPos T5RelPosEncBucketDim
sedtMkPos :: MkRelPos T5RelPosEncBucketDim
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias ())))
sedtMkDecoderAttentionMask :: MkTransformerDecoderAttentionMask T5DataType
sedtMkCrossAttentionMask :: MkTransformerCrossAttentionMask T5DataType
sedtMkAttentionMask :: MkTransformerAttentionMask T5DataType
sedtMkPaddingMask :: MkTransformerPaddingMask
sedtMkDecoderPos :: MkRelPos T5RelPosEncBucketDim
sedtMkPos :: MkRelPos T5RelPosEncBucketDim
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: GEncoderDecoderTransformer
  ('Dim ('Name &quot;*&quot;) ('Size 512))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (Embedding
              ('Gradient 'WithGradient)
              ('Layout 'Dense)
              ('Device 'CPU)
              T5DataType
              T5RelPosEncBucketDim
              ('Dim ('Name &quot;*&quot;) ('Size 8))
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (Vector
                 4
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GMultiHeadAttention
                                ('Dim ('Name &quot;*&quot;) ('Size 8))
                                ('Dim ('Name &quot;*&quot;) ('Size 64))
                                ('Dim ('Name &quot;*&quot;) ('Size 512))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            ('Gradient 'WithGradient)
                                            ('Layout 'Dense)
                                            ('Device 'CPU)
                                            T5DataType
                                            ('Shape
                                               '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                  'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias
                                ('Gradient 'WithGradient)
                                ('Device 'CPU)
                                T5DataType
                                ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                            'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      ('Gradient 'WithGradient)
                                      ('Layout 'Dense)
                                      ('Device 'CPU)
                                      T5DataType
                                      ('Shape
                                         '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                            'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              T5DataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
        Dropout))
  (NamedModel
     (Embedding
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        T5DataType
        ('Dim ('Name &quot;*&quot;) ('Size 32128))
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        'Nothing))
  (NamedModel
     (GLMHead
        ('Dim ('Name &quot;*&quot;) ('Size 512))
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    T5DataType
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
              (NamedModel ())))
        (GBias ())))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkDecoderAttentionMask"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-284"></span><span>        </span><span id="local-6989586621679587177"><span class="annot"><span class="annottext">inputs :: SimplifiedEncoderDecoderTransformerInput
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
</span><a href="#local-6989586621679587177"><span class="hs-identifier hs-var hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
-&gt; SimplifiedEncoderDecoderTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
forall input decoderInput.
input
-&gt; decoderInput
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])
</span><a href="#local-6989586621679587224"><span class="hs-identifier hs-var">edtInput</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Int64)
  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)])
</span><a href="#local-6989586621679587218"><span class="hs-identifier hs-var">edtDecoderInput</span></a></span><span>
</span><span id="line-285"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GCrossAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       T5DataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias ()))))
  (MkRelPos T5RelPosEncBucketDim)
  (MkRelPos T5RelPosEncBucketDim)
  MkTransformerPaddingMask
  (MkTransformerAttentionMask T5DataType)
  (MkTransformerCrossAttentionMask T5DataType)
  (MkTransformerDecoderAttentionMask T5DataType)
-&gt; SimplifiedEncoderDecoderTransformerInput
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
     (Tensor
        ('Gradient 'WithoutGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Int64)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (SimplifiedEncoderDecoderTransformerOutput
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
                 'Dim ('Name &quot;*&quot;) ('Size 32128)]))
        (Tensor
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                 'Dim ('Name &quot;*&quot;) ('Size 512)]))
        (Tensor
           ('Gradient 'WithoutGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           ('DataType 'Bool)
           ('Shape
              '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)])),
      Generator ('Device 'CPU))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  (GEncoderDecoderTransformer
     ('Dim ('Name &quot;*&quot;) ('Size 512))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (GTransformer
           ()
           (NamedModel
              (Embedding
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 T5DataType
                 T5RelPosEncBucketDim
                 ('Dim ('Name &quot;*&quot;) ('Size 8))
                 'Nothing))
           ()
           Dropout
           (NamedModel
              (GTransformerStack
                 (Vector
                    4
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GCrossAttention
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GMultiHeadAttention
                                   ('Dim ('Name &quot;*&quot;) ('Size 8))
                                   ('Dim ('Name &quot;*&quot;) ('Size 64))
                                   ('Dim ('Name &quot;*&quot;) ('Size 512))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               ('Gradient 'WithGradient)
                                               ('Layout 'Dense)
                                               ('Device 'CPU)
                                               T5DataType
                                               ('Shape
                                                  '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                                     'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                         (NamedModel ())))
                                   Dropout))
                             Dropout
                             ()))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (NamedModel
                                (LayerNorm
                                   'WithoutBias
                                   ('Gradient 'WithGradient)
                                   ('Device 'CPU)
                                   T5DataType
                                   ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 2048),
                                               'Dim ('Name &quot;*&quot;) ('Size 512)])))
                                   (NamedModel ())))
                             Relu
                             Dropout
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         ('Gradient 'WithGradient)
                                         ('Layout 'Dense)
                                         ('Device 'CPU)
                                         T5DataType
                                         ('Shape
                                            '[ 'Dim ('Name &quot;*&quot;) ('Size 512),
                                               'Dim ('Name &quot;*&quot;) ('Size 2048)])))
                                   (NamedModel ())))
                             Dropout
                             ()))))))
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 T5DataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 512)])))
           Dropout))
     (NamedModel
        (Embedding
           ('Gradient 'WithGradient)
           ('Layout 'Dense)
           ('Device 'CPU)
           T5DataType
           ('Dim ('Name &quot;*&quot;) ('Size 32128))
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           'Nothing))
     (NamedModel
        (GLMHead
           ('Dim ('Name &quot;*&quot;) ('Size 512))
           ()
           ()
           ()
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       T5DataType
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 32128), 'Dim ('Name &quot;*&quot;) ('Size 512)])))
                 (NamedModel ())))
           (GBias ()))))
  (MkRelPos T5RelPosEncBucketDim)
  (MkRelPos T5RelPosEncBucketDim)
  MkTransformerPaddingMask
  (MkTransformerAttentionMask T5DataType)
  (MkTransformerCrossAttentionMask T5DataType)
  (MkTransformerDecoderAttentionMask T5DataType)
</span><a href="#local-6989586621679587187"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Int64)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7)]))
</span><a href="#local-6989586621679587177"><span class="hs-identifier hs-var">inputs</span></a></span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679587209"><span class="hs-identifier hs-var">g''</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="annottext">((EncoderDecoderTransformerOutput
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       T5DataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
             'Dim ('Name &quot;*&quot;) ('Size 32128)]))
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       T5DataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
             'Dim ('Name &quot;*&quot;) ('Size 512)])),
  SimplifiedEncoderDecoderTransformerOutput
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       T5DataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
             'Dim ('Name &quot;*&quot;) ('Size 32128)]))
    (Tensor
       ('Gradient 'WithGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       T5DataType
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
             'Dim ('Name &quot;*&quot;) ('Size 512)]))
    (Tensor
       ('Gradient 'WithoutGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       ('DataType 'Bool)
       ('Shape
          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))),
 Generator ('Device 'CPU))
-&gt; IO
     ((EncoderDecoderTransformerOutput
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            T5DataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
                  'Dim ('Name &quot;*&quot;) ('Size 32128)]))
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            T5DataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                  'Dim ('Name &quot;*&quot;) ('Size 512)])),
       SimplifiedEncoderDecoderTransformerOutput
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            T5DataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
                  'Dim ('Name &quot;*&quot;) ('Size 32128)]))
         (Tensor
            ('Gradient 'WithGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            T5DataType
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
                  'Dim ('Name &quot;*&quot;) ('Size 512)]))
         (Tensor
            ('Gradient 'WithoutGradient)
            ('Layout 'Dense)
            ('Device 'CPU)
            ('DataType 'Bool)
            ('Shape
               '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))),
      Generator ('Device 'CPU))
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 7),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
</span><a href="#local-6989586621679587210"><span class="hs-identifier hs-var">t5Output</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 8),
           'Dim ('Name &quot;*&quot;) ('Size 32128)]))
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     T5DataType
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13),
           'Dim ('Name &quot;*&quot;) ('Size 512)]))
  (Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Bool)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 13)]))
</span><a href="#local-6989586621679587197"><span class="hs-identifier hs-var">t5Output'</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679587196"><span class="hs-identifier hs-var">g'''</span></a></span><span class="hs-special">)</span></pre></body></html>