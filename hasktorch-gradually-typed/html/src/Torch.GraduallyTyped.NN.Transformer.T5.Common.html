<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.T5.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Catch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadThrow</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier">SDType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformerF"><span class="hs-identifier">GEncoderDecoderTransformerF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier">encoderDecoderTransformerSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier">MkRelPos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier">MkTransformerAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier">MkTransformerPaddingMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier">SByT5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier">ST5</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier">ShiftRight</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier">ByT5</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier">T5</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier">mkTransformerInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier">HasDropout</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier">SHasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier">Catch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.TypeLits.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier">SGetDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- | T5 dType.</span><span>
</span><span id="line-33"></span><span class="hs-keyword">type</span><span> </span><span id="T5DType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-var">T5DType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span>
</span><span id="line-34"></span><span>
</span><span id="line-35"></span><span class="hs-comment">-- | T5 dType singleton.</span><span>
</span><span id="line-36"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DType"><span class="hs-identifier hs-type">t5DType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier hs-type">SDType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-type">T5DType</span></a></span><span>
</span><span id="line-37"></span><span id="t5DType"><span class="annot"><span class="annottext">t5DType :: SDType T5DType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DType"><span class="hs-identifier hs-var hs-var">t5DType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI T5DType =&gt; Sing T5DType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-type">T5DType</span></a></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-comment">-- | T5 data type.</span><span>
</span><span id="line-40"></span><span class="hs-keyword">type</span><span> </span><span id="T5DataType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-var">T5DataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DType"><span class="hs-identifier hs-type">T5DType</span></a></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | T5 data type singleton.</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-type">t5DataType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span>
</span><span id="line-44"></span><span id="t5DataType"><span class="annot"><span class="annottext">t5DataType :: SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var hs-var">t5DataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI T5DataType =&gt; Sing T5DataType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | T5 dropout rate.</span><span>
</span><span id="line-47"></span><span class="hs-comment">-- 'dropout_rate = 0.1'</span><span>
</span><span id="line-48"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DropoutP"><span class="hs-identifier hs-type">t5DropoutP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-49"></span><span id="t5DropoutP"><span class="annot"><span class="annottext">t5DropoutP :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DropoutP"><span class="hs-identifier hs-var hs-var">t5DropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | T5 relative positional encoding bucket dimension.</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- 'relative_attention_num_buckets = 32'</span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span id="T5RelPosEncBucketDim"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-var">T5RelPosEncBucketDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">32</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | T5 relative positional encoding bucket dimension singleton.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-type">t5RelPosEncBucketDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span>
</span><span id="line-57"></span><span id="t5RelPosEncBucketDim"><span class="annot"><span class="annottext">t5RelPosEncBucketDim :: SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var hs-var">t5RelPosEncBucketDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI T5RelPosEncBucketDim =&gt; Sing T5RelPosEncBucketDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | T5 layer-norm epsilon.</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- 'layer_norm_epsilon = 1e-06'</span><span>
</span><span id="line-61"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5Eps"><span class="hs-identifier hs-type">t5Eps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-62"></span><span id="t5Eps"><span class="annot"><span class="annottext">t5Eps :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5Eps"><span class="hs-identifier hs-var hs-var">t5Eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-6</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | T5 maximum distance for relative positional encoding.</span><span>
</span><span id="line-65"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-type">t5MaxDistance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-66"></span><span id="t5MaxDistance"><span class="annot"><span class="annottext">t5MaxDistance :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var hs-var">t5MaxDistance</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">128</span></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="hs-comment">-- | T5 padding token id.</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- 'pad_token_id = 0'</span><span>
</span><span id="line-70"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-type">t5PadTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-71"></span><span id="t5PadTokenId"><span class="annot"><span class="annottext">t5PadTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var hs-var">t5PadTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">-- | T5 begin-of-sentence token id.</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-type">t5BOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-75"></span><span id="t5BOSTokenId"><span class="annot"><span class="annottext">t5BOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-var hs-var">t5BOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | T5 end-of-sentence token id.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- 'eos_token_id = 1'</span><span>
</span><span id="line-79"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5EOSTokenId"><span class="hs-identifier hs-type">t5EOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-80"></span><span id="t5EOSTokenId"><span class="annot"><span class="annottext">t5EOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5EOSTokenId"><span class="hs-identifier hs-var hs-var">t5EOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | T5 attention mask bias</span><span>
</span><span id="line-83"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-type">t5AttentionMaskBias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-84"></span><span id="t5AttentionMaskBias"><span class="annot"><span class="annottext">t5AttentionMaskBias :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var hs-var">t5AttentionMaskBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10000</span></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="hs-comment">-- | Specifies a T5 or ByT5 model.</span><span>
</span><span id="line-87"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-type">T5ModelF</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-88"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-98"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-102"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-103"></span><span>  </span><span id="T5ModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-var">T5ModelF</span></a></span></span><span> </span><span id="local-6989586621679706514"><span class="annot"><a href="#local-6989586621679706514"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679706513"><span class="annot"><a href="#local-6989586621679706513"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679706512"><span class="annot"><a href="#local-6989586621679706512"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706511"><span class="annot"><a href="#local-6989586621679706511"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706510"><span class="annot"><a href="#local-6989586621679706510"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679706509"><span class="annot"><a href="#local-6989586621679706509"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679706508"><span class="annot"><a href="#local-6989586621679706508"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679706507"><span class="annot"><a href="#local-6989586621679706507"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706506"><span class="annot"><a href="#local-6989586621679706506"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679706505"><span class="annot"><a href="#local-6989586621679706505"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706504"><span class="annot"><a href="#local-6989586621679706504"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679706503"><span class="annot"><a href="#local-6989586621679706503"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679706502"><span class="annot"><a href="#local-6989586621679706502"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-105"></span><span>  </span><span id="T5ModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-var">T5ModelF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679706501"><span class="annot"><a href="#local-6989586621679706501"><span class="hs-identifier hs-type hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679706500"><span class="annot"><a href="#local-6989586621679706500"><span class="hs-identifier hs-type hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706499"><span class="annot"><a href="#local-6989586621679706499"><span class="hs-identifier hs-type hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706498"><span class="annot"><a href="#local-6989586621679706498"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679706497"><span class="annot"><a href="#local-6989586621679706497"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679706496"><span class="annot"><a href="#local-6989586621679706496"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679706495"><span class="annot"><a href="#local-6989586621679706495"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706494"><span class="annot"><a href="#local-6989586621679706494"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679706493"><span class="annot"><a href="#local-6989586621679706493"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706492"><span class="annot"><a href="#local-6989586621679706492"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679706491"><span class="annot"><a href="#local-6989586621679706491"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679706490"><span class="annot"><a href="#local-6989586621679706490"><span class="hs-identifier hs-type hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformerF"><span class="hs-identifier hs-type">GEncoderDecoderTransformerF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706501"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706500"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706499"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706498"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706497"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706496"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706495"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706494"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706493"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706492"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706491"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706490"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-type">MkTransformerPaddingMask</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-type">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-type">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-type">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>  </span><span id="T5ModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-var">T5ModelF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679706489"><span class="annot"><a href="#local-6989586621679706489"><span class="hs-identifier hs-type hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679706488"><span class="annot"><a href="#local-6989586621679706488"><span class="hs-identifier hs-type hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706487"><span class="annot"><a href="#local-6989586621679706487"><span class="hs-identifier hs-type hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706486"><span class="annot"><a href="#local-6989586621679706486"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679706485"><span class="annot"><a href="#local-6989586621679706485"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679706484"><span class="annot"><a href="#local-6989586621679706484"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679706483"><span class="annot"><a href="#local-6989586621679706483"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706482"><span class="annot"><a href="#local-6989586621679706482"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679706481"><span class="annot"><a href="#local-6989586621679706481"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706480"><span class="annot"><a href="#local-6989586621679706480"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679706479"><span class="annot"><a href="#local-6989586621679706479"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679706478"><span class="annot"><a href="#local-6989586621679706478"><span class="hs-identifier hs-type hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-115"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformerF"><span class="hs-identifier hs-type">GEncoderDecoderTransformerF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706489"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706488"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706487"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706486"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706485"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706484"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706483"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706482"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706481"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706480"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706479"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706478"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-type">MkRelPos</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5RelPosEncBucketDim"><span class="hs-identifier hs-type">T5RelPosEncBucketDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-type">MkTransformerPaddingMask</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-type">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-type">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-type">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5DataType"><span class="hs-identifier hs-type">T5DataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>
</span><span id="line-124"></span><span class="hs-comment">-- | Specifies the parameters of a T5 or ByT5 model.</span><span>
</span><span id="line-125"></span><span class="hs-comment">--</span><span>
</span><span id="line-126"></span><span class="hs-comment">-- - @transformerHead@: the head of the T5 or ByT5 model.</span><span>
</span><span id="line-127"></span><span class="hs-comment">-- - @numLayers@: the number of layers in the T5 or ByT5 model.</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the T5 or ByT5 model.</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- - @device@: the computational device on which the T5 or ByT5 model parameters are to be allocated.</span><span>
</span><span id="line-130"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5ModelSpec"><span class="hs-identifier hs-type">t5ModelSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679706476"><span class="annot"><a href="#local-6989586621679706476"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679706475"><span class="annot"><a href="#local-6989586621679706475"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679706474"><span class="annot"><a href="#local-6989586621679706474"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706473"><span class="annot"><a href="#local-6989586621679706473"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706472"><span class="annot"><a href="#local-6989586621679706472"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679706471"><span class="annot"><a href="#local-6989586621679706471"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679706470"><span class="annot"><a href="#local-6989586621679706470"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679706469"><span class="annot"><a href="#local-6989586621679706469"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706468"><span class="annot"><a href="#local-6989586621679706468"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679706467"><span class="annot"><a href="#local-6989586621679706467"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679706466"><span class="annot"><a href="#local-6989586621679706466"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679706465"><span class="annot"><a href="#local-6989586621679706465"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679706464"><span class="annot"><a href="#local-6989586621679706464"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706470"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-133"></span><span>    </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706469"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-134"></span><span>    </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706468"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706467"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706466"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706465"><span class="hs-identifier hs-type">vocabDim</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706476"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706475"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706474"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706473"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706472"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706471"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier hs-type">SHasDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706464"><span class="hs-identifier hs-type">hasDropout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#T5ModelF"><span class="hs-identifier hs-type">T5ModelF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706476"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706475"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706474"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706473"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706472"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706471"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706470"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706469"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706468"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706467"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706466"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706465"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706464"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span id="t5ModelSpec"><span class="annot"><span class="annottext">t5ModelSpec :: STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SHasDropout hasDropout
-&gt; ModelSpec
     (T5ModelF
        style
        transformerHead
        numEncoderLayers
        numDecoderLayers
        gradient
        device
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        vocabDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5ModelSpec"><span class="hs-identifier hs-var hs-var">t5ModelSpec</span></a></span></span><span> </span><span id="local-6989586621679706463"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679706463"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679706462"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679706462"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679706461"><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679706461"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706460"><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679706460"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679706459"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679706459"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679706458"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679706458"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679706457"><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679706457"><span class="hs-identifier hs-var">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679706463"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>      </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        (ModelSpec (TEInitialDropoutF 'T5 hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                (DropoutF 'T5 hasDropout)))
                          (SADropoutF 'T5 hasDropout)
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          (FFNActivationDropoutF 'T5 hasDropout)
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          (FFNOutputDropoutF 'T5 hasDropout)
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        (ModelSpec (TEFinalDropoutF 'T5 hasDropout))))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        (ModelSpec (TDInitialDropoutF 'T5 hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                (DropoutF 'T5 hasDropout)))
                          (SADropoutF 'T5 hasDropout)
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                (DropoutF 'T5 hasDropout)))
                          (CADropoutF 'T5 hasDropout)
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          (FFNActivationDropoutF 'T5 hasDropout)
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          (FFNOutputDropoutF 'T5 hasDropout)
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        (ModelSpec (TDFinalDropoutF 'T5 hasDropout))))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        T5DataType
        vocabDim
        inputEmbedDim
        'Nothing))
  (ModelSpec
     (EDTHeadF
        'T5
        transformerHead
        gradient
        device
        T5DataType
        inputEmbedDim
        vocabDim))
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkTransformerPaddingMask
-&gt; MkTransformerAttentionMask T5DataType
-&gt; MkTransformerCrossAttentionMask T5DataType
-&gt; MkTransformerDecoderAttentionMask T5DataType
-&gt; GSimplifiedEncoderDecoderTransformer
     (GEncoderDecoderTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              (ModelSpec (TEInitialDropoutF 'T5 hasDropout))
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numEncoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      (DropoutF 'T5 hasDropout)))
                                (SADropoutF 'T5 hasDropout)
                                ()))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel ())))
                                Relu
                                (FFNActivationDropoutF 'T5 hasDropout)
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                (FFNOutputDropoutF 'T5 hasDropout)
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              (ModelSpec (TEFinalDropoutF 'T5 hasDropout))))
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              (ModelSpec (TDInitialDropoutF 'T5 hasDropout))
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numDecoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      (DropoutF 'T5 hasDropout)))
                                (SADropoutF 'T5 hasDropout)
                                ()))
                          (NamedModel
                             (GCrossAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      (DropoutF 'T5 hasDropout)))
                                (CADropoutF 'T5 hasDropout)
                                ()))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel ())))
                                Relu
                                (FFNActivationDropoutF 'T5 hasDropout)
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                (FFNOutputDropoutF 'T5 hasDropout)
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              (ModelSpec (TDFinalDropoutF 'T5 hasDropout))))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EDTHeadF
              'T5
              transformerHead
              gradient
              device
              T5DataType
              inputEmbedDim
              vocabDim)))
     (MkRelPos T5RelPosEncBucketDim)
     (MkRelPos T5RelPosEncBucketDim)
     MkTransformerPaddingMask
     (MkTransformerAttentionMask T5DataType)
     (MkTransformerCrossAttentionMask T5DataType)
     (MkTransformerDecoderAttentionMask T5DataType)
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-151"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 'T5 gradient device T5DataType inputEmbedDim T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 'T5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF 'T5 hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF 'T5 gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF 'T5 hasDropout)))
                             (SADropoutF 'T5 hasDropout)
                             (SAFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'T5)
                             (FFNActivationDropoutF 'T5 hasDropout)
                             (FFNOutputProjectionF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF 'T5 hasDropout)
                             (FFNOutputLayerNormF
                                'T5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF 'T5 hasDropout))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 'T5 gradient device T5DataType inputEmbedDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 'T5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF 'T5 hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF 'T5 gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF 'T5 hasDropout)))
                             (SADropoutF 'T5 hasDropout)
                             (SAFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF 'T5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF 'T5 gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF 'T5 hasDropout)))
                             (CADropoutF 'T5 hasDropout)
                             (CAFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'T5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'T5)
                             (FFNActivationDropoutF 'T5 hasDropout)
                             (FFNOutputProjectionF
                                'T5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF 'T5 hasDropout)
                             (FFNOutputLayerNormF
                                'T5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF 'T5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF 'T5 hasDropout))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           'T5
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF style hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (SADropoutF style hasDropout)
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style hasDropout)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF style hasDropout)
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF style hasDropout))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF style hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (SADropoutF style hasDropout)
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (CADropoutF style hasDropout)
                             (CAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style hasDropout)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF style hasDropout)
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF style hasDropout))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
</span><a href="#local-6989586621679706455"><span class="hs-identifier hs-var">modelSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-var">t5BOSTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-var">MkRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkDecoderRelPos"><span class="hs-identifier hs-var">MkDecoderRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        (ModelSpec (TEInitialDropoutF 'ByT5 hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                (DropoutF 'ByT5 hasDropout)))
                          (SADropoutF 'ByT5 hasDropout)
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          (FFNActivationDropoutF 'T5 hasDropout)
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          (FFNOutputDropoutF 'ByT5 hasDropout)
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        (ModelSpec (TEFinalDropoutF 'ByT5 hasDropout))))
  (NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              T5RelPosEncBucketDim
              headDim
              'Nothing))
        ()
        (ModelSpec (TDInitialDropoutF 'ByT5 hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                (DropoutF 'ByT5 hasDropout)))
                          (SADropoutF 'ByT5 hasDropout)
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                (DropoutF 'ByT5 hasDropout)))
                          (CADropoutF 'ByT5 hasDropout)
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         T5DataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          (FFNActivationDropoutF 'T5 hasDropout)
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          (FFNOutputDropoutF 'ByT5 hasDropout)
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
        (ModelSpec (TDFinalDropoutF 'ByT5 hasDropout))))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        T5DataType
        vocabDim
        inputEmbedDim
        'Nothing))
  (ModelSpec
     (EDTHeadF
        'ByT5
        transformerHead
        gradient
        device
        T5DataType
        inputEmbedDim
        vocabDim))
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkRelPos T5RelPosEncBucketDim
-&gt; MkTransformerPaddingMask
-&gt; MkTransformerAttentionMask T5DataType
-&gt; MkTransformerCrossAttentionMask T5DataType
-&gt; MkTransformerDecoderAttentionMask T5DataType
-&gt; GSimplifiedEncoderDecoderTransformer
     (GEncoderDecoderTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              (ModelSpec (TEInitialDropoutF 'ByT5 hasDropout))
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numEncoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      (DropoutF 'ByT5 hasDropout)))
                                (SADropoutF 'ByT5 hasDropout)
                                ()))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (GGate
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ())))
                                   GeluNew
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ()))))
                                GeluNew
                                (FFNActivationDropoutF 'T5 hasDropout)
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                (FFNOutputDropoutF 'ByT5 hasDropout)
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              (ModelSpec (TEFinalDropoutF 'ByT5 hasDropout))))
        (NamedModel
           (GTransformer
              ()
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    T5DataType
                    T5RelPosEncBucketDim
                    headDim
                    'Nothing))
              ()
              (ModelSpec (TDInitialDropoutF 'ByT5 hasDropout))
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numDecoderLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      (DropoutF 'ByT5 hasDropout)))
                                (SADropoutF 'ByT5 hasDropout)
                                ()))
                          (NamedModel
                             (GCrossAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel ())))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  T5DataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel ())))
                                      (DropoutF 'ByT5 hasDropout)))
                                (CADropoutF 'ByT5 hasDropout)
                                ()))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithoutBias
                                      gradient
                                      device
                                      T5DataType
                                      ('Shape '[inputEmbedDim])))
                                (GGate
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ())))
                                   GeluNew
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               T5DataType
                                               ('Shape '[ffnDim, inputEmbedDim])))
                                         (NamedModel ()))))
                                GeluNew
                                (FFNActivationDropoutF 'T5 hasDropout)
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            T5DataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel ())))
                                (FFNOutputDropoutF 'ByT5 hasDropout)
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithoutBias gradient device T5DataType ('Shape '[inputEmbedDim])))
              (ModelSpec (TDFinalDropoutF 'ByT5 hasDropout))))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              T5DataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EDTHeadF
              'ByT5
              transformerHead
              gradient
              device
              T5DataType
              inputEmbedDim
              vocabDim)))
     (MkRelPos T5RelPosEncBucketDim)
     (MkRelPos T5RelPosEncBucketDim)
     MkTransformerPaddingMask
     (MkTransformerAttentionMask T5DataType)
     (MkTransformerCrossAttentionMask T5DataType)
     (MkTransformerDecoderAttentionMask T5DataType)
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-162"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 'ByT5
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 'ByT5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF 'ByT5 hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      'ByT5 gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF 'ByT5 hasDropout)))
                             (SADropoutF 'ByT5 hasDropout)
                             (SAFinalLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'ByT5)
                             (FFNActivationDropoutF 'ByT5 hasDropout)
                             (FFNOutputProjectionF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF 'ByT5 hasDropout)
                             (FFNOutputLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF 'ByT5 hasDropout))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 'ByT5
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 'ByT5 gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF 'ByT5 hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      'ByT5 gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF 'ByT5 hasDropout)))
                             (SADropoutF 'ByT5 hasDropout)
                             (SAFinalLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      'ByT5 gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      'ByT5 gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF 'ByT5 hasDropout)))
                             (CADropoutF 'ByT5 hasDropout)
                             (CAFinalLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF 'ByT5)
                             (FFNActivationDropoutF 'ByT5 hasDropout)
                             (FFNOutputProjectionF
                                'ByT5 gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF 'ByT5 hasDropout)
                             (FFNOutputLayerNormF
                                'ByT5 gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF 'ByT5 gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF 'ByT5 hasDropout))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           'ByT5
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF style hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (SADropoutF style hasDropout)
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style hasDropout)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF style hasDropout)
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF style hasDropout))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF style hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (SADropoutF style hasDropout)
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (CADropoutF style hasDropout)
                             (CAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style hasDropout)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF style hasDropout)
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF style hasDropout))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
</span><a href="#local-6989586621679706455"><span class="hs-identifier hs-var">modelSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5BOSTokenId"><span class="hs-identifier hs-var">t5BOSTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkRelPos"><span class="hs-identifier hs-var">MkRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim -&gt; Int -&gt; MkRelPos T5RelPosEncBucketDim
forall (relPosEncBucketDim :: Dim (Name Symbol) (Size Nat)).
SDim relPosEncBucketDim -&gt; Int -&gt; MkRelPos relPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkDecoderRelPos"><span class="hs-identifier hs-var">MkDecoderRelPos</span></a></span><span> </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5MaxDistance"><span class="hs-identifier hs-var">t5MaxDistance</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType T5DataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask T5DataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5AttentionMaskBias"><span class="hs-identifier hs-var">t5AttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><span class="annottext">STransformerStyle style
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (T5ModelF
     style
     transformerHead
     numEncoderLayers
     numDecoderLayers
     gradient
     device
     headDim
     headEmbedDim
     embedDim
     inputEmbedDim
     ffnDim
     vocabDim
     hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="#local-6989586621679706455"><span class="hs-identifier hs-type">modelSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-174"></span><span>    </span><span id="local-6989586621679706455"><span class="annot"><span class="annottext">modelSpec' :: STransformerStyle style
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TERelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TEInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF style hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (SADropoutF style hasDropout)
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style hasDropout)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF style hasDropout)
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF style hasDropout))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF
                 style
                 gradient
                 device
                 T5DataType
                 inputEmbedDim
                 T5RelPosEncBucketDim))
           (ModelSpec
              (TDRelPosEncF
                 style gradient device T5DataType headDim T5RelPosEncBucketDim))
           (ModelSpec
              (TDInitialLayerNormF
                 style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF style hasDropout))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (SADropoutF style hasDropout)
                             (SAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF
                                style gradient device T5DataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (KInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (VInProjF
                                      style gradient device T5DataType inputEmbedDim embedDim)
                                   (OutProjF
                                      style gradient device T5DataType embedDim inputEmbedDim)
                                   (DropoutF style hasDropout)))
                             (CADropoutF style hasDropout)
                             (CAFinalLayerNormF
                                style gradient device T5DataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device T5DataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style hasDropout)
                             (FFNOutputProjectionF
                                style gradient device T5DataType inputEmbedDim ffnDim)
                             (FFNOutputDropoutF style hasDropout)
                             (FFNOutputLayerNormF
                                style gradient device T5DataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF style gradient device T5DataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF style hasDropout))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           T5DataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           T5DataType
           inputEmbedDim
           vocabDim))
</span><a href="#local-6989586621679706455"><span class="hs-identifier hs-var hs-var">modelSpec'</span></a></span></span><span> </span><span id="local-6989586621679706446"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679706446"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-175"></span><span>      </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType T5DataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim T5RelPosEncBucketDim
-&gt; SDim vocabDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformerF
        style
        transformerHead
        numEncoderLayers
        numDecoderLayers
        gradient
        device
        T5DataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        T5RelPosEncBucketDim
        vocabDim
        hasDropout)
forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numEncoderLayers :: Nat)
       (numDecoderLayers :: Nat) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformerF
        style
        transformerHead
        numEncoderLayers
        numDecoderLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        posEncDim
        vocabDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var">encoderDecoderTransformerSpec</span></a></span><span>
</span><span id="line-176"></span><span>        </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679706446"><span class="hs-identifier hs-var">style'</span></a></span><span>
</span><span id="line-177"></span><span>        </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679706462"><span class="hs-identifier hs-var">transformerHead</span></a></span><span>
</span><span id="line-178"></span><span>        </span><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679706461"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679706460"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span><span>
</span><span id="line-180"></span><span>        </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679706459"><span class="hs-identifier hs-var">gradient</span></a></span><span>
</span><span id="line-181"></span><span>        </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679706458"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="annottext">SDataType T5DataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DataType"><span class="hs-identifier hs-var">t5DataType</span></a></span><span>
</span><span id="line-183"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headDim =&gt; Sing headDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679706470"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headEmbedDim =&gt; Sing headEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679706469"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI embedDim =&gt; Sing embedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679706468"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI inputEmbedDim =&gt; Sing inputEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679706467"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI ffnDim =&gt; Sing ffnDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679706466"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><span class="annottext">SDim T5RelPosEncBucketDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5RelPosEncBucketDim"><span class="hs-identifier hs-var">t5RelPosEncBucketDim</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI vocabDim =&gt; Sing vocabDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/44d7539k7gqlplsaxjj66fck1zc772zc-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679706465"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679706457"><span class="hs-identifier hs-var">hasDropout</span></a></span><span>
</span><span id="line-191"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5DropoutP"><span class="hs-identifier hs-var">t5DropoutP</span></a></span><span>
</span><span id="line-192"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5Eps"><span class="hs-identifier hs-var">t5Eps</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#mkT5Input"><span class="hs-identifier hs-type">mkT5Input</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679706444"><span class="annot"><a href="#local-6989586621679706444"><span class="hs-identifier hs-type">batchDim</span></a></span></span><span> </span><span id="local-6989586621679706443"><span class="annot"><a href="#local-6989586621679706443"><span class="hs-identifier hs-type">seqDim</span></a></span></span><span> </span><span id="local-6989586621679706442"><span class="annot"><a href="#local-6989586621679706442"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679706441"><span class="annot"><a href="#local-6989586621679706441"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679706440"><span class="annot"><a href="#local-6989586621679706440"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679706441"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706444"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706443"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span>
</span><span id="line-200"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-201"></span><span>          </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>             </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span>
</span><span id="line-203"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-204"></span><span>          </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679706444"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679706443"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-206"></span><span>    </span><span class="annot"><a href="#local-6989586621679706440"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-208"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithoutGradient"><span class="hs-identifier hs-type">WithoutGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>          </span><span class="annot"><a href="#local-6989586621679706442"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-211"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679706444"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679706443"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706444"><span class="hs-identifier hs-type">batchDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-215"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706443"><span class="hs-identifier hs-type">seqDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706442"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-218"></span><span>  </span><span class="annot"><a href="#local-6989586621679706441"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679706440"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-219"></span><span id="mkT5Input"><span class="annot"><span class="annottext">mkT5Input :: SDim batchDim
-&gt; SDim seqDim -&gt; SDevice device -&gt; [[Int]] -&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#mkT5Input"><span class="hs-identifier hs-var hs-var">mkT5Input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
forall (batchDim :: Dim (Name Symbol) (Size Nat))
       (seqDim :: Dim (Name Symbol) (Size Nat))
       (device :: Device (DeviceType Nat)) (m :: * -&gt; *) output.
(MonadThrow m, SGetDim batchDim, SGetDim seqDim,
 Catch
   ('Shape
      '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize,
         'Dim ('Name &quot;*&quot;) 'UncheckedSize]
    &lt;+&gt; 'Shape '[batchDim, seqDim]),
 output
 ~ Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     device
     ('DataType 'Int64)
     ('Shape '[batchDim, seqDim])) =&gt;
Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier hs-var">mkTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.T5.Common.html#t5PadTokenId"><span class="hs-identifier hs-var">t5PadTokenId</span></a></span><span>
</span><span id="line-220"></span></pre></body></html>