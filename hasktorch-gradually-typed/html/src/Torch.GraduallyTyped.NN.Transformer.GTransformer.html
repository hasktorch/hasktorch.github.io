<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GTransformer</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed.Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">IxMonadTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ilift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">IxPointed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier">Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Normalization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier">LayerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier">LayerNormSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Sparse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier">Embedding</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier">EmbeddingSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#DecoderStackF"><span class="hs-identifier">DecoderStackF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#EncoderStackF"><span class="hs-identifier">EncoderStackF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#decoderStackSpec"><span class="hs-identifier">decoderStackSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#encoderStackSpec"><span class="hs-identifier">encoderStackSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasBias"><span class="hs-identifier">HasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier">HasDropout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasBias"><span class="hs-identifier">SHasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier">SHasDropout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier">Catch</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.List.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNil</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.Maybe.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.TypeLits.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier">BroadcastShapesF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#By"><span class="hs-identifier">By</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SBy"><span class="hs-identifier">SBy</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier">SSelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.IndexingSlicingJoining</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier">TransposeF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier">UnsqueezeF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sTranspose"><span class="hs-identifier">sTranspose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sUnsqueeze"><span class="hs-identifier">sUnsqueeze</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier">transpose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier">unsqueeze</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Generic transformer.</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- Can specialize to either encoder or decoder.</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- - @posEnc@: an absolute positional encoding layer as used by, e.g., BERT.</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- - @relPosEnc@: a relative positional encoding layer as used by, e.g., T5.</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- - @initialLayerNorm@: a layer normalization layer for the embeddings.</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- - @initialDropout@: a dropout layer for the embeddings.</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- - @stack@: a stack of transformer blocks.</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- - @finalLayerNorm@: the final layer normalization layer.</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- - @finalDropout@: the final dropout layer.</span><span>
</span><span id="line-59"></span><span id="local-6989586621679719911"><span id="local-6989586621679719912"></span></span><span class="hs-keyword">data</span><span>
</span><span id="line-60"></span><span>  </span><span id="GTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720850"><span class="annot"><a href="#local-6989586621679720850"><span class="hs-identifier hs-type">posEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720849"><span class="annot"><a href="#local-6989586621679720849"><span class="hs-identifier hs-type">relPosEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720848"><span class="annot"><a href="#local-6989586621679720848"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720847"><span class="annot"><a href="#local-6989586621679720847"><span class="hs-identifier hs-type">initialDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720846"><span class="annot"><a href="#local-6989586621679720846"><span class="hs-identifier hs-type">stack</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720845"><span class="annot"><a href="#local-6989586621679720845"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679720844"><span class="annot"><a href="#local-6989586621679720844"><span class="hs-identifier hs-type">finalDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-69"></span><span>  </span><span id="GTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720907"><span class="annot"><a href="#local-6989586621679720907"><span class="hs-identifier hs-type">posEnc</span></a></span></span><span> </span><span id="local-6989586621679720906"><span class="annot"><a href="#local-6989586621679720906"><span class="hs-identifier hs-type">relPosEnc</span></a></span></span><span> </span><span id="local-6989586621679720905"><span class="annot"><a href="#local-6989586621679720905"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679720904"><span class="annot"><a href="#local-6989586621679720904"><span class="hs-identifier hs-type">initialDropout</span></a></span></span><span> </span><span id="local-6989586621679720903"><span class="annot"><a href="#local-6989586621679720903"><span class="hs-identifier hs-type">stack</span></a></span></span><span> </span><span id="local-6989586621679720902"><span class="annot"><a href="#local-6989586621679720902"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679720901"><span class="annot"><a href="#local-6989586621679720901"><span class="hs-identifier hs-type">finalDropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-71"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | absolute positional encoding</span><span>
</span><span id="line-72"></span><span>      </span><span id="tPosEnc"><span class="annot"><span class="annottext">forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tPosEnc"><span class="hs-identifier hs-var hs-var">tPosEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720907"><span class="hs-identifier hs-type">posEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>      </span><span class="hs-comment">-- | relative positional encoding</span><span>
</span><span id="line-74"></span><span>      </span><span id="tRelPosEnc"><span class="annot"><span class="annottext">forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tRelPosEnc"><span class="hs-identifier hs-var hs-var">tRelPosEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720906"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>      </span><span class="hs-comment">-- | initial layer norm</span><span>
</span><span id="line-76"></span><span>      </span><span id="tInitialLayerNorm"><span class="annot"><span class="annottext">forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tInitialLayerNorm"><span class="hs-identifier hs-var hs-var">tInitialLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720905"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>      </span><span class="hs-comment">-- | initial dropout</span><span>
</span><span id="line-78"></span><span>      </span><span id="tInitialDropout"><span class="annot"><span class="annottext">forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tInitialDropout"><span class="hs-identifier hs-var hs-var">tInitialDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720904"><span class="hs-identifier hs-type">initialDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>      </span><span class="hs-comment">-- | transformer block stack</span><span>
</span><span id="line-80"></span><span>      </span><span id="tStack"><span class="annot"><span class="annottext">forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tStack"><span class="hs-identifier hs-var hs-var">tStack</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720903"><span class="hs-identifier hs-type">stack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>      </span><span class="hs-comment">-- | final layer norm</span><span>
</span><span id="line-82"></span><span>      </span><span id="tFinalLayerNorm"><span class="annot"><span class="annottext">forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tFinalLayerNorm"><span class="hs-identifier hs-var hs-var">tFinalLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720902"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>      </span><span class="hs-comment">-- | final dropout</span><span>
</span><span id="line-84"></span><span>      </span><span id="tFinalDropout"><span class="annot"><span class="annottext">forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tFinalDropout"><span class="hs-identifier hs-var hs-var">tFinalDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679720901"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720907"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720906"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720905"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720904"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720903"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720902"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720901"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679719892"><span id="local-6989586621679719901"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
(GTransformer
   posEnc
   relPosEnc
   initialLayerNorm
   initialDropout
   stack
   finalLayerNorm
   finalDropout
 -&gt; GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
 -&gt; Bool)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; Bool)
-&gt; Eq
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Eq posEnc, Eq relPosEnc, Eq initialLayerNorm, Eq initialDropout,
 Eq stack, Eq finalLayerNorm, Eq finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
/= :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
$c/= :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Eq posEnc, Eq relPosEnc, Eq initialLayerNorm, Eq initialDropout,
 Eq stack, Eq finalLayerNorm, Eq finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
== :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
$c== :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Eq posEnc, Eq relPosEnc, Eq initialLayerNorm, Eq initialDropout,
 Eq stack, Eq finalLayerNorm, Eq finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719858"><span id="local-6989586621679719860"><span id="local-6989586621679719863"><span id="local-6989586621679719866"><span id="local-6989586621679719869"><span id="local-6989586621679719878"><span id="local-6989586621679719887"><span class="annot"><span class="annottext">Eq
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
Eq
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; Ordering)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; Bool)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; Bool)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; Bool)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; Bool)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout)
-&gt; Ord
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Ordering
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {posEnc} {relPosEnc} {initialLayerNorm} {initialDropout}
       {stack} {finalLayerNorm} {finalDropout}.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
Eq
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Ordering
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
min :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
$cmin :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
max :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
$cmax :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
&gt;= :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
$c&gt;= :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
&gt; :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
$c&gt; :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
&lt;= :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
$c&lt;= :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
&lt; :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
$c&lt; :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Bool
compare :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Ordering
$ccompare :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Ord posEnc, Ord relPosEnc, Ord initialLayerNorm,
 Ord initialDropout, Ord stack, Ord finalLayerNorm,
 Ord finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; Ordering
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719842"><span id="local-6989586621679719844"><span id="local-6989586621679719855"><span class="annot"><span class="annottext">Int
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; ShowS
[GTransformer
   posEnc
   relPosEnc
   initialLayerNorm
   initialDropout
   stack
   finalLayerNorm
   finalDropout]
-&gt; ShowS
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; String
(Int
 -&gt; GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
 -&gt; ShowS)
-&gt; (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout
    -&gt; String)
-&gt; ([GTransformer
       posEnc
       relPosEnc
       initialLayerNorm
       initialDropout
       stack
       finalLayerNorm
       finalDropout]
    -&gt; ShowS)
-&gt; Show
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Show posEnc, Show relPosEnc, Show initialLayerNorm,
 Show initialDropout, Show stack, Show finalLayerNorm,
 Show finalDropout) =&gt;
Int
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; ShowS
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Show posEnc, Show relPosEnc, Show initialLayerNorm,
 Show initialDropout, Show stack, Show finalLayerNorm,
 Show finalDropout) =&gt;
[GTransformer
   posEnc
   relPosEnc
   initialLayerNorm
   initialDropout
   stack
   finalLayerNorm
   finalDropout]
-&gt; ShowS
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Show posEnc, Show relPosEnc, Show initialLayerNorm,
 Show initialDropout, Show stack, Show finalLayerNorm,
 Show finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; String
showList :: [GTransformer
   posEnc
   relPosEnc
   initialLayerNorm
   initialDropout
   stack
   finalLayerNorm
   finalDropout]
-&gt; ShowS
$cshowList :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Show posEnc, Show relPosEnc, Show initialLayerNorm,
 Show initialDropout, Show stack, Show finalLayerNorm,
 Show finalDropout) =&gt;
[GTransformer
   posEnc
   relPosEnc
   initialLayerNorm
   initialDropout
   stack
   finalLayerNorm
   finalDropout]
-&gt; ShowS
show :: GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; String
$cshow :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Show posEnc, Show relPosEnc, Show initialLayerNorm,
 Show initialDropout, Show stack, Show finalLayerNorm,
 Show finalDropout) =&gt;
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; String
showsPrec :: Int
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; ShowS
$cshowsPrec :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
(Show posEnc, Show relPosEnc, Show initialLayerNorm,
 Show initialDropout, Show stack, Show finalLayerNorm,
 Show finalDropout) =&gt;
Int
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x.
 GTransformer
   posEnc
   relPosEnc
   initialLayerNorm
   initialDropout
   stack
   finalLayerNorm
   finalDropout
 -&gt; Rep
      (GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout)
      x)
-&gt; (forall x.
    Rep
      (GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout)
      x
    -&gt; GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout)
-&gt; Generic
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
forall x.
Rep
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
  x
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
forall x.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; Rep
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
     x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout x.
Rep
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
  x
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout x.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; Rep
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
     x
$cto :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout x.
Rep
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
  x
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
$cfrom :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout x.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; Rep
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
     x
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-90"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span id="local-6989586621679719831"><span id="local-6989586621679719832"><span id="local-6989586621679719833"><span id="local-6989586621679719834"><span id="local-6989586621679719835"><span id="local-6989586621679719836"><span id="local-6989586621679719837"><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719837"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719836"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719835"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719834"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719833"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719832"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719831"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719837"><span class="hs-identifier hs-type">posEnc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719836"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719835"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719834"><span class="hs-identifier hs-type">initialDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719833"><span class="hs-identifier hs-type">stack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719832"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719831"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-94"></span><span>  </span><span id="TransformerEncoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerEncoderF"><span class="hs-identifier hs-var">TransformerEncoderF</span></a></span></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719830"><span class="annot"><a href="#local-6989586621679719830"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719829"><span class="annot"><a href="#local-6989586621679719829"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719828"><span class="annot"><a href="#local-6989586621679719828"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719827"><span class="annot"><a href="#local-6989586621679719827"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719826"><span class="annot"><a href="#local-6989586621679719826"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719825"><span class="annot"><a href="#local-6989586621679719825"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719824"><span class="annot"><a href="#local-6989586621679719824"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719823"><span class="annot"><a href="#local-6989586621679719823"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719822"><span class="annot"><a href="#local-6989586621679719822"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719821"><span class="annot"><a href="#local-6989586621679719821"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719820"><span class="annot"><a href="#local-6989586621679719820"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719819"><span class="annot"><a href="#local-6989586621679719819"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-109"></span><span>  </span><span id="TransformerEncoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerEncoderF"><span class="hs-identifier hs-var">TransformerEncoderF</span></a></span></span><span> </span><span id="local-6989586621679719807"><span id="local-6989586621679719808"><span id="local-6989586621679719809"><span id="local-6989586621679719810"><span id="local-6989586621679719811"><span id="local-6989586621679719812"><span id="local-6989586621679719813"><span id="local-6989586621679719814"><span id="local-6989586621679719815"><span id="local-6989586621679719816"><span id="local-6989586621679719817"><span id="local-6989586621679719818"><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719817"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719816"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719815"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719814"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719813"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719812"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719811"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719810"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719809"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719808"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719807"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span>
</span><span id="line-111"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719816"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719815"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719814"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719810"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719808"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719816"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719815"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719814"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719813"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719808"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719816"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719815"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719814"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719810"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-type">TEInitialDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719807"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier hs-type">TEStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719817"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719816"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719815"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719814"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719813"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719812"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719811"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719810"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719809"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719807"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719816"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719815"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719814"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719810"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-type">TEFinalDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719818"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719807"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Specifies the absolute positional encoding layer of a transformer encoder.</span><span>
</span><span id="line-120"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-121"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719805"><span class="annot"><a href="#local-6989586621679719805"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719804"><span class="annot"><a href="#local-6989586621679719804"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719803"><span class="annot"><a href="#local-6989586621679719803"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719802"><span class="annot"><a href="#local-6989586621679719802"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719801"><span class="annot"><a href="#local-6989586621679719801"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719800"><span class="annot"><a href="#local-6989586621679719800"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-130"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719795"><span id="local-6989586621679719796"><span id="local-6989586621679719797"><span id="local-6989586621679719798"><span id="local-6989586621679719799"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719799"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719798"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719797"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719796"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719795"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719799"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719798"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719797"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719796"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719795"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719790"><span id="local-6989586621679719791"><span id="local-6989586621679719792"><span id="local-6989586621679719793"><span id="local-6989586621679719794"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719794"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719793"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719792"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719791"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719790"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719794"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679719793"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719792"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719790"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719791"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719785"><span id="local-6989586621679719786"><span id="local-6989586621679719787"><span id="local-6989586621679719788"><span id="local-6989586621679719789"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719789"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719788"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719787"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719786"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719785"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719789"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719788"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719787"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719786"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719785"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719780"><span id="local-6989586621679719781"><span id="local-6989586621679719782"><span id="local-6989586621679719783"><span id="local-6989586621679719784"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719784"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719783"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719782"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719781"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719780"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719784"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719783"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719782"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719781"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719780"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719775"><span id="local-6989586621679719776"><span id="local-6989586621679719777"><span id="local-6989586621679719778"><span id="local-6989586621679719779"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719779"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719778"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719777"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719776"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719775"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719779"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679719778"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719777"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719775"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719776"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719770"><span id="local-6989586621679719771"><span id="local-6989586621679719772"><span id="local-6989586621679719773"><span id="local-6989586621679719774"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719774"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719773"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719772"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719771"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719770"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719774"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719773"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719772"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719771"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719770"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Specifies the relative positional encoding layer of a transformer encoder.</span><span>
</span><span id="line-139"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-140"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719769"><span class="annot"><a href="#local-6989586621679719769"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719768"><span class="annot"><a href="#local-6989586621679719768"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719767"><span class="annot"><a href="#local-6989586621679719767"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719766"><span class="annot"><a href="#local-6989586621679719766"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719765"><span class="annot"><a href="#local-6989586621679719765"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719764"><span class="annot"><a href="#local-6989586621679719764"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-149"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719759"><span id="local-6989586621679719760"><span id="local-6989586621679719761"><span id="local-6989586621679719762"><span id="local-6989586621679719763"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719763"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719762"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719761"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719760"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719759"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719763"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679719762"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719761"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719759"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719760"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719754"><span id="local-6989586621679719755"><span id="local-6989586621679719756"><span id="local-6989586621679719757"><span id="local-6989586621679719758"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719758"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719757"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719756"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719755"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719754"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719758"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719757"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719756"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719755"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719754"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-151"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719749"><span id="local-6989586621679719750"><span id="local-6989586621679719751"><span id="local-6989586621679719752"><span id="local-6989586621679719753"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719753"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719752"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719751"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719750"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719749"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719753"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719752"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719751"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719750"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719749"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719744"><span id="local-6989586621679719745"><span id="local-6989586621679719746"><span id="local-6989586621679719747"><span id="local-6989586621679719748"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719748"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719747"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719746"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719745"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719744"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719748"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719747"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719746"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719745"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719744"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719739"><span id="local-6989586621679719740"><span id="local-6989586621679719741"><span id="local-6989586621679719742"><span id="local-6989586621679719743"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719743"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719742"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719741"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719740"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719739"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719743"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719742"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719741"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719740"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719739"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Specifies the initial layer normalization layer of a transformer encoder.</span><span>
</span><span id="line-158"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-159"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719738"><span class="annot"><a href="#local-6989586621679719738"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719737"><span class="annot"><a href="#local-6989586621679719737"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719736"><span class="annot"><a href="#local-6989586621679719736"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719735"><span class="annot"><a href="#local-6989586621679719735"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719734"><span class="annot"><a href="#local-6989586621679719734"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719730"><span id="local-6989586621679719731"><span id="local-6989586621679719732"><span id="local-6989586621679719733"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719733"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719732"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719731"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719730"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719733"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719732"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719731"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719730"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719726"><span id="local-6989586621679719727"><span id="local-6989586621679719728"><span id="local-6989586621679719729"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719729"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719728"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719727"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719726"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719729"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719728"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719727"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679719726"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719722"><span id="local-6989586621679719723"><span id="local-6989586621679719724"><span id="local-6989586621679719725"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719725"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719724"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719723"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719722"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719725"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719724"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719723"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719722"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719718"><span id="local-6989586621679719719"><span id="local-6989586621679719720"><span id="local-6989586621679719721"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719721"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719720"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719719"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719718"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719721"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719720"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719719"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679719718"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719714"><span id="local-6989586621679719715"><span id="local-6989586621679719716"><span id="local-6989586621679719717"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719717"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719716"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719715"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719714"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719717"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719716"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719715"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719714"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | Specifies the initial dropout layer of a transformer encoder.</span><span>
</span><span id="line-176"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-177"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719713"><span class="annot"><a href="#local-6989586621679719713"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719712"><span class="annot"><a href="#local-6989586621679719712"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-182"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutDropout"><span class="hs-identifier hs-type">WithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Specifies the transformer block stack of a transformer encoder.</span><span>
</span><span id="line-192"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-193"></span><span>  </span><span id="TEStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier hs-var">TEStackF</span></a></span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719711"><span class="annot"><a href="#local-6989586621679719711"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719710"><span class="annot"><a href="#local-6989586621679719710"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719709"><span class="annot"><a href="#local-6989586621679719709"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719708"><span class="annot"><a href="#local-6989586621679719708"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719707"><span class="annot"><a href="#local-6989586621679719707"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719706"><span class="annot"><a href="#local-6989586621679719706"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719705"><span class="annot"><a href="#local-6989586621679719705"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719704"><span class="annot"><a href="#local-6989586621679719704"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719703"><span class="annot"><a href="#local-6989586621679719703"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719702"><span class="annot"><a href="#local-6989586621679719702"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719701"><span class="annot"><a href="#local-6989586621679719701"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-205"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-206"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-207"></span><span>  </span><span id="TEStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier hs-var">TEStackF</span></a></span></span><span> </span><span id="local-6989586621679719690"><span id="local-6989586621679719691"><span id="local-6989586621679719692"><span id="local-6989586621679719693"><span id="local-6989586621679719694"><span id="local-6989586621679719695"><span id="local-6989586621679719696"><span id="local-6989586621679719697"><span id="local-6989586621679719698"><span id="local-6989586621679719699"><span id="local-6989586621679719700"><span class="annot"><a href="#local-6989586621679719700"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719699"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719698"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719697"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719696"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719695"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719694"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719693"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719692"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719691"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719690"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#EncoderStackF"><span class="hs-identifier hs-type">EncoderStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719700"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719699"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719698"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719697"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719696"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719695"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719694"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719693"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719692"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719691"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719690"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- | Specifies the final layer normalization layer of a transformer encoder.</span><span>
</span><span id="line-211"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-212"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719689"><span class="annot"><a href="#local-6989586621679719689"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719688"><span class="annot"><a href="#local-6989586621679719688"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719687"><span class="annot"><a href="#local-6989586621679719687"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719686"><span class="annot"><a href="#local-6989586621679719686"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719685"><span class="annot"><a href="#local-6989586621679719685"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-220"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719681"><span id="local-6989586621679719682"><span id="local-6989586621679719683"><span id="local-6989586621679719684"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719684"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719683"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719682"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719681"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719684"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719683"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719682"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679719681"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719677"><span id="local-6989586621679719678"><span id="local-6989586621679719679"><span id="local-6989586621679719680"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719680"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719679"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719678"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719677"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719680"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719679"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719678"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719677"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-222"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719673"><span id="local-6989586621679719674"><span id="local-6989586621679719675"><span id="local-6989586621679719676"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719676"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719674"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719673"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719676"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719675"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719674"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719673"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719669"><span id="local-6989586621679719670"><span id="local-6989586621679719671"><span id="local-6989586621679719672"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719672"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719671"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719670"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719669"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719672"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719671"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719670"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679719669"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719665"><span id="local-6989586621679719666"><span id="local-6989586621679719667"><span id="local-6989586621679719668"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719668"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719667"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719666"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719665"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719668"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719667"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719666"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719665"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Specifies the final dropout layer of a transformer encoder.</span><span>
</span><span id="line-229"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-230"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719664"><span class="annot"><a href="#local-6989586621679719664"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719663"><span class="annot"><a href="#local-6989586621679719663"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-234"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutDropout"><span class="hs-identifier hs-type">WithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>
</span><span id="line-244"></span><span class="hs-comment">-- | Specifies the parameters of a transformer in an encoder configuration.</span><span>
</span><span id="line-245"></span><span class="hs-comment">--</span><span>
</span><span id="line-246"></span><span class="hs-comment">-- - @style@: the style of the transformer stack, e.g. 'ST5', 'SByT5', etc.</span><span>
</span><span id="line-247"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the stack's parameters.</span><span>
</span><span id="line-248"></span><span class="hs-comment">-- - @device@: the computational device on which the stack is allocated.</span><span>
</span><span id="line-249"></span><span class="hs-comment">-- - @dataType@: the data type of the stack's parameters.</span><span>
</span><span id="line-250"></span><span class="hs-comment">-- - @headDim@: the dimension of all transformer heads in the stack.</span><span>
</span><span id="line-251"></span><span class="hs-comment">-- - @headEmbedDim@: the dimension of the transformer head embeddings.</span><span>
</span><span id="line-252"></span><span class="hs-comment">-- - @embedDim@: the dimension of the transformer embeddings.</span><span>
</span><span id="line-253"></span><span class="hs-comment">-- - @inputEmbedDim@: the dimension of the transformer query embeddings.</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- - @ffnDim@: the dimension of the feed-forward network.</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- - @posEncDim@: the dimension of the positional encoding.</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- - @dropoutP@: the dropout rate.</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- - @eps@: the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-258"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier hs-type">transformerEncoderSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720828"><span class="annot"><a href="#local-6989586621679720828"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679720826"><span class="annot"><a href="#local-6989586621679720826"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679720824"><span class="annot"><a href="#local-6989586621679720824"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679720822"><span class="annot"><a href="#local-6989586621679720822"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679720820"><span class="annot"><a href="#local-6989586621679720820"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679720818"><span class="annot"><a href="#local-6989586621679720818"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679720816"><span class="annot"><a href="#local-6989586621679720816"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679720815"><span class="annot"><a href="#local-6989586621679720815"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679720814"><span class="annot"><a href="#local-6989586621679720814"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679720813"><span class="annot"><a href="#local-6989586621679720813"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679720812"><span class="annot"><a href="#local-6989586621679720812"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679720811"><span class="annot"><a href="#local-6989586621679720811"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720828"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-261"></span><span>  </span><span class="annot"><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720826"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720824"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720822"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-264"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720820"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-265"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720818"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-266"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720816"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-267"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720815"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720814"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720813"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720812"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier hs-type">SHasDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720811"><span class="hs-identifier hs-type">hasDropout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-273"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerEncoderF"><span class="hs-identifier hs-type">TransformerEncoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720828"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720826"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720824"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720822"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720820"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720818"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720816"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720815"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720814"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720813"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720812"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720811"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span id="transformerEncoderSpec"><span class="annot"><span class="annottext">transformerEncoderSpec :: forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (TransformerEncoderF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        posEncDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier hs-var hs-var">transformerEncoderSpec</span></a></span></span><span> </span><span id="local-6989586621679719661"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679719660"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679719660"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679719659"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719659"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679719658"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719658"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679719657"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719657"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679719656"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719656"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679719655"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679719655"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679719654"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679719654"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679719653"><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719653"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679719652"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679719652"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679719651"><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719651"><span class="hs-identifier hs-var">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679719650"><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719650"><span class="hs-identifier hs-var">hasDropout</span></a></span></span><span> </span><span id="local-6989586621679719649"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679719648"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719648"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679719647"><span class="annot"><span class="annottext">posEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
</span><a href="#local-6989586621679719647"><span class="hs-identifier hs-var hs-var">posEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719637"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719637"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719637"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.position_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719637"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.position_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719637"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-284"></span><span>      </span><span id="local-6989586621679719619"><span class="annot"><span class="annottext">relPosEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TERelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679719619"><span class="hs-identifier hs-var hs-var">relPosEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679719616"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679719616"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TERelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-292"></span><span>      </span><span id="local-6989586621679719605"><span class="annot"><span class="annottext">initialLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679719605"><span class="hs-identifier hs-var hs-var">initialLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>      </span><span class="annot"><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.LayerNorm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.LayerNorm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-299"></span><span>      </span><span class="annot"><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-300"></span><span>      </span><span id="local-6989586621679719588"><span class="annot"><span class="annottext">initialDropoutSpec :: STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TEInitialDropoutF style hasDropout)
</span><a href="#local-6989586621679719588"><span class="hs-identifier hs-var hs-var">initialDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-301"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-305"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-309"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-313"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TEInitialDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-315"></span><span>      </span><span id="local-6989586621679719553"><span class="annot"><span class="annottext">stackSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF style gradient device dataType inputEmbedDim embedDim)
                          (KInProjF style gradient device dataType inputEmbedDim embedDim)
                          (VInProjF style gradient device dataType inputEmbedDim embedDim)
                          (OutProjF style gradient device dataType embedDim inputEmbedDim)
                          (DropoutF style hasDropout)))
                    (SADropoutF style hasDropout)
                    (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style hasDropout)
                    (FFNOutputProjectionF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNOutputDropoutF style hasDropout)
                    (FFNOutputLayerNormF
                       style gradient device dataType inputEmbedDim))))))
</span><a href="#local-6989586621679719553"><span class="hs-identifier hs-var hs-var">stackSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'T5 hasDropout)))
                 (SADropoutF 'T5 hasDropout)
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'T5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'T5 hasDropout)))
                    (SADropoutF 'T5 hasDropout)
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'T5 hasDropout)
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel ())))
                     (DropoutF 'T5 hasDropout)))
               (SADropoutF 'T5 hasDropout)
               ()))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel ())))
               Relu
               (FFNActivationDropoutF 'T5 hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel ())))
               (FFNOutputDropoutF 'T5 hasDropout)
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           (DropoutF 'T5 hasDropout)))
                     (SADropoutF 'T5 hasDropout)
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel ())))
                     Relu
                     (FFNActivationDropoutF 'T5 hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     (FFNOutputDropoutF 'T5 hasDropout)
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'T5 hasDropout)))
                 (SADropoutF 'T5 hasDropout)
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'T5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'T5 hasDropout)))
                    (SADropoutF 'T5 hasDropout)
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'T5 hasDropout)
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'T5 gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'T5 gradient device dataType embedDim inputEmbedDim)
                       (DropoutF 'T5 hasDropout)))
                 (SADropoutF 'T5 hasDropout)
                 (SAFinalLayerNormF 'T5 gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'T5 gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'T5 gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'T5)
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (FFNOutputProjectionF
                    'T5 gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'T5 hasDropout)
                 (FFNOutputLayerNormF
                    'T5 gradient device dataType inputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-316"></span><span>      </span><span class="annot"><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'ByT5 hasDropout)))
                 (SADropoutF 'ByT5 hasDropout)
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'ByT5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'ByT5 hasDropout)))
                    (SADropoutF 'ByT5 hasDropout)
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'ByT5 hasDropout)
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel ())))
                     (DropoutF 'ByT5 hasDropout)))
               (SADropoutF 'ByT5 hasDropout)
               ()))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (GGate
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, inputEmbedDim])))
                        (NamedModel ())))
                  GeluNew
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, inputEmbedDim])))
                        (NamedModel ()))))
               GeluNew
               (FFNActivationDropoutF 'T5 hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel ())))
               (FFNOutputDropoutF 'ByT5 hasDropout)
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           (DropoutF 'ByT5 hasDropout)))
                     (SADropoutF 'ByT5 hasDropout)
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (GGate
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ())))
                        GeluNew
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ()))))
                     GeluNew
                     (FFNActivationDropoutF 'T5 hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     (FFNOutputDropoutF 'ByT5 hasDropout)
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'ByT5 hasDropout)))
                 (SADropoutF 'ByT5 hasDropout)
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'ByT5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'ByT5 hasDropout)))
                    (SADropoutF 'ByT5 hasDropout)
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'ByT5 hasDropout)
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'ByT5 gradient device dataType embedDim inputEmbedDim)
                       (DropoutF 'ByT5 hasDropout)))
                 (SADropoutF 'ByT5 hasDropout)
                 (SAFinalLayerNormF 'ByT5 gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'ByT5 gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'ByT5)
                 (FFNActivationDropoutF 'ByT5 hasDropout)
                 (FFNOutputProjectionF
                    'ByT5 gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'ByT5 hasDropout)
                 (FFNOutputLayerNormF
                    'ByT5 gradient device dataType inputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'BART hasDropout)))
                 (SADropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'BART hasDropout)))
                    (SADropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (DropoutF 'BART hasDropout)))
               (SADropoutF 'BART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               (FFNActivationDropoutF 'BART hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               (FFNOutputDropoutF 'BART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           (DropoutF 'BART hasDropout)))
                     (SADropoutF 'BART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     (FFNActivationDropoutF 'BART hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (FFNOutputDropoutF 'BART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'BART hasDropout)))
                 (SADropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'BART hasDropout)))
                    (SADropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'BART gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'BART gradient device dataType embedDim inputEmbedDim)
                       (DropoutF 'BART hasDropout)))
                 (SADropoutF 'BART hasDropout)
                 (SAFinalLayerNormF 'BART gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'BART gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'BART gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'BART)
                 (FFNActivationDropoutF 'BART hasDropout)
                 (FFNOutputProjectionF
                    'BART gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'BART hasDropout)
                 (FFNOutputLayerNormF
                    'BART gradient device dataType inputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-318"></span><span>      </span><span class="annot"><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'MBART hasDropout)))
                 (SADropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'MBART hasDropout)))
                    (SADropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (DropoutF 'MBART hasDropout)))
               (SADropoutF 'MBART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               (FFNActivationDropoutF 'BART hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               (FFNOutputDropoutF 'MBART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           (DropoutF 'MBART hasDropout)))
                     (SADropoutF 'MBART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     (FFNActivationDropoutF 'BART hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (FFNOutputDropoutF 'MBART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'MBART hasDropout)))
                 (SADropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'MBART hasDropout)))
                    (SADropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'MBART gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'MBART gradient device dataType embedDim inputEmbedDim)
                       (DropoutF 'MBART hasDropout)))
                 (SADropoutF 'MBART hasDropout)
                 (SAFinalLayerNormF 'MBART gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'MBART gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'MBART gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'MBART)
                 (FFNActivationDropoutF 'MBART hasDropout)
                 (FFNOutputProjectionF
                    'MBART gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'MBART hasDropout)
                 (FFNOutputLayerNormF
                    'MBART gradient device dataType inputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-319"></span><span>      </span><span class="annot"><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'Pegasus hasDropout)))
                 (SADropoutF 'Pegasus hasDropout)
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'Pegasus hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'Pegasus hasDropout)))
                    (SADropoutF 'Pegasus hasDropout)
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'Pegasus hasDropout)
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (DropoutF 'Pegasus hasDropout)))
               (SADropoutF 'Pegasus hasDropout)
               ()))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Relu
               (FFNActivationDropoutF 'BART hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               (FFNOutputDropoutF 'Pegasus hasDropout)
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           (DropoutF 'Pegasus hasDropout)))
                     (SADropoutF 'Pegasus hasDropout)
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Relu
                     (FFNActivationDropoutF 'BART hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (FFNOutputDropoutF 'Pegasus hasDropout)
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'Pegasus hasDropout)))
                 (SADropoutF 'Pegasus hasDropout)
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'Pegasus hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'Pegasus hasDropout)))
                    (SADropoutF 'Pegasus hasDropout)
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'Pegasus hasDropout)
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'Pegasus gradient device dataType embedDim inputEmbedDim)
                       (DropoutF 'Pegasus hasDropout)))
                 (SADropoutF 'Pegasus hasDropout)
                 (SAFinalLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'Pegasus gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'Pegasus)
                 (FFNActivationDropoutF 'Pegasus hasDropout)
                 (FFNOutputProjectionF
                    'Pegasus gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'Pegasus hasDropout)
                 (FFNOutputLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span class="annot"><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'BERT hasDropout)))
                 (SADropoutF 'BERT hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'BERT hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'BERT hasDropout)))
                    (SADropoutF 'BERT hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'BERT hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;encoder.layer.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (DropoutF 'BERT hasDropout)))
               (SADropoutF 'BERT hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               (FFNOutputDropoutF 'BERT hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           (DropoutF 'BERT hasDropout)))
                     (SADropoutF 'BERT hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (FFNOutputDropoutF 'BERT hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'BERT hasDropout)))
                 (SADropoutF 'BERT hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'BERT hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'BERT hasDropout)))
                    (SADropoutF 'BERT hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'BERT hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'BERT gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'BERT gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'BERT gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'BERT gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'BERT gradient device dataType embedDim inputEmbedDim)
                       (DropoutF 'BERT hasDropout)))
                 (SADropoutF 'BERT hasDropout)
                 (SAFinalLayerNormF 'BERT gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'BERT gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'BERT gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'BERT)
                 (FFNActivationDropoutF 'BERT hasDropout)
                 (FFNOutputProjectionF
                    'BERT gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'BERT hasDropout)
                 (FFNOutputLayerNormF
                    'BERT gradient device dataType inputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span>
</span><span id="line-321"></span><span>      </span><span class="annot"><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'RoBERTa hasDropout)))
                 (SADropoutF 'RoBERTa hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'RoBERTa hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'RoBERTa hasDropout)))
                    (SADropoutF 'RoBERTa hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'RoBERTa hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;encoder.layer.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (DropoutF 'RoBERTa hasDropout)))
               (SADropoutF 'RoBERTa hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               (FFNOutputDropoutF 'RoBERTa hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           (DropoutF 'RoBERTa hasDropout)))
                     (SADropoutF 'RoBERTa hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     (FFNOutputDropoutF 'RoBERTa hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       (DropoutF 'RoBERTa hasDropout)))
                 (SADropoutF 'RoBERTa hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 (FFNOutputDropoutF 'RoBERTa hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          (DropoutF 'RoBERTa hasDropout)))
                    (SADropoutF 'RoBERTa hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    (FFNOutputDropoutF 'RoBERTa hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'RoBERTa gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'RoBERTa gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'RoBERTa gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'RoBERTa gradient device dataType embedDim inputEmbedDim)
                       (DropoutF 'RoBERTa hasDropout)))
                 (SADropoutF 'RoBERTa hasDropout)
                 (SAFinalLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'RoBERTa gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'RoBERTa)
                 (FFNActivationDropoutF 'RoBERTa hasDropout)
                 (FFNOutputProjectionF
                    'RoBERTa gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'RoBERTa hasDropout)
                 (FFNOutputLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span>
</span><span id="line-322"></span><span>      </span><span class="annot"><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-323"></span><span>      </span><span id="local-6989586621679719534"><span class="annot"><span class="annottext">finalLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679719534"><span class="hs-identifier hs-var hs-var">finalLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="annot"><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>      </span><span class="annot"><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>      </span><span class="annot"><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-328"></span><span>      </span><span class="annot"><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>      </span><span class="annot"><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>      </span><span class="annot"><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-331"></span><span>      </span><span id="local-6989586621679719519"><span class="annot"><span class="annottext">finalDropoutSpec :: STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TEFinalDropoutF style hasDropout)
</span><a href="#local-6989586621679719519"><span class="hs-identifier hs-var hs-var">finalDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-332"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>      </span><span class="annot"><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TEFinalDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-341"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
-&gt; ModelSpec
     (TERelPosEncF style gradient device dataType headDim posEncDim)
-&gt; ModelSpec
     (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
-&gt; ModelSpec (TEInitialDropoutF style hasDropout)
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF style gradient device dataType inputEmbedDim embedDim)
                          (KInProjF style gradient device dataType inputEmbedDim embedDim)
                          (VInProjF style gradient device dataType inputEmbedDim embedDim)
                          (OutProjF style gradient device dataType embedDim inputEmbedDim)
                          (DropoutF style hasDropout)))
                    (SADropoutF style hasDropout)
                    (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style hasDropout)
                    (FFNOutputProjectionF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNOutputDropoutF style hasDropout)
                    (FFNOutputLayerNormF
                       style gradient device dataType inputEmbedDim))))))
-&gt; ModelSpec
     (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
-&gt; ModelSpec (TEFinalDropoutF style hasDropout)
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
</span><a href="#local-6989586621679719647"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TERelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679719619"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679719605"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TEInitialDropoutF style hasDropout)
</span><a href="#local-6989586621679719588"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719650"><span class="hs-identifier hs-var">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF style gradient device dataType inputEmbedDim embedDim)
                          (KInProjF style gradient device dataType inputEmbedDim embedDim)
                          (VInProjF style gradient device dataType inputEmbedDim embedDim)
                          (OutProjF style gradient device dataType embedDim inputEmbedDim)
                          (DropoutF style hasDropout)))
                    (SADropoutF style hasDropout)
                    (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style hasDropout)
                    (FFNOutputProjectionF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNOutputDropoutF style hasDropout)
                    (FFNOutputLayerNormF
                       style gradient device dataType inputEmbedDim))))))
</span><a href="#local-6989586621679719553"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679719534"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TEFinalDropoutF style hasDropout)
</span><a href="#local-6989586621679719519"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719661"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719650"><span class="hs-identifier hs-var">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="#local-6989586621679719550"><span class="hs-identifier hs-type">stackSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-351"></span><span>    </span><span id="local-6989586621679719550"><span class="annot"><span class="annottext">stackSpec' :: STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679719550"><span class="hs-identifier hs-var hs-var">stackSpec'</span></a></span></span><span> </span><span id="local-6989586621679719502"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719502"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (EncoderStackF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        hasDropout)
forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (EncoderStackF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        queryEmbedDim
        ffnDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#encoderStackSpec"><span class="hs-identifier hs-var">encoderStackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719502"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679719660"><span class="hs-identifier hs-var">numLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719659"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719658"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719657"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719656"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679719655"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679719654"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719653"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679719652"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719650"><span class="hs-identifier hs-var">hasDropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719649"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719648"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><a href="#local-6989586621679719600"><span class="hs-identifier hs-type">layerNormSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-353"></span><span>    </span><span id="local-6989586621679719600"><span class="annot"><span class="annottext">layerNormSpec' :: SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679719600"><span class="hs-identifier hs-var hs-var">layerNormSpec'</span></a></span></span><span> </span><span id="local-6989586621679719501"><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679719501"><span class="hs-identifier hs-var">hasBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[inputEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679719501"><span class="hs-identifier hs-var">hasBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719659"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719658"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719657"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[inputEmbedDim] -&gt; SShape ('Shape '[inputEmbedDim])
forall (index :: [Dim (Name Symbol) (Size Nat)]).
SList index -&gt; SShape ('Shape index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[inputEmbedDim] -&gt; SShape ('Shape '[inputEmbedDim]))
-&gt; SList '[inputEmbedDim] -&gt; SShape ('Shape '[inputEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sing inputEmbedDim
SDim inputEmbedDim
</span><a href="#local-6989586621679719653"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">Sing inputEmbedDim -&gt; SList '[] -&gt; SList '[inputEmbedDim]
forall {a1} (a2 :: a1) (as :: [a1]).
Sing a2 -&gt; SList as -&gt; SList (a2 : as)
</span><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719648"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span id="local-6989586621679719616"><span class="annot"><span class="annottext">relPosEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679719616"><span class="hs-identifier hs-var hs-var">relPosEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim headDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719659"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (index :: LayoutType).
SLayoutType index -&gt; SLayout ('Layout index)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719658"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719657"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719651"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719656"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span id="local-6989586621679719637"><span class="annot"><span class="annottext">posEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719637"><span class="hs-identifier hs-var hs-var">posEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim inputEmbedDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719659"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (index :: LayoutType).
SLayoutType index -&gt; SLayout ('Layout index)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719658"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719657"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719651"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679719653"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-358"></span><span>  </span><span id="TransformerDecoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerDecoderF"><span class="hs-identifier hs-var">TransformerDecoderF</span></a></span></span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719495"><span class="annot"><a href="#local-6989586621679719495"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719494"><span class="annot"><a href="#local-6989586621679719494"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719493"><span class="annot"><a href="#local-6989586621679719493"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719492"><span class="annot"><a href="#local-6989586621679719492"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719491"><span class="annot"><a href="#local-6989586621679719491"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719490"><span class="annot"><a href="#local-6989586621679719490"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719489"><span class="annot"><a href="#local-6989586621679719489"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719488"><span class="annot"><a href="#local-6989586621679719488"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719487"><span class="annot"><a href="#local-6989586621679719487"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719486"><span class="annot"><a href="#local-6989586621679719486"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719485"><span class="annot"><a href="#local-6989586621679719485"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719484"><span class="annot"><a href="#local-6989586621679719484"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719483"><span class="annot"><a href="#local-6989586621679719483"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-373"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-374"></span><span>  </span><span id="TransformerDecoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerDecoderF"><span class="hs-identifier hs-var">TransformerDecoderF</span></a></span></span><span> </span><span id="local-6989586621679719470"><span id="local-6989586621679719471"><span id="local-6989586621679719472"><span id="local-6989586621679719473"><span id="local-6989586621679719474"><span id="local-6989586621679719475"><span id="local-6989586621679719476"><span id="local-6989586621679719477"><span id="local-6989586621679719478"><span id="local-6989586621679719479"><span id="local-6989586621679719480"><span id="local-6989586621679719481"><span id="local-6989586621679719482"><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719481"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719480"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719479"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719478"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719477"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719476"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719475"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719474"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719473"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719472"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719471"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719470"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-375"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719480"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719479"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719478"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719474"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719471"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719480"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719479"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719478"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719477"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719471"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-type">TDInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719480"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719479"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719478"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719474"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-type">TDInitialDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719470"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier hs-type">TDStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719481"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719480"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719479"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719478"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719477"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719476"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719475"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719474"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719473"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719472"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719470"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-type">TDFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719480"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719479"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719478"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719474"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-type">TDFinalDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719482"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719470"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>
</span><span id="line-384"></span><span class="hs-comment">-- | Specifies the absolute positional encoding layer of a transformer decoder.</span><span>
</span><span id="line-385"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-386"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719468"><span class="annot"><a href="#local-6989586621679719468"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719467"><span class="annot"><a href="#local-6989586621679719467"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719466"><span class="annot"><a href="#local-6989586621679719466"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719465"><span class="annot"><a href="#local-6989586621679719465"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719464"><span class="annot"><a href="#local-6989586621679719464"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719463"><span class="annot"><a href="#local-6989586621679719463"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-395"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719458"><span id="local-6989586621679719459"><span id="local-6989586621679719460"><span id="local-6989586621679719461"><span id="local-6989586621679719462"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719462"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719461"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719460"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719459"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719458"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719462"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719461"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719460"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719459"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719458"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719453"><span id="local-6989586621679719454"><span id="local-6989586621679719455"><span id="local-6989586621679719456"><span id="local-6989586621679719457"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719457"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719456"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719455"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719454"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719453"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719457"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679719456"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719455"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719453"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719454"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719448"><span id="local-6989586621679719449"><span id="local-6989586621679719450"><span id="local-6989586621679719451"><span id="local-6989586621679719452"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719452"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719451"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719450"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719449"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719448"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719452"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719451"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719450"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719449"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719448"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-399"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719443"><span id="local-6989586621679719444"><span id="local-6989586621679719445"><span id="local-6989586621679719446"><span id="local-6989586621679719447"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719447"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719446"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719445"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719444"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719443"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719447"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719446"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719445"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719444"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719443"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- | Specifies the relative positional encoding layer of a transformer decoder.</span><span>
</span><span id="line-402"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-403"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719442"><span class="annot"><a href="#local-6989586621679719442"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719441"><span class="annot"><a href="#local-6989586621679719441"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719440"><span class="annot"><a href="#local-6989586621679719440"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719439"><span class="annot"><a href="#local-6989586621679719439"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719438"><span class="annot"><a href="#local-6989586621679719438"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719437"><span class="annot"><a href="#local-6989586621679719437"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-410"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-412"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719432"><span id="local-6989586621679719433"><span id="local-6989586621679719434"><span id="local-6989586621679719435"><span id="local-6989586621679719436"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719436"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719435"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719434"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719433"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719432"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719436"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679719435"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719434"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719432"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719433"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719427"><span id="local-6989586621679719428"><span id="local-6989586621679719429"><span id="local-6989586621679719430"><span id="local-6989586621679719431"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719431"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719430"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719429"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719428"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719427"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719431"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719430"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719429"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719428"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719427"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-414"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719422"><span id="local-6989586621679719423"><span id="local-6989586621679719424"><span id="local-6989586621679719425"><span id="local-6989586621679719426"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719426"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719425"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719424"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719423"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719422"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719426"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719425"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719424"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719423"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719422"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-416"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span id="local-6989586621679719417"><span id="local-6989586621679719418"><span id="local-6989586621679719419"><span id="local-6989586621679719420"><span id="local-6989586621679719421"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719421"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719420"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719419"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719418"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719417"><span class="hs-identifier hs-type">posEncDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719421"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719420"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719419"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719418"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719417"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-comment">-- | Specifies the initial layer normalization layer of a transformer decoder.</span><span>
</span><span id="line-419"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-420"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719416"><span class="annot"><a href="#local-6989586621679719416"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719415"><span class="annot"><a href="#local-6989586621679719415"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719414"><span class="annot"><a href="#local-6989586621679719414"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719413"><span class="annot"><a href="#local-6989586621679719413"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719412"><span class="annot"><a href="#local-6989586621679719412"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-428"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719408"><span id="local-6989586621679719409"><span id="local-6989586621679719410"><span id="local-6989586621679719411"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719411"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719410"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719409"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719408"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-type">TDInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719411"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719410"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719409"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719408"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-430"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719404"><span id="local-6989586621679719405"><span id="local-6989586621679719406"><span id="local-6989586621679719407"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719407"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719406"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719405"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719404"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719407"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719406"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719405"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679719404"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719400"><span id="local-6989586621679719401"><span id="local-6989586621679719402"><span id="local-6989586621679719403"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719403"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719402"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719400"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-type">TDInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719403"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719402"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719401"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719400"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-432"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>
</span><span id="line-434"></span><span class="hs-comment">-- | Specifies the initial dropout layer of a transformer decoder.</span><span>
</span><span id="line-435"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-436"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719399"><span class="annot"><a href="#local-6989586621679719399"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719398"><span class="annot"><a href="#local-6989586621679719398"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-440"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-442"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-444"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-445"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutDropout"><span class="hs-identifier hs-type">WithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="hs-comment">-- | Specifies the transformer block stack of a transformer decoder.</span><span>
</span><span id="line-449"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-450"></span><span>  </span><span id="TDStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier hs-var">TDStackF</span></a></span></span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719397"><span class="annot"><a href="#local-6989586621679719397"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719396"><span class="annot"><a href="#local-6989586621679719396"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719395"><span class="annot"><a href="#local-6989586621679719395"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719394"><span class="annot"><a href="#local-6989586621679719394"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719393"><span class="annot"><a href="#local-6989586621679719393"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719392"><span class="annot"><a href="#local-6989586621679719392"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719391"><span class="annot"><a href="#local-6989586621679719391"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719390"><span class="annot"><a href="#local-6989586621679719390"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719389"><span class="annot"><a href="#local-6989586621679719389"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719388"><span class="annot"><a href="#local-6989586621679719388"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719387"><span class="annot"><a href="#local-6989586621679719387"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719386"><span class="annot"><a href="#local-6989586621679719386"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-463"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-464"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-465"></span><span>  </span><span id="TDStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier hs-var">TDStackF</span></a></span></span><span> </span><span id="local-6989586621679719374"><span id="local-6989586621679719375"><span id="local-6989586621679719376"><span id="local-6989586621679719377"><span id="local-6989586621679719378"><span id="local-6989586621679719379"><span id="local-6989586621679719380"><span id="local-6989586621679719381"><span id="local-6989586621679719382"><span id="local-6989586621679719383"><span id="local-6989586621679719384"><span id="local-6989586621679719385"><span class="annot"><a href="#local-6989586621679719385"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719384"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719383"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719382"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719381"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719380"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719379"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719378"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719377"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719376"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719375"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719374"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#DecoderStackF"><span class="hs-identifier hs-type">DecoderStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719385"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719384"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719383"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719382"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719381"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719380"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719379"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719378"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719377"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719376"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719375"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719374"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">-- | Specifies the final layer normalization layer of a transformer decoder.</span><span>
</span><span id="line-469"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-470"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719373"><span class="annot"><a href="#local-6989586621679719373"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719372"><span class="annot"><a href="#local-6989586621679719372"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719371"><span class="annot"><a href="#local-6989586621679719371"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719370"><span class="annot"><a href="#local-6989586621679719370"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719369"><span class="annot"><a href="#local-6989586621679719369"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-477"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-478"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719365"><span id="local-6989586621679719366"><span id="local-6989586621679719367"><span id="local-6989586621679719368"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719368"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719367"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719366"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719365"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719368"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719367"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719366"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679719365"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719361"><span id="local-6989586621679719362"><span id="local-6989586621679719363"><span id="local-6989586621679719364"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719361"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-type">TDFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719361"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-480"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719357"><span id="local-6989586621679719358"><span id="local-6989586621679719359"><span id="local-6989586621679719360"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719360"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719359"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719358"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719357"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-type">TDFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719360"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719359"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719358"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719357"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-482"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span id="local-6989586621679719353"><span id="local-6989586621679719354"><span id="local-6989586621679719355"><span id="local-6989586621679719356"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719356"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719355"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719354"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719353"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719356"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719355"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679719354"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679719353"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="hs-comment">-- | Specifies the final dropout layer of a transformer decoder.</span><span>
</span><span id="line-485"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-486"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719352"><span class="annot"><a href="#local-6989586621679719352"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679719351"><span class="annot"><a href="#local-6989586621679719351"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-489"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-491"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-492"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithDropout"><span class="hs-identifier hs-type">WithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-493"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutDropout"><span class="hs-identifier hs-type">WithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>
</span><span id="line-498"></span><span class="hs-comment">-- | Specifies the parameters of a transformer in a decoder configuration.</span><span>
</span><span id="line-499"></span><span class="hs-comment">--</span><span>
</span><span id="line-500"></span><span class="hs-comment">-- - @style@: the style of the transformer stack, e.g. 'ST5', 'SByT5', etc.</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the stack's parameters.</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- - @device@: the computational device on which the stack is allocated.</span><span>
</span><span id="line-503"></span><span class="hs-comment">-- - @dataType@: the data type of the stack's parameters.</span><span>
</span><span id="line-504"></span><span class="hs-comment">-- - @headDim@: the dimension of all transformer heads in the stack.</span><span>
</span><span id="line-505"></span><span class="hs-comment">-- - @headEmbedDim@: the dimension of the transformer head embeddings.</span><span>
</span><span id="line-506"></span><span class="hs-comment">-- - @embedDim@: the dimension of the transformer embeddings.</span><span>
</span><span id="line-507"></span><span class="hs-comment">-- - @decoderInputEmbedDim@: the dimension of the decoder input embeddings.</span><span>
</span><span id="line-508"></span><span class="hs-comment">-- - @encoderOutputEmbedDim@: the dimension of the encoder output embeddings.</span><span>
</span><span id="line-509"></span><span class="hs-comment">-- - @ffnDim@: the dimension of the feed-forward network.</span><span>
</span><span id="line-510"></span><span class="hs-comment">-- - @posEncDim@: the dimension of the positional encoding.</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- - @dropoutP@: the dropout rate.</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- - @eps@: the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-513"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier hs-type">transformerDecoderSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679720692"><span class="annot"><a href="#local-6989586621679720692"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679720691"><span class="annot"><a href="#local-6989586621679720691"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679720690"><span class="annot"><a href="#local-6989586621679720690"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679720689"><span class="annot"><a href="#local-6989586621679720689"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679720688"><span class="annot"><a href="#local-6989586621679720688"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679720687"><span class="annot"><a href="#local-6989586621679720687"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679720686"><span class="annot"><a href="#local-6989586621679720686"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679720685"><span class="annot"><a href="#local-6989586621679720685"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679720684"><span class="annot"><a href="#local-6989586621679720684"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679720683"><span class="annot"><a href="#local-6989586621679720683"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679720682"><span class="annot"><a href="#local-6989586621679720682"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679720681"><span class="annot"><a href="#local-6989586621679720681"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679720680"><span class="annot"><a href="#local-6989586621679720680"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-515"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720692"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720691"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-517"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720690"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-518"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720689"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-519"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720688"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-520"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720687"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-521"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720686"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720685"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-523"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720684"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-524"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720683"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720682"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720681"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-527"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier hs-type">SHasDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720680"><span class="hs-identifier hs-type">hasDropout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-528"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-529"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-530"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerDecoderF"><span class="hs-identifier hs-type">TransformerDecoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720692"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720691"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720690"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720689"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720688"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720687"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720686"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720685"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720684"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720683"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720682"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720681"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720680"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span id="transformerDecoderSpec"><span class="annot"><span class="annottext">transformerDecoderSpec :: forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (decoderInputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (encoderOutputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim decoderInputEmbedDim
-&gt; SDim encoderOutputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (TransformerDecoderF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        decoderInputEmbedDim
        encoderOutputEmbedDim
        ffnDim
        posEncDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier hs-var hs-var">transformerDecoderSpec</span></a></span></span><span> </span><span id="local-6989586621679719349"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679719348"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679719348"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679719347"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719347"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679719346"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719346"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679719345"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719345"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679719344"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719344"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679719343"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679719343"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679719342"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679719342"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679719341"><span class="annot"><span class="annottext">SDim decoderInputEmbedDim
</span><a href="#local-6989586621679719341"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679719340"><span class="annot"><span class="annottext">SDim encoderOutputEmbedDim
</span><a href="#local-6989586621679719340"><span class="hs-identifier hs-var">encoderOutputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679719339"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679719339"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679719338"><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719338"><span class="hs-identifier hs-var">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679719337"><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719337"><span class="hs-identifier hs-var">hasDropout</span></a></span></span><span> </span><span id="local-6989586621679719336"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679719335"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719335"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-532"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679719334"><span class="annot"><span class="annottext">posEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDPosEncF
        style gradient device dataType decoderInputEmbedDim posEncDim)
</span><a href="#local-6989586621679719334"><span class="hs-identifier hs-var hs-var">posEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-533"></span><span>      </span><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span>      </span><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        decoderInputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719329"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-535"></span><span>      </span><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        decoderInputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719329"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-536"></span><span>      </span><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        decoderInputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719329"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-537"></span><span>      </span><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-538"></span><span>      </span><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-540"></span><span>      </span><span id="local-6989586621679719315"><span class="annot"><span class="annottext">relPosEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDRelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679719315"><span class="hs-identifier hs-var hs-var">relPosEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679719312"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679719312"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>      </span><span class="annot"><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>      </span><span class="annot"><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>      </span><span class="annot"><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDRelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-546"></span><span>      </span><span class="annot"><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDRelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-547"></span><span>      </span><span class="annot"><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDRelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-548"></span><span>      </span><span id="local-6989586621679719297"><span class="annot"><span class="annottext">initialLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDInitialLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679719297"><span class="hs-identifier hs-var hs-var">initialLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-550"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679719292"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-551"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679719292"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-552"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDInitialLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-554"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDInitialLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-555"></span><span>      </span><span class="annot"><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDInitialLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-556"></span><span>      </span><span id="local-6989586621679719279"><span class="annot"><span class="annottext">initialDropoutSpec :: STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TDInitialDropoutF style hasDropout)
</span><a href="#local-6989586621679719279"><span class="hs-identifier hs-var hs-var">initialDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-557"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-561"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-562"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-563"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-565"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-566"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDInitialDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-567"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDInitialDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-568"></span><span>      </span><span class="annot"><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDInitialDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-569"></span><span>      </span><span id="local-6989586621679719249"><span class="annot"><span class="annottext">stackSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          (DropoutF style hasDropout)))
                    (SADropoutF style hasDropout)
                    (SAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GCrossAttention
                    (CAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          (DropoutF style hasDropout)))
                    (CADropoutF style hasDropout)
                    (CAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style hasDropout)
                    (FFNOutputProjectionF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNOutputDropoutF style hasDropout)
                    (FFNOutputLayerNormF
                       style gradient device dataType decoderInputEmbedDim))))))
</span><a href="#local-6989586621679719249"><span class="hs-identifier hs-var hs-var">stackSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'T5 hasDropout)))
                 (SADropoutF 'T5 hasDropout)
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'T5 hasDropout)))
                 (CADropoutF 'T5 hasDropout)
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'T5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'T5 hasDropout)))
                    (SADropoutF 'T5 hasDropout)
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'T5 hasDropout)))
                    (CADropoutF 'T5 hasDropout)
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'T5 hasDropout)
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     (DropoutF 'T5 hasDropout)))
               (SADropoutF 'T5 hasDropout)
               ()))
         (NamedModel
            (GCrossAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     (DropoutF 'T5 hasDropout)))
               (CADropoutF 'T5 hasDropout)
               ()))
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel ())))
               Relu
               (FFNActivationDropoutF 'T5 hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel ())))
               (FFNOutputDropoutF 'T5 hasDropout)
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           (DropoutF 'T5 hasDropout)))
                     (SADropoutF 'T5 hasDropout)
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           (DropoutF 'T5 hasDropout)))
                     (CADropoutF 'T5 hasDropout)
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     Relu
                     (FFNActivationDropoutF 'T5 hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     (FFNOutputDropoutF 'T5 hasDropout)
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'T5 hasDropout)))
                 (SADropoutF 'T5 hasDropout)
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'T5 hasDropout)))
                 (CADropoutF 'T5 hasDropout)
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'T5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'T5 hasDropout)))
                    (SADropoutF 'T5 hasDropout)
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'T5 hasDropout)))
                    (CADropoutF 'T5 hasDropout)
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'T5 hasDropout)
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'T5 gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'T5 hasDropout)))
                 (SADropoutF 'T5 hasDropout)
                 (SAFinalLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'T5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'T5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'T5 gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'T5 hasDropout)))
                 (CADropoutF 'T5 hasDropout)
                 (CAFinalLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'T5 gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'T5)
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (FFNOutputProjectionF
                    'T5 gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'T5 hasDropout)
                 (FFNOutputLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679719246"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-570"></span><span>      </span><span class="annot"><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'ByT5 hasDropout)))
                 (SADropoutF 'ByT5 hasDropout)
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'ByT5 hasDropout)))
                 (CADropoutF 'ByT5 hasDropout)
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'ByT5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'ByT5 hasDropout)))
                    (SADropoutF 'ByT5 hasDropout)
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'ByT5 hasDropout)))
                    (CADropoutF 'ByT5 hasDropout)
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'ByT5 hasDropout)
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     (DropoutF 'ByT5 hasDropout)))
               (SADropoutF 'ByT5 hasDropout)
               ()))
         (NamedModel
            (GCrossAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     (DropoutF 'ByT5 hasDropout)))
               (CADropoutF 'ByT5 hasDropout)
               ()))
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (GGate
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, decoderInputEmbedDim])))
                        (NamedModel ())))
                  GeluNew
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, decoderInputEmbedDim])))
                        (NamedModel ()))))
               GeluNew
               (FFNActivationDropoutF 'T5 hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel ())))
               (FFNOutputDropoutF 'ByT5 hasDropout)
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           (DropoutF 'ByT5 hasDropout)))
                     (SADropoutF 'ByT5 hasDropout)
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           (DropoutF 'ByT5 hasDropout)))
                     (CADropoutF 'ByT5 hasDropout)
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (GGate
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, decoderInputEmbedDim])))
                              (NamedModel ())))
                        GeluNew
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, decoderInputEmbedDim])))
                              (NamedModel ()))))
                     GeluNew
                     (FFNActivationDropoutF 'T5 hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     (FFNOutputDropoutF 'ByT5 hasDropout)
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'ByT5 hasDropout)))
                 (SADropoutF 'ByT5 hasDropout)
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       (DropoutF 'ByT5 hasDropout)))
                 (CADropoutF 'ByT5 hasDropout)
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 (FFNActivationDropoutF 'T5 hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 (FFNOutputDropoutF 'ByT5 hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'ByT5 hasDropout)))
                    (SADropoutF 'ByT5 hasDropout)
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          (DropoutF 'ByT5 hasDropout)))
                    (CADropoutF 'ByT5 hasDropout)
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    (FFNActivationDropoutF 'T5 hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    (FFNOutputDropoutF 'ByT5 hasDropout)
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'ByT5 gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'ByT5 hasDropout)))
                 (SADropoutF 'ByT5 hasDropout)
                 (SAFinalLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'ByT5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'ByT5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'ByT5 gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'ByT5 hasDropout)))
                 (CADropoutF 'ByT5 hasDropout)
                 (CAFinalLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'ByT5 gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'ByT5)
                 (FFNActivationDropoutF 'ByT5 hasDropout)
                 (FFNOutputProjectionF
                    'ByT5 gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'ByT5 hasDropout)
                 (FFNOutputLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679719246"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-571"></span><span>      </span><span class="annot"><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'BART hasDropout)))
                 (SADropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'BART hasDropout)))
                 (CADropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 (FFNOutputDropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'BART hasDropout)))
                    (SADropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'BART hasDropout)))
                    (CADropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    (FFNOutputDropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (DropoutF 'BART hasDropout)))
               (SADropoutF 'BART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GCrossAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (DropoutF 'BART hasDropout)))
               (CADropoutF 'BART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               (FFNActivationDropoutF 'BART hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (FFNOutputDropoutF 'BART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           (DropoutF 'BART hasDropout)))
                     (SADropoutF 'BART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GCrossAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           (DropoutF 'BART hasDropout)))
                     (CADropoutF 'BART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     (FFNActivationDropoutF 'BART hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (FFNOutputDropoutF 'BART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'BART hasDropout)))
                 (SADropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'BART hasDropout)))
                 (CADropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 (FFNOutputDropoutF 'BART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'BART hasDropout)))
                    (SADropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'BART hasDropout)))
                    (CADropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    (FFNOutputDropoutF 'BART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'BART gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'BART hasDropout)))
                 (SADropoutF 'BART hasDropout)
                 (SAFinalLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'BART gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'BART gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'BART gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'BART hasDropout)))
                 (CADropoutF 'BART hasDropout)
                 (CAFinalLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'BART gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'BART)
                 (FFNActivationDropoutF 'BART hasDropout)
                 (FFNOutputProjectionF
                    'BART gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'BART hasDropout)
                 (FFNOutputLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679719246"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-572"></span><span>      </span><span class="annot"><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'MBART hasDropout)))
                 (SADropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'MBART hasDropout)))
                 (CADropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 (FFNOutputDropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'MBART hasDropout)))
                    (SADropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'MBART hasDropout)))
                    (CADropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    (FFNOutputDropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (DropoutF 'MBART hasDropout)))
               (SADropoutF 'MBART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GCrossAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (DropoutF 'MBART hasDropout)))
               (CADropoutF 'MBART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               (FFNActivationDropoutF 'BART hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (FFNOutputDropoutF 'MBART hasDropout)
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           (DropoutF 'MBART hasDropout)))
                     (SADropoutF 'MBART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GCrossAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           (DropoutF 'MBART hasDropout)))
                     (CADropoutF 'MBART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     (FFNActivationDropoutF 'BART hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (FFNOutputDropoutF 'MBART hasDropout)
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'MBART hasDropout)))
                 (SADropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'MBART hasDropout)))
                 (CADropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 (FFNOutputDropoutF 'MBART hasDropout)
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'MBART hasDropout)))
                    (SADropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'MBART hasDropout)))
                    (CADropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    (FFNOutputDropoutF 'MBART hasDropout)
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'MBART gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'MBART hasDropout)))
                 (SADropoutF 'MBART hasDropout)
                 (SAFinalLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'MBART gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'MBART gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'MBART gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'MBART hasDropout)))
                 (CADropoutF 'MBART hasDropout)
                 (CAFinalLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'MBART gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'MBART)
                 (FFNActivationDropoutF 'MBART hasDropout)
                 (FFNOutputProjectionF
                    'MBART gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'MBART hasDropout)
                 (FFNOutputLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679719246"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'Pegasus hasDropout)))
                 (SADropoutF 'Pegasus hasDropout)
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'Pegasus hasDropout)))
                 (CADropoutF 'Pegasus hasDropout)
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 (FFNOutputDropoutF 'Pegasus hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'Pegasus hasDropout)))
                    (SADropoutF 'Pegasus hasDropout)
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'Pegasus hasDropout)))
                    (CADropoutF 'Pegasus hasDropout)
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    (FFNOutputDropoutF 'Pegasus hasDropout)
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (DropoutF 'Pegasus hasDropout)))
               (SADropoutF 'Pegasus hasDropout)
               ()))
         (NamedModel
            (GCrossAttention
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (DropoutF 'Pegasus hasDropout)))
               (CADropoutF 'Pegasus hasDropout)
               ()))
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Relu
               (FFNActivationDropoutF 'BART hasDropout)
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (FFNOutputDropoutF 'Pegasus hasDropout)
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           (DropoutF 'Pegasus hasDropout)))
                     (SADropoutF 'Pegasus hasDropout)
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           (DropoutF 'Pegasus hasDropout)))
                     (CADropoutF 'Pegasus hasDropout)
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Relu
                     (FFNActivationDropoutF 'BART hasDropout)
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     (FFNOutputDropoutF 'Pegasus hasDropout)
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'Pegasus hasDropout)))
                 (SADropoutF 'Pegasus hasDropout)
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       (DropoutF 'Pegasus hasDropout)))
                 (CADropoutF 'Pegasus hasDropout)
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 (FFNActivationDropoutF 'BART hasDropout)
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 (FFNOutputDropoutF 'Pegasus hasDropout)
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'Pegasus hasDropout)))
                    (SADropoutF 'Pegasus hasDropout)
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          (DropoutF 'Pegasus hasDropout)))
                    (CADropoutF 'Pegasus hasDropout)
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    (FFNActivationDropoutF 'BART hasDropout)
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    (FFNOutputDropoutF 'Pegasus hasDropout)
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'Pegasus gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'Pegasus hasDropout)))
                 (SADropoutF 'Pegasus hasDropout)
                 (SAFinalLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'Pegasus gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'Pegasus gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'Pegasus gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF 'Pegasus hasDropout)))
                 (CADropoutF 'Pegasus hasDropout)
                 (CAFinalLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'Pegasus gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'Pegasus)
                 (FFNActivationDropoutF 'Pegasus hasDropout)
                 (FFNOutputProjectionF
                    'Pegasus gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF 'Pegasus hasDropout)
                 (FFNOutputLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)))))
forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679719246"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-574"></span><span>      </span><span class="annot"><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-575"></span><span>      </span><span class="annot"><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-576"></span><span>      </span><span class="annot"><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-577"></span><span>      </span><span id="local-6989586621679719228"><span class="annot"><span class="annottext">finalLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDFinalLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679719228"><span class="hs-identifier hs-var hs-var">finalLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias
   gradient
   device
   dataType
   ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679719292"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span class="annot"><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias
   gradient
   device
   dataType
   ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679719292"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-579"></span><span>      </span><span class="annot"><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>      </span><span class="annot"><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall {hasBias :: HasBias}.
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679719292"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-582"></span><span>      </span><span class="annot"><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDFinalLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-583"></span><span>      </span><span class="annot"><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDFinalLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-584"></span><span>      </span><span class="annot"><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDFinalLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-585"></span><span>      </span><span id="local-6989586621679719210"><span class="annot"><span class="annottext">finalDropoutSpec :: STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TDFinalDropoutF style hasDropout)
</span><a href="#local-6989586621679719210"><span class="hs-identifier hs-var hs-var">finalDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithDropout"><span class="hs-identifier hs-var">SWithDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-588"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutDropout"><span class="hs-identifier hs-var">SWithoutDropout</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-589"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDFinalDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-593"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDFinalDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDFinalDropoutF style hasDropout)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-595"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
-&gt; ModelSpec
     (TDRelPosEncF style gradient device dataType headDim posEncDim)
-&gt; ModelSpec
     (TDInitialLayerNormF
        style gradient device dataType decoderInputEmbedDim)
-&gt; ModelSpec (TDInitialDropoutF style hasDropout)
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          (DropoutF style hasDropout)))
                    (SADropoutF style hasDropout)
                    (SAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GCrossAttention
                    (CAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          (DropoutF style hasDropout)))
                    (CADropoutF style hasDropout)
                    (CAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style hasDropout)
                    (FFNOutputProjectionF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNOutputDropoutF style hasDropout)
                    (FFNOutputLayerNormF
                       style gradient device dataType decoderInputEmbedDim))))))
-&gt; ModelSpec
     (TDFinalLayerNormF
        style gradient device dataType decoderInputEmbedDim)
-&gt; ModelSpec (TDFinalDropoutF style hasDropout)
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF
           style gradient device dataType decoderInputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF
           style gradient device dataType decoderInputEmbedDim))
     (ModelSpec (TDInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF
                          style gradient device dataType decoderInputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (KInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (VInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (OutProjF
                                style gradient device dataType embedDim decoderInputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF
                          style gradient device dataType decoderInputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF
                          style gradient device dataType decoderInputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (KInProjF
                                style gradient device dataType encoderOutputEmbedDim embedDim)
                             (VInProjF
                                style gradient device dataType encoderOutputEmbedDim embedDim)
                             (OutProjF
                                style gradient device dataType embedDim decoderInputEmbedDim)
                             (DropoutF style hasDropout)))
                       (CADropoutF style hasDropout)
                       (CAFinalLayerNormF
                          style gradient device dataType decoderInputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF
                          style gradient device dataType decoderInputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType decoderInputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType decoderInputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType decoderInputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF
           style gradient device dataType decoderInputEmbedDim))
     (ModelSpec (TDFinalDropoutF style hasDropout))
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span><span>
</span><span id="line-596"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDPosEncF
        style gradient device dataType decoderInputEmbedDim posEncDim)
</span><a href="#local-6989586621679719334"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDRelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679719315"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-598"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDInitialLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679719297"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-599"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TDInitialDropoutF style hasDropout)
</span><a href="#local-6989586621679719279"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719337"><span class="hs-identifier hs-var">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          (DropoutF style hasDropout)))
                    (SADropoutF style hasDropout)
                    (SAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GCrossAttention
                    (CAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          (DropoutF style hasDropout)))
                    (CADropoutF style hasDropout)
                    (CAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style hasDropout)
                    (FFNOutputProjectionF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNOutputDropoutF style hasDropout)
                    (FFNOutputLayerNormF
                       style gradient device dataType decoderInputEmbedDim))))))
</span><a href="#local-6989586621679719249"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDFinalLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679719228"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SHasDropout hasDropout
-&gt; ModelSpec (TDFinalDropoutF style hasDropout)
</span><a href="#local-6989586621679719210"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719349"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719337"><span class="hs-identifier hs-var">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-604"></span><span>    </span><span class="annot"><a href="#local-6989586621679719246"><span class="hs-identifier hs-type">stackSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-605"></span><span>    </span><span id="local-6989586621679719246"><span class="annot"><span class="annottext">stackSpec' :: STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (SADropoutF style hasDropout)
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       (DropoutF style hasDropout)))
                 (CADropoutF style hasDropout)
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style hasDropout)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNOutputDropoutF style hasDropout)
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679719246"><span class="hs-identifier hs-var hs-var">stackSpec'</span></a></span></span><span> </span><span id="local-6989586621679719189"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719189"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim decoderInputEmbedDim
-&gt; SDim encoderOutputEmbedDim
-&gt; SDim ffnDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (DecoderStackF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        decoderInputEmbedDim
        encoderOutputEmbedDim
        ffnDim
        hasDropout)
forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (keyEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim keyEmbedDim
-&gt; SDim ffnDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (DecoderStackF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        queryEmbedDim
        keyEmbedDim
        ffnDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#decoderStackSpec"><span class="hs-identifier hs-var">decoderStackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679719189"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679719348"><span class="hs-identifier hs-var">numLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719347"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719346"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719345"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719344"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679719343"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679719342"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim decoderInputEmbedDim
</span><a href="#local-6989586621679719341"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim encoderOutputEmbedDim
</span><a href="#local-6989586621679719340"><span class="hs-identifier hs-var">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679719339"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679719337"><span class="hs-identifier hs-var">hasDropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719336"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719335"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><a href="#local-6989586621679719292"><span class="hs-identifier hs-type">layerNormSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-607"></span><span>    </span><span id="local-6989586621679719292"><span class="annot"><span class="annottext">layerNormSpec' :: SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679719292"><span class="hs-identifier hs-var hs-var">layerNormSpec'</span></a></span></span><span> </span><span id="local-6989586621679719188"><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679719188"><span class="hs-identifier hs-var">hasBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[decoderInputEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679719188"><span class="hs-identifier hs-var">hasBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719347"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719346"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719345"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[decoderInputEmbedDim]
-&gt; SShape ('Shape '[decoderInputEmbedDim])
forall (index :: [Dim (Name Symbol) (Size Nat)]).
SList index -&gt; SShape ('Shape index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[decoderInputEmbedDim]
 -&gt; SShape ('Shape '[decoderInputEmbedDim]))
-&gt; SList '[decoderInputEmbedDim]
-&gt; SShape ('Shape '[decoderInputEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sing decoderInputEmbedDim
SDim decoderInputEmbedDim
</span><a href="#local-6989586621679719341"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">Sing decoderInputEmbedDim
-&gt; SList '[] -&gt; SList '[decoderInputEmbedDim]
forall {a1} (a2 :: a1) (as :: [a1]).
Sing a2 -&gt; SList as -&gt; SList (a2 : as)
</span><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679719335"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-608"></span><span>    </span><span id="local-6989586621679719312"><span class="annot"><span class="annottext">relPosEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679719312"><span class="hs-identifier hs-var hs-var">relPosEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim headDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719347"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (index :: LayoutType).
SLayoutType index -&gt; SLayout ('Layout index)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719346"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719345"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719338"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679719344"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span id="local-6989586621679719329"><span class="annot"><span class="annottext">posEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679719329"><span class="hs-identifier hs-var hs-var">posEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim decoderInputEmbedDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679719347"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (index :: LayoutType).
SLayoutType index -&gt; SLayout ('Layout index)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679719346"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679719345"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679719338"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim decoderInputEmbedDim
</span><a href="#local-6989586621679719341"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/5fimh704vh0dpf8xfhffyiz4vcnc02i2-singletons-base-lib-singletons-base-3.0-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span id="local-6989586621679720613"><span id="local-6989586621679720614"><span id="local-6989586621679720615"><span id="local-6989586621679720616"><span id="local-6989586621679720617"><span id="local-6989586621679720618"><span id="local-6989586621679720619"><span id="local-6989586621679720620"><span id="local-6989586621679720621"><span id="local-6989586621679720622"><span id="local-6989586621679720623"><span id="local-6989586621679720624"><span id="local-6989586621679720625"><span id="local-6989586621679720626"><span id="local-6989586621679720627"><span id="local-6989586621679720628"><span id="local-6989586621679720629"><span id="local-6989586621679720630"><span id="local-6989586621679720631"><span id="local-6989586621679720632"><span id="local-6989586621679720633"><span id="local-6989586621679720634"><span class="hs-keyword">instance</span><span>
</span><span id="line-612"></span><span>  </span><span id="local-6989586621679719186"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720634"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720633"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720632"><span class="hs-identifier hs-type">posEnc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720631"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720630"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720631"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720629"><span class="hs-identifier hs-type">relPosEnc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720628"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-614"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720627"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720628"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720626"><span class="hs-identifier hs-type">initialLayerNorm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720625"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-615"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720624"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720625"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720623"><span class="hs-identifier hs-type">initialDropout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720622"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720621"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720622"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720620"><span class="hs-identifier hs-type">stack'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720619"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720618"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720619"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720617"><span class="hs-identifier hs-type">finalLayerNorm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720616"><span class="hs-identifier hs-type">generatorDevice5</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720615"><span class="hs-identifier hs-type">finalDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720616"><span class="hs-identifier hs-type">generatorDevice5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720614"><span class="hs-identifier hs-type">finalDropout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720613"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-620"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-621"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720634"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720630"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720627"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720624"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720621"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720618"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720615"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><a href="#local-6989586621679720633"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720632"><span class="hs-identifier hs-type">posEnc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720629"><span class="hs-identifier hs-type">relPosEnc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720626"><span class="hs-identifier hs-type">initialLayerNorm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720623"><span class="hs-identifier hs-type">initialDropout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720620"><span class="hs-identifier hs-type">stack'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720617"><span class="hs-identifier hs-type">finalLayerNorm'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720614"><span class="hs-identifier hs-type">finalDropout'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>    </span><span class="annot"><a href="#local-6989586621679720613"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span id="local-6989586621679720603"><span id="local-6989586621679720604"><span id="local-6989586621679720605"><span id="local-6989586621679720606"><span id="local-6989586621679720607"><span id="local-6989586621679720608"><span id="local-6989586621679720609"><span class="hs-keyword">instance</span><span>
</span><span id="line-627"></span><span>  </span><span id="local-6989586621679719181"><span id="local-6989586621679719183"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720609"><span class="hs-identifier hs-type">posEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-628"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720608"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720607"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720606"><span class="hs-identifier hs-type">initialDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-631"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720605"><span class="hs-identifier hs-type">stack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-632"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720604"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-633"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720603"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720609"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720608"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720607"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720606"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720605"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720604"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720603"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-636"></span><span>
</span><span id="line-637"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in an encoder configuration</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- with absolute positional encoding rather than relative positional encoding.</span><span>
</span><span id="line-639"></span><span class="hs-comment">--</span><span>
</span><span id="line-640"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-641"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- &#9474; input &#9474;  &#9474; pos &#9474;  &#9474; attentionMask &#9474;</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-644"></span><span class="hs-comment">--     &#9474;         &#9474;             &#9474;</span><span>
</span><span id="line-645"></span><span class="hs-comment">--     &#9474;         &#9660;             &#9474;</span><span>
</span><span id="line-646"></span><span class="hs-comment">--     &#9474;      tPosEnc          &#9474;</span><span>
</span><span id="line-647"></span><span class="hs-comment">--     &#9474;         &#9474;             &#9474;</span><span>
</span><span id="line-648"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9496;             &#9474;</span><span>
</span><span id="line-649"></span><span class="hs-comment">--          &#9474;                  &#9474;</span><span>
</span><span id="line-650"></span><span class="hs-comment">--          &#9660;                  &#9474;</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- (tInitialLayerNorm)         &#9474;</span><span>
</span><span id="line-652"></span><span class="hs-comment">--          &#9660;                  &#9660;</span><span>
</span><span id="line-653"></span><span class="hs-comment">--  (tInitialDropout)     unsqueeze</span><span>
</span><span id="line-654"></span><span class="hs-comment">--          &#9660;                  &#9474;</span><span>
</span><span id="line-655"></span><span class="hs-comment">--       tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-656"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-657"></span><span class="hs-comment">--  (tFinalLayerNorm)</span><span>
</span><span id="line-658"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-659"></span><span class="hs-comment">--   (tFinalDropout)</span><span>
</span><span id="line-660"></span><span class="hs-comment">--          &#9474;</span><span>
</span><span id="line-661"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-662"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-663"></span><span class="hs-comment">--     &#9474; output &#9474;</span><span>
</span><span id="line-664"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-666"></span><span id="local-6989586621679720512"><span id="local-6989586621679720513"><span id="local-6989586621679720514"><span id="local-6989586621679720515"><span id="local-6989586621679720516"><span id="local-6989586621679720517"><span id="local-6989586621679720518"><span id="local-6989586621679720519"><span id="local-6989586621679720520"><span id="local-6989586621679720521"><span id="local-6989586621679720522"><span id="local-6989586621679720523"><span id="local-6989586621679720524"><span id="local-6989586621679720525"><span id="local-6989586621679720526"><span id="local-6989586621679720527"><span id="local-6989586621679720528"><span id="local-6989586621679720529"><span id="local-6989586621679720530"><span id="local-6989586621679720531"><span id="local-6989586621679720532"><span id="local-6989586621679720533"><span id="local-6989586621679720534"><span id="local-6989586621679720535"><span id="local-6989586621679720536"><span id="local-6989586621679720537"><span id="local-6989586621679720538"><span id="local-6989586621679720539"><span id="local-6989586621679720540"><span id="local-6989586621679720541"><span id="local-6989586621679720542"><span id="local-6989586621679720543"><span id="local-6989586621679720544"><span id="local-6989586621679720545"><span id="local-6989586621679720546"><span id="local-6989586621679720547"><span id="local-6989586621679720548"><span id="local-6989586621679720549"><span class="hs-keyword">instance</span><span>
</span><span id="line-667"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span class="annot"><a href="#local-6989586621679720549"><span class="hs-identifier hs-type">posEnc</span></a></span><span>
</span><span id="line-669"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720548"><span class="hs-identifier hs-type">posGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720547"><span class="hs-identifier hs-type">posLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720546"><span class="hs-identifier hs-type">posDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720545"><span class="hs-identifier hs-type">posDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720544"><span class="hs-identifier hs-type">posShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>      </span><span class="annot"><a href="#local-6989586621679720543"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-671"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720542"><span class="hs-identifier hs-type">posEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720541"><span class="hs-identifier hs-type">posEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720540"><span class="hs-identifier hs-type">posEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720539"><span class="hs-identifier hs-type">posEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720538"><span class="hs-identifier hs-type">posEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>      </span><span class="annot"><a href="#local-6989586621679720537"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-673"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-674"></span><span>      </span><span class="annot"><a href="#local-6989586621679720536"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-675"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-676"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720535"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720542"><span class="hs-identifier hs-type">posEncGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-677"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720534"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720541"><span class="hs-identifier hs-type">posEncLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720533"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720540"><span class="hs-identifier hs-type">posEncDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720532"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720539"><span class="hs-identifier hs-type">posEncDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720531"><span class="hs-identifier hs-type">inputShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720538"><span class="hs-identifier hs-type">posEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-682"></span><span>      </span><span class="annot"><a href="#local-6989586621679720537"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-683"></span><span>      </span><span class="annot"><a href="#local-6989586621679720530"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-684"></span><span>      </span><span class="annot"><a href="#local-6989586621679720529"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-685"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720531"><span class="hs-identifier hs-type">inputShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720538"><span class="hs-identifier hs-type">posEncShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-686"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><a href="#local-6989586621679720528"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-688"></span><span>      </span><span class="annot"><a href="#local-6989586621679720530"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-689"></span><span>      </span><span class="annot"><a href="#local-6989586621679720529"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-690"></span><span>      </span><span class="annot"><a href="#local-6989586621679720527"><span class="hs-identifier hs-type">tensor2</span></a></span><span>
</span><span id="line-691"></span><span>      </span><span class="annot"><a href="#local-6989586621679720526"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-692"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-693"></span><span>      </span><span class="annot"><a href="#local-6989586621679720525"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-694"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679720527"><span class="hs-identifier hs-type">tensor2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-695"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-696"></span><span>          </span><span class="annot"><a href="#local-6989586621679720524"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span>
</span><span id="line-697"></span><span>          </span><span class="annot"><a href="#local-6989586621679720523"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span>
</span><span id="line-698"></span><span>          </span><span class="annot"><a href="#local-6989586621679720522"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span>
</span><span id="line-699"></span><span>          </span><span class="annot"><a href="#local-6989586621679720521"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span>
</span><span id="line-700"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720520"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>      </span><span class="annot"><a href="#local-6989586621679720526"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-703"></span><span>      </span><span class="annot"><a href="#local-6989586621679720519"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-704"></span><span>      </span><span class="annot"><a href="#local-6989586621679720518"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-705"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720520"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-707"></span><span>      </span><span class="annot"><a href="#local-6989586621679720517"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-708"></span><span>      </span><span class="annot"><a href="#local-6989586621679720519"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-709"></span><span>      </span><span class="annot"><a href="#local-6989586621679720518"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-710"></span><span>      </span><span class="annot"><a href="#local-6989586621679720516"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-711"></span><span>      </span><span class="annot"><a href="#local-6989586621679720515"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-712"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-713"></span><span>      </span><span class="annot"><a href="#local-6989586621679720514"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-714"></span><span>      </span><span class="annot"><a href="#local-6989586621679720516"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-715"></span><span>      </span><span class="annot"><a href="#local-6989586621679720515"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-716"></span><span>      </span><span class="annot"><a href="#local-6989586621679720513"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-717"></span><span>      </span><span class="annot"><a href="#local-6989586621679720512"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-718"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-719"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720549"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720536"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720528"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720525"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720517"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720514"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720535"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720534"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720533"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720532"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720531"><span class="hs-identifier hs-type">inputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720548"><span class="hs-identifier hs-type">posGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720547"><span class="hs-identifier hs-type">posLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720546"><span class="hs-identifier hs-type">posDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720545"><span class="hs-identifier hs-type">posDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720544"><span class="hs-identifier hs-type">posShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-723"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720524"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720523"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720522"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720521"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720520"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span>
</span><span id="line-724"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><a href="#local-6989586621679720543"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-726"></span><span>    </span><span class="annot"><a href="#local-6989586621679720513"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-727"></span><span>    </span><span class="annot"><a href="#local-6989586621679720512"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-728"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-729"></span><span>  </span><span id="local-6989586621679719111"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GTransformer
  posEnc
  ()
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape,
    Tensor posGradient posLayout posDevice posDataType posShape,
    Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      attentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679719103"><span id="local-6989586621679719104"><span id="local-6989586621679719105"><span id="local-6989586621679719106"><span id="local-6989586621679719107"><span id="local-6989586621679719108"><span id="local-6989586621679719109"><span class="annot"><span class="annottext">posEnc
initialLayerNorm
initialDropout
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: ()
tPosEnc :: posEnc
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679719103"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679719102"><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679719102"><span class="hs-identifier hs-var">input</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719101"><span class="annot"><span class="annottext">Tensor posGradient posLayout posDevice posDataType posShape
</span><a href="#local-6989586621679719101"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679719100"><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679719100"><span class="hs-identifier hs-var">attentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-730"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679719099"><span class="annot"><span class="annottext">attentionBias :: IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
</span><a href="#local-6989586621679719099"><span class="hs-identifier hs-var hs-var">attentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        attentionMaskGradient
        attentionMaskLayout
        attentionMaskDevice
        attentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         attentionMaskGradient
         attentionMaskLayout
         attentionMaskDevice
         attentionMaskDataType
         (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
-&gt; m (Tensor
        attentionMaskGradient
        attentionMaskLayout
        attentionMaskDevice
        attentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        attentionMaskGradient
        attentionMaskLayout
        attentionMaskDevice
        attentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ UnsqueezeF selectDim shape, Catch shape',
 SingI selectDim, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679719100"><span class="hs-identifier hs-var">attentionMask</span></a></span><span>
</span><span id="line-731"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-732"></span><span>          </span><span class="annot"><span class="annottext">Tensor posGradient posLayout posDevice posDataType posShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor posGradient posLayout posDevice posDataType posShape)
forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor posGradient posLayout posDevice posDataType posShape
</span><a href="#local-6989586621679719101"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-733"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor posGradient posLayout posDevice posDataType posShape)
-&gt; (Tensor posGradient posLayout posDevice posDataType posShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice0)
         (Tensor
            posEncGradient
            posEncLayout
            posEncDevice
            posEncDataType
            posEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         posEncGradient
         posEncLayout
         posEncDevice
         posEncDataType
         posEncShape,
       Generator generatorDevice0))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          posEncGradient
          posEncLayout
          posEncDevice
          posEncDataType
          posEncShape,
        Generator generatorDevice0))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice0)
      (Tensor
         posEncGradient
         posEncLayout
         posEncDevice
         posEncDataType
         posEncShape))
-&gt; (Tensor posGradient posLayout posDevice posDataType posShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            posEncGradient
            posEncLayout
            posEncDevice
            posEncDataType
            posEncShape,
          Generator generatorDevice0))
-&gt; Tensor posGradient posLayout posDevice posDataType posShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">posEnc
-&gt; Tensor posGradient posLayout posDevice posDataType posShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape,
      Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">posEnc
</span><a href="#local-6989586621679719109"><span class="hs-identifier hs-var">tPosEnc</span></a></span><span>
</span><span id="line-734"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     posEncGradient
     posEncLayout
     posEncDevice
     posEncDataType
     posEncShape)
-&gt; (Tensor
      posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice0)
         (Tensor
            (Or (Gradient RequiresGradient) inputGradient posEncGradient)
            (Unify (Layout LayoutType) inputLayout posEncLayout)
            (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
            (Unify (DataType DType) inputDataType posEncDataType)
            (BroadcastShapesF inputShape posEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        (Or (Gradient RequiresGradient) inputGradient posEncGradient)
        (Unify (Layout LayoutType) inputLayout posEncLayout)
        (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
        (Unify (DataType DType) inputDataType posEncDataType)
        (BroadcastShapesF inputShape posEncShape))
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     (Or (Gradient RequiresGradient) inputGradient posEncGradient)
     (Unify (Layout LayoutType) inputLayout posEncLayout)
     (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
     (Unify (DataType DType) inputDataType posEncDataType)
     (BroadcastShapesF inputShape posEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or (Gradient RequiresGradient) inputGradient posEncGradient)
        (Unify (Layout LayoutType) inputLayout posEncLayout)
        (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
        (Unify (DataType DType) inputDataType posEncDataType)
        (BroadcastShapesF inputShape posEncShape))
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      (Or (Gradient RequiresGradient) inputGradient posEncGradient)
      (Unify (Layout LayoutType) inputLayout posEncLayout)
      (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
      (Unify (DataType DType) inputDataType posEncDataType)
      (BroadcastShapesF inputShape posEncShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice0)
      (Tensor
         (Or (Gradient RequiresGradient) inputGradient posEncGradient)
         (Unify (Layout LayoutType) inputLayout posEncLayout)
         (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
         (Unify (DataType DType) inputDataType posEncDataType)
         (BroadcastShapesF inputShape posEncShape)))
-&gt; (Tensor
      posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) inputGradient posEncGradient)
            (Unify (Layout LayoutType) inputLayout posEncLayout)
            (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
            (Unify (DataType DType) inputDataType posEncDataType)
            (BroadcastShapesF inputShape posEncShape)))
-&gt; Tensor
     posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or (Gradient RequiresGradient) inputGradient posEncGradient)
        (Unify (Layout LayoutType) inputLayout posEncLayout)
        (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
        (Unify (DataType DType) inputDataType posEncDataType)
        (BroadcastShapesF inputShape posEncShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679719102"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; Tensor
     posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
-&gt; m (Tensor
        (inputGradient &lt;|&gt; posEncGradient)
        (inputLayout &lt;+&gt; posEncLayout)
        (inputDevice &lt;+&gt; posEncDevice)
        (inputDataType &lt;+&gt; posEncDataType)
        (BroadcastShapesF inputShape posEncShape))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape'' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(MonadThrow m, shape'' ~ BroadcastShapesF shape shape',
 Catch shape'') =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; m (Tensor
        (gradient &lt;|&gt; gradient')
        (layout &lt;+&gt; layout')
        (device &lt;+&gt; device')
        (dataType &lt;+&gt; dataType')
        shape'')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-735"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     (Or (Gradient RequiresGradient) inputGradient posEncGradient)
     (Unify (Layout LayoutType) inputLayout posEncLayout)
     (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
     (Unify (DataType DType) inputDataType posEncDataType)
     (BroadcastShapesF inputShape posEncShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) inputGradient posEncGradient)
      (Unify (Layout LayoutType) inputLayout posEncLayout)
      (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
      (Unify (DataType DType) inputDataType posEncDataType)
      (BroadcastShapesF inputShape posEncShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (Tensor
      (Or (Gradient RequiresGradient) inputGradient posEncGradient)
      (Unify (Layout LayoutType) inputLayout posEncLayout)
      (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
      (Unify (DataType DType) inputDataType posEncDataType)
      (BroadcastShapesF inputShape posEncShape)
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; Tensor
     (Or (Gradient RequiresGradient) inputGradient posEncGradient)
     (Unify (Layout LayoutType) inputLayout posEncLayout)
     (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
     (Unify (DataType DType) inputDataType posEncDataType)
     (BroadcastShapesF inputShape posEncShape)
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     (Or (Gradient RequiresGradient) inputGradient posEncGradient)
     (Unify (Layout LayoutType) inputLayout posEncLayout)
     (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
     (Unify (DataType DType) inputDataType posEncDataType)
     (BroadcastShapesF inputShape posEncShape)
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679719107"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-736"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         tensor2)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice2) tensor2
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (tensor2, Generator generatorDevice2))
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (tensor2, Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      tensor2)
-&gt; (tensor1
    -&gt; Generator generatorDevice1
    -&gt; m (tensor2, Generator generatorDevice2))
-&gt; tensor1
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor1
-&gt; Generator generatorDevice1
-&gt; m (tensor2, Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679719106"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-737"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice2) tensor2
-&gt; (tensor2
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679719095"><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679719095"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-738"></span><span>                     </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
</span><a href="#local-6989586621679719099"><span class="hs-identifier hs-var">attentionBias</span></a></span><span>
</span><span id="line-739"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
-&gt; (Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679719094"><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
</span><a href="#local-6989586621679719094"><span class="hs-identifier hs-var">attentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-740"></span><span>                                </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">stack
-&gt; (tensor2,
    Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679719105"><span class="hs-identifier hs-var">tStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679719095"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
</span><a href="#local-6989586621679719094"><span class="hs-identifier hs-var">attentionBias'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-741"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-742"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-743"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679719104"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-744"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679719103"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-745"></span><span>
</span><span id="line-746"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in an encoder configuration</span><span>
</span><span id="line-747"></span><span class="hs-comment">-- with relative positional encoding rather than absolute positional encoding.</span><span>
</span><span id="line-748"></span><span class="hs-comment">--</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-750"></span><span class="hs-comment">--      &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-751"></span><span class="hs-comment">--      &#9474; input &#9474;  &#9474; relPos &#9474;  &#9474; attentionMask &#9474;</span><span>
</span><span id="line-752"></span><span class="hs-comment">--      &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-753"></span><span class="hs-comment">--          &#9474;          &#9474;               &#9474;</span><span>
</span><span id="line-754"></span><span class="hs-comment">--          &#9474;          &#9660;               &#9474;</span><span>
</span><span id="line-755"></span><span class="hs-comment">--          &#9474;     tRelPosEnc           &#9474;</span><span>
</span><span id="line-756"></span><span class="hs-comment">--          &#9474;          &#9660;               &#9474;</span><span>
</span><span id="line-757"></span><span class="hs-comment">--          &#9474;      transpose           &#9474;</span><span>
</span><span id="line-758"></span><span class="hs-comment">--          &#9474;          &#9660;               &#9660;</span><span>
</span><span id="line-759"></span><span class="hs-comment">--          &#9474;      transpose       unsqueeze</span><span>
</span><span id="line-760"></span><span class="hs-comment">--          &#9660;          &#9474;               &#9474;</span><span>
</span><span id="line-761"></span><span class="hs-comment">-- (tInitialLayerNorm) &#9474;               &#9474;</span><span>
</span><span id="line-762"></span><span class="hs-comment">--          &#9660;          &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-763"></span><span class="hs-comment">--  (tInitialDropout)          &#9474;</span><span>
</span><span id="line-764"></span><span class="hs-comment">--          &#9660;                  &#9474;</span><span>
</span><span id="line-765"></span><span class="hs-comment">--       tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-766"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-767"></span><span class="hs-comment">--  (tFinalLayerNorm)</span><span>
</span><span id="line-768"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-769"></span><span class="hs-comment">--   (tFinalDropout)</span><span>
</span><span id="line-770"></span><span class="hs-comment">--          &#9474;</span><span>
</span><span id="line-771"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-772"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-773"></span><span class="hs-comment">--     &#9474; output &#9474;</span><span>
</span><span id="line-774"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-776"></span><span id="local-6989586621679720368"><span id="local-6989586621679720369"><span id="local-6989586621679720370"><span id="local-6989586621679720371"><span id="local-6989586621679720372"><span id="local-6989586621679720373"><span id="local-6989586621679720374"><span id="local-6989586621679720375"><span id="local-6989586621679720376"><span id="local-6989586621679720377"><span id="local-6989586621679720378"><span id="local-6989586621679720379"><span id="local-6989586621679720380"><span id="local-6989586621679720381"><span id="local-6989586621679720382"><span id="local-6989586621679720383"><span id="local-6989586621679720384"><span id="local-6989586621679720385"><span id="local-6989586621679720386"><span id="local-6989586621679720387"><span id="local-6989586621679720388"><span id="local-6989586621679720389"><span id="local-6989586621679720390"><span id="local-6989586621679720391"><span id="local-6989586621679720392"><span id="local-6989586621679720393"><span id="local-6989586621679720394"><span id="local-6989586621679720395"><span id="local-6989586621679720396"><span id="local-6989586621679720397"><span id="local-6989586621679720398"><span id="local-6989586621679720399"><span id="local-6989586621679720400"><span id="local-6989586621679720401"><span id="local-6989586621679720402"><span id="local-6989586621679720403"><span id="local-6989586621679720404"><span id="local-6989586621679720405"><span id="local-6989586621679720406"><span id="local-6989586621679720407"><span id="local-6989586621679720408"><span class="hs-keyword">instance</span><span>
</span><span id="line-777"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-778"></span><span>      </span><span class="annot"><a href="#local-6989586621679720408"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-779"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720407"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720406"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720405"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720404"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720403"><span class="hs-identifier hs-type">inputShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>      </span><span class="annot"><a href="#local-6989586621679720402"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-781"></span><span>      </span><span class="annot"><a href="#local-6989586621679720401"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-782"></span><span>      </span><span class="annot"><a href="#local-6989586621679720400"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-783"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-784"></span><span>      </span><span class="annot"><a href="#local-6989586621679720399"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-785"></span><span>      </span><span class="annot"><a href="#local-6989586621679720401"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-786"></span><span>      </span><span class="annot"><a href="#local-6989586621679720400"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-787"></span><span>      </span><span class="annot"><a href="#local-6989586621679720398"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-788"></span><span>      </span><span class="annot"><a href="#local-6989586621679720397"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-789"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-790"></span><span>      </span><span class="annot"><a href="#local-6989586621679720396"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720395"><span class="hs-identifier hs-type">relPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720394"><span class="hs-identifier hs-type">relPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720393"><span class="hs-identifier hs-type">relPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720392"><span class="hs-identifier hs-type">relPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720391"><span class="hs-identifier hs-type">relPosShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>      </span><span class="annot"><a href="#local-6989586621679720397"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-793"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720390"><span class="hs-identifier hs-type">relPosEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720389"><span class="hs-identifier hs-type">relPosEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720388"><span class="hs-identifier hs-type">relPosEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720387"><span class="hs-identifier hs-type">relPosEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720386"><span class="hs-identifier hs-type">relPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-794"></span><span>      </span><span class="annot"><a href="#local-6989586621679720385"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-795"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-796"></span><span>      </span><span class="annot"><a href="#local-6989586621679720384"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-797"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679720398"><span class="hs-identifier hs-type">tensor1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-798"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-799"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720390"><span class="hs-identifier hs-type">relPosEncGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720383"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720389"><span class="hs-identifier hs-type">relPosEncLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720382"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-801"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720388"><span class="hs-identifier hs-type">relPosEncDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720381"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720387"><span class="hs-identifier hs-type">relPosEncDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720380"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720379"><span class="hs-identifier hs-type">doubleTransposedRelPosEncShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720378"><span class="hs-identifier hs-type">unsqueezedAttentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-804"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>      </span><span class="annot"><a href="#local-6989586621679720385"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-806"></span><span>      </span><span class="annot"><a href="#local-6989586621679720377"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-807"></span><span>      </span><span class="annot"><a href="#local-6989586621679720376"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-808"></span><span>    </span><span class="annot"><a href="#local-6989586621679720375"><span class="hs-identifier hs-type">transposedRelPosEncShape</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720386"><span class="hs-identifier hs-type">relPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-809"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720375"><span class="hs-identifier hs-type">transposedRelPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-810"></span><span>    </span><span class="annot"><a href="#local-6989586621679720379"><span class="hs-identifier hs-type">doubleTransposedRelPosEncShape</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720375"><span class="hs-identifier hs-type">transposedRelPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-811"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720379"><span class="hs-identifier hs-type">doubleTransposedRelPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-812"></span><span>    </span><span class="annot"><a href="#local-6989586621679720378"><span class="hs-identifier hs-type">unsqueezedAttentionMaskShape</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720374"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-813"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720378"><span class="hs-identifier hs-type">unsqueezedAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-814"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720379"><span class="hs-identifier hs-type">doubleTransposedRelPosEncShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720378"><span class="hs-identifier hs-type">unsqueezedAttentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-815"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-816"></span><span>      </span><span class="annot"><a href="#local-6989586621679720373"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-817"></span><span>      </span><span class="annot"><a href="#local-6989586621679720377"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-818"></span><span>      </span><span class="annot"><a href="#local-6989586621679720376"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-819"></span><span>      </span><span class="annot"><a href="#local-6989586621679720372"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-820"></span><span>      </span><span class="annot"><a href="#local-6989586621679720371"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-821"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-822"></span><span>      </span><span class="annot"><a href="#local-6989586621679720370"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-823"></span><span>      </span><span class="annot"><a href="#local-6989586621679720372"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-824"></span><span>      </span><span class="annot"><a href="#local-6989586621679720371"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-825"></span><span>      </span><span class="annot"><a href="#local-6989586621679720369"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-826"></span><span>      </span><span class="annot"><a href="#local-6989586621679720368"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-827"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-828"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-829"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720396"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720408"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720399"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720384"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720373"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720370"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-830"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720407"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720406"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720405"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720404"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720403"><span class="hs-identifier hs-type">inputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-831"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720395"><span class="hs-identifier hs-type">relPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720394"><span class="hs-identifier hs-type">relPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720393"><span class="hs-identifier hs-type">relPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720392"><span class="hs-identifier hs-type">relPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720391"><span class="hs-identifier hs-type">relPosShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-832"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720383"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720382"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720381"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720380"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720374"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span>
</span><span id="line-833"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><a href="#local-6989586621679720402"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-835"></span><span>    </span><span class="annot"><a href="#local-6989586621679720369"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="#local-6989586621679720368"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-837"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-838"></span><span>  </span><span id="local-6989586621679719000"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GTransformer
  ()
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape,
    Tensor
      relPosGradient
      relPosLayout
      relPosDevice
      relPosDataType
      relPosShape,
    Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      attentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679719000"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718993"><span id="local-6989586621679718994"><span id="local-6989586621679718995"><span id="local-6989586621679718996"><span id="local-6989586621679718997"><span id="local-6989586621679718998"><span id="local-6989586621679718999"><span class="annot"><span class="annottext">initialLayerNorm
initialDropout
relPosEnc
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: relPosEnc
tPosEnc :: ()
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679718993"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718992"><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679718992"><span class="hs-identifier hs-var">input</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718991"><span class="annot"><span class="annottext">Tensor
  relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
</span><a href="#local-6989586621679718991"><span class="hs-identifier hs-var">relPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718990"><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679718990"><span class="hs-identifier hs-var">attentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-839"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718989"><span class="annot"><span class="annottext">relPosBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     doubleTransposedRelPosEncShape)
</span><a href="#local-6989586621679718989"><span class="hs-identifier hs-var hs-var">relPosBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-840"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice1)
     (Tensor
        relPosGradient
        relPosLayout
        relPosDevice
        relPosDataType
        relPosShape)
forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
</span><a href="#local-6989586621679718991"><span class="hs-identifier hs-var">relPos</span></a></span><span>
</span><span id="line-841"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice1)
  (Tensor
     relPosGradient
     relPosLayout
     relPosDevice
     relPosDataType
     relPosShape)
-&gt; (Tensor
      relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            relPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         relPosEncShape,
       Generator generatorDevice2))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (Tensor
          relPosEncGradient
          relPosEncLayout
          relPosEncDevice
          relPosEncDataType
          relPosEncShape,
        Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         relPosEncShape))
-&gt; (Tensor
      relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
    -&gt; Generator generatorDevice1
    -&gt; m (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            relPosEncShape,
          Generator generatorDevice2))
-&gt; Tensor
     relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">relPosEnc
-&gt; Tensor
     relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
-&gt; Generator generatorDevice1
-&gt; m (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape,
      Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">relPosEnc
</span><a href="#local-6989586621679718998"><span class="hs-identifier hs-var">tRelPosEnc</span></a></span><span>
</span><span id="line-842"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     relPosEncShape)
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      relPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            transposedRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        transposedRelPosEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     transposedRelPosEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        transposedRelPosEncShape)
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      transposedRelPosEncShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         transposedRelPosEncShape))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      relPosEncShape
    -&gt; m (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            transposedRelPosEncShape))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     relPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        transposedRelPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SSelectDim ('SelectDim ('ByIndex 2))
-&gt; SSelectDim ('SelectDim ('ByIndex 3))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     relPosEncShape
-&gt; m (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        transposedRelPosEncShape)
forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, Catch shape',
 MonadThrow m) =&gt;
SSelectDim selectDim0
-&gt; SSelectDim selectDim1
-&gt; Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sTranspose"><span class="hs-identifier hs-var">sTranspose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBy ('ByIndex 2) -&gt; SSelectDim ('SelectDim ('ByIndex 2))
forall (index :: By Symbol Nat).
SBy index -&gt; SSelectDim ('SelectDim index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">(SBy ('ByIndex 2) -&gt; SSelectDim ('SelectDim ('ByIndex 2)))
-&gt; SBy ('ByIndex 2) -&gt; SSelectDim ('SelectDim ('ByIndex 2))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBy ('ByIndex 3) -&gt; SSelectDim ('SelectDim ('ByIndex 3))
forall (index :: By Symbol Nat).
SBy index -&gt; SSelectDim ('SelectDim index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">(SBy ('ByIndex 3) -&gt; SSelectDim ('SelectDim ('ByIndex 3)))
-&gt; SBy ('ByIndex 3) -&gt; SSelectDim ('SelectDim ('ByIndex 3))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span>
</span><span id="line-843"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     transposedRelPosEncShape)
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      transposedRelPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            doubleTransposedRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        doubleTransposedRelPosEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     doubleTransposedRelPosEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        doubleTransposedRelPosEncShape)
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      doubleTransposedRelPosEncShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         doubleTransposedRelPosEncShape))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      transposedRelPosEncShape
    -&gt; m (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            doubleTransposedRelPosEncShape))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     transposedRelPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        doubleTransposedRelPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SSelectDim ('SelectDim ('ByIndex 1))
-&gt; SSelectDim ('SelectDim ('ByIndex 2))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     transposedRelPosEncShape
-&gt; m (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        doubleTransposedRelPosEncShape)
forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, Catch shape',
 MonadThrow m) =&gt;
SSelectDim selectDim0
-&gt; SSelectDim selectDim1
-&gt; Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sTranspose"><span class="hs-identifier hs-var">sTranspose</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1))
forall (index :: By Symbol Nat).
SBy index -&gt; SSelectDim ('SelectDim index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">(SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1)))
-&gt; SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBy ('ByIndex 2) -&gt; SSelectDim ('SelectDim ('ByIndex 2))
forall (index :: By Symbol Nat).
SBy index -&gt; SSelectDim ('SelectDim index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">(SBy ('ByIndex 2) -&gt; SSelectDim ('SelectDim ('ByIndex 2)))
-&gt; SBy ('ByIndex 2) -&gt; SSelectDim ('SelectDim ('ByIndex 2))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>        </span><span id="local-6989586621679718986"><span class="annot"><span class="annottext">attentionBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        relPosEncGradient
        attentionMaskGradient)
     (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
     (Unify
        (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
     (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
</span><a href="#local-6989586621679718986"><span class="hs-identifier hs-var hs-var">attentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-845"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     doubleTransposedRelPosEncShape)
</span><a href="#local-6989586621679718989"><span class="hs-identifier hs-var">relPosBias</span></a></span><span>
</span><span id="line-846"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     doubleTransposedRelPosEncShape)
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      doubleTransposedRelPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               relPosEncGradient
               attentionMaskGradient)
            (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
            (Unify
               (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
            (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     (Or
        (Gradient RequiresGradient)
        relPosEncGradient
        attentionMaskGradient)
     (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
     (Unify
        (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
     (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      (Or
         (Gradient RequiresGradient)
         relPosEncGradient
         attentionMaskGradient)
      (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
      (Unify
         (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
      (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
      (BroadcastShapesF
         doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            relPosEncGradient
            attentionMaskGradient)
         (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
         (Unify
            (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
         (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
         (BroadcastShapesF
            doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      doubleTransposedRelPosEncShape
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               relPosEncGradient
               attentionMaskGradient)
            (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
            (Unify
               (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
            (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     doubleTransposedRelPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SSelectDim ('SelectDim ('ByIndex 1))
-&gt; Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     attentionMaskShape
-&gt; m (Tensor
        attentionMaskGradient
        attentionMaskLayout
        attentionMaskDevice
        attentionMaskDataType
        unsqueezedAttentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ UnsqueezeF selectDim shape, Catch shape',
 MonadThrow m) =&gt;
SSelectDim selectDim
-&gt; Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sUnsqueeze"><span class="hs-identifier hs-var">sUnsqueeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1))
forall (index :: By Symbol Nat).
SBy index -&gt; SSelectDim ('SelectDim index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">(SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1)))
-&gt; SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679718990"><span class="hs-identifier hs-var">attentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     unsqueezedAttentionMaskShape)
-&gt; (Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      unsqueezedAttentionMaskShape
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               relPosEncGradient
               attentionMaskGradient)
            (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
            (Unify
               (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
            (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)))
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Tensor
    attentionMaskGradient
    attentionMaskLayout
    attentionMaskDevice
    attentionMaskDataType
    unsqueezedAttentionMaskShape
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             relPosEncGradient
             attentionMaskGradient)
          (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
          (Unify
             (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
          (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
          (BroadcastShapesF
             doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)))
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            relPosEncGradient
            attentionMaskGradient)
         (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
         (Unify
            (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
         (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
         (BroadcastShapesF
            doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      doubleTransposedRelPosEncShape
    -&gt; Tensor
         attentionMaskGradient
         attentionMaskLayout
         attentionMaskDevice
         attentionMaskDataType
         unsqueezedAttentionMaskShape
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               relPosEncGradient
               attentionMaskGradient)
            (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
            (Unify
               (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
            (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     doubleTransposedRelPosEncShape
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  relPosEncGradient
  relPosEncLayout
  relPosEncDevice
  relPosEncDataType
  doubleTransposedRelPosEncShape
-&gt; Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     unsqueezedAttentionMaskShape
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape'' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(MonadThrow m, shape'' ~ BroadcastShapesF shape shape',
 Catch shape'') =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; m (Tensor
        (gradient &lt;|&gt; gradient')
        (layout &lt;+&gt; layout')
        (device &lt;+&gt; device')
        (dataType &lt;+&gt; dataType')
        shape'')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier hs-var">add</span></a></span><span>
</span><span id="line-847"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-848"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        inputGradient inputLayout inputDevice inputDataType inputShape)
forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679718992"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-849"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     inputGradient inputLayout inputDevice inputDataType inputShape)
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape
    -&gt; IxStateT
         m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (tensor0, Generator generatorDevice0))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (tensor0, Generator generatorDevice0))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape
    -&gt; Generator generatorDevice
    -&gt; m (tensor0, Generator generatorDevice0))
-&gt; Tensor
     inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; Generator generatorDevice
-&gt; m (tensor0, Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679718997"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-850"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice0) tensor0
-&gt; (tensor0
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (tensor0
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; tensor0
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor0
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679718996"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-851"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679718985"><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679718985"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        relPosEncGradient
        attentionMaskGradient)
     (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
     (Unify
        (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
     (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
</span><a href="#local-6989586621679718986"><span class="hs-identifier hs-var">attentionBias</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        relPosEncGradient
        attentionMaskGradient)
     (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
     (Unify
        (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
     (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         relPosEncGradient
         attentionMaskGradient)
      (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
      (Unify
         (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
      (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
      (BroadcastShapesF
         doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679718984"><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     relPosEncGradient
     attentionMaskGradient)
  (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
  (Unify
     (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
  (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
  (BroadcastShapesF
     doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)
</span><a href="#local-6989586621679718984"><span class="hs-identifier hs-var">attentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">stack
-&gt; (tensor1,
    Tensor
      (Or
         (Gradient RequiresGradient)
         relPosEncGradient
         attentionMaskGradient)
      (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
      (Unify
         (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
      (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
      (BroadcastShapesF
         doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape))
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679718995"><span class="hs-identifier hs-var">tStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679718985"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     relPosEncGradient
     attentionMaskGradient)
  (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
  (Unify
     (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
  (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
  (BroadcastShapesF
     doubleTransposedRelPosEncShape unsqueezedAttentionMaskShape)
</span><a href="#local-6989586621679718984"><span class="hs-identifier hs-var">attentionBias'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-852"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679718994"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-853"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679718993"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in a decoder configuration</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- with absolute positional encoding rather than relative positional encoding.</span><span>
</span><span id="line-857"></span><span class="hs-comment">--</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-860"></span><span class="hs-comment">-- &#9474; decoderInput &#9474;  &#9474; decoderPos &#9474;  &#9474; encoderOutput &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-862"></span><span class="hs-comment">--        &#9474;                 &#9474;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-863"></span><span class="hs-comment">--        &#9474;                 &#9660;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-864"></span><span class="hs-comment">--        &#9474;             tdPosEnc             &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-865"></span><span class="hs-comment">--        &#9474;                 &#9474;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-866"></span><span class="hs-comment">--        &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-867"></span><span class="hs-comment">--                 &#9474;                         &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-868"></span><span class="hs-comment">--                 &#9660;                         &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-869"></span><span class="hs-comment">--        (tInitialLayerNorm)                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-870"></span><span class="hs-comment">--                 &#9660;                         &#9474;                     &#9660;                         &#9660;</span><span>
</span><span id="line-871"></span><span class="hs-comment">--         (tInitialDropout)                 &#9474;                 unsqueeze                 unsqueeze</span><span>
</span><span id="line-872"></span><span class="hs-comment">--                 &#9660;                         &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-873"></span><span class="hs-comment">--              tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-874"></span><span class="hs-comment">--                 &#9660;</span><span>
</span><span id="line-875"></span><span class="hs-comment">--         (tFinalLayerNorm)</span><span>
</span><span id="line-876"></span><span class="hs-comment">--                 &#9660;</span><span>
</span><span id="line-877"></span><span class="hs-comment">--          (tFinalDropout)</span><span>
</span><span id="line-878"></span><span class="hs-comment">--                 &#9474;</span><span>
</span><span id="line-879"></span><span class="hs-comment">--                 &#9660;</span><span>
</span><span id="line-880"></span><span class="hs-comment">--            &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-881"></span><span class="hs-comment">--            &#9474; output &#9474;</span><span>
</span><span id="line-882"></span><span class="hs-comment">--            &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-883"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-884"></span><span id="local-6989586621679720249"><span id="local-6989586621679720250"><span id="local-6989586621679720251"><span id="local-6989586621679720252"><span id="local-6989586621679720253"><span id="local-6989586621679720254"><span id="local-6989586621679720255"><span id="local-6989586621679720256"><span id="local-6989586621679720257"><span id="local-6989586621679720258"><span id="local-6989586621679720259"><span id="local-6989586621679720260"><span id="local-6989586621679720261"><span id="local-6989586621679720262"><span id="local-6989586621679720263"><span id="local-6989586621679720264"><span id="local-6989586621679720265"><span id="local-6989586621679720266"><span id="local-6989586621679720267"><span id="local-6989586621679720268"><span id="local-6989586621679720269"><span id="local-6989586621679720270"><span id="local-6989586621679720271"><span id="local-6989586621679720272"><span id="local-6989586621679720273"><span id="local-6989586621679720274"><span id="local-6989586621679720275"><span id="local-6989586621679720276"><span id="local-6989586621679720277"><span id="local-6989586621679720278"><span id="local-6989586621679720279"><span id="local-6989586621679720280"><span id="local-6989586621679720281"><span id="local-6989586621679720282"><span id="local-6989586621679720283"><span id="local-6989586621679720284"><span id="local-6989586621679720285"><span id="local-6989586621679720286"><span id="local-6989586621679720287"><span id="local-6989586621679720288"><span id="local-6989586621679720289"><span id="local-6989586621679720290"><span id="local-6989586621679720291"><span id="local-6989586621679720292"><span id="local-6989586621679720293"><span id="local-6989586621679720294"><span id="local-6989586621679720295"><span id="local-6989586621679720296"><span class="hs-keyword">instance</span><span>
</span><span id="line-885"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-886"></span><span>      </span><span class="annot"><a href="#local-6989586621679720296"><span class="hs-identifier hs-type">posEnc</span></a></span><span>
</span><span id="line-887"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720295"><span class="hs-identifier hs-type">decoderPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720294"><span class="hs-identifier hs-type">decoderPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720293"><span class="hs-identifier hs-type">decoderPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720292"><span class="hs-identifier hs-type">decoderPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720291"><span class="hs-identifier hs-type">decoderPosShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-888"></span><span>      </span><span class="annot"><a href="#local-6989586621679720290"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-889"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720289"><span class="hs-identifier hs-type">decoderPosEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720288"><span class="hs-identifier hs-type">decoderPosEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720287"><span class="hs-identifier hs-type">decoderPosEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720286"><span class="hs-identifier hs-type">decoderPosEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720285"><span class="hs-identifier hs-type">decoderPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-890"></span><span>      </span><span class="annot"><a href="#local-6989586621679720284"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-891"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-892"></span><span>      </span><span class="annot"><a href="#local-6989586621679720283"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-893"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-894"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720282"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720289"><span class="hs-identifier hs-type">decoderPosEncGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-895"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720281"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720288"><span class="hs-identifier hs-type">decoderPosEncLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-896"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720280"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720287"><span class="hs-identifier hs-type">decoderPosEncDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-897"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720279"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720286"><span class="hs-identifier hs-type">decoderPosEncDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720278"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720285"><span class="hs-identifier hs-type">decoderPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>      </span><span class="annot"><a href="#local-6989586621679720284"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-901"></span><span>      </span><span class="annot"><a href="#local-6989586621679720277"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-902"></span><span>      </span><span class="annot"><a href="#local-6989586621679720276"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-903"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-904"></span><span>      </span><span class="annot"><a href="#local-6989586621679720275"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-905"></span><span>      </span><span class="annot"><a href="#local-6989586621679720277"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-906"></span><span>      </span><span class="annot"><a href="#local-6989586621679720276"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-907"></span><span>      </span><span class="annot"><a href="#local-6989586621679720274"><span class="hs-identifier hs-type">tensor2</span></a></span><span>
</span><span id="line-908"></span><span>      </span><span class="annot"><a href="#local-6989586621679720273"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-909"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-910"></span><span>      </span><span class="annot"><a href="#local-6989586621679720272"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-911"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679720274"><span class="hs-identifier hs-type">tensor2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-912"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720271"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720270"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720269"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720268"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720267"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-913"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-914"></span><span>          </span><span class="annot"><a href="#local-6989586621679720266"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span>
</span><span id="line-915"></span><span>          </span><span class="annot"><a href="#local-6989586621679720265"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span>
</span><span id="line-916"></span><span>          </span><span class="annot"><a href="#local-6989586621679720264"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span>
</span><span id="line-917"></span><span>          </span><span class="annot"><a href="#local-6989586621679720263"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span>
</span><span id="line-918"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720262"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-919"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-920"></span><span>          </span><span class="annot"><a href="#local-6989586621679720261"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span>
</span><span id="line-921"></span><span>          </span><span class="annot"><a href="#local-6989586621679720260"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span>
</span><span id="line-922"></span><span>          </span><span class="annot"><a href="#local-6989586621679720259"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span>
</span><span id="line-923"></span><span>          </span><span class="annot"><a href="#local-6989586621679720258"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span>
</span><span id="line-924"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720257"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-926"></span><span>      </span><span class="annot"><a href="#local-6989586621679720273"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-927"></span><span>      </span><span class="annot"><a href="#local-6989586621679720256"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-928"></span><span>      </span><span class="annot"><a href="#local-6989586621679720255"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-929"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720262"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-930"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720257"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-931"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720278"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720285"><span class="hs-identifier hs-type">decoderPosEncShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-932"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-933"></span><span>      </span><span class="annot"><a href="#local-6989586621679720254"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-934"></span><span>      </span><span class="annot"><a href="#local-6989586621679720256"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-935"></span><span>      </span><span class="annot"><a href="#local-6989586621679720255"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-936"></span><span>      </span><span class="annot"><a href="#local-6989586621679720253"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-937"></span><span>      </span><span class="annot"><a href="#local-6989586621679720252"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-938"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-939"></span><span>      </span><span class="annot"><a href="#local-6989586621679720251"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-940"></span><span>      </span><span class="annot"><a href="#local-6989586621679720253"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-941"></span><span>      </span><span class="annot"><a href="#local-6989586621679720252"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-942"></span><span>      </span><span class="annot"><a href="#local-6989586621679720250"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-943"></span><span>      </span><span class="annot"><a href="#local-6989586621679720249"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-944"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-945"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-946"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720296"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720283"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720275"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720272"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720254"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720251"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720282"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720281"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720280"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720279"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720278"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-948"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720271"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720270"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720269"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720268"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720267"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-949"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720295"><span class="hs-identifier hs-type">decoderPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720294"><span class="hs-identifier hs-type">decoderPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720293"><span class="hs-identifier hs-type">decoderPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720292"><span class="hs-identifier hs-type">decoderPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720291"><span class="hs-identifier hs-type">decoderPosShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-950"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720266"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720265"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720264"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720263"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720262"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-951"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720261"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720260"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720259"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720258"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720257"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span>
</span><span id="line-952"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>    </span><span class="annot"><a href="#local-6989586621679720290"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-954"></span><span>    </span><span class="annot"><a href="#local-6989586621679720250"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-955"></span><span>    </span><span class="annot"><a href="#local-6989586621679720249"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-956"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-957"></span><span>  </span><span id="local-6989586621679718909"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GTransformer
  posEnc
  ()
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      decoderPosGradient
      decoderPosLayout
      decoderPosDevice
      decoderPosDataType
      decoderPosShape,
    Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      decoderAttentionMaskShape,
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      crossAttentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679718909"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718902"><span id="local-6989586621679718903"><span id="local-6989586621679718904"><span id="local-6989586621679718905"><span id="local-6989586621679718906"><span id="local-6989586621679718907"><span id="local-6989586621679718908"><span class="annot"><span class="annottext">posEnc
initialLayerNorm
initialDropout
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: ()
tPosEnc :: posEnc
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679718902"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718901"><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679718901"><span class="hs-identifier hs-var">decoderInput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718900"><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679718900"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718899"><span class="annot"><span class="annottext">Tensor
  decoderPosGradient
  decoderPosLayout
  decoderPosDevice
  decoderPosDataType
  decoderPosShape
</span><a href="#local-6989586621679718899"><span class="hs-identifier hs-var">decoderPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718898"><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679718898"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718897"><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679718897"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-958"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718896"><span class="annot"><span class="annottext">decoderAttentionBias :: IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
</span><a href="#local-6989586621679718896"><span class="hs-identifier hs-var hs-var">decoderAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderAttentionMaskGradient
        decoderAttentionMaskLayout
        decoderAttentionMaskDevice
        decoderAttentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         decoderAttentionMaskGradient
         decoderAttentionMaskLayout
         decoderAttentionMaskDevice
         decoderAttentionMaskDataType
         (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
-&gt; m (Tensor
        decoderAttentionMaskGradient
        decoderAttentionMaskLayout
        decoderAttentionMaskDevice
        decoderAttentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderAttentionMaskGradient
        decoderAttentionMaskLayout
        decoderAttentionMaskDevice
        decoderAttentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ UnsqueezeF selectDim shape, Catch shape',
 SingI selectDim, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679718898"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span><span>
</span><span id="line-959"></span><span>        </span><span id="local-6989586621679718895"><span class="annot"><span class="annottext">crossAttentionBias :: IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
</span><a href="#local-6989586621679718895"><span class="hs-identifier hs-var hs-var">crossAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        crossAttentionMaskGradient
        crossAttentionMaskLayout
        crossAttentionMaskDevice
        crossAttentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         crossAttentionMaskGradient
         crossAttentionMaskLayout
         crossAttentionMaskDevice
         crossAttentionMaskDataType
         (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)))
-&gt; m (Tensor
        crossAttentionMaskGradient
        crossAttentionMaskLayout
        crossAttentionMaskDevice
        crossAttentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        crossAttentionMaskGradient
        crossAttentionMaskLayout
        crossAttentionMaskDevice
        crossAttentionMaskDataType
        (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ UnsqueezeF selectDim shape, Catch shape',
 SingI selectDim, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679718897"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span><span>
</span><span id="line-960"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-961"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  decoderPosGradient
  decoderPosLayout
  decoderPosDevice
  decoderPosDataType
  decoderPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        decoderPosGradient
        decoderPosLayout
        decoderPosDevice
        decoderPosDataType
        decoderPosShape)
forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderPosGradient
  decoderPosLayout
  decoderPosDevice
  decoderPosDataType
  decoderPosShape
</span><a href="#local-6989586621679718899"><span class="hs-identifier hs-var">decoderPos</span></a></span><span>
</span><span id="line-962"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     decoderPosGradient
     decoderPosLayout
     decoderPosDevice
     decoderPosDataType
     decoderPosShape)
-&gt; (Tensor
      decoderPosGradient
      decoderPosLayout
      decoderPosDevice
      decoderPosDataType
      decoderPosShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice0)
         (Tensor
            decoderPosEncGradient
            decoderPosEncLayout
            decoderPosEncDevice
            decoderPosEncDataType
            decoderPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         decoderPosEncGradient
         decoderPosEncLayout
         decoderPosEncDevice
         decoderPosEncDataType
         decoderPosEncShape,
       Generator generatorDevice0))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          decoderPosEncGradient
          decoderPosEncLayout
          decoderPosEncDevice
          decoderPosEncDataType
          decoderPosEncShape,
        Generator generatorDevice0))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice0)
      (Tensor
         decoderPosEncGradient
         decoderPosEncLayout
         decoderPosEncDevice
         decoderPosEncDataType
         decoderPosEncShape))
-&gt; (Tensor
      decoderPosGradient
      decoderPosLayout
      decoderPosDevice
      decoderPosDataType
      decoderPosShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            decoderPosEncGradient
            decoderPosEncLayout
            decoderPosEncDevice
            decoderPosEncDataType
            decoderPosEncShape,
          Generator generatorDevice0))
-&gt; Tensor
     decoderPosGradient
     decoderPosLayout
     decoderPosDevice
     decoderPosDataType
     decoderPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">posEnc
-&gt; Tensor
     decoderPosGradient
     decoderPosLayout
     decoderPosDevice
     decoderPosDataType
     decoderPosShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape,
      Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">posEnc
</span><a href="#local-6989586621679718908"><span class="hs-identifier hs-var">tPosEnc</span></a></span><span>
</span><span id="line-963"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     decoderPosEncGradient
     decoderPosEncLayout
     decoderPosEncDevice
     decoderPosEncDataType
     decoderPosEncShape)
-&gt; (Tensor
      decoderPosEncGradient
      decoderPosEncLayout
      decoderPosEncDevice
      decoderPosEncDataType
      decoderPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice0)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderInputGradient
               decoderPosEncGradient)
            (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
            (Unify
               (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
            (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
            (BroadcastShapesF decoderInputShape decoderPosEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderInputGradient
           decoderPosEncGradient)
        (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
        (Unify
           (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
        (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
        (BroadcastShapesF decoderInputShape decoderPosEncShape))
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderInputGradient
        decoderPosEncGradient)
     (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
     (Unify
        (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
     (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderInputGradient
           decoderPosEncGradient)
        (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
        (Unify
           (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
        (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
        (BroadcastShapesF decoderInputShape decoderPosEncShape))
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderInputGradient
         decoderPosEncGradient)
      (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
      (Unify
         (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
      (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
      (BroadcastShapesF decoderInputShape decoderPosEncShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice0)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            decoderInputGradient
            decoderPosEncGradient)
         (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
         (Unify
            (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
         (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
         (BroadcastShapesF decoderInputShape decoderPosEncShape)))
-&gt; (Tensor
      decoderPosEncGradient
      decoderPosEncLayout
      decoderPosEncDevice
      decoderPosEncDataType
      decoderPosEncShape
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderInputGradient
               decoderPosEncGradient)
            (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
            (Unify
               (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
            (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
            (BroadcastShapesF decoderInputShape decoderPosEncShape)))
-&gt; Tensor
     decoderPosEncGradient
     decoderPosEncLayout
     decoderPosEncDevice
     decoderPosEncDataType
     decoderPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderInputGradient
           decoderPosEncGradient)
        (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
        (Unify
           (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
        (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
        (BroadcastShapesF decoderInputShape decoderPosEncShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679718901"><span class="hs-identifier hs-var">decoderInput</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
-&gt; Tensor
     decoderPosEncGradient
     decoderPosEncLayout
     decoderPosEncDevice
     decoderPosEncDataType
     decoderPosEncShape
-&gt; m (Tensor
        (decoderInputGradient &lt;|&gt; decoderPosEncGradient)
        (decoderInputLayout &lt;+&gt; decoderPosEncLayout)
        (decoderInputDevice &lt;+&gt; decoderPosEncDevice)
        (decoderInputDataType &lt;+&gt; decoderPosEncDataType)
        (BroadcastShapesF decoderInputShape decoderPosEncShape))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape'' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(MonadThrow m, shape'' ~ BroadcastShapesF shape shape',
 Catch shape'') =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; m (Tensor
        (gradient &lt;|&gt; gradient')
        (layout &lt;+&gt; layout')
        (device &lt;+&gt; device')
        (dataType &lt;+&gt; dataType')
        shape'')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderInputGradient
        decoderPosEncGradient)
     (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
     (Unify
        (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
     (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderInputGradient
         decoderPosEncGradient)
      (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
      (Unify
         (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
      (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
      (BroadcastShapesF decoderInputShape decoderPosEncShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderInputGradient
         decoderPosEncGradient)
      (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
      (Unify
         (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
      (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
      (BroadcastShapesF decoderInputShape decoderPosEncShape)
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        decoderInputGradient
        decoderPosEncGradient)
     (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
     (Unify
        (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
     (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape)
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        decoderInputGradient
        decoderPosEncGradient)
     (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
     (Unify
        (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
     (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape)
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679718906"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-965"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         tensor2)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice2) tensor2
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (tensor2, Generator generatorDevice2))
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (tensor2, Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      tensor2)
-&gt; (tensor1
    -&gt; Generator generatorDevice1
    -&gt; m (tensor2, Generator generatorDevice2))
-&gt; tensor1
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor1
-&gt; Generator generatorDevice1
-&gt; m (tensor2, Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679718905"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-966"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice2) tensor2
-&gt; (tensor2
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718894"><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679718894"><span class="hs-identifier hs-var">decoderInput'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-967"></span><span>                     </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
</span><a href="#local-6989586621679718896"><span class="hs-identifier hs-var">decoderAttentionBias</span></a></span><span>
</span><span id="line-968"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
-&gt; (Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718893"><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
</span><a href="#local-6989586621679718893"><span class="hs-identifier hs-var">decoderAttentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-969"></span><span>                                </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
</span><a href="#local-6989586621679718895"><span class="hs-identifier hs-var">crossAttentionBias</span></a></span><span>
</span><span id="line-970"></span><span>                                  </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
-&gt; (Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718892"><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
</span><a href="#local-6989586621679718892"><span class="hs-identifier hs-var">crossAttentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-971"></span><span>                                           </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-972"></span><span>                                             </span><span class="annot"><span class="annottext">stack
-&gt; (tensor2,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape),
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span>
</span><span id="line-973"></span><span>                                               </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679718904"><span class="hs-identifier hs-var">tStack</span></a></span><span>
</span><span id="line-974"></span><span>                                               </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679718894"><span class="hs-identifier hs-var">decoderInput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-975"></span><span>                                                 </span><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679718900"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-976"></span><span>                                                 </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
</span><a href="#local-6989586621679718893"><span class="hs-identifier hs-var">decoderAttentionBias'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-977"></span><span>                                                 </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
</span><a href="#local-6989586621679718892"><span class="hs-identifier hs-var">crossAttentionBias'</span></a></span><span>
</span><span id="line-978"></span><span>                                               </span><span class="hs-special">)</span><span>
</span><span id="line-979"></span><span>                                       </span><span class="hs-special">)</span><span>
</span><span id="line-980"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-981"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-982"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679718903"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-983"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679718902"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-984"></span><span>
</span><span id="line-985"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in a decoder configuration</span><span>
</span><span id="line-986"></span><span class="hs-comment">-- with relative positional encoding rather than absolute positional encoding.</span><span>
</span><span id="line-987"></span><span class="hs-comment">--</span><span>
</span><span id="line-988"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-989"></span><span class="hs-comment">--   &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-990"></span><span class="hs-comment">--   &#9474; decoderInput &#9474;  &#9474; encoderOutput &#9474;  &#9474; decoderRelPos &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-991"></span><span class="hs-comment">--   &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-992"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9474;                     &#9474;                        &#9474;</span><span>
</span><span id="line-993"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9660;                     &#9474;                        &#9474;</span><span>
</span><span id="line-994"></span><span class="hs-comment">--          &#9474;                  &#9474;             tdRelPosEnc                &#9474;                        &#9474;</span><span>
</span><span id="line-995"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9660;                     &#9474;                        &#9474;</span><span>
</span><span id="line-996"></span><span class="hs-comment">--          &#9474;                  &#9474;              transpose                 &#9474;                        &#9474;</span><span>
</span><span id="line-997"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9660;                     &#9660;                        &#9660;</span><span>
</span><span id="line-998"></span><span class="hs-comment">--          &#9474;                  &#9474;              transpose             unsqueeze                unsqueeze</span><span>
</span><span id="line-999"></span><span class="hs-comment">--          &#9660;                  &#9474;                  &#9474;                     &#9474;                        &#9474;</span><span>
</span><span id="line-1000"></span><span class="hs-comment">-- (tInitialLayerNorm)         &#9474;                  &#9474;                     &#9474;                        &#9474;</span><span>
</span><span id="line-1001"></span><span class="hs-comment">--          &#9660;                  &#9474;                  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                        &#9474;</span><span>
</span><span id="line-1002"></span><span class="hs-comment">--  (tInitialDropout)          &#9474;                             &#9474;                                   &#9474;</span><span>
</span><span id="line-1003"></span><span class="hs-comment">--          &#9660;                  &#9474;                             &#9474;                                   &#9474;</span><span>
</span><span id="line-1004"></span><span class="hs-comment">--       tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-1005"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-1006"></span><span class="hs-comment">--  (tFinalLayerNorm)</span><span>
</span><span id="line-1007"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-1008"></span><span class="hs-comment">--   (tFinalDropout)</span><span>
</span><span id="line-1009"></span><span class="hs-comment">--          &#9474;</span><span>
</span><span id="line-1010"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-1011"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-1012"></span><span class="hs-comment">--     &#9474; output &#9474;</span><span>
</span><span id="line-1013"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-1014"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-1015"></span><span id="local-6989586621679720144"><span id="local-6989586621679720145"><span id="local-6989586621679720146"><span id="local-6989586621679720147"><span id="local-6989586621679720148"><span id="local-6989586621679720149"><span id="local-6989586621679720150"><span id="local-6989586621679720151"><span id="local-6989586621679720152"><span id="local-6989586621679720153"><span id="local-6989586621679720154"><span id="local-6989586621679720155"><span id="local-6989586621679720156"><span id="local-6989586621679720157"><span id="local-6989586621679720158"><span id="local-6989586621679720159"><span id="local-6989586621679720160"><span id="local-6989586621679720161"><span id="local-6989586621679720162"><span id="local-6989586621679720163"><span id="local-6989586621679720164"><span id="local-6989586621679720165"><span id="local-6989586621679720166"><span id="local-6989586621679720167"><span id="local-6989586621679720168"><span id="local-6989586621679720169"><span id="local-6989586621679720170"><span id="local-6989586621679720171"><span id="local-6989586621679720172"><span id="local-6989586621679720173"><span id="local-6989586621679720174"><span id="local-6989586621679720175"><span id="local-6989586621679720176"><span id="local-6989586621679720177"><span id="local-6989586621679720178"><span id="local-6989586621679720179"><span id="local-6989586621679720180"><span id="local-6989586621679720181"><span id="local-6989586621679720182"><span id="local-6989586621679720183"><span id="local-6989586621679720184"><span id="local-6989586621679720185"><span id="local-6989586621679720186"><span id="local-6989586621679720187"><span id="local-6989586621679720188"><span id="local-6989586621679720189"><span id="local-6989586621679720190"><span id="local-6989586621679720191"><span id="local-6989586621679720192"><span id="local-6989586621679720193"><span id="local-6989586621679720194"><span id="local-6989586621679720195"><span class="hs-keyword">instance</span><span>
</span><span id="line-1016"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1017"></span><span>      </span><span class="annot"><a href="#local-6989586621679720195"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-1018"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720194"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720193"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720192"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720191"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720190"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>      </span><span class="annot"><a href="#local-6989586621679720189"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-1020"></span><span>      </span><span class="annot"><a href="#local-6989586621679720188"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-1021"></span><span>      </span><span class="annot"><a href="#local-6989586621679720187"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1022"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1023"></span><span>      </span><span class="annot"><a href="#local-6989586621679720186"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-1024"></span><span>      </span><span class="annot"><a href="#local-6989586621679720188"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-1025"></span><span>      </span><span class="annot"><a href="#local-6989586621679720187"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-1026"></span><span>      </span><span class="annot"><a href="#local-6989586621679720185"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-1027"></span><span>      </span><span class="annot"><a href="#local-6989586621679720184"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1028"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1029"></span><span>      </span><span class="annot"><a href="#local-6989586621679720183"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span>
</span><span id="line-1030"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720182"><span class="hs-identifier hs-type">decoderRelPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720181"><span class="hs-identifier hs-type">decoderRelPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720180"><span class="hs-identifier hs-type">decoderRelPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720179"><span class="hs-identifier hs-type">decoderRelPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720178"><span class="hs-identifier hs-type">decoderRelPosShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1031"></span><span>      </span><span class="annot"><a href="#local-6989586621679720184"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-1032"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720177"><span class="hs-identifier hs-type">decoderRelPosEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720176"><span class="hs-identifier hs-type">decoderRelPosEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720175"><span class="hs-identifier hs-type">decoderRelPosEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720174"><span class="hs-identifier hs-type">decoderRelPosEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720173"><span class="hs-identifier hs-type">decoderRelPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1033"></span><span>      </span><span class="annot"><a href="#local-6989586621679720172"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1034"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1035"></span><span>      </span><span class="annot"><a href="#local-6989586621679720171"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-1036"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679720185"><span class="hs-identifier hs-type">tensor1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1037"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720170"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720169"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720168"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720167"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720166"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1038"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-1039"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720177"><span class="hs-identifier hs-type">decoderRelPosEncGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720165"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1040"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720176"><span class="hs-identifier hs-type">decoderRelPosEncLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720164"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1041"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720175"><span class="hs-identifier hs-type">decoderRelPosEncDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720163"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1042"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679720174"><span class="hs-identifier hs-type">decoderRelPosEncDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720162"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720161"><span class="hs-identifier hs-type">doubleTransposedDecoderRelPosEncShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720160"><span class="hs-identifier hs-type">unsqueezedDecoderAttentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1044"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-1045"></span><span>          </span><span class="annot"><a href="#local-6989586621679720159"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span>
</span><span id="line-1046"></span><span>          </span><span class="annot"><a href="#local-6989586621679720158"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span>
</span><span id="line-1047"></span><span>          </span><span class="annot"><a href="#local-6989586621679720157"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span>
</span><span id="line-1048"></span><span>          </span><span class="annot"><a href="#local-6989586621679720156"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span>
</span><span id="line-1049"></span><span>          </span><span class="annot"><a href="#local-6989586621679720155"><span class="hs-identifier hs-type">unsqueezedCrossAttentionMaskShape</span></a></span><span>
</span><span id="line-1050"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1051"></span><span>      </span><span class="annot"><a href="#local-6989586621679720172"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-1052"></span><span>      </span><span class="annot"><a href="#local-6989586621679720154"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-1053"></span><span>      </span><span class="annot"><a href="#local-6989586621679720153"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1054"></span><span>    </span><span class="annot"><a href="#local-6989586621679720152"><span class="hs-identifier hs-type">transposedDecoderRelPosEncShape</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720173"><span class="hs-identifier hs-type">decoderRelPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1055"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720152"><span class="hs-identifier hs-type">transposedDecoderRelPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1056"></span><span>    </span><span class="annot"><a href="#local-6989586621679720161"><span class="hs-identifier hs-type">doubleTransposedDecoderRelPosEncShape</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720152"><span class="hs-identifier hs-type">transposedDecoderRelPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1057"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720161"><span class="hs-identifier hs-type">doubleTransposedDecoderRelPosEncShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1058"></span><span>    </span><span class="annot"><a href="#local-6989586621679720160"><span class="hs-identifier hs-type">unsqueezedDecoderAttentionMaskShape</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720151"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1059"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720160"><span class="hs-identifier hs-type">unsqueezedDecoderAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1060"></span><span>    </span><span class="annot"><a href="#local-6989586621679720155"><span class="hs-identifier hs-type">unsqueezedCrossAttentionMaskShape</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720150"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1061"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720155"><span class="hs-identifier hs-type">unsqueezedCrossAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1062"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720161"><span class="hs-identifier hs-type">doubleTransposedDecoderRelPosEncShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720160"><span class="hs-identifier hs-type">unsqueezedDecoderAttentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1063"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1064"></span><span>      </span><span class="annot"><a href="#local-6989586621679720149"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-1065"></span><span>      </span><span class="annot"><a href="#local-6989586621679720154"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-1066"></span><span>      </span><span class="annot"><a href="#local-6989586621679720153"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-1067"></span><span>      </span><span class="annot"><a href="#local-6989586621679720148"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-1068"></span><span>      </span><span class="annot"><a href="#local-6989586621679720147"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1069"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1070"></span><span>      </span><span class="annot"><a href="#local-6989586621679720146"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-1071"></span><span>      </span><span class="annot"><a href="#local-6989586621679720148"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-1072"></span><span>      </span><span class="annot"><a href="#local-6989586621679720147"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-1073"></span><span>      </span><span class="annot"><a href="#local-6989586621679720145"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-1074"></span><span>      </span><span class="annot"><a href="#local-6989586621679720144"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-1075"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1076"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1077"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679720183"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720195"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720186"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720171"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720149"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720146"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1078"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720194"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720193"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720192"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720191"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720190"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1079"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720170"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720169"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720168"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720167"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720166"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1080"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720182"><span class="hs-identifier hs-type">decoderRelPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720181"><span class="hs-identifier hs-type">decoderRelPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720180"><span class="hs-identifier hs-type">decoderRelPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720179"><span class="hs-identifier hs-type">decoderRelPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720178"><span class="hs-identifier hs-type">decoderRelPosShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1081"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720165"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720164"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720163"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720162"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720151"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1082"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720159"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720158"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720157"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720156"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679720150"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span>
</span><span id="line-1083"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1084"></span><span>    </span><span class="annot"><a href="#local-6989586621679720189"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-1085"></span><span>    </span><span class="annot"><a href="#local-6989586621679720145"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-1086"></span><span>    </span><span class="annot"><a href="#local-6989586621679720144"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-1087"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1088"></span><span>  </span><span id="local-6989586621679718777"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GTransformer
  ()
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      decoderRelPosGradient
      decoderRelPosLayout
      decoderRelPosDevice
      decoderRelPosDataType
      decoderRelPosShape,
    Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      decoderAttentionMaskShape,
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      crossAttentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679718777"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679718770"><span id="local-6989586621679718771"><span id="local-6989586621679718772"><span id="local-6989586621679718773"><span id="local-6989586621679718774"><span id="local-6989586621679718775"><span id="local-6989586621679718776"><span class="annot"><span class="annottext">initialLayerNorm
initialDropout
relPosEnc
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: relPosEnc
tPosEnc :: ()
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679718770"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679718769"><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679718769"><span class="hs-identifier hs-var">decoderInput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718768"><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679718768"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718767"><span class="annot"><span class="annottext">Tensor
  decoderRelPosGradient
  decoderRelPosLayout
  decoderRelPosDevice
  decoderRelPosDataType
  decoderRelPosShape
</span><a href="#local-6989586621679718767"><span class="hs-identifier hs-var">decoderRelPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718766"><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679718766"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679718765"><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679718765"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1089"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679718764"><span class="annot"><span class="annottext">decoderRelPosBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     doubleTransposedDecoderRelPosEncShape)
</span><a href="#local-6989586621679718764"><span class="hs-identifier hs-var hs-var">decoderRelPosBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1090"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  decoderRelPosGradient
  decoderRelPosLayout
  decoderRelPosDevice
  decoderRelPosDataType
  decoderRelPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice1)
     (Tensor
        decoderRelPosGradient
        decoderRelPosLayout
        decoderRelPosDevice
        decoderRelPosDataType
        decoderRelPosShape)
forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderRelPosGradient
  decoderRelPosLayout
  decoderRelPosDevice
  decoderRelPosDataType
  decoderRelPosShape
</span><a href="#local-6989586621679718767"><span class="hs-identifier hs-var">decoderRelPos</span></a></span><span>
</span><span id="line-1091"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice1)
  (Tensor
     decoderRelPosGradient
     decoderRelPosLayout
     decoderRelPosDevice
     decoderRelPosDataType
     decoderRelPosShape)
-&gt; (Tensor
      decoderRelPosGradient
      decoderRelPosLayout
      decoderRelPosDevice
      decoderRelPosDataType
      decoderRelPosShape
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            decoderRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         decoderRelPosEncShape,
       Generator generatorDevice2))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (Tensor
          decoderRelPosEncGradient
          decoderRelPosEncLayout
          decoderRelPosEncDevice
          decoderRelPosEncDataType
          decoderRelPosEncShape,
        Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         decoderRelPosEncShape))
-&gt; (Tensor
      decoderRelPosGradient
      decoderRelPosLayout
      decoderRelPosDevice
      decoderRelPosDataType
      decoderRelPosShape
    -&gt; Generator generatorDevice1
    -&gt; m (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            decoderRelPosEncShape,
          Generator generatorDevice2))
-&gt; Tensor
     decoderRelPosGradient
     decoderRelPosLayout
     decoderRelPosDevice
     decoderRelPosDataType
     decoderRelPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">relPosEnc
-&gt; Tensor
     decoderRelPosGradient
     decoderRelPosLayout
     decoderRelPosDevice
     decoderRelPosDataType
     decoderRelPosShape
-&gt; Generator generatorDevice1
-&gt; m (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape,
      Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">relPosEnc
</span><a href="#local-6989586621679718775"><span class="hs-identifier hs-var">tRelPosEnc</span></a></span><span>
</span><span id="line-1092"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     decoderRelPosEncShape)
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      decoderRelPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            transposedDecoderRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        transposedDecoderRelPosEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     transposedDecoderRelPosEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        transposedDecoderRelPosEncShape)
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      transposedDecoderRelPosEncShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         transposedDecoderRelPosEncShape))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      decoderRelPosEncShape
    -&gt; m (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            transposedDecoderRelPosEncShape))
-&gt; Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     decoderRelPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        transposedDecoderRelPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, Catch shape',
 SingI selectDim0, SingI selectDim1, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1093"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     transposedDecoderRelPosEncShape)
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      transposedDecoderRelPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            doubleTransposedDecoderRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        doubleTransposedDecoderRelPosEncShape)
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     doubleTransposedDecoderRelPosEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        doubleTransposedDecoderRelPosEncShape)
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      doubleTransposedDecoderRelPosEncShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         doubleTransposedDecoderRelPosEncShape))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      transposedDecoderRelPosEncShape
    -&gt; m (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            doubleTransposedDecoderRelPosEncShape))
-&gt; Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     transposedDecoderRelPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        doubleTransposedDecoderRelPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, Catch shape',
 SingI selectDim0, SingI selectDim1, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1094"></span><span>        </span><span id="local-6989586621679718763"><span class="annot"><span class="annottext">decoderAttentionBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderRelPosEncGradient
        decoderAttentionMaskGradient)
     (Unify
        (Layout LayoutType)
        decoderRelPosEncLayout
        decoderAttentionMaskLayout)
     (Unify
        (Device (DeviceType Nat))
        decoderRelPosEncDevice
        decoderAttentionMaskDevice)
     (Unify
        (DataType DType)
        decoderRelPosEncDataType
        decoderAttentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedDecoderRelPosEncShape
        unsqueezedDecoderAttentionMaskShape))
</span><a href="#local-6989586621679718763"><span class="hs-identifier hs-var hs-var">decoderAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1095"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     doubleTransposedDecoderRelPosEncShape)
</span><a href="#local-6989586621679718764"><span class="hs-identifier hs-var">decoderRelPosBias</span></a></span><span>
</span><span id="line-1096"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     doubleTransposedDecoderRelPosEncShape)
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      doubleTransposedDecoderRelPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderRelPosEncGradient
               decoderAttentionMaskGradient)
            (Unify
               (Layout LayoutType)
               decoderRelPosEncLayout
               decoderAttentionMaskLayout)
            (Unify
               (Device (DeviceType Nat))
               decoderRelPosEncDevice
               decoderAttentionMaskDevice)
            (Unify
               (DataType DType)
               decoderRelPosEncDataType
               decoderAttentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedDecoderRelPosEncShape
               unsqueezedDecoderAttentionMaskShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedDecoderRelPosEncShape
           unsqueezedDecoderAttentionMaskShape))
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderRelPosEncGradient
        decoderAttentionMaskGradient)
     (Unify
        (Layout LayoutType)
        decoderRelPosEncLayout
        decoderAttentionMaskLayout)
     (Unify
        (Device (DeviceType Nat))
        decoderRelPosEncDevice
        decoderAttentionMaskDevice)
     (Unify
        (DataType DType)
        decoderRelPosEncDataType
        decoderAttentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedDecoderRelPosEncShape
        unsqueezedDecoderAttentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedDecoderRelPosEncShape
           unsqueezedDecoderAttentionMaskShape))
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderRelPosEncGradient
         decoderAttentionMaskGradient)
      (Unify
         (Layout LayoutType)
         decoderRelPosEncLayout
         decoderAttentionMaskLayout)
      (Unify
         (Device (DeviceType Nat))
         decoderRelPosEncDevice
         decoderAttentionMaskDevice)
      (Unify
         (DataType DType)
         decoderRelPosEncDataType
         decoderAttentionMaskDataType)
      (BroadcastShapesF
         doubleTransposedDecoderRelPosEncShape
         unsqueezedDecoderAttentionMaskShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            decoderRelPosEncGradient
            decoderAttentionMaskGradient)
         (Unify
            (Layout LayoutType)
            decoderRelPosEncLayout
            decoderAttentionMaskLayout)
         (Unify
            (Device (DeviceType Nat))
            decoderRelPosEncDevice
            decoderAttentionMaskDevice)
         (Unify
            (DataType DType)
            decoderRelPosEncDataType
            decoderAttentionMaskDataType)
         (BroadcastShapesF
            doubleTransposedDecoderRelPosEncShape
            unsqueezedDecoderAttentionMaskShape)))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      doubleTransposedDecoderRelPosEncShape
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderRelPosEncGradient
               decoderAttentionMaskGradient)
            (Unify
               (Layout LayoutType)
               decoderRelPosEncLayout
               decoderAttentionMaskLayout)
            (Unify
               (Device (DeviceType Nat))
               decoderRelPosEncDevice
               decoderAttentionMaskDevice)
            (Unify
               (DataType DType)
               decoderRelPosEncDataType
               decoderAttentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedDecoderRelPosEncShape
               unsqueezedDecoderAttentionMaskShape)))
-&gt; Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     doubleTransposedDecoderRelPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedDecoderRelPosEncShape
           unsqueezedDecoderAttentionMaskShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SSelectDim ('SelectDim ('ByIndex 1))
-&gt; Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     decoderAttentionMaskShape
-&gt; m (Tensor
        decoderAttentionMaskGradient
        decoderAttentionMaskLayout
        decoderAttentionMaskDevice
        decoderAttentionMaskDataType
        unsqueezedDecoderAttentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ UnsqueezeF selectDim shape, Catch shape',
 MonadThrow m) =&gt;
SSelectDim selectDim
-&gt; Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#sUnsqueeze"><span class="hs-identifier hs-var">sUnsqueeze</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1))
forall (index :: By Symbol Nat).
SBy index -&gt; SSelectDim ('SelectDim index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSelectDim"><span class="hs-identifier hs-var">SSelectDim</span></a></span><span> </span><span class="annot"><span class="annottext">(SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1)))
-&gt; SBy ('ByIndex 1) -&gt; SSelectDim ('SelectDim ('ByIndex 1))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (index :: Nat). KnownNat index =&gt; SBy ('ByIndex index)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SByIndex"><span class="hs-identifier hs-var">SByIndex</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679718766"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     unsqueezedDecoderAttentionMaskShape)
-&gt; (Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      unsqueezedDecoderAttentionMaskShape
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderRelPosEncGradient
               decoderAttentionMaskGradient)
            (Unify
               (Layout LayoutType)
               decoderRelPosEncLayout
               decoderAttentionMaskLayout)
            (Unify
               (Device (DeviceType Nat))
               decoderRelPosEncDevice
               decoderAttentionMaskDevice)
            (Unify
               (DataType DType)
               decoderRelPosEncDataType
               decoderAttentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedDecoderRelPosEncShape
               unsqueezedDecoderAttentionMaskShape)))
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedDecoderRelPosEncShape
           unsqueezedDecoderAttentionMaskShape))
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Tensor
    decoderAttentionMaskGradient
    decoderAttentionMaskLayout
    decoderAttentionMaskDevice
    decoderAttentionMaskDataType
    unsqueezedDecoderAttentionMaskShape
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             decoderRelPosEncGradient
             decoderAttentionMaskGradient)
          (Unify
             (Layout LayoutType)
             decoderRelPosEncLayout
             decoderAttentionMaskLayout)
          (Unify
             (Device (DeviceType Nat))
             decoderRelPosEncDevice
             decoderAttentionMaskDevice)
          (Unify
             (DataType DType)
             decoderRelPosEncDataType
             decoderAttentionMaskDataType)
          (BroadcastShapesF
             doubleTransposedDecoderRelPosEncShape
             unsqueezedDecoderAttentionMaskShape)))
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            decoderRelPosEncGradient
            decoderAttentionMaskGradient)
         (Unify
            (Layout LayoutType)
            decoderRelPosEncLayout
            decoderAttentionMaskLayout)
         (Unify
            (Device (DeviceType Nat))
            decoderRelPosEncDevice
            decoderAttentionMaskDevice)
         (Unify
            (DataType DType)
            decoderRelPosEncDataType
            decoderAttentionMaskDataType)
         (BroadcastShapesF
            doubleTransposedDecoderRelPosEncShape
            unsqueezedDecoderAttentionMaskShape)))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      doubleTransposedDecoderRelPosEncShape
    -&gt; Tensor
         decoderAttentionMaskGradient
         decoderAttentionMaskLayout
         decoderAttentionMaskDevice
         decoderAttentionMaskDataType
         unsqueezedDecoderAttentionMaskShape
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderRelPosEncGradient
               decoderAttentionMaskGradient)
            (Unify
               (Layout LayoutType)
               decoderRelPosEncLayout
               decoderAttentionMaskLayout)
            (Unify
               (Device (DeviceType Nat))
               decoderRelPosEncDevice
               decoderAttentionMaskDevice)
            (Unify
               (DataType DType)
               decoderRelPosEncDataType
               decoderAttentionMaskDataType)
            (BroadcastShapesF
               doubleTransposedDecoderRelPosEncShape
               unsqueezedDecoderAttentionMaskShape)))
-&gt; Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     doubleTransposedDecoderRelPosEncShape
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedDecoderRelPosEncShape
           unsqueezedDecoderAttentionMaskShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderRelPosEncGradient
  decoderRelPosEncLayout
  decoderRelPosEncDevice
  decoderRelPosEncDataType
  doubleTransposedDecoderRelPosEncShape
-&gt; Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     unsqueezedDecoderAttentionMaskShape
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           doubleTransposedDecoderRelPosEncShape
           unsqueezedDecoderAttentionMaskShape))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape'' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(MonadThrow m, shape'' ~ BroadcastShapesF shape shape',
 Catch shape'') =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; m (Tensor
        (gradient &lt;|&gt; gradient')
        (layout &lt;+&gt; layout')
        (device &lt;+&gt; device')
        (dataType &lt;+&gt; dataType')
        shape'')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier hs-var">add</span></a></span><span>
</span><span id="line-1097"></span><span>        </span><span id="local-6989586621679718762"><span class="annot"><span class="annottext">crossAttentionBias :: IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     unsqueezedCrossAttentionMaskShape)
</span><a href="#local-6989586621679718762"><span class="hs-identifier hs-var hs-var">crossAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     unsqueezedCrossAttentionMaskShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        crossAttentionMaskGradient
        crossAttentionMaskLayout
        crossAttentionMaskDevice
        crossAttentionMaskDataType
        unsqueezedCrossAttentionMaskShape)
forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      unsqueezedCrossAttentionMaskShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         crossAttentionMaskGradient
         crossAttentionMaskLayout
         crossAttentionMaskDevice
         crossAttentionMaskDataType
         unsqueezedCrossAttentionMaskShape))
-&gt; m (Tensor
        crossAttentionMaskGradient
        crossAttentionMaskLayout
        crossAttentionMaskDevice
        crossAttentionMaskDataType
        unsqueezedCrossAttentionMaskShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        crossAttentionMaskGradient
        crossAttentionMaskLayout
        crossAttentionMaskDevice
        crossAttentionMaskDataType
        unsqueezedCrossAttentionMaskShape)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ UnsqueezeF selectDim shape, Catch shape',
 SingI selectDim, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679718765"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span><span>
</span><span id="line-1098"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1099"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        decoderInputGradient
        decoderInputLayout
        decoderInputDevice
        decoderInputDataType
        decoderInputShape)
forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679718769"><span class="hs-identifier hs-var">decoderInput</span></a></span><span>
</span><span id="line-1100"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     decoderInputGradient
     decoderInputLayout
     decoderInputDevice
     decoderInputDataType
     decoderInputShape)
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape
    -&gt; IxStateT
         m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (tensor0, Generator generatorDevice0))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (tensor0, Generator generatorDevice0))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape
    -&gt; Generator generatorDevice
    -&gt; m (tensor0, Generator generatorDevice0))
-&gt; Tensor
     decoderInputGradient
     decoderInputLayout
     decoderInputDevice
     decoderInputDataType
     decoderInputShape
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     decoderInputGradient
     decoderInputLayout
     decoderInputDevice
     decoderInputDataType
     decoderInputShape
-&gt; Generator generatorDevice
-&gt; m (tensor0, Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679718774"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-1101"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice0) tensor0
-&gt; (tensor0
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (tensor0
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; tensor0
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor0
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679718773"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-1102"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718761"><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679718761"><span class="hs-identifier hs-var">decoderInput'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1103"></span><span>                     </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderRelPosEncGradient
        decoderAttentionMaskGradient)
     (Unify
        (Layout LayoutType)
        decoderRelPosEncLayout
        decoderAttentionMaskLayout)
     (Unify
        (Device (DeviceType Nat))
        decoderRelPosEncDevice
        decoderAttentionMaskDevice)
     (Unify
        (DataType DType)
        decoderRelPosEncDataType
        decoderAttentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedDecoderRelPosEncShape
        unsqueezedDecoderAttentionMaskShape))
</span><a href="#local-6989586621679718763"><span class="hs-identifier hs-var">decoderAttentionBias</span></a></span><span>
</span><span id="line-1104"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderRelPosEncGradient
        decoderAttentionMaskGradient)
     (Unify
        (Layout LayoutType)
        decoderRelPosEncLayout
        decoderAttentionMaskLayout)
     (Unify
        (Device (DeviceType Nat))
        decoderRelPosEncDevice
        decoderAttentionMaskDevice)
     (Unify
        (DataType DType)
        decoderRelPosEncDataType
        decoderAttentionMaskDataType)
     (BroadcastShapesF
        doubleTransposedDecoderRelPosEncShape
        unsqueezedDecoderAttentionMaskShape))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderRelPosEncGradient
         decoderAttentionMaskGradient)
      (Unify
         (Layout LayoutType)
         decoderRelPosEncLayout
         decoderAttentionMaskLayout)
      (Unify
         (Device (DeviceType Nat))
         decoderRelPosEncDevice
         decoderAttentionMaskDevice)
      (Unify
         (DataType DType)
         decoderRelPosEncDataType
         decoderAttentionMaskDataType)
      (BroadcastShapesF
         doubleTransposedDecoderRelPosEncShape
         unsqueezedDecoderAttentionMaskShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718760"><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     decoderRelPosEncGradient
     decoderAttentionMaskGradient)
  (Unify
     (Layout LayoutType)
     decoderRelPosEncLayout
     decoderAttentionMaskLayout)
  (Unify
     (Device (DeviceType Nat))
     decoderRelPosEncDevice
     decoderAttentionMaskDevice)
  (Unify
     (DataType DType)
     decoderRelPosEncDataType
     decoderAttentionMaskDataType)
  (BroadcastShapesF
     doubleTransposedDecoderRelPosEncShape
     unsqueezedDecoderAttentionMaskShape)
</span><a href="#local-6989586621679718760"><span class="hs-identifier hs-var">decoderAttentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1105"></span><span>                                </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     unsqueezedCrossAttentionMaskShape)
</span><a href="#local-6989586621679718762"><span class="hs-identifier hs-var">crossAttentionBias</span></a></span><span>
</span><span id="line-1106"></span><span>                                  </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice2)
  (Generator generatorDevice2)
  (Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     unsqueezedCrossAttentionMaskShape)
-&gt; (Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      unsqueezedCrossAttentionMaskShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679718759"><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  unsqueezedCrossAttentionMaskShape
</span><a href="#local-6989586621679718759"><span class="hs-identifier hs-var">crossAttentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1107"></span><span>                                           </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1108"></span><span>                                             </span><span class="annot"><span class="annottext">stack
-&gt; (tensor1,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      (Or
         (Gradient RequiresGradient)
         decoderRelPosEncGradient
         decoderAttentionMaskGradient)
      (Unify
         (Layout LayoutType)
         decoderRelPosEncLayout
         decoderAttentionMaskLayout)
      (Unify
         (Device (DeviceType Nat))
         decoderRelPosEncDevice
         decoderAttentionMaskDevice)
      (Unify
         (DataType DType)
         decoderRelPosEncDataType
         decoderAttentionMaskDataType)
      (BroadcastShapesF
         doubleTransposedDecoderRelPosEncShape
         unsqueezedDecoderAttentionMaskShape),
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      unsqueezedCrossAttentionMaskShape)
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span>
</span><span id="line-1109"></span><span>                                               </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679718772"><span class="hs-identifier hs-var">tStack</span></a></span><span>
</span><span id="line-1110"></span><span>                                               </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679718761"><span class="hs-identifier hs-var">decoderInput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1111"></span><span>                                                 </span><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679718768"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1112"></span><span>                                                 </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     decoderRelPosEncGradient
     decoderAttentionMaskGradient)
  (Unify
     (Layout LayoutType)
     decoderRelPosEncLayout
     decoderAttentionMaskLayout)
  (Unify
     (Device (DeviceType Nat))
     decoderRelPosEncDevice
     decoderAttentionMaskDevice)
  (Unify
     (DataType DType)
     decoderRelPosEncDataType
     decoderAttentionMaskDataType)
  (BroadcastShapesF
     doubleTransposedDecoderRelPosEncShape
     unsqueezedDecoderAttentionMaskShape)
</span><a href="#local-6989586621679718760"><span class="hs-identifier hs-var">decoderAttentionBias'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1113"></span><span>                                                 </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  unsqueezedCrossAttentionMaskShape
</span><a href="#local-6989586621679718759"><span class="hs-identifier hs-var">crossAttentionBias'</span></a></span><span>
</span><span id="line-1114"></span><span>                                               </span><span class="hs-special">)</span><span>
</span><span id="line-1115"></span><span>                                       </span><span class="hs-special">)</span><span>
</span><span id="line-1116"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-1117"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-1118"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679718771"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-1119"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/cdv23r2x3jsa4zy3rx4k8dq2s3magv3j-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/dsfqizasqlb6l8cf2j98rvkk3d1pfj7j-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679718770"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-1120"></span></pre></body></html>