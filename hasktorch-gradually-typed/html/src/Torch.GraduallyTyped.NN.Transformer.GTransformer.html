<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GTransformer</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed.Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">IxMonadTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ilift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">IxPointed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNil</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../file:///nix/store/33j53czfh9iaqr8w1k6rjcna7zg8rw55-vector-sized-lib-vector-sized-1.4.3.1-haddock-doc/share/doc/vector-sized/html/src"><span class="hs-identifier">Data.Vector.Sized</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">VS</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier">Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Normalization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier">LayerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier">LayerNormSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Sparse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier">Embedding</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier">EmbeddingSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GBlock</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockCrossAttentionF"><span class="hs-identifier">DecoderBlockCrossAttentionF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockFeedForwardNetworkF"><span class="hs-identifier">DecoderBlockFeedForwardNetworkF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockSelfAttentionF"><span class="hs-identifier">DecoderBlockSelfAttentionF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockCrossAttentionF"><span class="hs-identifier">EncoderBlockCrossAttentionF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockFeedForwardNetworkF"><span class="hs-identifier">EncoderBlockFeedForwardNetworkF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockSelfAttentionF"><span class="hs-identifier">EncoderBlockSelfAttentionF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier">GTransformerBlock</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#GTransformerStack"><span class="hs-identifier">GTransformerStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#decoderStackSpec"><span class="hs-identifier">decoderStackSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#encoderStackSpec"><span class="hs-identifier">encoderStackSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasBias"><span class="hs-identifier">HasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasBias"><span class="hs-identifier">SHasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier">SWithBias</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier">SWithoutBias</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier">BroadcastShapesF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#By"><span class="hs-identifier">By</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.IndexingSlicingJoining</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier">TransposeF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier">UnsqueezeF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier">transpose</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier">unsqueeze</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-comment">-- | Generic transformer.</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- Can specialize to either encoder or decoder.</span><span>
</span><span id="line-50"></span><span class="hs-comment">--</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- - @posEnc@: an absolute positional encoding layer as used by, e.g., BERT.</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- - @relPosEnc@: a relative positional encoding layer as used by, e.g., T5.</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- - @initialLayerNorm@: a layer normalization layer for the embeddings.</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- - @initialDropout@: a dropout layer for the embeddings.</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- - @stack@: a stack of transformer blocks.</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- - @finalLayerNorm@: the final layer normalization layer.</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- - @finalDropout@: the final dropout layer.</span><span>
</span><span id="line-58"></span><span class="hs-keyword">data</span><span>
</span><span id="line-59"></span><span>  </span><span id="GTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span></span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656528"><span class="annot"><a href="#local-6989586621679656528"><span class="hs-identifier hs-type">posEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656527"><span class="annot"><a href="#local-6989586621679656527"><span class="hs-identifier hs-type">relPosEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656526"><span class="annot"><a href="#local-6989586621679656526"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656525"><span class="annot"><a href="#local-6989586621679656525"><span class="hs-identifier hs-type">initialDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656524"><span class="annot"><a href="#local-6989586621679656524"><span class="hs-identifier hs-type">stack</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656523"><span class="annot"><a href="#local-6989586621679656523"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656522"><span class="annot"><a href="#local-6989586621679656522"><span class="hs-identifier hs-type">finalDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>  </span><span id="GTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-69"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679656944"><span class="annot"><a href="#local-6989586621679656944"><span class="hs-identifier hs-type">posEnc</span></a></span></span><span> </span><span id="local-6989586621679656943"><span class="annot"><a href="#local-6989586621679656943"><span class="hs-identifier hs-type">relPosEnc</span></a></span></span><span> </span><span id="local-6989586621679656942"><span class="annot"><a href="#local-6989586621679656942"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679656941"><span class="annot"><a href="#local-6989586621679656941"><span class="hs-identifier hs-type">initialDropout</span></a></span></span><span> </span><span id="local-6989586621679656940"><span class="annot"><a href="#local-6989586621679656940"><span class="hs-identifier hs-type">stack</span></a></span></span><span> </span><span id="local-6989586621679656939"><span class="annot"><a href="#local-6989586621679656939"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679656938"><span class="annot"><a href="#local-6989586621679656938"><span class="hs-identifier hs-type">finalDropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | absolute positional encoding</span><span>
</span><span id="line-71"></span><span>      </span><span id="tPosEnc"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tPosEnc"><span class="hs-identifier hs-var hs-var">tPosEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679656944"><span class="hs-identifier hs-type">posEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>      </span><span class="hs-comment">-- | relative positional encoding</span><span>
</span><span id="line-73"></span><span>      </span><span id="tRelPosEnc"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tRelPosEnc"><span class="hs-identifier hs-var hs-var">tRelPosEnc</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679656943"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>      </span><span class="hs-comment">-- | initial layer norm</span><span>
</span><span id="line-75"></span><span>      </span><span id="tInitialLayerNorm"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tInitialLayerNorm"><span class="hs-identifier hs-var hs-var">tInitialLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679656942"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-76"></span><span>      </span><span class="hs-comment">-- | initial dropout</span><span>
</span><span id="line-77"></span><span>      </span><span id="tInitialDropout"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tInitialDropout"><span class="hs-identifier hs-var hs-var">tInitialDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679656941"><span class="hs-identifier hs-type">initialDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>      </span><span class="hs-comment">-- | transformer block stack</span><span>
</span><span id="line-79"></span><span>      </span><span id="tStack"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tStack"><span class="hs-identifier hs-var hs-var">tStack</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679656940"><span class="hs-identifier hs-type">stack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>      </span><span class="hs-comment">-- | final layer norm</span><span>
</span><span id="line-81"></span><span>      </span><span id="tFinalLayerNorm"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tFinalLayerNorm"><span class="hs-identifier hs-var hs-var">tFinalLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679656939"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>      </span><span class="hs-comment">-- | final dropout</span><span>
</span><span id="line-83"></span><span>      </span><span id="tFinalDropout"><span class="annot"><span class="annottext">GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#tFinalDropout"><span class="hs-identifier hs-var hs-var">tFinalDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679656938"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-85"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656944"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656943"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656942"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656941"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656940"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656939"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656938"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-88"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span id="local-6989586621679656513"><span class="annot"><a href="#local-6989586621679656513"><span class="hs-identifier hs-type hs-type">posEnc</span></a></span></span><span> </span><span id="local-6989586621679656512"><span class="annot"><a href="#local-6989586621679656512"><span class="hs-identifier hs-type hs-type">relPosEnc</span></a></span></span><span> </span><span id="local-6989586621679656511"><span class="annot"><a href="#local-6989586621679656511"><span class="hs-identifier hs-type hs-type">initialLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679656510"><span class="annot"><a href="#local-6989586621679656510"><span class="hs-identifier hs-type hs-type">initialDropout</span></a></span></span><span> </span><span id="local-6989586621679656509"><span class="annot"><a href="#local-6989586621679656509"><span class="hs-identifier hs-type hs-type">stack</span></a></span></span><span> </span><span id="local-6989586621679656508"><span class="annot"><a href="#local-6989586621679656508"><span class="hs-identifier hs-type hs-type">finalLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679656507"><span class="annot"><a href="#local-6989586621679656507"><span class="hs-identifier hs-type hs-type">finalDropout</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656513"><span class="hs-identifier hs-type">posEnc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656512"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656511"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656510"><span class="hs-identifier hs-type">initialDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656509"><span class="hs-identifier hs-type">stack</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656508"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656507"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Specifies the absolute positional encoding layer of a transformer encoder.</span><span>
</span><span id="line-92"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-93"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656506"><span class="annot"><a href="#local-6989586621679656506"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656505"><span class="annot"><a href="#local-6989586621679656505"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656504"><span class="annot"><a href="#local-6989586621679656504"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656503"><span class="annot"><a href="#local-6989586621679656503"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656502"><span class="annot"><a href="#local-6989586621679656502"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656501"><span class="annot"><a href="#local-6989586621679656501"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656500"><span class="annot"><a href="#local-6989586621679656500"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656499"><span class="annot"><a href="#local-6989586621679656499"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656498"><span class="annot"><a href="#local-6989586621679656498"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656497"><span class="annot"><a href="#local-6989586621679656497"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656496"><span class="annot"><a href="#local-6989586621679656496"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656500"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656499"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656498"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656497"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656496"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679656495"><span class="annot"><a href="#local-6989586621679656495"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656494"><span class="annot"><a href="#local-6989586621679656494"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656493"><span class="annot"><a href="#local-6989586621679656493"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656492"><span class="annot"><a href="#local-6989586621679656492"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656491"><span class="annot"><a href="#local-6989586621679656491"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656495"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656494"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656493"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656491"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656492"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656490"><span class="annot"><a href="#local-6989586621679656490"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656489"><span class="annot"><a href="#local-6989586621679656489"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656488"><span class="annot"><a href="#local-6989586621679656488"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656487"><span class="annot"><a href="#local-6989586621679656487"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656486"><span class="annot"><a href="#local-6989586621679656486"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656490"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656489"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656488"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656487"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656486"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679656485"><span class="annot"><a href="#local-6989586621679656485"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656484"><span class="annot"><a href="#local-6989586621679656484"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656483"><span class="annot"><a href="#local-6989586621679656483"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656482"><span class="annot"><a href="#local-6989586621679656482"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656481"><span class="annot"><a href="#local-6989586621679656481"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656485"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656484"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656483"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656482"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656481"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span id="local-6989586621679656480"><span class="annot"><a href="#local-6989586621679656480"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656479"><span class="annot"><a href="#local-6989586621679656479"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656478"><span class="annot"><a href="#local-6989586621679656478"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656477"><span class="annot"><a href="#local-6989586621679656477"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656476"><span class="annot"><a href="#local-6989586621679656476"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656480"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656479"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656478"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656476"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656477"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span id="TEPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-var">TEPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679656475"><span class="annot"><a href="#local-6989586621679656475"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656474"><span class="annot"><a href="#local-6989586621679656474"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656473"><span class="annot"><a href="#local-6989586621679656473"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656472"><span class="annot"><a href="#local-6989586621679656472"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656471"><span class="annot"><a href="#local-6989586621679656471"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656475"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656474"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656473"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656472"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656471"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">-- | Specifies the relative positional encoding layer of a transformer encoder.</span><span>
</span><span id="line-111"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-112"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656470"><span class="annot"><a href="#local-6989586621679656470"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656469"><span class="annot"><a href="#local-6989586621679656469"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656468"><span class="annot"><a href="#local-6989586621679656468"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656467"><span class="annot"><a href="#local-6989586621679656467"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656466"><span class="annot"><a href="#local-6989586621679656466"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656465"><span class="annot"><a href="#local-6989586621679656465"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679656464"><span class="annot"><a href="#local-6989586621679656464"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656463"><span class="annot"><a href="#local-6989586621679656463"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656462"><span class="annot"><a href="#local-6989586621679656462"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656461"><span class="annot"><a href="#local-6989586621679656461"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656460"><span class="annot"><a href="#local-6989586621679656460"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656464"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656463"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656462"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656460"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656461"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656459"><span class="annot"><a href="#local-6989586621679656459"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656458"><span class="annot"><a href="#local-6989586621679656458"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656457"><span class="annot"><a href="#local-6989586621679656457"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656456"><span class="annot"><a href="#local-6989586621679656456"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656455"><span class="annot"><a href="#local-6989586621679656455"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656459"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656458"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656457"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656456"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656455"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656454"><span class="annot"><a href="#local-6989586621679656454"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656453"><span class="annot"><a href="#local-6989586621679656453"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656452"><span class="annot"><a href="#local-6989586621679656452"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656451"><span class="annot"><a href="#local-6989586621679656451"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656450"><span class="annot"><a href="#local-6989586621679656450"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656454"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656453"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656452"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656451"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656450"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679656449"><span class="annot"><a href="#local-6989586621679656449"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656448"><span class="annot"><a href="#local-6989586621679656448"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656447"><span class="annot"><a href="#local-6989586621679656447"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656446"><span class="annot"><a href="#local-6989586621679656446"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656445"><span class="annot"><a href="#local-6989586621679656445"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656449"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656448"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656447"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656446"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656445"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span id="TERelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-var">TERelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679656444"><span class="annot"><a href="#local-6989586621679656444"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656443"><span class="annot"><a href="#local-6989586621679656443"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656442"><span class="annot"><a href="#local-6989586621679656442"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656441"><span class="annot"><a href="#local-6989586621679656441"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656440"><span class="annot"><a href="#local-6989586621679656440"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656444"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656443"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656442"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656441"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656440"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Specifies the initial layer normalization layer of a transformer encoder.</span><span>
</span><span id="line-130"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-131"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656439"><span class="annot"><a href="#local-6989586621679656439"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656438"><span class="annot"><a href="#local-6989586621679656438"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656437"><span class="annot"><a href="#local-6989586621679656437"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656436"><span class="annot"><a href="#local-6989586621679656436"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656435"><span class="annot"><a href="#local-6989586621679656435"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656434"><span class="annot"><a href="#local-6989586621679656434"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656433"><span class="annot"><a href="#local-6989586621679656433"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656432"><span class="annot"><a href="#local-6989586621679656432"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656431"><span class="annot"><a href="#local-6989586621679656431"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656434"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656433"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656432"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656431"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679656430"><span class="annot"><a href="#local-6989586621679656430"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656429"><span class="annot"><a href="#local-6989586621679656429"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656428"><span class="annot"><a href="#local-6989586621679656428"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656427"><span class="annot"><a href="#local-6989586621679656427"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656430"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656429"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656428"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679656427"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656426"><span class="annot"><a href="#local-6989586621679656426"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656425"><span class="annot"><a href="#local-6989586621679656425"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656424"><span class="annot"><a href="#local-6989586621679656424"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656423"><span class="annot"><a href="#local-6989586621679656423"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656426"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656425"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656424"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656423"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span id="local-6989586621679656422"><span class="annot"><a href="#local-6989586621679656422"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656421"><span class="annot"><a href="#local-6989586621679656421"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656420"><span class="annot"><a href="#local-6989586621679656420"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656419"><span class="annot"><a href="#local-6989586621679656419"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656422"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656421"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656420"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679656419"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span id="TEInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-var">TEInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679656418"><span class="annot"><a href="#local-6989586621679656418"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656417"><span class="annot"><a href="#local-6989586621679656417"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656416"><span class="annot"><a href="#local-6989586621679656416"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656415"><span class="annot"><a href="#local-6989586621679656415"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656418"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656417"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656416"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656415"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Specifies the initial dropout layer of a transformer encoder.</span><span>
</span><span id="line-148"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-149"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656414"><span class="annot"><a href="#local-6989586621679656414"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-153"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-154"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-155"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-158"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-159"></span><span>  </span><span id="TEInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-var">TEInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="hs-comment">-- | Specifies the transformer block stack of a transformer encoder.</span><span>
</span><span id="line-162"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-163"></span><span>  </span><span id="TEStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier hs-var">TEStackF</span></a></span></span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656413"><span class="annot"><a href="#local-6989586621679656413"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656412"><span class="annot"><a href="#local-6989586621679656412"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656411"><span class="annot"><a href="#local-6989586621679656411"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656410"><span class="annot"><a href="#local-6989586621679656410"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656409"><span class="annot"><a href="#local-6989586621679656409"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656408"><span class="annot"><a href="#local-6989586621679656408"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656407"><span class="annot"><a href="#local-6989586621679656407"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656406"><span class="annot"><a href="#local-6989586621679656406"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656405"><span class="annot"><a href="#local-6989586621679656405"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656404"><span class="annot"><a href="#local-6989586621679656404"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="TEStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier hs-var">TEStackF</span></a></span></span><span> </span><span id="local-6989586621679656403"><span class="annot"><a href="#local-6989586621679656403"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679656402"><span class="annot"><a href="#local-6989586621679656402"><span class="hs-identifier hs-type hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679656401"><span class="annot"><a href="#local-6989586621679656401"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656400"><span class="annot"><a href="#local-6989586621679656400"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656399"><span class="annot"><a href="#local-6989586621679656399"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656398"><span class="annot"><a href="#local-6989586621679656398"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656397"><span class="annot"><a href="#local-6989586621679656397"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656396"><span class="annot"><a href="#local-6989586621679656396"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679656395"><span class="annot"><a href="#local-6989586621679656395"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656394"><span class="annot"><a href="#local-6989586621679656394"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#GTransformerStack"><span class="hs-identifier hs-type">GTransformerStack</span></a></span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/33j53czfh9iaqr8w1k6rjcna7zg8rw55-vector-sized-lib-vector-sized-1.4.3.1-haddock-doc/share/doc/vector-sized/html/src"><span class="hs-identifier hs-type">VS.Vector</span></a></span><span>
</span><span id="line-180"></span><span>              </span><span class="annot"><a href="#local-6989586621679656402"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-181"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span>
</span><span id="line-182"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockSelfAttentionF"><span class="hs-identifier hs-type">EncoderBlockSelfAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656403"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656401"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656400"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656399"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656398"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656397"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656396"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656395"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockCrossAttentionF"><span class="hs-identifier hs-type">EncoderBlockCrossAttentionF</span></a></span><span>
</span><span id="line-184"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#EncoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-type">EncoderBlockFeedForwardNetworkF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656403"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656401"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656400"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656399"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656395"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656394"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-comment">-- | Specifies the final layer normalization layer of a transformer encoder.</span><span>
</span><span id="line-190"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-191"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656393"><span class="annot"><a href="#local-6989586621679656393"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656392"><span class="annot"><a href="#local-6989586621679656392"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656391"><span class="annot"><a href="#local-6989586621679656391"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656390"><span class="annot"><a href="#local-6989586621679656390"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656389"><span class="annot"><a href="#local-6989586621679656389"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679656388"><span class="annot"><a href="#local-6989586621679656388"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656387"><span class="annot"><a href="#local-6989586621679656387"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656386"><span class="annot"><a href="#local-6989586621679656386"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656385"><span class="annot"><a href="#local-6989586621679656385"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656388"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656387"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656386"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679656385"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-200"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656384"><span class="annot"><a href="#local-6989586621679656384"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656383"><span class="annot"><a href="#local-6989586621679656383"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656382"><span class="annot"><a href="#local-6989586621679656382"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656381"><span class="annot"><a href="#local-6989586621679656381"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656384"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656383"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656382"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656381"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-202"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656380"><span class="annot"><a href="#local-6989586621679656380"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656379"><span class="annot"><a href="#local-6989586621679656379"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656378"><span class="annot"><a href="#local-6989586621679656378"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656377"><span class="annot"><a href="#local-6989586621679656377"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656380"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656379"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656378"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656377"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679656376"><span class="annot"><a href="#local-6989586621679656376"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656375"><span class="annot"><a href="#local-6989586621679656375"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656374"><span class="annot"><a href="#local-6989586621679656374"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656373"><span class="annot"><a href="#local-6989586621679656373"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656376"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656375"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656374"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679656373"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>  </span><span id="TEFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-var">TEFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679656372"><span class="annot"><a href="#local-6989586621679656372"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656371"><span class="annot"><a href="#local-6989586621679656371"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656370"><span class="annot"><a href="#local-6989586621679656370"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656369"><span class="annot"><a href="#local-6989586621679656369"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656372"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656371"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656370"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656369"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Specifies the final dropout layer of a transformer encoder.</span><span>
</span><span id="line-208"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-209"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656368"><span class="annot"><a href="#local-6989586621679656368"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span id="TEFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-var">TEFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Specifies the parameters of a transformer in an encoder configuration.</span><span>
</span><span id="line-222"></span><span class="hs-comment">--</span><span>
</span><span id="line-223"></span><span class="hs-comment">-- - @style@: the style of the transformer stack, e.g. 'ST5', 'SByT5', etc.</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the stack's parameters.</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- - @device@: the computational device on which the stack is allocated.</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- - @dataType@: the data type of the stack's parameters.</span><span>
</span><span id="line-227"></span><span class="hs-comment">-- - @headDim@: the dimension of all transformer heads in the stack.</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- - @headEmbedDim@: the dimension of the transformer head embeddings.</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- - @embedDim@: the dimension of the transformer embeddings.</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- - @inputEmbedDim@: the dimension of the transformer query embeddings.</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- - @ffnDim@: the dimension of the feed-forward network.</span><span>
</span><span id="line-232"></span><span class="hs-comment">-- - @posEncDim@: the dimension of the positional encoding.</span><span>
</span><span id="line-233"></span><span class="hs-comment">-- - @dropoutP@: the dropout rate.</span><span>
</span><span id="line-234"></span><span class="hs-comment">-- - @eps@: the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-235"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier hs-type">transformerEncoderSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-236"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679656366"><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679656365"><span class="annot"><a href="#local-6989586621679656365"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679656364"><span class="annot"><a href="#local-6989586621679656364"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656363"><span class="annot"><a href="#local-6989586621679656363"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656362"><span class="annot"><a href="#local-6989586621679656362"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656361"><span class="annot"><a href="#local-6989586621679656361"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656360"><span class="annot"><a href="#local-6989586621679656360"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656359"><span class="annot"><a href="#local-6989586621679656359"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679656358"><span class="annot"><a href="#local-6989586621679656358"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656357"><span class="annot"><a href="#local-6989586621679656357"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679656356"><span class="annot"><a href="#local-6989586621679656356"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-237"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656365"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-239"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656361"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656360"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-244"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656359"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-245"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656358"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656357"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656356"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-248"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-249"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-250"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656358"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656356"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656361"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656356"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656358"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-type">TEInitialDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier hs-type">TEStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656365"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656361"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656360"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656359"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656358"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656357"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656358"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-type">TEFinalDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656366"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span id="transformerEncoderSpec"><span class="annot"><span class="annottext">transformerEncoderSpec :: STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformer
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
        (TERelPosEncF style gradient device dataType headDim posEncDim)
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
        (TEInitialDropoutF style)
        (TEStackF
           style
           numLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim)
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
        (TEFinalDropoutF style))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier hs-var hs-var">transformerEncoderSpec</span></a></span></span><span> </span><span id="local-6989586621679656355"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679656354"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679656354"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679656353"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656353"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679656352"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656352"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679656351"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656351"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679656350"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679656350"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679656349"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679656349"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656348"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679656348"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679656347"><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679656347"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656346"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679656346"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679656345"><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679656345"><span class="hs-identifier hs-var">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679656344"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679656343"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656343"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679656342"><span class="annot"><span class="annottext">posEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
</span><a href="#local-6989586621679656342"><span class="hs-identifier hs-var hs-var">posEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656337"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656337"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656337"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-266"></span><span>      </span><span class="annot"><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.position_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656337"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-267"></span><span>      </span><span class="annot"><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.position_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656337"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-268"></span><span>      </span><span class="annot"><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-269"></span><span>      </span><span id="local-6989586621679656330"><span class="annot"><span class="annottext">relPosEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TERelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679656330"><span class="hs-identifier hs-var hs-var">relPosEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679656329"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-270"></span><span>      </span><span class="annot"><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679656329"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-271"></span><span>      </span><span class="annot"><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>      </span><span class="annot"><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>      </span><span class="annot"><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TERelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-277"></span><span>      </span><span id="local-6989586621679656328"><span class="annot"><span class="annottext">initialLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679656328"><span class="hs-identifier hs-var hs-var">initialLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-281"></span><span>      </span><span class="annot"><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.LayerNorm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-283"></span><span>      </span><span class="annot"><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embeddings.LayerNorm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-284"></span><span>      </span><span class="annot"><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-285"></span><span>      </span><span id="local-6989586621679656326"><span class="annot"><span class="annottext">initialDropoutSpec :: STransformerStyle style -&gt; ModelSpec (TEInitialDropoutF style)
</span><a href="#local-6989586621679656326"><span class="hs-identifier hs-var hs-var">initialDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-286"></span><span>      </span><span class="annot"><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-287"></span><span>      </span><span class="annot"><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-288"></span><span>      </span><span class="annot"><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-289"></span><span>      </span><span class="annot"><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-290"></span><span>      </span><span class="annot"><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="annot"><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TEInitialDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-293"></span><span>      </span><span id="local-6989586621679656324"><span class="annot"><span class="annottext">stackSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF style gradient device dataType inputEmbedDim embedDim)
                          (KInProjF style gradient device dataType inputEmbedDim embedDim)
                          (VInProjF style gradient device dataType inputEmbedDim embedDim)
                          (OutProjF style gradient device dataType embedDim inputEmbedDim)
                          Dropout))
                    Dropout
                    (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style)
                    (FFNOutputProjectionF
                       style gradient device dataType inputEmbedDim ffnDim)
                    Dropout
                    (FFNOutputLayerNormF
                       style gradient device dataType inputEmbedDim))))))
</span><a href="#local-6989586621679656324"><span class="hs-identifier hs-var hs-var">stackSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel ())))
                     Dropout))
               Dropout
               ()))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel ())))
               Relu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel ())))
               Dropout
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel ())))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'T5 gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'T5 gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF 'T5 gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'T5 gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'T5 gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'T5)
                 (FFNActivationDropoutF 'T5)
                 (FFNOutputProjectionF
                    'T5 gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'T5 gradient device dataType inputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-294"></span><span>      </span><span class="annot"><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel ())))
                     Dropout))
               Dropout
               ()))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
               (GGate
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, inputEmbedDim])))
                        (NamedModel ())))
                  GeluNew
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, inputEmbedDim])))
                        (NamedModel ()))))
               GeluNew
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel ())))
               Dropout
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (GGate
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ())))
                        GeluNew
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ()))))
                     GeluNew
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'ByT5 gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF 'ByT5 gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'ByT5 gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'ByT5)
                 (FFNActivationDropoutF 'ByT5)
                 (FFNOutputProjectionF
                    'ByT5 gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'ByT5 gradient device dataType inputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'BART gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'BART gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF 'BART gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'BART gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'BART gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'BART)
                 (FFNActivationDropoutF 'BART)
                 (FFNOutputProjectionF
                    'BART gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'BART gradient device dataType inputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="annot"><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'MBART gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'MBART gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF 'MBART gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'MBART gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'MBART gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'MBART)
                 (FFNActivationDropoutF 'MBART)
                 (FFNOutputProjectionF
                    'MBART gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'MBART gradient device dataType inputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout))
               Dropout
               ()))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Relu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               Dropout
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 ()))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    ()))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'Pegasus gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'Pegasus gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'Pegasus)
                 (FFNActivationDropoutF 'Pegasus)
                 (FFNOutputProjectionF
                    'Pegasus gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'Pegasus gradient device dataType inputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;encoder.layer.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF 'BERT gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'BERT gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'BERT gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'BERT gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'BERT gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF 'BERT gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF 'BERT gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'BERT gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'BERT)
                 (FFNActivationDropoutF 'BERT)
                 (FFNOutputProjectionF
                    'BERT gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'BERT gradient device dataType inputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span>
</span><span id="line-299"></span><span>      </span><span class="annot"><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;encoder.layer.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
         ()
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, inputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, inputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, inputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias gradient device dataType ('Shape '[inputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF 'RoBERTa gradient device dataType inputEmbedDim embedDim)
                       (KInProjF 'RoBERTa gradient device dataType inputEmbedDim embedDim)
                       (VInProjF 'RoBERTa gradient device dataType inputEmbedDim embedDim)
                       (OutProjF 'RoBERTa gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    'RoBERTa gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF 'RoBERTa)
                 (FFNActivationDropoutF 'RoBERTa)
                 (FFNOutputProjectionF
                    'RoBERTa gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'RoBERTa gradient device dataType inputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-301"></span><span>      </span><span id="local-6989586621679656322"><span class="annot"><span class="annottext">finalLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679656322"><span class="hs-identifier hs-var hs-var">finalLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-302"></span><span>      </span><span class="annot"><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-303"></span><span>      </span><span class="annot"><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>      </span><span class="annot"><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>      </span><span class="annot"><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[inputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[inputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-306"></span><span>      </span><span class="annot"><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>      </span><span class="annot"><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>      </span><span class="annot"><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-309"></span><span>      </span><span id="local-6989586621679656321"><span class="annot"><span class="annottext">finalDropoutSpec :: STransformerStyle style -&gt; ModelSpec (TEFinalDropoutF style)
</span><a href="#local-6989586621679656321"><span class="hs-identifier hs-var hs-var">finalDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-310"></span><span>      </span><span class="annot"><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-311"></span><span>      </span><span class="annot"><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>      </span><span class="annot"><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>      </span><span class="annot"><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TEFinalDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-317"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
-&gt; ModelSpec
     (TERelPosEncF style gradient device dataType headDim posEncDim)
-&gt; ModelSpec
     (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
-&gt; ModelSpec (TEInitialDropoutF style)
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF style gradient device dataType inputEmbedDim embedDim)
                          (KInProjF style gradient device dataType inputEmbedDim embedDim)
                          (VInProjF style gradient device dataType inputEmbedDim embedDim)
                          (OutProjF style gradient device dataType embedDim inputEmbedDim)
                          Dropout))
                    Dropout
                    (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style)
                    (FFNOutputProjectionF
                       style gradient device dataType inputEmbedDim ffnDim)
                    Dropout
                    (FFNOutputLayerNormF
                       style gradient device dataType inputEmbedDim))))))
-&gt; ModelSpec
     (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
-&gt; ModelSpec (TEFinalDropoutF style)
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style))
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
</span><a href="#local-6989586621679656342"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TERelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679656330"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679656328"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; ModelSpec (TEInitialDropoutF style)
</span><a href="#local-6989586621679656326"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF style gradient device dataType inputEmbedDim embedDim)
                          (KInProjF style gradient device dataType inputEmbedDim embedDim)
                          (VInProjF style gradient device dataType inputEmbedDim embedDim)
                          (OutProjF style gradient device dataType embedDim inputEmbedDim)
                          Dropout))
                    Dropout
                    (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
              ()
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType inputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style)
                    (FFNOutputProjectionF
                       style gradient device dataType inputEmbedDim ffnDim)
                    Dropout
                    (FFNOutputLayerNormF
                       style gradient device dataType inputEmbedDim))))))
</span><a href="#local-6989586621679656324"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
</span><a href="#local-6989586621679656322"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; ModelSpec (TEFinalDropoutF style)
</span><a href="#local-6989586621679656321"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656355"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="#local-6989586621679656323"><span class="hs-identifier hs-type">stackSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-320"></span><span>    </span><span id="local-6989586621679656323"><span class="annot"><span class="annottext">stackSpec' :: STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF style gradient device dataType inputEmbedDim embedDim)
                       (KInProjF style gradient device dataType inputEmbedDim embedDim)
                       (VInProjF style gradient device dataType inputEmbedDim embedDim)
                       (OutProjF style gradient device dataType embedDim inputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
           ()
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType inputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType inputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType inputEmbedDim)))))
</span><a href="#local-6989586621679656323"><span class="hs-identifier hs-var hs-var">stackSpec'</span></a></span></span><span> </span><span id="local-6989586621679656320"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656320"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerStack
        (Vector
           numLayers
           (GTransformerBlock
              (EncoderBlockSelfAttentionF
                 style
                 gradient
                 device
                 dataType
                 headDim
                 headEmbedDim
                 embedDim
                 inputEmbedDim)
              EncoderBlockCrossAttentionF
              (EncoderBlockFeedForwardNetworkF
                 style gradient device dataType inputEmbedDim ffnDim))))
forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerStack
        (Vector
           numLayers
           (GTransformerBlock
              (EncoderBlockSelfAttentionF
                 style
                 gradient
                 device
                 dataType
                 headDim
                 headEmbedDim
                 embedDim
                 queryEmbedDim)
              EncoderBlockCrossAttentionF
              (EncoderBlockFeedForwardNetworkF
                 style gradient device dataType queryEmbedDim ffnDim))))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#encoderStackSpec"><span class="hs-identifier hs-var">encoderStackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656320"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679656354"><span class="hs-identifier hs-var">numLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656353"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656352"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656351"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679656350"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679656349"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679656348"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679656347"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679656346"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656344"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656343"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="annot"><a href="#local-6989586621679656327"><span class="hs-identifier hs-type">layerNormSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-322"></span><span>    </span><span id="local-6989586621679656327"><span class="annot"><span class="annottext">layerNormSpec' :: SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
</span><a href="#local-6989586621679656327"><span class="hs-identifier hs-var hs-var">layerNormSpec'</span></a></span></span><span> </span><span id="local-6989586621679656319"><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679656319"><span class="hs-identifier hs-var">hasBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[inputEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[inputEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679656319"><span class="hs-identifier hs-var">hasBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656353"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656352"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656351"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[inputEmbedDim] -&gt; SShape ('Shape '[inputEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[inputEmbedDim] -&gt; SShape ('Shape '[inputEmbedDim]))
-&gt; SList '[inputEmbedDim] -&gt; SShape ('Shape '[inputEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sing inputEmbedDim
SDim inputEmbedDim
</span><a href="#local-6989586621679656347"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">Sing inputEmbedDim -&gt; SList '[] -&gt; SList '[inputEmbedDim]
forall a1 (a2 :: a1) (as :: [a1]).
Sing a2 -&gt; SList as -&gt; SList (a2 : as)
</span><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656343"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span id="local-6989586621679656329"><span class="annot"><span class="annottext">relPosEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679656329"><span class="hs-identifier hs-var hs-var">relPosEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim headDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656353"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656352"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656351"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679656345"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679656350"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span id="local-6989586621679656337"><span class="annot"><span class="annottext">posEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656337"><span class="hs-identifier hs-var hs-var">posEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim inputEmbedDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     inputEmbedDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656353"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656352"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656351"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679656345"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679656347"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-comment">-- | Specifies the absolute positional encoding layer of a transformer decoder.</span><span>
</span><span id="line-327"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-328"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656313"><span class="annot"><a href="#local-6989586621679656313"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656312"><span class="annot"><a href="#local-6989586621679656312"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656311"><span class="annot"><a href="#local-6989586621679656311"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656310"><span class="annot"><a href="#local-6989586621679656310"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656309"><span class="annot"><a href="#local-6989586621679656309"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656308"><span class="annot"><a href="#local-6989586621679656308"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-335"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656307"><span class="annot"><a href="#local-6989586621679656307"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656306"><span class="annot"><a href="#local-6989586621679656306"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656305"><span class="annot"><a href="#local-6989586621679656305"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656304"><span class="annot"><a href="#local-6989586621679656304"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656303"><span class="annot"><a href="#local-6989586621679656303"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656307"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656306"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656305"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656304"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656303"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-339"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679656302"><span class="annot"><a href="#local-6989586621679656302"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656301"><span class="annot"><a href="#local-6989586621679656301"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656300"><span class="annot"><a href="#local-6989586621679656300"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656299"><span class="annot"><a href="#local-6989586621679656299"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656298"><span class="annot"><a href="#local-6989586621679656298"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656302"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656301"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656300"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656298"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656299"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656297"><span class="annot"><a href="#local-6989586621679656297"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656296"><span class="annot"><a href="#local-6989586621679656296"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656295"><span class="annot"><a href="#local-6989586621679656295"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656294"><span class="annot"><a href="#local-6989586621679656294"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656293"><span class="annot"><a href="#local-6989586621679656293"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656297"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656296"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656295"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656294"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656293"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-341"></span><span>  </span><span id="TDPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-var">TDPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679656292"><span class="annot"><a href="#local-6989586621679656292"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656291"><span class="annot"><a href="#local-6989586621679656291"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656290"><span class="annot"><a href="#local-6989586621679656290"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656289"><span class="annot"><a href="#local-6989586621679656289"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656288"><span class="annot"><a href="#local-6989586621679656288"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656292"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656291"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656290"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656289"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656288"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-342"></span><span>
</span><span id="line-343"></span><span class="hs-comment">-- | Specifies the relative positional encoding layer of a transformer decoder.</span><span>
</span><span id="line-344"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-345"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656287"><span class="annot"><a href="#local-6989586621679656287"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656286"><span class="annot"><a href="#local-6989586621679656286"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656285"><span class="annot"><a href="#local-6989586621679656285"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656284"><span class="annot"><a href="#local-6989586621679656284"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656283"><span class="annot"><a href="#local-6989586621679656283"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656282"><span class="annot"><a href="#local-6989586621679656282"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-354"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679656281"><span class="annot"><a href="#local-6989586621679656281"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656280"><span class="annot"><a href="#local-6989586621679656280"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656279"><span class="annot"><a href="#local-6989586621679656279"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656278"><span class="annot"><a href="#local-6989586621679656278"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656277"><span class="annot"><a href="#local-6989586621679656277"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656281"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656280"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656279"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656277"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656278"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656276"><span class="annot"><a href="#local-6989586621679656276"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656275"><span class="annot"><a href="#local-6989586621679656275"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656274"><span class="annot"><a href="#local-6989586621679656274"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656273"><span class="annot"><a href="#local-6989586621679656273"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656272"><span class="annot"><a href="#local-6989586621679656272"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656276"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656275"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656274"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656273"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656272"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656271"><span class="annot"><a href="#local-6989586621679656271"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656270"><span class="annot"><a href="#local-6989586621679656270"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656269"><span class="annot"><a href="#local-6989586621679656269"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656268"><span class="annot"><a href="#local-6989586621679656268"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656267"><span class="annot"><a href="#local-6989586621679656267"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656271"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656270"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656269"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656268"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656267"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span id="TDRelPosEncF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-var">TDRelPosEncF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679656266"><span class="annot"><a href="#local-6989586621679656266"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656265"><span class="annot"><a href="#local-6989586621679656265"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656264"><span class="annot"><a href="#local-6989586621679656264"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656263"><span class="annot"><a href="#local-6989586621679656263"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656262"><span class="annot"><a href="#local-6989586621679656262"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656266"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656265"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656264"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656263"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656262"><span class="hs-identifier hs-type">posEncDim</span></a></span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | Specifies the initial layer normalization layer of a transformer decoder.</span><span>
</span><span id="line-361"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-362"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656261"><span class="annot"><a href="#local-6989586621679656261"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656260"><span class="annot"><a href="#local-6989586621679656260"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656259"><span class="annot"><a href="#local-6989586621679656259"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656258"><span class="annot"><a href="#local-6989586621679656258"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656257"><span class="annot"><a href="#local-6989586621679656257"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-370"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656256"><span class="annot"><a href="#local-6989586621679656256"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656255"><span class="annot"><a href="#local-6989586621679656255"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656254"><span class="annot"><a href="#local-6989586621679656254"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656253"><span class="annot"><a href="#local-6989586621679656253"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-type">TDInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656256"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656255"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656254"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656253"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-372"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679656252"><span class="annot"><a href="#local-6989586621679656252"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656251"><span class="annot"><a href="#local-6989586621679656251"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656250"><span class="annot"><a href="#local-6989586621679656250"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656249"><span class="annot"><a href="#local-6989586621679656249"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656252"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656251"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656250"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679656249"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656248"><span class="annot"><a href="#local-6989586621679656248"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656247"><span class="annot"><a href="#local-6989586621679656247"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656246"><span class="annot"><a href="#local-6989586621679656246"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656245"><span class="annot"><a href="#local-6989586621679656245"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-type">TDInitialLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656248"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656247"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656246"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656245"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-374"></span><span>  </span><span id="TDInitialLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-var">TDInitialLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span class="hs-comment">-- | Specifies the initial dropout layer of a transformer decoder.</span><span>
</span><span id="line-377"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-378"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656244"><span class="annot"><a href="#local-6989586621679656244"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-383"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-386"></span><span>  </span><span id="TDInitialDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-var">TDInitialDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="hs-comment">-- | Specifies the transformer block stack of a transformer decoder.</span><span>
</span><span id="line-389"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-390"></span><span>  </span><span id="TDStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier hs-var">TDStackF</span></a></span></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656243"><span class="annot"><a href="#local-6989586621679656243"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656242"><span class="annot"><a href="#local-6989586621679656242"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656241"><span class="annot"><a href="#local-6989586621679656241"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656240"><span class="annot"><a href="#local-6989586621679656240"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656239"><span class="annot"><a href="#local-6989586621679656239"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656238"><span class="annot"><a href="#local-6989586621679656238"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656237"><span class="annot"><a href="#local-6989586621679656237"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656236"><span class="annot"><a href="#local-6989586621679656236"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656235"><span class="annot"><a href="#local-6989586621679656235"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656234"><span class="annot"><a href="#local-6989586621679656234"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656233"><span class="annot"><a href="#local-6989586621679656233"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-403"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-404"></span><span>  </span><span id="TDStackF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier hs-var">TDStackF</span></a></span></span><span> </span><span id="local-6989586621679656232"><span class="annot"><a href="#local-6989586621679656232"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679656231"><span class="annot"><a href="#local-6989586621679656231"><span class="hs-identifier hs-type hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679656230"><span class="annot"><a href="#local-6989586621679656230"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656229"><span class="annot"><a href="#local-6989586621679656229"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656228"><span class="annot"><a href="#local-6989586621679656228"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656227"><span class="annot"><a href="#local-6989586621679656227"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656226"><span class="annot"><a href="#local-6989586621679656226"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656225"><span class="annot"><a href="#local-6989586621679656225"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679656224"><span class="annot"><a href="#local-6989586621679656224"><span class="hs-identifier hs-type hs-type">decoderInputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656223"><span class="annot"><a href="#local-6989586621679656223"><span class="hs-identifier hs-type hs-type">encoderOutputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656222"><span class="annot"><a href="#local-6989586621679656222"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-406"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#GTransformerStack"><span class="hs-identifier hs-type">GTransformerStack</span></a></span><span>
</span><span id="line-407"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/33j53czfh9iaqr8w1k6rjcna7zg8rw55-vector-sized-lib-vector-sized-1.4.3.1-haddock-doc/share/doc/vector-sized/html/src"><span class="hs-identifier hs-type">VS.Vector</span></a></span><span>
</span><span id="line-408"></span><span>              </span><span class="annot"><a href="#local-6989586621679656231"><span class="hs-identifier hs-type">numLayers</span></a></span><span>
</span><span id="line-409"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#GTransformerBlock"><span class="hs-identifier hs-type">GTransformerBlock</span></a></span><span>
</span><span id="line-410"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockSelfAttentionF"><span class="hs-identifier hs-type">DecoderBlockSelfAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656232"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656230"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656229"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656228"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656227"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656226"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656225"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656224"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockCrossAttentionF"><span class="hs-identifier hs-type">DecoderBlockCrossAttentionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656232"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656230"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656229"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656228"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656227"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656226"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656225"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656224"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656223"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GBlock.html#DecoderBlockFeedForwardNetworkF"><span class="hs-identifier hs-type">DecoderBlockFeedForwardNetworkF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656232"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656230"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656229"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656228"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656224"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656222"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>
</span><span id="line-417"></span><span class="hs-comment">-- | Specifies the final layer normalization layer of a transformer decoder.</span><span>
</span><span id="line-418"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-419"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656221"><span class="annot"><a href="#local-6989586621679656221"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656220"><span class="annot"><a href="#local-6989586621679656220"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656219"><span class="annot"><a href="#local-6989586621679656219"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656218"><span class="annot"><a href="#local-6989586621679656218"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656217"><span class="annot"><a href="#local-6989586621679656217"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-426"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-427"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679656216"><span class="annot"><a href="#local-6989586621679656216"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656215"><span class="annot"><a href="#local-6989586621679656215"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656214"><span class="annot"><a href="#local-6989586621679656214"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656213"><span class="annot"><a href="#local-6989586621679656213"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656216"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656215"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656214"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679656213"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679656212"><span class="annot"><a href="#local-6989586621679656212"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656211"><span class="annot"><a href="#local-6989586621679656211"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656210"><span class="annot"><a href="#local-6989586621679656210"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656209"><span class="annot"><a href="#local-6989586621679656209"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-type">TDFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656212"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656211"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656210"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656209"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679656208"><span class="annot"><a href="#local-6989586621679656208"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656207"><span class="annot"><a href="#local-6989586621679656207"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656206"><span class="annot"><a href="#local-6989586621679656206"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656205"><span class="annot"><a href="#local-6989586621679656205"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-type">TDFinalLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656208"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656207"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656206"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656205"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-431"></span><span>  </span><span id="TDFinalLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-var">TDFinalLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679656204"><span class="annot"><a href="#local-6989586621679656204"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656203"><span class="annot"><a href="#local-6989586621679656203"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656202"><span class="annot"><a href="#local-6989586621679656202"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656201"><span class="annot"><a href="#local-6989586621679656201"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656204"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656203"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656202"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679656201"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="hs-comment">-- | Specifies the final dropout layer of a transformer decoder.</span><span>
</span><span id="line-434"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-435"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679656200"><span class="annot"><a href="#local-6989586621679656200"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-437"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-438"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-439"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-440"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>  </span><span id="TDFinalDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-var">TDFinalDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="hs-comment">-- | Specifies the parameters of a transformer in a decoder configuration.</span><span>
</span><span id="line-446"></span><span class="hs-comment">--</span><span>
</span><span id="line-447"></span><span class="hs-comment">-- - @style@: the style of the transformer stack, e.g. 'ST5', 'SByT5', etc.</span><span>
</span><span id="line-448"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the stack's parameters.</span><span>
</span><span id="line-449"></span><span class="hs-comment">-- - @device@: the computational device on which the stack is allocated.</span><span>
</span><span id="line-450"></span><span class="hs-comment">-- - @dataType@: the data type of the stack's parameters.</span><span>
</span><span id="line-451"></span><span class="hs-comment">-- - @headDim@: the dimension of all transformer heads in the stack.</span><span>
</span><span id="line-452"></span><span class="hs-comment">-- - @headEmbedDim@: the dimension of the transformer head embeddings.</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- - @embedDim@: the dimension of the transformer embeddings.</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- - @decoderInputEmbedDim@: the dimension of the decoder input embeddings.</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- - @encoderOutputEmbedDim@: the dimension of the encoder output embeddings.</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- - @ffnDim@: the dimension of the feed-forward network.</span><span>
</span><span id="line-457"></span><span class="hs-comment">-- - @posEncDim@: the dimension of the positional encoding.</span><span>
</span><span id="line-458"></span><span class="hs-comment">-- - @dropoutP@: the dropout rate.</span><span>
</span><span id="line-459"></span><span class="hs-comment">-- - @eps@: the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-460"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier hs-type">transformerDecoderSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679656198"><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679656197"><span class="annot"><a href="#local-6989586621679656197"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679656196"><span class="annot"><a href="#local-6989586621679656196"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679656195"><span class="annot"><a href="#local-6989586621679656195"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679656194"><span class="annot"><a href="#local-6989586621679656194"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679656193"><span class="annot"><a href="#local-6989586621679656193"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679656192"><span class="annot"><a href="#local-6989586621679656192"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656191"><span class="annot"><a href="#local-6989586621679656191"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679656190"><span class="annot"><a href="#local-6989586621679656190"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656189"><span class="annot"><a href="#local-6989586621679656189"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656188"><span class="annot"><a href="#local-6989586621679656188"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679656187"><span class="annot"><a href="#local-6989586621679656187"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-463"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656197"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656196"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-465"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656195"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656194"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-467"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656193"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-468"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656192"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-469"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656191"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656190"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656189"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-472"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656188"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-473"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656187"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-474"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-475"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-476"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-477"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span>
</span><span id="line-478"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656196"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656195"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656194"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656190"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656187"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656196"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656195"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656194"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656193"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656187"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-480"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-type">TDInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656196"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656195"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656194"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656190"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-type">TDInitialDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier hs-type">TDStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656197"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656196"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656195"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656194"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656193"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656192"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656191"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656190"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656189"><span class="hs-identifier hs-type">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656188"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-type">TDFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656196"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656195"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656194"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656190"><span class="hs-identifier hs-type">decoderInputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-type">TDFinalDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656198"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span id="transformerDecoderSpec"><span class="annot"><span class="annottext">transformerDecoderSpec :: STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim decoderInputEmbedDim
-&gt; SDim encoderOutputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformer
        (TDPosEncF
           style gradient device dataType decoderInputEmbedDim posEncDim)
        (TDRelPosEncF style gradient device dataType headDim posEncDim)
        (TDInitialLayerNormF
           style gradient device dataType decoderInputEmbedDim)
        (TDInitialDropoutF style)
        (TDStackF
           style
           numLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           decoderInputEmbedDim
           encoderOutputEmbedDim
           ffnDim)
        (TDFinalLayerNormF
           style gradient device dataType decoderInputEmbedDim)
        (TDFinalDropoutF style))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier hs-var hs-var">transformerDecoderSpec</span></a></span></span><span> </span><span id="local-6989586621679656186"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679656185"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679656185"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679656184"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656184"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679656183"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656183"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679656182"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656182"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679656181"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679656181"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679656180"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679656180"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656179"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679656179"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679656178"><span class="annot"><span class="annottext">SDim decoderInputEmbedDim
</span><a href="#local-6989586621679656178"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656177"><span class="annot"><span class="annottext">SDim encoderOutputEmbedDim
</span><a href="#local-6989586621679656177"><span class="hs-identifier hs-var">encoderOutputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679656176"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679656176"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679656175"><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679656175"><span class="hs-identifier hs-var">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679656174"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679656173"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656173"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679656172"><span class="annot"><span class="annottext">posEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDPosEncF
        style gradient device dataType decoderInputEmbedDim posEncDim)
</span><a href="#local-6989586621679656172"><span class="hs-identifier hs-var hs-var">posEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>      </span><span class="annot"><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        decoderInputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656171"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-490"></span><span>      </span><span class="annot"><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        decoderInputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656171"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-491"></span><span>      </span><span class="annot"><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        decoderInputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;embed_positions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656171"><span class="hs-identifier hs-var">posEncSpec'</span></a></span><span>
</span><span id="line-492"></span><span>      </span><span class="annot"><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-493"></span><span>      </span><span class="annot"><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-494"></span><span>      </span><span class="annot"><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-495"></span><span>      </span><span id="local-6989586621679656170"><span class="annot"><span class="annottext">relPosEncSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDRelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679656170"><span class="hs-identifier hs-var hs-var">relPosEncSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679656169"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-496"></span><span>      </span><span class="annot"><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        posEncDim
        headDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.0.layer.0.SelfAttention.relative_attention_bias.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679656169"><span class="hs-identifier hs-var">relPosEncSpec'</span></a></span><span>
</span><span id="line-497"></span><span>      </span><span class="annot"><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>      </span><span class="annot"><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>      </span><span class="annot"><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>      </span><span class="annot"><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDRelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-501"></span><span>      </span><span class="annot"><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDRelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-502"></span><span>      </span><span class="annot"><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDRelPosEncF style gradient device dataType headDim posEncDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-503"></span><span>      </span><span id="local-6989586621679656168"><span class="annot"><span class="annottext">initialLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDInitialLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679656168"><span class="hs-identifier hs-var hs-var">initialLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>      </span><span class="annot"><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>      </span><span class="annot"><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679656167"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-506"></span><span>      </span><span class="annot"><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layernorm_embedding.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679656167"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-507"></span><span>      </span><span class="annot"><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>      </span><span class="annot"><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDInitialLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-509"></span><span>      </span><span class="annot"><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDInitialLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-510"></span><span>      </span><span class="annot"><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDInitialLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-511"></span><span>      </span><span id="local-6989586621679656166"><span class="annot"><span class="annottext">initialDropoutSpec :: STransformerStyle style -&gt; ModelSpec (TDInitialDropoutF style)
</span><a href="#local-6989586621679656166"><span class="hs-identifier hs-var hs-var">initialDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-512"></span><span>      </span><span class="annot"><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-513"></span><span>      </span><span class="annot"><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-514"></span><span>      </span><span class="annot"><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-515"></span><span>      </span><span class="annot"><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-516"></span><span>      </span><span class="annot"><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDInitialDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-517"></span><span>      </span><span class="annot"><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDInitialDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-518"></span><span>      </span><span class="annot"><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDInitialDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-519"></span><span>      </span><span id="local-6989586621679656165"><span class="annot"><span class="annottext">stackSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          Dropout))
                    Dropout
                    (SAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GCrossAttention
                    (CAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          Dropout))
                    Dropout
                    (CAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style)
                    (FFNOutputProjectionF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    Dropout
                    (FFNOutputLayerNormF
                       style gradient device dataType decoderInputEmbedDim))))))
</span><a href="#local-6989586621679656165"><span class="hs-identifier hs-var hs-var">stackSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     Dropout))
               Dropout
               ()))
         (NamedModel
            (GCrossAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     Dropout))
               Dropout
               ()))
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel ())))
               Relu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel ())))
               Dropout
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel ())))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'T5 gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'T5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'T5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'T5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'T5 gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'T5 gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'T5)
                 (FFNActivationDropoutF 'T5)
                 (FFNOutputProjectionF
                    'T5 gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'T5 gradient device dataType decoderInputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679656164"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-520"></span><span>      </span><span class="annot"><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;block.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     Dropout))
               Dropout
               ()))
         (NamedModel
            (GCrossAttention
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel ())))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel ())))
                     Dropout))
               Dropout
               ()))
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithoutBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (GGate
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, decoderInputEmbedDim])))
                        (NamedModel ())))
                  GeluNew
                  (NamedModel
                     (GLinear
                        (NamedModel
                           (Tensor
                              gradient
                              ('Layout 'Dense)
                              device
                              dataType
                              ('Shape '[ffnDim, decoderInputEmbedDim])))
                        (NamedModel ()))))
               GeluNew
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel ())))
               Dropout
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (GGate
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, decoderInputEmbedDim])))
                              (NamedModel ())))
                        GeluNew
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, decoderInputEmbedDim])))
                              (NamedModel ()))))
                     GeluNew
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel ())))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel ())))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithoutBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (GGate
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ())))
                    GeluNew
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel ()))))
                 GeluNew
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel ())))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel ())))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel ())))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithoutBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (GGate
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ())))
                       GeluNew
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, decoderInputEmbedDim])))
                             (NamedModel ()))))
                    GeluNew
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel ())))
                    Dropout
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'ByT5 gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'ByT5 gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'ByT5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'ByT5 gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'ByT5 gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'ByT5 gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'ByT5)
                 (FFNActivationDropoutF 'ByT5)
                 (FFNOutputProjectionF
                    'ByT5 gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'ByT5 gradient device dataType decoderInputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679656164"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-521"></span><span>      </span><span class="annot"><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GCrossAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GCrossAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'BART gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'BART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'BART gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'BART gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'BART gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'BART gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'BART)
                 (FFNActivationDropoutF 'BART)
                 (FFNOutputProjectionF
                    'BART gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'BART gradient device dataType decoderInputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679656164"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-522"></span><span>      </span><span class="annot"><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GCrossAttention
               ()
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))
         (NamedModel
            (GTransformerFeedForwardNetwork
               ()
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Gelu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               Dropout
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GCrossAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GCrossAttention
                 ()
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 ()
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Gelu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 Dropout
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GCrossAttention
                    ()
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    ()
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Gelu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    Dropout
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim]))))))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'MBART gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'MBART gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'MBART gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'MBART gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'MBART gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'MBART gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'MBART)
                 (FFNActivationDropoutF 'MBART)
                 (FFNOutputProjectionF
                    'MBART gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'MBART gradient device dataType decoderInputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679656164"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    Dropout
                    ())))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layers.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerStack
   (VectorSpec
      numLayers
      (GTransformerBlock
         (NamedModel
            (GSelfAttention
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout))
               Dropout
               ()))
         (NamedModel
            (GCrossAttention
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GMultiHeadAttention
                     headDim
                     headEmbedDim
                     embedDim
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[embedDim, encoderOutputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[embedDim])))))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, embedDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout))
               Dropout
               ()))
         (NamedModel
            (GTransformerFeedForwardNetwork
               (NamedModel
                  (LayerNorm
                     'WithBias
                     gradient
                     device
                     dataType
                     ('Shape '[decoderInputEmbedDim])))
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[ffnDim, decoderInputEmbedDim])))
                     (NamedModel
                        (Tensor
                           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
               Relu
               Dropout
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim, ffnDim])))
                     (NamedModel
                        (Tensor
                           gradient
                           ('Layout 'Dense)
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))))
               Dropout
               ()))))
 -&gt; NamedModel
      (GTransformerStack
         (VectorSpec
            numLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, decoderInputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, encoderOutputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[decoderInputEmbedDim])))))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[decoderInputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, decoderInputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[decoderInputEmbedDim])))))
                     Dropout
                     ()))))))
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GCrossAttention
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, decoderInputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim, encoderOutputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[embedDim])))))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim, embedDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[decoderInputEmbedDim])))))
                       Dropout))
                 Dropout
                 ()))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (NamedModel
                    (LayerNorm
                       'WithBias
                       gradient
                       device
                       dataType
                       ('Shape '[decoderInputEmbedDim])))
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[ffnDim, decoderInputEmbedDim])))
                       (NamedModel
                          (Tensor
                             gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                 Relu
                 Dropout
                 (NamedModel
                    (GLinear
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim, ffnDim])))
                       (NamedModel
                          (Tensor
                             gradient
                             ('Layout 'Dense)
                             device
                             dataType
                             ('Shape '[decoderInputEmbedDim])))))
                 Dropout
                 ()))))
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GCrossAttention
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, decoderInputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim, encoderOutputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[embedDim])))))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim, embedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[decoderInputEmbedDim])))))
                          Dropout))
                    Dropout
                    ()))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (NamedModel
                       (LayerNorm
                          'WithBias
                          gradient
                          device
                          dataType
                          ('Shape '[decoderInputEmbedDim])))
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[ffnDim, decoderInputEmbedDim])))
                          (NamedModel
                             (Tensor
                                gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                    Relu
                    Dropout
                    (NamedModel
                       (GLinear
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim, ffnDim])))
                          (NamedModel
                             (Tensor
                                gradient
                                ('Layout 'Dense)
                                device
                                dataType
                                ('Shape '[decoderInputEmbedDim])))))
                    Dropout
                    ())))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          'Pegasus gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          'Pegasus gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          'Pegasus gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          'Pegasus gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          'Pegasus gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    'Pegasus gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF 'Pegasus)
                 (FFNActivationDropoutF 'Pegasus)
                 (FFNOutputProjectionF
                    'Pegasus gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    'Pegasus gradient device dataType decoderInputEmbedDim)))))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679656164"><span class="hs-identifier hs-var">stackSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-524"></span><span>      </span><span class="annot"><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-525"></span><span>      </span><span class="annot"><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-526"></span><span>      </span><span class="annot"><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim))))))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-527"></span><span>      </span><span id="local-6989586621679656163"><span class="annot"><span class="annottext">finalLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (TDFinalLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679656163"><span class="hs-identifier hs-var hs-var">finalLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias
   gradient
   device
   dataType
   ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679656167"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-528"></span><span>      </span><span class="annot"><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithoutBias
   gradient
   device
   dataType
   ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithoutBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; LayerNormSpec
     'WithoutBias
     gradient
     device
     dataType
     ('Shape '[decoderInputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679656167"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span>
</span><span id="line-529"></span><span>      </span><span class="annot"><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-530"></span><span>      </span><span class="annot"><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-531"></span><span>      </span><span class="annot"><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(LayerNormSpec
   'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
 -&gt; NamedModel
      (LayerNormSpec
         'WithBias
         gradient
         device
         dataType
         ('Shape '[decoderInputEmbedDim])))
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias
        gradient
        device
        dataType
        ('Shape '[decoderInputEmbedDim]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall (hasBias :: HasBias).
SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679656167"><span class="hs-identifier hs-var">layerNormSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span>
</span><span id="line-532"></span><span>      </span><span class="annot"><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDFinalLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-533"></span><span>      </span><span class="annot"><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDFinalLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-534"></span><span>      </span><span class="annot"><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDFinalLayerNormF
     style gradient device dataType decoderInputEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-535"></span><span>      </span><span id="local-6989586621679656162"><span class="annot"><span class="annottext">finalDropoutSpec :: STransformerStyle style -&gt; ModelSpec (TDFinalDropoutF style)
</span><a href="#local-6989586621679656162"><span class="hs-identifier hs-var hs-var">finalDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-536"></span><span>      </span><span class="annot"><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-537"></span><span>      </span><span class="annot"><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-538"></span><span>      </span><span class="annot"><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>      </span><span class="annot"><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>      </span><span class="annot"><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDFinalDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-541"></span><span>      </span><span class="annot"><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDFinalDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (TDFinalDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-543"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (TDPosEncF
     style gradient device dataType decoderInputEmbedDim posEncDim)
-&gt; ModelSpec
     (TDRelPosEncF style gradient device dataType headDim posEncDim)
-&gt; ModelSpec
     (TDInitialLayerNormF
        style gradient device dataType decoderInputEmbedDim)
-&gt; ModelSpec (TDInitialDropoutF style)
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          Dropout))
                    Dropout
                    (SAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GCrossAttention
                    (CAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          Dropout))
                    Dropout
                    (CAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style)
                    (FFNOutputProjectionF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    Dropout
                    (FFNOutputLayerNormF
                       style gradient device dataType decoderInputEmbedDim))))))
-&gt; ModelSpec
     (TDFinalLayerNormF
        style gradient device dataType decoderInputEmbedDim)
-&gt; ModelSpec (TDFinalDropoutF style)
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF
           style gradient device dataType decoderInputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF
           style gradient device dataType decoderInputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF
                          style gradient device dataType decoderInputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (KInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (VInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (OutProjF
                                style gradient device dataType embedDim decoderInputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF
                          style gradient device dataType decoderInputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF
                          style gradient device dataType decoderInputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF
                                style gradient device dataType decoderInputEmbedDim embedDim)
                             (KInProjF
                                style gradient device dataType encoderOutputEmbedDim embedDim)
                             (VInProjF
                                style gradient device dataType encoderOutputEmbedDim embedDim)
                             (OutProjF
                                style gradient device dataType embedDim decoderInputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF
                          style gradient device dataType decoderInputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF
                          style gradient device dataType decoderInputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType decoderInputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType decoderInputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType decoderInputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF
           style gradient device dataType decoderInputEmbedDim))
     (ModelSpec (TDFinalDropoutF style))
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDPosEncF
        style gradient device dataType decoderInputEmbedDim posEncDim)
</span><a href="#local-6989586621679656172"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDRelPosEncF style gradient device dataType headDim posEncDim)
</span><a href="#local-6989586621679656170"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDInitialLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679656168"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; ModelSpec (TDInitialDropoutF style)
</span><a href="#local-6989586621679656166"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformerStack
        (VectorSpec
           numLayers
           (GTransformerBlock
              (NamedModel
                 (GSelfAttention
                    (SAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          Dropout))
                    Dropout
                    (SAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GCrossAttention
                    (CAInitialLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (NamedModel
                       (GMultiHeadAttention
                          headDim
                          headEmbedDim
                          embedDim
                          (QInProjF
                             style gradient device dataType decoderInputEmbedDim embedDim)
                          (KInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (VInProjF
                             style gradient device dataType encoderOutputEmbedDim embedDim)
                          (OutProjF
                             style gradient device dataType embedDim decoderInputEmbedDim)
                          Dropout))
                    Dropout
                    (CAFinalLayerNormF
                       style gradient device dataType decoderInputEmbedDim)))
              (NamedModel
                 (GTransformerFeedForwardNetwork
                    (FFNInputLayerNormF
                       style gradient device dataType decoderInputEmbedDim)
                    (FFNInputTransformationF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    (FFNActivationF style)
                    (FFNActivationDropoutF style)
                    (FFNOutputProjectionF
                       style gradient device dataType decoderInputEmbedDim ffnDim)
                    Dropout
                    (FFNOutputLayerNormF
                       style gradient device dataType decoderInputEmbedDim))))))
</span><a href="#local-6989586621679656165"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (TDFinalLayerNormF
        style gradient device dataType decoderInputEmbedDim)
</span><a href="#local-6989586621679656163"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; ModelSpec (TDFinalDropoutF style)
</span><a href="#local-6989586621679656162"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656186"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>    </span><span class="annot"><a href="#local-6989586621679656164"><span class="hs-identifier hs-type">stackSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-546"></span><span>    </span><span id="local-6989586621679656164"><span class="annot"><span class="annottext">stackSpec' :: STransformerStyle style
-&gt; GTransformerStack
     (VectorSpec
        numLayers
        (GTransformerBlock
           (NamedModel
              (GSelfAttention
                 (SAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (SAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GCrossAttention
                 (CAInitialLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (NamedModel
                    (GMultiHeadAttention
                       headDim
                       headEmbedDim
                       embedDim
                       (QInProjF
                          style gradient device dataType decoderInputEmbedDim embedDim)
                       (KInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (VInProjF
                          style gradient device dataType encoderOutputEmbedDim embedDim)
                       (OutProjF
                          style gradient device dataType embedDim decoderInputEmbedDim)
                       Dropout))
                 Dropout
                 (CAFinalLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))
           (NamedModel
              (GTransformerFeedForwardNetwork
                 (FFNInputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)
                 (FFNInputTransformationF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 (FFNActivationF style)
                 (FFNActivationDropoutF style)
                 (FFNOutputProjectionF
                    style gradient device dataType decoderInputEmbedDim ffnDim)
                 Dropout
                 (FFNOutputLayerNormF
                    style gradient device dataType decoderInputEmbedDim)))))
</span><a href="#local-6989586621679656164"><span class="hs-identifier hs-var hs-var">stackSpec'</span></a></span></span><span> </span><span id="local-6989586621679656161"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656161"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim decoderInputEmbedDim
-&gt; SDim encoderOutputEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerStack
        (Vector
           numLayers
           (GTransformerBlock
              (DecoderBlockSelfAttentionF
                 style
                 gradient
                 device
                 dataType
                 headDim
                 headEmbedDim
                 embedDim
                 decoderInputEmbedDim)
              (DecoderBlockCrossAttentionF
                 style
                 gradient
                 device
                 dataType
                 headDim
                 headEmbedDim
                 embedDim
                 decoderInputEmbedDim
                 encoderOutputEmbedDim)
              (DecoderBlockFeedForwardNetworkF
                 style gradient device dataType decoderInputEmbedDim ffnDim))))
forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (keyEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim queryEmbedDim
-&gt; SDim keyEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerStack
        (Vector
           numLayers
           (GTransformerBlock
              (DecoderBlockSelfAttentionF
                 style
                 gradient
                 device
                 dataType
                 headDim
                 headEmbedDim
                 embedDim
                 queryEmbedDim)
              (DecoderBlockCrossAttentionF
                 style
                 gradient
                 device
                 dataType
                 headDim
                 headEmbedDim
                 embedDim
                 queryEmbedDim
                 keyEmbedDim)
              (DecoderBlockFeedForwardNetworkF
                 style gradient device dataType queryEmbedDim ffnDim))))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GStack.html#decoderStackSpec"><span class="hs-identifier hs-var">decoderStackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679656161"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679656185"><span class="hs-identifier hs-var">numLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656184"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656183"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656182"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679656181"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679656180"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679656179"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim decoderInputEmbedDim
</span><a href="#local-6989586621679656178"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim encoderOutputEmbedDim
</span><a href="#local-6989586621679656177"><span class="hs-identifier hs-var">encoderOutputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679656176"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656174"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656173"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-547"></span><span>    </span><span class="annot"><a href="#local-6989586621679656167"><span class="hs-identifier hs-type">layerNormSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-548"></span><span>    </span><span id="local-6989586621679656167"><span class="annot"><span class="annottext">layerNormSpec' :: SHasBias hasBias
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
</span><a href="#local-6989586621679656167"><span class="hs-identifier hs-var hs-var">layerNormSpec'</span></a></span></span><span> </span><span id="local-6989586621679656160"><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679656160"><span class="hs-identifier hs-var">hasBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[decoderInputEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     hasBias gradient device dataType ('Shape '[decoderInputEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias hasBias
</span><a href="#local-6989586621679656160"><span class="hs-identifier hs-var">hasBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656184"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656183"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656182"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[decoderInputEmbedDim]
-&gt; SShape ('Shape '[decoderInputEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[decoderInputEmbedDim]
 -&gt; SShape ('Shape '[decoderInputEmbedDim]))
-&gt; SList '[decoderInputEmbedDim]
-&gt; SShape ('Shape '[decoderInputEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Sing decoderInputEmbedDim
SDim decoderInputEmbedDim
</span><a href="#local-6989586621679656178"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">Sing decoderInputEmbedDim
-&gt; SList '[] -&gt; SList '[decoderInputEmbedDim]
forall a1 (a2 :: a1) (as :: [a1]).
Sing a2 -&gt; SList as -&gt; SList (a2 : as)
</span><a href="Torch.GraduallyTyped.Prelude.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679656173"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-549"></span><span>    </span><span id="local-6989586621679656169"><span class="annot"><span class="annottext">relPosEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  headDim
  'Nothing
</span><a href="#local-6989586621679656169"><span class="hs-identifier hs-var hs-var">relPosEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim headDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     headDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656184"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656183"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656182"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679656175"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679656181"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span id="local-6989586621679656171"><span class="annot"><span class="annottext">posEncSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  posEncDim
  decoderInputEmbedDim
  'Nothing
</span><a href="#local-6989586621679656171"><span class="hs-identifier hs-var hs-var">posEncSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim posEncDim
-&gt; SDim decoderInputEmbedDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     posEncDim
     decoderInputEmbedDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679656184"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679656183"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679656182"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679656175"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim decoderInputEmbedDim
</span><a href="#local-6989586621679656178"><span class="hs-identifier hs-var">decoderInputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span id="local-6989586621679656152"><span id="local-6989586621679656153"><span id="local-6989586621679656154"><span id="local-6989586621679656155"><span id="local-6989586621679656156"><span id="local-6989586621679656157"><span id="local-6989586621679656158"><span id="local-6989586621679656159"><span class="hs-keyword">instance</span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656159"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656159"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656157"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656157"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656156"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656156"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656155"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656155"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-557"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656154"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656154"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656153"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656153"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-559"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656152"><span class="hs-identifier hs-type">finalDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656152"><span class="hs-identifier hs-type">finalDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-562"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656159"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656157"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656156"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656155"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656154"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656153"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656152"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-563"></span><span>    </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656159"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656157"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656156"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656155"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656154"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656153"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656152"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><a href="#local-6989586621679656158"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-567"></span><span>  </span><span id="local-6989586621679656149"><span class="annot"><span class="annottext">initialize :: ModelSpec
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
-&gt; Generator generatorDevice
-&gt; m (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout,
      Generator generatorDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span id="local-6989586621679656147"><span class="annot"><a href="#local-6989586621679656147"><span class="hs-identifier hs-var">posEncSpec</span></a></span></span><span> </span><span id="local-6989586621679656146"><span class="annot"><a href="#local-6989586621679656146"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span></span><span> </span><span id="local-6989586621679656145"><span class="annot"><a href="#local-6989586621679656145"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span></span><span> </span><span id="local-6989586621679656144"><span class="annot"><a href="#local-6989586621679656144"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span></span><span> </span><span id="local-6989586621679656143"><span class="annot"><a href="#local-6989586621679656143"><span class="hs-identifier hs-var">stackSpec</span></a></span></span><span> </span><span id="local-6989586621679656142"><span class="annot"><a href="#local-6989586621679656142"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span></span><span> </span><span id="local-6989586621679656141"><span class="annot"><a href="#local-6989586621679656141"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679656140"><span class="annot"><span class="annottext">posEnc :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) posEnc
</span><a href="#local-6989586621679656140"><span class="hs-identifier hs-var hs-var">posEnc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (posEnc, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) posEnc
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (posEnc, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) posEnc)
-&gt; (ModelSpec posEnc
    -&gt; Generator generatorDevice
    -&gt; m (posEnc, Generator generatorDevice))
-&gt; ModelSpec posEnc
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) posEnc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec posEnc
-&gt; Generator generatorDevice
-&gt; m (posEnc, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec posEnc
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) posEnc)
-&gt; ModelSpec posEnc
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) posEnc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec posEnc
</span><a href="#local-6989586621679656147"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span id="local-6989586621679656137"><span class="annot"><span class="annottext">relPosEnc :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) relPosEnc
</span><a href="#local-6989586621679656137"><span class="hs-identifier hs-var hs-var">relPosEnc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (relPosEnc, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) relPosEnc
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (relPosEnc, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      relPosEnc)
-&gt; (ModelSpec relPosEnc
    -&gt; Generator generatorDevice
    -&gt; m (relPosEnc, Generator generatorDevice))
-&gt; ModelSpec relPosEnc
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) relPosEnc
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec relPosEnc
-&gt; Generator generatorDevice
-&gt; m (relPosEnc, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec relPosEnc
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      relPosEnc)
-&gt; ModelSpec relPosEnc
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) relPosEnc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec relPosEnc
</span><a href="#local-6989586621679656146"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span>
</span><span id="line-570"></span><span>        </span><span id="local-6989586621679656136"><span class="annot"><span class="annottext">initialLayerNorm :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  initialLayerNorm
</span><a href="#local-6989586621679656136"><span class="hs-identifier hs-var hs-var">initialLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (initialLayerNorm, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialLayerNorm
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (initialLayerNorm, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      initialLayerNorm)
-&gt; (ModelSpec initialLayerNorm
    -&gt; Generator generatorDevice
    -&gt; m (initialLayerNorm, Generator generatorDevice))
-&gt; ModelSpec initialLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialLayerNorm
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialLayerNorm
-&gt; Generator generatorDevice
-&gt; m (initialLayerNorm, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec initialLayerNorm
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      initialLayerNorm)
-&gt; ModelSpec initialLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialLayerNorm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialLayerNorm
</span><a href="#local-6989586621679656145"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span>
</span><span id="line-571"></span><span>        </span><span id="local-6989586621679656135"><span class="annot"><span class="annottext">initialDropout :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  initialDropout
</span><a href="#local-6989586621679656135"><span class="hs-identifier hs-var hs-var">initialDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (initialDropout, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialDropout
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (initialDropout, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      initialDropout)
-&gt; (ModelSpec initialDropout
    -&gt; Generator generatorDevice
    -&gt; m (initialDropout, Generator generatorDevice))
-&gt; ModelSpec initialDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialDropout
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialDropout
-&gt; Generator generatorDevice
-&gt; m (initialDropout, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec initialDropout
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      initialDropout)
-&gt; ModelSpec initialDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialDropout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialDropout
</span><a href="#local-6989586621679656144"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span>
</span><span id="line-572"></span><span>        </span><span id="local-6989586621679656134"><span class="annot"><span class="annottext">stack :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) stack
</span><a href="#local-6989586621679656134"><span class="hs-identifier hs-var hs-var">stack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice -&gt; m (stack, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) stack
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (stack, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) stack)
-&gt; (ModelSpec stack
    -&gt; Generator generatorDevice
    -&gt; m (stack, Generator generatorDevice))
-&gt; ModelSpec stack
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) stack
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec stack
-&gt; Generator generatorDevice
-&gt; m (stack, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec stack
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) stack)
-&gt; ModelSpec stack
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) stack
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec stack
</span><a href="#local-6989586621679656143"><span class="hs-identifier hs-var">stackSpec</span></a></span><span>
</span><span id="line-573"></span><span>        </span><span id="local-6989586621679656133"><span class="annot"><span class="annottext">finalLayerNorm :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  finalLayerNorm
</span><a href="#local-6989586621679656133"><span class="hs-identifier hs-var hs-var">finalLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (finalLayerNorm, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalLayerNorm
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (finalLayerNorm, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      finalLayerNorm)
-&gt; (ModelSpec finalLayerNorm
    -&gt; Generator generatorDevice
    -&gt; m (finalLayerNorm, Generator generatorDevice))
-&gt; ModelSpec finalLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalLayerNorm
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalLayerNorm
-&gt; Generator generatorDevice
-&gt; m (finalLayerNorm, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec finalLayerNorm
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      finalLayerNorm)
-&gt; ModelSpec finalLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalLayerNorm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalLayerNorm
</span><a href="#local-6989586621679656142"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span>
</span><span id="line-574"></span><span>        </span><span id="local-6989586621679656132"><span class="annot"><span class="annottext">finalDropout :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  finalDropout
</span><a href="#local-6989586621679656132"><span class="hs-identifier hs-var hs-var">finalDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (finalDropout, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalDropout
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (finalDropout, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      finalDropout)
-&gt; (ModelSpec finalDropout
    -&gt; Generator generatorDevice
    -&gt; m (finalDropout, Generator generatorDevice))
-&gt; ModelSpec finalDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalDropout
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalDropout
-&gt; Generator generatorDevice
-&gt; m (finalDropout, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec finalDropout
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      finalDropout)
-&gt; ModelSpec finalDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalDropout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalDropout
</span><a href="#local-6989586621679656141"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span>
</span><span id="line-575"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
-&gt; Generator generatorDevice
-&gt; m (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout,
      Generator generatorDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorDevice)
   (GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout)
 -&gt; Generator generatorDevice
 -&gt; m (GTransformer
         posEnc
         relPosEnc
         initialLayerNorm
         initialDropout
         stack
         finalLayerNorm
         finalDropout,
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; Generator generatorDevice
-&gt; m (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout,
      Generator generatorDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-576"></span><span>          </span><span class="annot"><span class="annottext">posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span><span>
</span><span id="line-577"></span><span>            </span><span class="annot"><span class="annottext">(posEnc
 -&gt; relPosEnc
 -&gt; initialLayerNorm
 -&gt; initialDropout
 -&gt; stack
 -&gt; finalLayerNorm
 -&gt; finalDropout
 -&gt; GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) posEnc
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (relPosEnc
      -&gt; initialLayerNorm
      -&gt; initialDropout
      -&gt; stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) posEnc
</span><a href="#local-6989586621679656140"><span class="hs-identifier hs-var">posEnc</span></a></span><span>
</span><span id="line-578"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (relPosEnc
   -&gt; initialLayerNorm
   -&gt; initialDropout
   -&gt; stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) relPosEnc
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (initialLayerNorm
      -&gt; initialDropout
      -&gt; stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) relPosEnc
</span><a href="#local-6989586621679656137"><span class="hs-identifier hs-var">relPosEnc</span></a></span><span>
</span><span id="line-579"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (initialLayerNorm
   -&gt; initialDropout
   -&gt; stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (initialDropout
      -&gt; stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  initialLayerNorm
</span><a href="#local-6989586621679656136"><span class="hs-identifier hs-var">initialLayerNorm</span></a></span><span>
</span><span id="line-580"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (initialDropout
   -&gt; stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     initialDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  initialDropout
</span><a href="#local-6989586621679656135"><span class="hs-identifier hs-var">initialDropout</span></a></span><span>
</span><span id="line-581"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) stack
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) stack
</span><a href="#local-6989586621679656134"><span class="hs-identifier hs-var">stack</span></a></span><span>
</span><span id="line-582"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  finalLayerNorm
</span><a href="#local-6989586621679656133"><span class="hs-identifier hs-var">finalLayerNorm</span></a></span><span>
</span><span id="line-583"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     finalDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  finalDropout
</span><a href="#local-6989586621679656132"><span class="hs-identifier hs-var">finalDropout</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-584"></span><span>
</span><span id="line-585"></span><span id="local-6989586621679656124"><span id="local-6989586621679656125"><span id="local-6989586621679656126"><span id="local-6989586621679656127"><span id="local-6989586621679656128"><span id="local-6989586621679656129"><span id="local-6989586621679656130"><span class="hs-keyword">instance</span><span>
</span><span id="line-586"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656130"><span class="hs-identifier hs-type">posEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-587"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656129"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656128"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656127"><span class="hs-identifier hs-type">initialDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656126"><span class="hs-identifier hs-type">stack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-591"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656125"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-592"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656124"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-594"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656130"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656129"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656128"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656127"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656126"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656125"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656124"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-596"></span><span>  </span><span id="local-6989586621679656120"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec
  (GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout)
-&gt; Text
-&gt; m (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span id="local-6989586621679656118"><span class="annot"><a href="#local-6989586621679656118"><span class="hs-identifier hs-var">posEncSpec</span></a></span></span><span> </span><span id="local-6989586621679656117"><span class="annot"><a href="#local-6989586621679656117"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span></span><span> </span><span id="local-6989586621679656116"><span class="annot"><a href="#local-6989586621679656116"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span></span><span> </span><span id="local-6989586621679656115"><span class="annot"><a href="#local-6989586621679656115"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span></span><span> </span><span id="local-6989586621679656114"><span class="annot"><a href="#local-6989586621679656114"><span class="hs-identifier hs-var">stackSpec</span></a></span></span><span> </span><span id="local-6989586621679656113"><span class="annot"><a href="#local-6989586621679656113"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span></span><span> </span><span id="local-6989586621679656112"><span class="annot"><a href="#local-6989586621679656112"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679656111"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><span class="annottext">posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
posEnc
-&gt; relPosEnc
-&gt; initialLayerNorm
-&gt; initialDropout
-&gt; stack
-&gt; finalLayerNorm
-&gt; finalDropout
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-var">GTransformer</span></a></span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><span class="annottext">(posEnc
 -&gt; relPosEnc
 -&gt; initialLayerNorm
 -&gt; initialDropout
 -&gt; stack
 -&gt; finalLayerNorm
 -&gt; finalDropout
 -&gt; GTransformer
      posEnc
      relPosEnc
      initialLayerNorm
      initialDropout
      stack
      finalLayerNorm
      finalDropout)
-&gt; m posEnc
-&gt; m (relPosEnc
      -&gt; initialLayerNorm
      -&gt; initialDropout
      -&gt; stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec posEnc -&gt; Text -&gt; m posEnc
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec posEnc
</span><a href="#local-6989586621679656118"><span class="hs-identifier hs-var">posEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-599"></span><span>      </span><span class="annot"><span class="annottext">m (relPosEnc
   -&gt; initialLayerNorm
   -&gt; initialDropout
   -&gt; stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; m relPosEnc
-&gt; m (initialLayerNorm
      -&gt; initialDropout
      -&gt; stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec relPosEnc -&gt; Text -&gt; m relPosEnc
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec relPosEnc
</span><a href="#local-6989586621679656117"><span class="hs-identifier hs-var">relPosEncSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="annot"><span class="annottext">m (initialLayerNorm
   -&gt; initialDropout
   -&gt; stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; m initialLayerNorm
-&gt; m (initialDropout
      -&gt; stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialLayerNorm -&gt; Text -&gt; m initialLayerNorm
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialLayerNorm
</span><a href="#local-6989586621679656116"><span class="hs-identifier hs-var">initialLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-601"></span><span>      </span><span class="annot"><span class="annottext">m (initialDropout
   -&gt; stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; m initialDropout
-&gt; m (stack
      -&gt; finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialDropout -&gt; Text -&gt; m initialDropout
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec initialDropout
</span><a href="#local-6989586621679656115"><span class="hs-identifier hs-var">initialDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><span class="annottext">m (stack
   -&gt; finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; m stack
-&gt; m (finalLayerNorm
      -&gt; finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec stack -&gt; Text -&gt; m stack
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec stack
</span><a href="#local-6989586621679656114"><span class="hs-identifier hs-var">stackSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><span class="annottext">m (finalLayerNorm
   -&gt; finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; m finalLayerNorm
-&gt; m (finalDropout
      -&gt; GTransformer
           posEnc
           relPosEnc
           initialLayerNorm
           initialDropout
           stack
           finalLayerNorm
           finalDropout)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalLayerNorm -&gt; Text -&gt; m finalLayerNorm
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalLayerNorm
</span><a href="#local-6989586621679656113"><span class="hs-identifier hs-var">finalLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span class="annot"><span class="annottext">m (finalDropout
   -&gt; GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
-&gt; m finalDropout
-&gt; m (GTransformer
        posEnc
        relPosEnc
        initialLayerNorm
        initialDropout
        stack
        finalLayerNorm
        finalDropout)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalDropout -&gt; Text -&gt; m finalDropout
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec finalDropout
</span><a href="#local-6989586621679656112"><span class="hs-identifier hs-var">finalDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656111"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-605"></span><span>  </span><span id="local-6989586621679656109"><span class="annot"><span class="annottext">toStateDict :: Text
-&gt; GTransformer
     posEnc
     relPosEnc
     initialLayerNorm
     initialDropout
     stack
     finalLayerNorm
     finalDropout
-&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679656107"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679656100"><span id="local-6989586621679656101"><span id="local-6989586621679656102"><span id="local-6989586621679656103"><span id="local-6989586621679656104"><span id="local-6989586621679656105"><span id="local-6989586621679656106"><span class="annot"><span class="annottext">posEnc
relPosEnc
initialLayerNorm
initialDropout
stack
finalLayerNorm
finalDropout
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: relPosEnc
tPosEnc :: posEnc
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679656100"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-606"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; posEnc -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">posEnc
</span><a href="#local-6989586621679656106"><span class="hs-identifier hs-var">tPosEnc</span></a></span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; relPosEnc -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">relPosEnc
</span><a href="#local-6989586621679656105"><span class="hs-identifier hs-var">tRelPosEnc</span></a></span><span>
</span><span id="line-608"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; initialLayerNorm -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679656104"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; initialDropout -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679656103"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; stack -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679656102"><span class="hs-identifier hs-var">tStack</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; finalLayerNorm -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679656101"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; finalDropout -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679656107"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679656100"><span class="hs-identifier hs-var">tFinalDropout</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in an encoder configuration</span><span>
</span><span id="line-616"></span><span class="hs-comment">-- with absolute positional encoding rather than relative positional encoding.</span><span>
</span><span id="line-617"></span><span class="hs-comment">--</span><span>
</span><span id="line-618"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-619"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-620"></span><span class="hs-comment">-- &#9474; input &#9474;  &#9474; pos &#9474;  &#9474; attentionMask &#9474;</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-622"></span><span class="hs-comment">--     &#9474;         &#9474;             &#9474;</span><span>
</span><span id="line-623"></span><span class="hs-comment">--     &#9474;         &#9660;             &#9474;</span><span>
</span><span id="line-624"></span><span class="hs-comment">--     &#9474;      tPosEnc          &#9474;</span><span>
</span><span id="line-625"></span><span class="hs-comment">--     &#9474;         &#9474;             &#9474;</span><span>
</span><span id="line-626"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9496;             &#9474;</span><span>
</span><span id="line-627"></span><span class="hs-comment">--          &#9474;                  &#9474;</span><span>
</span><span id="line-628"></span><span class="hs-comment">--          &#9660;                  &#9474;</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- (tInitialLayerNorm)         &#9474;</span><span>
</span><span id="line-630"></span><span class="hs-comment">--          &#9660;                  &#9660;</span><span>
</span><span id="line-631"></span><span class="hs-comment">--  (tInitialDropout)     unsqueeze</span><span>
</span><span id="line-632"></span><span class="hs-comment">--          &#9660;                  &#9474;</span><span>
</span><span id="line-633"></span><span class="hs-comment">--       tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-634"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-635"></span><span class="hs-comment">--  (tFinalLayerNorm)</span><span>
</span><span id="line-636"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-637"></span><span class="hs-comment">--   (tFinalDropout)</span><span>
</span><span id="line-638"></span><span class="hs-comment">--          &#9474;</span><span>
</span><span id="line-639"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-640"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-641"></span><span class="hs-comment">--     &#9474; output &#9474;</span><span>
</span><span id="line-642"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-644"></span><span id="local-6989586621679656062"><span id="local-6989586621679656063"><span id="local-6989586621679656064"><span id="local-6989586621679656065"><span id="local-6989586621679656066"><span id="local-6989586621679656067"><span id="local-6989586621679656068"><span id="local-6989586621679656069"><span id="local-6989586621679656070"><span id="local-6989586621679656071"><span id="local-6989586621679656072"><span id="local-6989586621679656073"><span id="local-6989586621679656074"><span id="local-6989586621679656075"><span id="local-6989586621679656076"><span id="local-6989586621679656077"><span id="local-6989586621679656078"><span id="local-6989586621679656079"><span id="local-6989586621679656080"><span id="local-6989586621679656081"><span id="local-6989586621679656082"><span id="local-6989586621679656083"><span id="local-6989586621679656084"><span id="local-6989586621679656085"><span id="local-6989586621679656086"><span id="local-6989586621679656087"><span id="local-6989586621679656088"><span id="local-6989586621679656089"><span id="local-6989586621679656090"><span id="local-6989586621679656091"><span id="local-6989586621679656092"><span id="local-6989586621679656093"><span id="local-6989586621679656094"><span id="local-6989586621679656095"><span id="local-6989586621679656096"><span id="local-6989586621679656097"><span id="local-6989586621679656098"><span id="local-6989586621679656099"><span class="hs-keyword">instance</span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-646"></span><span>      </span><span class="annot"><a href="#local-6989586621679656099"><span class="hs-identifier hs-type">posEnc</span></a></span><span>
</span><span id="line-647"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656098"><span class="hs-identifier hs-type">posGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656097"><span class="hs-identifier hs-type">posLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656096"><span class="hs-identifier hs-type">posDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656095"><span class="hs-identifier hs-type">posDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656094"><span class="hs-identifier hs-type">posShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>      </span><span class="annot"><a href="#local-6989586621679656093"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-649"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656092"><span class="hs-identifier hs-type">posEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656091"><span class="hs-identifier hs-type">posEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656090"><span class="hs-identifier hs-type">posEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656089"><span class="hs-identifier hs-type">posEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656088"><span class="hs-identifier hs-type">posEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>      </span><span class="annot"><a href="#local-6989586621679656087"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-651"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-652"></span><span>      </span><span class="annot"><a href="#local-6989586621679656086"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-653"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-654"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656085"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656092"><span class="hs-identifier hs-type">posEncGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656084"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656091"><span class="hs-identifier hs-type">posEncLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656083"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656090"><span class="hs-identifier hs-type">posEncDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-657"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656082"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656089"><span class="hs-identifier hs-type">posEncDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656081"><span class="hs-identifier hs-type">inputShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656088"><span class="hs-identifier hs-type">posEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>      </span><span class="annot"><a href="#local-6989586621679656087"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-661"></span><span>      </span><span class="annot"><a href="#local-6989586621679656080"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-662"></span><span>      </span><span class="annot"><a href="#local-6989586621679656079"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-663"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-664"></span><span>      </span><span class="annot"><a href="#local-6989586621679656078"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-665"></span><span>      </span><span class="annot"><a href="#local-6989586621679656080"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><a href="#local-6989586621679656079"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-667"></span><span>      </span><span class="annot"><a href="#local-6989586621679656077"><span class="hs-identifier hs-type">tensor2</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span class="annot"><a href="#local-6989586621679656076"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-669"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-670"></span><span>      </span><span class="annot"><a href="#local-6989586621679656075"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-671"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679656077"><span class="hs-identifier hs-type">tensor2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-672"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-673"></span><span>          </span><span class="annot"><a href="#local-6989586621679656074"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span>
</span><span id="line-674"></span><span>          </span><span class="annot"><a href="#local-6989586621679656073"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span>
</span><span id="line-675"></span><span>          </span><span class="annot"><a href="#local-6989586621679656072"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span>
</span><span id="line-676"></span><span>          </span><span class="annot"><a href="#local-6989586621679656071"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span>
</span><span id="line-677"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656070"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-678"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-679"></span><span>      </span><span class="annot"><a href="#local-6989586621679656076"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-680"></span><span>      </span><span class="annot"><a href="#local-6989586621679656069"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-681"></span><span>      </span><span class="annot"><a href="#local-6989586621679656068"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-683"></span><span>      </span><span class="annot"><a href="#local-6989586621679656067"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-684"></span><span>      </span><span class="annot"><a href="#local-6989586621679656069"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-685"></span><span>      </span><span class="annot"><a href="#local-6989586621679656068"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-686"></span><span>      </span><span class="annot"><a href="#local-6989586621679656066"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><a href="#local-6989586621679656065"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-689"></span><span>      </span><span class="annot"><a href="#local-6989586621679656064"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-690"></span><span>      </span><span class="annot"><a href="#local-6989586621679656066"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-691"></span><span>      </span><span class="annot"><a href="#local-6989586621679656065"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-692"></span><span>      </span><span class="annot"><a href="#local-6989586621679656063"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-693"></span><span>      </span><span class="annot"><a href="#local-6989586621679656062"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-694"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-695"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-696"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656099"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656086"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656078"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656075"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656067"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656064"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-697"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656085"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656084"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656083"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656082"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656081"><span class="hs-identifier hs-type">inputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-698"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656098"><span class="hs-identifier hs-type">posGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656097"><span class="hs-identifier hs-type">posLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656096"><span class="hs-identifier hs-type">posDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656095"><span class="hs-identifier hs-type">posDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656094"><span class="hs-identifier hs-type">posShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-699"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656074"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656073"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656072"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656071"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656070"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span>
</span><span id="line-700"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-701"></span><span>    </span><span class="annot"><a href="#local-6989586621679656093"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-702"></span><span>    </span><span class="annot"><a href="#local-6989586621679656063"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-703"></span><span>    </span><span class="annot"><a href="#local-6989586621679656062"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-705"></span><span>  </span><span id="local-6989586621679656059"><span class="annot"><span class="annottext">forward :: GTransformer
  posEnc
  ()
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape,
    Tensor posGradient posLayout posDevice posDataType posShape,
    Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      attentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679656051"><span id="local-6989586621679656052"><span id="local-6989586621679656053"><span id="local-6989586621679656054"><span id="local-6989586621679656055"><span id="local-6989586621679656056"><span id="local-6989586621679656057"><span class="annot"><span class="annottext">posEnc
initialLayerNorm
initialDropout
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: ()
tPosEnc :: posEnc
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679656051"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679656050"><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679656050"><span class="hs-identifier hs-var">input</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679656049"><span class="annot"><span class="annottext">Tensor posGradient posLayout posDevice posDataType posShape
</span><a href="#local-6989586621679656049"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679656048"><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679656048"><span class="hs-identifier hs-var">attentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-706"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679656047"><span class="annot"><span class="annottext">attentionBias :: Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
</span><a href="#local-6989586621679656047"><span class="hs-identifier hs-var hs-var">attentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
-&gt; Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
(shape' ~ UnsqueezeF selectDim shape, SingI selectDim) =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape'
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679656048"><span class="hs-identifier hs-var">attentionMask</span></a></span><span>
</span><span id="line-707"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-708"></span><span>          </span><span class="annot"><span class="annottext">Tensor posGradient posLayout posDevice posDataType posShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor posGradient posLayout posDevice posDataType posShape)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor posGradient posLayout posDevice posDataType posShape
</span><a href="#local-6989586621679656049"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-709"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor posGradient posLayout posDevice posDataType posShape)
-&gt; (Tensor posGradient posLayout posDevice posDataType posShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice0)
         (Tensor
            posEncGradient
            posEncLayout
            posEncDevice
            posEncDataType
            posEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         posEncGradient
         posEncLayout
         posEncDevice
         posEncDataType
         posEncShape,
       Generator generatorDevice0))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          posEncGradient
          posEncLayout
          posEncDevice
          posEncDataType
          posEncShape,
        Generator generatorDevice0))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice0)
      (Tensor
         posEncGradient
         posEncLayout
         posEncDevice
         posEncDataType
         posEncShape))
-&gt; (Tensor posGradient posLayout posDevice posDataType posShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            posEncGradient
            posEncLayout
            posEncDevice
            posEncDataType
            posEncShape,
          Generator generatorDevice0))
-&gt; Tensor posGradient posLayout posDevice posDataType posShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">posEnc
-&gt; Tensor posGradient posLayout posDevice posDataType posShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        posEncGradient
        posEncLayout
        posEncDevice
        posEncDataType
        posEncShape,
      Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">posEnc
</span><a href="#local-6989586621679656057"><span class="hs-identifier hs-var">tPosEnc</span></a></span><span>
</span><span id="line-710"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     posEncGradient
     posEncLayout
     posEncDevice
     posEncDataType
     posEncShape)
-&gt; (Tensor
      posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice0)
         (Tensor
            (Or (Gradient RequiresGradient) inputGradient posEncGradient)
            (Unify (Layout LayoutType) inputLayout posEncLayout)
            (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
            (Unify (DataType DType) inputDataType posEncDataType)
            (BroadcastShapesF inputShape posEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        (Or (Gradient RequiresGradient) inputGradient posEncGradient)
        (Unify (Layout LayoutType) inputLayout posEncLayout)
        (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
        (Unify (DataType DType) inputDataType posEncDataType)
        (BroadcastShapesF inputShape posEncShape))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) inputGradient posEncGradient)
  (Unify (Layout LayoutType) inputLayout posEncLayout)
  (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
  (Unify (DataType DType) inputDataType posEncDataType)
  (BroadcastShapesF inputShape posEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or (Gradient RequiresGradient) inputGradient posEncGradient)
        (Unify (Layout LayoutType) inputLayout posEncLayout)
        (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
        (Unify (DataType DType) inputDataType posEncDataType)
        (BroadcastShapesF inputShape posEncShape))
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or (Gradient RequiresGradient) inputGradient posEncGradient)
   (Unify (Layout LayoutType) inputLayout posEncLayout)
   (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
   (Unify (DataType DType) inputDataType posEncDataType)
   (BroadcastShapesF inputShape posEncShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice0)
      (Tensor
         (Or (Gradient RequiresGradient) inputGradient posEncGradient)
         (Unify (Layout LayoutType) inputLayout posEncLayout)
         (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
         (Unify (DataType DType) inputDataType posEncDataType)
         (BroadcastShapesF inputShape posEncShape)))
-&gt; (Tensor
      posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
    -&gt; Tensor
         (Or (Gradient RequiresGradient) inputGradient posEncGradient)
         (Unify (Layout LayoutType) inputLayout posEncLayout)
         (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
         (Unify (DataType DType) inputDataType posEncDataType)
         (BroadcastShapesF inputShape posEncShape))
-&gt; Tensor
     posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or (Gradient RequiresGradient) inputGradient posEncGradient)
        (Unify (Layout LayoutType) inputLayout posEncLayout)
        (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
        (Unify (DataType DType) inputDataType posEncDataType)
        (BroadcastShapesF inputShape posEncShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679656050"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; Tensor
     posEncGradient posEncLayout posEncDevice posEncDataType posEncShape
-&gt; Tensor
     (inputGradient &lt;|&gt; posEncGradient)
     (inputLayout &lt;+&gt; posEncLayout)
     (inputDevice &lt;+&gt; posEncDevice)
     (inputDataType &lt;+&gt; posEncDataType)
     (BroadcastShapesF inputShape posEncShape)
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     (Or (Gradient RequiresGradient) inputGradient posEncGradient)
     (Unify (Layout LayoutType) inputLayout posEncLayout)
     (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
     (Unify (DataType DType) inputDataType posEncDataType)
     (BroadcastShapesF inputShape posEncShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) inputGradient posEncGradient)
      (Unify (Layout LayoutType) inputLayout posEncLayout)
      (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
      (Unify (DataType DType) inputDataType posEncDataType)
      (BroadcastShapesF inputShape posEncShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (Tensor
      (Or (Gradient RequiresGradient) inputGradient posEncGradient)
      (Unify (Layout LayoutType) inputLayout posEncLayout)
      (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
      (Unify (DataType DType) inputDataType posEncDataType)
      (BroadcastShapesF inputShape posEncShape)
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; Tensor
     (Or (Gradient RequiresGradient) inputGradient posEncGradient)
     (Unify (Layout LayoutType) inputLayout posEncLayout)
     (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
     (Unify (DataType DType) inputDataType posEncDataType)
     (BroadcastShapesF inputShape posEncShape)
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     (Or (Gradient RequiresGradient) inputGradient posEncGradient)
     (Unify (Layout LayoutType) inputLayout posEncLayout)
     (Unify (Device (DeviceType Nat)) inputDevice posEncDevice)
     (Unify (DataType DType) inputDataType posEncDataType)
     (BroadcastShapesF inputShape posEncShape)
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679656055"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-712"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         tensor2)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice2) tensor2
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (tensor2, Generator generatorDevice2))
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (tensor2, Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      tensor2)
-&gt; (tensor1
    -&gt; Generator generatorDevice1
    -&gt; m (tensor2, Generator generatorDevice2))
-&gt; tensor1
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor1
-&gt; Generator generatorDevice1
-&gt; m (tensor2, Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679656054"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-713"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice2) tensor2
-&gt; (tensor2
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679656046"><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679656046"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">stack
-&gt; (tensor2,
    Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679656053"><span class="hs-identifier hs-var">tStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679656046"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
</span><a href="#local-6989586621679656047"><span class="hs-identifier hs-var">attentionBias</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-714"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679656052"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-715"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679656051"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-716"></span><span>
</span><span id="line-717"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in an encoder configuration</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- with relative positional encoding rather than absolute positional encoding.</span><span>
</span><span id="line-719"></span><span class="hs-comment">--</span><span>
</span><span id="line-720"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-721"></span><span class="hs-comment">--      &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-722"></span><span class="hs-comment">--      &#9474; input &#9474;  &#9474; relPos &#9474;  &#9474; attentionMask &#9474;</span><span>
</span><span id="line-723"></span><span class="hs-comment">--      &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-724"></span><span class="hs-comment">--          &#9474;          &#9474;               &#9474;</span><span>
</span><span id="line-725"></span><span class="hs-comment">--          &#9474;          &#9660;               &#9474;</span><span>
</span><span id="line-726"></span><span class="hs-comment">--          &#9474;     tRelPosEnc           &#9474;</span><span>
</span><span id="line-727"></span><span class="hs-comment">--          &#9474;          &#9660;               &#9474;</span><span>
</span><span id="line-728"></span><span class="hs-comment">--          &#9474;      transpose           &#9474;</span><span>
</span><span id="line-729"></span><span class="hs-comment">--          &#9474;          &#9660;               &#9660;</span><span>
</span><span id="line-730"></span><span class="hs-comment">--          &#9474;      transpose       unsqueeze</span><span>
</span><span id="line-731"></span><span class="hs-comment">--          &#9660;          &#9474;               &#9474;</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- (tInitialLayerNorm) &#9474;               &#9474;</span><span>
</span><span id="line-733"></span><span class="hs-comment">--          &#9660;          &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-734"></span><span class="hs-comment">--  (tInitialDropout)          &#9474;</span><span>
</span><span id="line-735"></span><span class="hs-comment">--          &#9660;                  &#9474;</span><span>
</span><span id="line-736"></span><span class="hs-comment">--       tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-737"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-738"></span><span class="hs-comment">--  (tFinalLayerNorm)</span><span>
</span><span id="line-739"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-740"></span><span class="hs-comment">--   (tFinalDropout)</span><span>
</span><span id="line-741"></span><span class="hs-comment">--          &#9474;</span><span>
</span><span id="line-742"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-743"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-744"></span><span class="hs-comment">--     &#9474; output &#9474;</span><span>
</span><span id="line-745"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-747"></span><span id="local-6989586621679656008"><span id="local-6989586621679656009"><span id="local-6989586621679656010"><span id="local-6989586621679656011"><span id="local-6989586621679656012"><span id="local-6989586621679656013"><span id="local-6989586621679656014"><span id="local-6989586621679656015"><span id="local-6989586621679656016"><span id="local-6989586621679656017"><span id="local-6989586621679656018"><span id="local-6989586621679656019"><span id="local-6989586621679656020"><span id="local-6989586621679656021"><span id="local-6989586621679656022"><span id="local-6989586621679656023"><span id="local-6989586621679656024"><span id="local-6989586621679656025"><span id="local-6989586621679656026"><span id="local-6989586621679656027"><span id="local-6989586621679656028"><span id="local-6989586621679656029"><span id="local-6989586621679656030"><span id="local-6989586621679656031"><span id="local-6989586621679656032"><span id="local-6989586621679656033"><span id="local-6989586621679656034"><span id="local-6989586621679656035"><span id="local-6989586621679656036"><span id="local-6989586621679656037"><span id="local-6989586621679656038"><span id="local-6989586621679656039"><span id="local-6989586621679656040"><span id="local-6989586621679656041"><span id="local-6989586621679656042"><span id="local-6989586621679656043"><span id="local-6989586621679656044"><span id="local-6989586621679656045"><span class="hs-keyword">instance</span><span>
</span><span id="line-748"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-749"></span><span>      </span><span class="annot"><a href="#local-6989586621679656045"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-750"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656044"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656043"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656042"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656041"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656040"><span class="hs-identifier hs-type">inputShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>      </span><span class="annot"><a href="#local-6989586621679656039"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-752"></span><span>      </span><span class="annot"><a href="#local-6989586621679656038"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-753"></span><span>      </span><span class="annot"><a href="#local-6989586621679656037"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-754"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-755"></span><span>      </span><span class="annot"><a href="#local-6989586621679656036"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-756"></span><span>      </span><span class="annot"><a href="#local-6989586621679656038"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-757"></span><span>      </span><span class="annot"><a href="#local-6989586621679656037"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-758"></span><span>      </span><span class="annot"><a href="#local-6989586621679656035"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-759"></span><span>      </span><span class="annot"><a href="#local-6989586621679656034"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-760"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-761"></span><span>      </span><span class="annot"><a href="#local-6989586621679656033"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span>
</span><span id="line-762"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656032"><span class="hs-identifier hs-type">relPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656031"><span class="hs-identifier hs-type">relPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656030"><span class="hs-identifier hs-type">relPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656029"><span class="hs-identifier hs-type">relPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656028"><span class="hs-identifier hs-type">relPosShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>      </span><span class="annot"><a href="#local-6989586621679656034"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-764"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656027"><span class="hs-identifier hs-type">relPosEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656026"><span class="hs-identifier hs-type">relPosEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656025"><span class="hs-identifier hs-type">relPosEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656024"><span class="hs-identifier hs-type">relPosEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656023"><span class="hs-identifier hs-type">relPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-765"></span><span>      </span><span class="annot"><a href="#local-6989586621679656022"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-766"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-767"></span><span>      </span><span class="annot"><a href="#local-6989586621679656021"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-768"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679656035"><span class="hs-identifier hs-type">tensor1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-769"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-770"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656027"><span class="hs-identifier hs-type">relPosEncGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656020"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656026"><span class="hs-identifier hs-type">relPosEncLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656019"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-772"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656025"><span class="hs-identifier hs-type">relPosEncDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656018"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-773"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679656024"><span class="hs-identifier hs-type">relPosEncDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656017"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-774"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-775"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span>
</span><span id="line-776"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-777"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span>
</span><span id="line-779"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-780"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>                      </span><span class="annot"><a href="#local-6989586621679656023"><span class="hs-identifier hs-type">relPosEncShape</span></a></span><span>
</span><span id="line-782"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656016"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>      </span><span class="annot"><a href="#local-6989586621679656022"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-788"></span><span>      </span><span class="annot"><a href="#local-6989586621679656015"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-789"></span><span>      </span><span class="annot"><a href="#local-6989586621679656014"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-790"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-791"></span><span>      </span><span class="annot"><a href="#local-6989586621679656013"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-792"></span><span>      </span><span class="annot"><a href="#local-6989586621679656015"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-793"></span><span>      </span><span class="annot"><a href="#local-6989586621679656014"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-794"></span><span>      </span><span class="annot"><a href="#local-6989586621679656012"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-795"></span><span>      </span><span class="annot"><a href="#local-6989586621679656011"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-796"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-797"></span><span>      </span><span class="annot"><a href="#local-6989586621679656010"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-798"></span><span>      </span><span class="annot"><a href="#local-6989586621679656012"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-799"></span><span>      </span><span class="annot"><a href="#local-6989586621679656011"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-800"></span><span>      </span><span class="annot"><a href="#local-6989586621679656009"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-801"></span><span>      </span><span class="annot"><a href="#local-6989586621679656008"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-802"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-803"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-804"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679656033"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656045"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656036"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656021"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656013"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656010"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-805"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656044"><span class="hs-identifier hs-type">inputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656043"><span class="hs-identifier hs-type">inputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656042"><span class="hs-identifier hs-type">inputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656041"><span class="hs-identifier hs-type">inputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656040"><span class="hs-identifier hs-type">inputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-806"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656032"><span class="hs-identifier hs-type">relPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656031"><span class="hs-identifier hs-type">relPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656030"><span class="hs-identifier hs-type">relPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656029"><span class="hs-identifier hs-type">relPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656028"><span class="hs-identifier hs-type">relPosShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-807"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656020"><span class="hs-identifier hs-type">attentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656019"><span class="hs-identifier hs-type">attentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656018"><span class="hs-identifier hs-type">attentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656017"><span class="hs-identifier hs-type">attentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679656016"><span class="hs-identifier hs-type">attentionMaskShape</span></a></span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-809"></span><span>    </span><span class="annot"><a href="#local-6989586621679656039"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-810"></span><span>    </span><span class="annot"><a href="#local-6989586621679656009"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-811"></span><span>    </span><span class="annot"><a href="#local-6989586621679656008"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-812"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-813"></span><span>  </span><span id="local-6989586621679656006"><span class="annot"><span class="annottext">forward :: GTransformer
  ()
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape,
    Tensor
      relPosGradient
      relPosLayout
      relPosDevice
      relPosDataType
      relPosShape,
    Tensor
      attentionMaskGradient
      attentionMaskLayout
      attentionMaskDevice
      attentionMaskDataType
      attentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679656006"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679655999"><span id="local-6989586621679656000"><span id="local-6989586621679656001"><span id="local-6989586621679656002"><span id="local-6989586621679656003"><span id="local-6989586621679656004"><span id="local-6989586621679656005"><span class="annot"><span class="annottext">initialLayerNorm
initialDropout
relPosEnc
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: relPosEnc
tPosEnc :: ()
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679655999"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679655998"><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679655998"><span class="hs-identifier hs-var">input</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655997"><span class="annot"><span class="annottext">Tensor
  relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
</span><a href="#local-6989586621679655997"><span class="hs-identifier hs-var">relPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655996"><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679655996"><span class="hs-identifier hs-var">attentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-814"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679655995"><span class="annot"><span class="annottext">relPosBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape)))
</span><a href="#local-6989586621679655995"><span class="hs-identifier hs-var hs-var">relPosBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-815"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice1)
     (Tensor
        relPosGradient
        relPosLayout
        relPosDevice
        relPosDataType
        relPosShape)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
</span><a href="#local-6989586621679655997"><span class="hs-identifier hs-var">relPos</span></a></span><span>
</span><span id="line-816"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice1)
  (Tensor
     relPosGradient
     relPosLayout
     relPosDevice
     relPosDataType
     relPosShape)
-&gt; (Tensor
      relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            relPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         relPosEncShape,
       Generator generatorDevice2))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (Tensor
          relPosEncGradient
          relPosEncLayout
          relPosEncDevice
          relPosEncDataType
          relPosEncShape,
        Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         relPosEncShape))
-&gt; (Tensor
      relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
    -&gt; Generator generatorDevice1
    -&gt; m (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            relPosEncShape,
          Generator generatorDevice2))
-&gt; Tensor
     relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">relPosEnc
-&gt; Tensor
     relPosGradient relPosLayout relPosDevice relPosDataType relPosShape
-&gt; Generator generatorDevice1
-&gt; m (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        relPosEncShape,
      Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">relPosEnc
</span><a href="#local-6989586621679656004"><span class="hs-identifier hs-var">tRelPosEnc</span></a></span><span>
</span><span id="line-817"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     relPosEncShape)
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      relPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               relPosEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 2))
        ('SelectDim ('ByIndex 3))
        relPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape))
forall k (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 2))
         ('SelectDim ('ByIndex 3))
         relPosEncShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            relPosEncShape)))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      relPosEncShape
    -&gt; m (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               relPosEncShape)))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     relPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape'
 ~ TransposeF
     ('SelectDim ('ByIndex 2)) ('SelectDim ('ByIndex 3)) shape,
 SingI ('SelectDim ('ByIndex 2)), SingI ('SelectDim ('ByIndex 3)),
 MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, SingI selectDim0,
 SingI selectDim1, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-818"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 2))
        ('SelectDim ('ByIndex 3))
        relPosEncShape))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 2)) ('SelectDim ('ByIndex 3)) relPosEncShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  relPosEncShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              relPosEncShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              relPosEncShape)))
forall k (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            relPosEncShape)))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         relPosEncGradient
         relPosEncLayout
         relPosEncDevice
         relPosEncDataType
         (TransposeF
            ('SelectDim ('ByIndex 1))
            ('SelectDim ('ByIndex 2))
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               relPosEncShape))))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 2)) ('SelectDim ('ByIndex 3)) relPosEncShape)
    -&gt; m (Tensor
            relPosEncGradient
            relPosEncLayout
            relPosEncDevice
            relPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  relPosEncShape))))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 2)) ('SelectDim ('ByIndex 3)) relPosEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        relPosEncGradient
        relPosEncLayout
        relPosEncDevice
        relPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              relPosEncShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape'
 ~ TransposeF
     ('SelectDim ('ByIndex 1)) ('SelectDim ('ByIndex 2)) shape,
 SingI ('SelectDim ('ByIndex 1)), SingI ('SelectDim ('ByIndex 2)),
 MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, SingI selectDim0,
 SingI selectDim1, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-819"></span><span>        </span><span id="local-6989586621679655994"><span class="annot"><span class="annottext">attentionBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        relPosEncGradient
        attentionMaskGradient)
     (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
     (Unify
        (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
     (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              relPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
</span><a href="#local-6989586621679655994"><span class="hs-identifier hs-var hs-var">attentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-820"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape)))
</span><a href="#local-6989586621679655995"><span class="hs-identifier hs-var">relPosBias</span></a></span><span>
</span><span id="line-821"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape)))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            relPosEncShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               relPosEncGradient
               attentionMaskGradient)
            (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
            (Unify
               (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
            (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
            (BroadcastShapesF
               (TransposeF
                  ('SelectDim ('ByIndex 1))
                  ('SelectDim ('ByIndex 2))
                  (TransposeF
                     ('SelectDim ('ByIndex 2))
                     ('SelectDim ('ByIndex 3))
                     relPosEncShape))
               (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           (TransposeF
              ('SelectDim ('ByIndex 1))
              ('SelectDim ('ByIndex 2))
              (TransposeF
                 ('SelectDim ('ByIndex 2))
                 ('SelectDim ('ByIndex 3))
                 relPosEncShape))
           (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     relPosEncGradient
     attentionMaskGradient)
  (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
  (Unify
     (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
  (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
  (BroadcastShapesF
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape))
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           (TransposeF
              ('SelectDim ('ByIndex 1))
              ('SelectDim ('ByIndex 2))
              (TransposeF
                 ('SelectDim ('ByIndex 2))
                 ('SelectDim ('ByIndex 3))
                 relPosEncShape))
           (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      relPosEncGradient
      attentionMaskGradient)
   (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
   (Unify
      (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
   (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
   (BroadcastShapesF
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            relPosEncShape))
      (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            relPosEncGradient
            attentionMaskGradient)
         (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
         (Unify
            (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
         (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
         (BroadcastShapesF
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  relPosEncShape))
            (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))))
-&gt; (Tensor
      relPosEncGradient
      relPosEncLayout
      relPosEncDevice
      relPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            relPosEncShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            relPosEncGradient
            attentionMaskGradient)
         (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
         (Unify
            (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
         (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
         (BroadcastShapesF
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  relPosEncShape))
            (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
-&gt; Tensor
     relPosEncGradient
     relPosEncLayout
     relPosEncDevice
     relPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           relPosEncGradient
           attentionMaskGradient)
        (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
        (Unify
           (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
        (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
        (BroadcastShapesF
           (TransposeF
              ('SelectDim ('ByIndex 1))
              ('SelectDim ('ByIndex 2))
              (TransposeF
                 ('SelectDim ('ByIndex 2))
                 ('SelectDim ('ByIndex 3))
                 relPosEncShape))
           (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  relPosEncGradient
  relPosEncLayout
  relPosEncDevice
  relPosEncDataType
  (TransposeF
     ('SelectDim ('ByIndex 1))
     ('SelectDim ('ByIndex 2))
     (TransposeF
        ('SelectDim ('ByIndex 2))
        ('SelectDim ('ByIndex 3))
        relPosEncShape))
-&gt; Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
-&gt; Tensor
     (relPosEncGradient &lt;|&gt; attentionMaskGradient)
     (relPosEncLayout &lt;+&gt; attentionMaskLayout)
     (relPosEncDevice &lt;+&gt; attentionMaskDevice)
     (relPosEncDataType &lt;+&gt; attentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              relPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
-&gt; Tensor
     attentionMaskGradient
     attentionMaskLayout
     attentionMaskDevice
     attentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
(shape' ~ UnsqueezeF selectDim shape, SingI selectDim) =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape'
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  attentionMaskGradient
  attentionMaskLayout
  attentionMaskDevice
  attentionMaskDataType
  attentionMaskShape
</span><a href="#local-6989586621679655996"><span class="hs-identifier hs-var">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-823"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        inputGradient inputLayout inputDevice inputDataType inputShape)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  inputGradient inputLayout inputDevice inputDataType inputShape
</span><a href="#local-6989586621679655998"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-824"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     inputGradient inputLayout inputDevice inputDataType inputShape)
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape
    -&gt; IxStateT
         m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (tensor0, Generator generatorDevice0))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (tensor0, Generator generatorDevice0))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; (Tensor
      inputGradient inputLayout inputDevice inputDataType inputShape
    -&gt; Generator generatorDevice
    -&gt; m (tensor0, Generator generatorDevice0))
-&gt; Tensor
     inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     inputGradient inputLayout inputDevice inputDataType inputShape
-&gt; Generator generatorDevice
-&gt; m (tensor0, Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679656003"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-825"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice0) tensor0
-&gt; (tensor0
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (tensor0
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; tensor0
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor0
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679656002"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-826"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679655993"><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679655993"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        relPosEncGradient
        attentionMaskGradient)
     (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
     (Unify
        (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
     (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              relPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
</span><a href="#local-6989586621679655994"><span class="hs-identifier hs-var">attentionBias</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        relPosEncGradient
        attentionMaskGradient)
     (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
     (Unify
        (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
     (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              relPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         relPosEncGradient
         attentionMaskGradient)
      (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
      (Unify
         (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
      (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
      (BroadcastShapesF
         (TransposeF
            ('SelectDim ('ByIndex 1))
            ('SelectDim ('ByIndex 2))
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               relPosEncShape))
         (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice3) tensor3
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679655992"><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     relPosEncGradient
     attentionMaskGradient)
  (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
  (Unify
     (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
  (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
  (BroadcastShapesF
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape))
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
</span><a href="#local-6989586621679655992"><span class="hs-identifier hs-var">attentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">stack
-&gt; (tensor1,
    Tensor
      (Or
         (Gradient RequiresGradient)
         relPosEncGradient
         attentionMaskGradient)
      (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
      (Unify
         (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
      (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
      (BroadcastShapesF
         (TransposeF
            ('SelectDim ('ByIndex 1))
            ('SelectDim ('ByIndex 2))
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               relPosEncShape))
         (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape)))
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679656001"><span class="hs-identifier hs-var">tStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679655993"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     relPosEncGradient
     attentionMaskGradient)
  (Unify (Layout LayoutType) relPosEncLayout attentionMaskLayout)
  (Unify
     (Device (DeviceType Nat)) relPosEncDevice attentionMaskDevice)
  (Unify (DataType DType) relPosEncDataType attentionMaskDataType)
  (BroadcastShapesF
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           relPosEncShape))
     (UnsqueezeF ('SelectDim ('ByIndex 1)) attentionMaskShape))
</span><a href="#local-6989586621679655992"><span class="hs-identifier hs-var">attentionBias'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679656000"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-828"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679655999"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-829"></span><span>
</span><span id="line-830"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in a decoder configuration</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- with absolute positional encoding rather than relative positional encoding.</span><span>
</span><span id="line-832"></span><span class="hs-comment">--</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-835"></span><span class="hs-comment">-- &#9474; decoderInput &#9474;  &#9474; decoderPos &#9474;  &#9474; encoderOutput &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-836"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-837"></span><span class="hs-comment">--        &#9474;                 &#9474;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-838"></span><span class="hs-comment">--        &#9474;                 &#9660;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-839"></span><span class="hs-comment">--        &#9474;             tdPosEnc             &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-840"></span><span class="hs-comment">--        &#9474;                 &#9474;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-841"></span><span class="hs-comment">--        &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-842"></span><span class="hs-comment">--                 &#9474;                         &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-843"></span><span class="hs-comment">--                 &#9660;                         &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-844"></span><span class="hs-comment">--        (tInitialLayerNorm)                &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-845"></span><span class="hs-comment">--                 &#9660;                         &#9474;                     &#9660;                         &#9660;</span><span>
</span><span id="line-846"></span><span class="hs-comment">--         (tInitialDropout)                 &#9474;                 unsqueeze                 unsqueeze</span><span>
</span><span id="line-847"></span><span class="hs-comment">--                 &#9660;                         &#9474;                     &#9474;                         &#9474;</span><span>
</span><span id="line-848"></span><span class="hs-comment">--              tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-849"></span><span class="hs-comment">--                 &#9660;</span><span>
</span><span id="line-850"></span><span class="hs-comment">--         (tFinalLayerNorm)</span><span>
</span><span id="line-851"></span><span class="hs-comment">--                 &#9660;</span><span>
</span><span id="line-852"></span><span class="hs-comment">--          (tFinalDropout)</span><span>
</span><span id="line-853"></span><span class="hs-comment">--                 &#9474;</span><span>
</span><span id="line-854"></span><span class="hs-comment">--                 &#9660;</span><span>
</span><span id="line-855"></span><span class="hs-comment">--            &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-856"></span><span class="hs-comment">--            &#9474; output &#9474;</span><span>
</span><span id="line-857"></span><span class="hs-comment">--            &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-858"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-859"></span><span id="local-6989586621679655944"><span id="local-6989586621679655945"><span id="local-6989586621679655946"><span id="local-6989586621679655947"><span id="local-6989586621679655948"><span id="local-6989586621679655949"><span id="local-6989586621679655950"><span id="local-6989586621679655951"><span id="local-6989586621679655952"><span id="local-6989586621679655953"><span id="local-6989586621679655954"><span id="local-6989586621679655955"><span id="local-6989586621679655956"><span id="local-6989586621679655957"><span id="local-6989586621679655958"><span id="local-6989586621679655959"><span id="local-6989586621679655960"><span id="local-6989586621679655961"><span id="local-6989586621679655962"><span id="local-6989586621679655963"><span id="local-6989586621679655964"><span id="local-6989586621679655965"><span id="local-6989586621679655966"><span id="local-6989586621679655967"><span id="local-6989586621679655968"><span id="local-6989586621679655969"><span id="local-6989586621679655970"><span id="local-6989586621679655971"><span id="local-6989586621679655972"><span id="local-6989586621679655973"><span id="local-6989586621679655974"><span id="local-6989586621679655975"><span id="local-6989586621679655976"><span id="local-6989586621679655977"><span id="local-6989586621679655978"><span id="local-6989586621679655979"><span id="local-6989586621679655980"><span id="local-6989586621679655981"><span id="local-6989586621679655982"><span id="local-6989586621679655983"><span id="local-6989586621679655984"><span id="local-6989586621679655985"><span id="local-6989586621679655986"><span id="local-6989586621679655987"><span id="local-6989586621679655988"><span id="local-6989586621679655989"><span id="local-6989586621679655990"><span id="local-6989586621679655991"><span class="hs-keyword">instance</span><span>
</span><span id="line-860"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-861"></span><span>      </span><span class="annot"><a href="#local-6989586621679655991"><span class="hs-identifier hs-type">posEnc</span></a></span><span>
</span><span id="line-862"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655990"><span class="hs-identifier hs-type">decoderPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655989"><span class="hs-identifier hs-type">decoderPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655988"><span class="hs-identifier hs-type">decoderPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655987"><span class="hs-identifier hs-type">decoderPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655986"><span class="hs-identifier hs-type">decoderPosShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>      </span><span class="annot"><a href="#local-6989586621679655985"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-864"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655984"><span class="hs-identifier hs-type">decoderPosEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655983"><span class="hs-identifier hs-type">decoderPosEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655982"><span class="hs-identifier hs-type">decoderPosEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655981"><span class="hs-identifier hs-type">decoderPosEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655980"><span class="hs-identifier hs-type">decoderPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>      </span><span class="annot"><a href="#local-6989586621679655979"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-866"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-867"></span><span>      </span><span class="annot"><a href="#local-6989586621679655978"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-868"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-869"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655977"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655984"><span class="hs-identifier hs-type">decoderPosEncGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-870"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655976"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655983"><span class="hs-identifier hs-type">decoderPosEncLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-871"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655975"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655982"><span class="hs-identifier hs-type">decoderPosEncDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-872"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655974"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655981"><span class="hs-identifier hs-type">decoderPosEncDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655973"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655980"><span class="hs-identifier hs-type">decoderPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>      </span><span class="annot"><a href="#local-6989586621679655979"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-876"></span><span>      </span><span class="annot"><a href="#local-6989586621679655972"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-877"></span><span>      </span><span class="annot"><a href="#local-6989586621679655971"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-878"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-879"></span><span>      </span><span class="annot"><a href="#local-6989586621679655970"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-880"></span><span>      </span><span class="annot"><a href="#local-6989586621679655972"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-881"></span><span>      </span><span class="annot"><a href="#local-6989586621679655971"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-882"></span><span>      </span><span class="annot"><a href="#local-6989586621679655969"><span class="hs-identifier hs-type">tensor2</span></a></span><span>
</span><span id="line-883"></span><span>      </span><span class="annot"><a href="#local-6989586621679655968"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-884"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-885"></span><span>      </span><span class="annot"><a href="#local-6989586621679655967"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-886"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679655969"><span class="hs-identifier hs-type">tensor2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-887"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655966"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655965"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655964"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655963"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655962"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-888"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-889"></span><span>          </span><span class="annot"><a href="#local-6989586621679655961"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span>
</span><span id="line-890"></span><span>          </span><span class="annot"><a href="#local-6989586621679655960"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span>
</span><span id="line-891"></span><span>          </span><span class="annot"><a href="#local-6989586621679655959"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span>
</span><span id="line-892"></span><span>          </span><span class="annot"><a href="#local-6989586621679655958"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span>
</span><span id="line-893"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679655957"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-894"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-895"></span><span>          </span><span class="annot"><a href="#local-6989586621679655956"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span>
</span><span id="line-896"></span><span>          </span><span class="annot"><a href="#local-6989586621679655955"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span>
</span><span id="line-897"></span><span>          </span><span class="annot"><a href="#local-6989586621679655954"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span>
</span><span id="line-898"></span><span>          </span><span class="annot"><a href="#local-6989586621679655953"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span>
</span><span id="line-899"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679655952"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-901"></span><span>      </span><span class="annot"><a href="#local-6989586621679655968"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-902"></span><span>      </span><span class="annot"><a href="#local-6989586621679655951"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-903"></span><span>      </span><span class="annot"><a href="#local-6989586621679655950"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-904"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-905"></span><span>      </span><span class="annot"><a href="#local-6989586621679655949"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-906"></span><span>      </span><span class="annot"><a href="#local-6989586621679655951"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-907"></span><span>      </span><span class="annot"><a href="#local-6989586621679655950"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-908"></span><span>      </span><span class="annot"><a href="#local-6989586621679655948"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-909"></span><span>      </span><span class="annot"><a href="#local-6989586621679655947"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-910"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-911"></span><span>      </span><span class="annot"><a href="#local-6989586621679655946"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-912"></span><span>      </span><span class="annot"><a href="#local-6989586621679655948"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-913"></span><span>      </span><span class="annot"><a href="#local-6989586621679655947"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-914"></span><span>      </span><span class="annot"><a href="#local-6989586621679655945"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-915"></span><span>      </span><span class="annot"><a href="#local-6989586621679655944"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-916"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-917"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-918"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655991"><span class="hs-identifier hs-type">posEnc</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679655978"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655970"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655967"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655949"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655946"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-919"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655977"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655976"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655975"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655974"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655973"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-920"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655966"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655965"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655964"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655963"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655962"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-921"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655990"><span class="hs-identifier hs-type">decoderPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655989"><span class="hs-identifier hs-type">decoderPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655988"><span class="hs-identifier hs-type">decoderPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655987"><span class="hs-identifier hs-type">decoderPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655986"><span class="hs-identifier hs-type">decoderPosShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-922"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655961"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655960"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655959"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655958"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655957"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-923"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655956"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655955"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655954"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655953"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655952"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span>
</span><span id="line-924"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-925"></span><span>    </span><span class="annot"><a href="#local-6989586621679655985"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-926"></span><span>    </span><span class="annot"><a href="#local-6989586621679655945"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-927"></span><span>    </span><span class="annot"><a href="#local-6989586621679655944"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-928"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-929"></span><span>  </span><span id="local-6989586621679655942"><span class="annot"><span class="annottext">forward :: GTransformer
  posEnc
  ()
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      decoderPosGradient
      decoderPosLayout
      decoderPosDevice
      decoderPosDataType
      decoderPosShape,
    Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      decoderAttentionMaskShape,
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      crossAttentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679655942"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679655935"><span id="local-6989586621679655936"><span id="local-6989586621679655937"><span id="local-6989586621679655938"><span id="local-6989586621679655939"><span id="local-6989586621679655940"><span id="local-6989586621679655941"><span class="annot"><span class="annottext">posEnc
initialLayerNorm
initialDropout
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: ()
tPosEnc :: posEnc
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679655935"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679655934"><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679655934"><span class="hs-identifier hs-var">decoderInput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655933"><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679655933"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655932"><span class="annot"><span class="annottext">Tensor
  decoderPosGradient
  decoderPosLayout
  decoderPosDevice
  decoderPosDataType
  decoderPosShape
</span><a href="#local-6989586621679655932"><span class="hs-identifier hs-var">decoderPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655931"><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679655931"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655930"><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679655930"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-930"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679655929"><span class="annot"><span class="annottext">decoderAttentionBias :: Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
</span><a href="#local-6989586621679655929"><span class="hs-identifier hs-var hs-var">decoderAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
-&gt; Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
(shape' ~ UnsqueezeF selectDim shape, SingI selectDim) =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape'
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679655931"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span><span>
</span><span id="line-931"></span><span>        </span><span id="local-6989586621679655928"><span class="annot"><span class="annottext">crossAttentionBias :: Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
</span><a href="#local-6989586621679655928"><span class="hs-identifier hs-var hs-var">crossAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
-&gt; Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
(shape' ~ UnsqueezeF selectDim shape, SingI selectDim) =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape'
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679655930"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span><span>
</span><span id="line-932"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-933"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  decoderPosGradient
  decoderPosLayout
  decoderPosDevice
  decoderPosDataType
  decoderPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        decoderPosGradient
        decoderPosLayout
        decoderPosDevice
        decoderPosDataType
        decoderPosShape)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderPosGradient
  decoderPosLayout
  decoderPosDevice
  decoderPosDataType
  decoderPosShape
</span><a href="#local-6989586621679655932"><span class="hs-identifier hs-var">decoderPos</span></a></span><span>
</span><span id="line-934"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     decoderPosGradient
     decoderPosLayout
     decoderPosDevice
     decoderPosDataType
     decoderPosShape)
-&gt; (Tensor
      decoderPosGradient
      decoderPosLayout
      decoderPosDevice
      decoderPosDataType
      decoderPosShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice0)
         (Tensor
            decoderPosEncGradient
            decoderPosEncLayout
            decoderPosEncDevice
            decoderPosEncDataType
            decoderPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         decoderPosEncGradient
         decoderPosEncLayout
         decoderPosEncDevice
         decoderPosEncDataType
         decoderPosEncShape,
       Generator generatorDevice0))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          decoderPosEncGradient
          decoderPosEncLayout
          decoderPosEncDevice
          decoderPosEncDataType
          decoderPosEncShape,
        Generator generatorDevice0))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice0)
      (Tensor
         decoderPosEncGradient
         decoderPosEncLayout
         decoderPosEncDevice
         decoderPosEncDataType
         decoderPosEncShape))
-&gt; (Tensor
      decoderPosGradient
      decoderPosLayout
      decoderPosDevice
      decoderPosDataType
      decoderPosShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            decoderPosEncGradient
            decoderPosEncLayout
            decoderPosEncDevice
            decoderPosEncDataType
            decoderPosEncShape,
          Generator generatorDevice0))
-&gt; Tensor
     decoderPosGradient
     decoderPosLayout
     decoderPosDevice
     decoderPosDataType
     decoderPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">posEnc
-&gt; Tensor
     decoderPosGradient
     decoderPosLayout
     decoderPosDevice
     decoderPosDataType
     decoderPosShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        decoderPosEncGradient
        decoderPosEncLayout
        decoderPosEncDevice
        decoderPosEncDataType
        decoderPosEncShape,
      Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">posEnc
</span><a href="#local-6989586621679655941"><span class="hs-identifier hs-var">tPosEnc</span></a></span><span>
</span><span id="line-935"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     decoderPosEncGradient
     decoderPosEncLayout
     decoderPosEncDevice
     decoderPosEncDataType
     decoderPosEncShape)
-&gt; (Tensor
      decoderPosEncGradient
      decoderPosEncLayout
      decoderPosEncDevice
      decoderPosEncDataType
      decoderPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice0)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderInputGradient
               decoderPosEncGradient)
            (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
            (Unify
               (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
            (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
            (BroadcastShapesF decoderInputShape decoderPosEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice0)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderInputGradient
           decoderPosEncGradient)
        (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
        (Unify
           (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
        (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
        (BroadcastShapesF decoderInputShape decoderPosEncShape))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     decoderInputGradient
     decoderPosEncGradient)
  (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
  (Unify
     (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
  (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
  (BroadcastShapesF decoderInputShape decoderPosEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderInputGradient
           decoderPosEncGradient)
        (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
        (Unify
           (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
        (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
        (BroadcastShapesF decoderInputShape decoderPosEncShape))
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      decoderInputGradient
      decoderPosEncGradient)
   (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
   (Unify
      (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
   (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
   (BroadcastShapesF decoderInputShape decoderPosEncShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice0)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            decoderInputGradient
            decoderPosEncGradient)
         (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
         (Unify
            (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
         (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
         (BroadcastShapesF decoderInputShape decoderPosEncShape)))
-&gt; (Tensor
      decoderPosEncGradient
      decoderPosEncLayout
      decoderPosEncDevice
      decoderPosEncDataType
      decoderPosEncShape
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            decoderInputGradient
            decoderPosEncGradient)
         (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
         (Unify
            (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
         (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
         (BroadcastShapesF decoderInputShape decoderPosEncShape))
-&gt; Tensor
     decoderPosEncGradient
     decoderPosEncLayout
     decoderPosEncDevice
     decoderPosEncDataType
     decoderPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice0)
     (Generator generatorDevice0)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderInputGradient
           decoderPosEncGradient)
        (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
        (Unify
           (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
        (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
        (BroadcastShapesF decoderInputShape decoderPosEncShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679655934"><span class="hs-identifier hs-var">decoderInput</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
-&gt; Tensor
     decoderPosEncGradient
     decoderPosEncLayout
     decoderPosEncDevice
     decoderPosEncDataType
     decoderPosEncShape
-&gt; Tensor
     (decoderInputGradient &lt;|&gt; decoderPosEncGradient)
     (decoderInputLayout &lt;+&gt; decoderPosEncLayout)
     (decoderInputDevice &lt;+&gt; decoderPosEncDevice)
     (decoderInputDataType &lt;+&gt; decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape)
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-936"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice0)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderInputGradient
        decoderPosEncGradient)
     (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
     (Unify
        (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
     (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderInputGradient
         decoderPosEncGradient)
      (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
      (Unify
         (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
      (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
      (BroadcastShapesF decoderInputShape decoderPosEncShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderInputGradient
         decoderPosEncGradient)
      (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
      (Unify
         (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
      (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
      (BroadcastShapesF decoderInputShape decoderPosEncShape)
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        decoderInputGradient
        decoderPosEncGradient)
     (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
     (Unify
        (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
     (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape)
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        decoderInputGradient
        decoderPosEncGradient)
     (Unify (Layout LayoutType) decoderInputLayout decoderPosEncLayout)
     (Unify
        (Device (DeviceType Nat)) decoderInputDevice decoderPosEncDevice)
     (Unify (DataType DType) decoderInputDataType decoderPosEncDataType)
     (BroadcastShapesF decoderInputShape decoderPosEncShape)
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679655939"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-937"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         tensor2)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice2) tensor2
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (tensor2, Generator generatorDevice2))
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (tensor2, Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      tensor2)
-&gt; (tensor1
    -&gt; Generator generatorDevice1
    -&gt; m (tensor2, Generator generatorDevice2))
-&gt; tensor1
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor1
-&gt; Generator generatorDevice1
-&gt; m (tensor2, Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679655938"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-938"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice2) tensor2
-&gt; (tensor2
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679655927"><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679655927"><span class="hs-identifier hs-var">decoderInput'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-939"></span><span>                     </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-940"></span><span>                       </span><span class="annot"><span class="annottext">stack
-&gt; (tensor2,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape),
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span>
</span><span id="line-941"></span><span>                         </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679655937"><span class="hs-identifier hs-var">tStack</span></a></span><span>
</span><span id="line-942"></span><span>                         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">tensor2
</span><a href="#local-6989586621679655927"><span class="hs-identifier hs-var">decoderInput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-943"></span><span>                           </span><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679655933"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-944"></span><span>                           </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
</span><a href="#local-6989586621679655929"><span class="hs-identifier hs-var">decoderAttentionBias</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-945"></span><span>                           </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
</span><a href="#local-6989586621679655928"><span class="hs-identifier hs-var">crossAttentionBias</span></a></span><span>
</span><span id="line-946"></span><span>                         </span><span class="hs-special">)</span><span>
</span><span id="line-947"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-948"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679655936"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-949"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679655935"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-950"></span><span>
</span><span id="line-951"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformer' in a decoder configuration</span><span>
</span><span id="line-952"></span><span class="hs-comment">-- with relative positional encoding rather than absolute positional encoding.</span><span>
</span><span id="line-953"></span><span class="hs-comment">--</span><span>
</span><span id="line-954"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-955"></span><span class="hs-comment">--   &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-956"></span><span class="hs-comment">--   &#9474; decoderInput &#9474;  &#9474; encoderOutput &#9474;  &#9474; decoderRelPos &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-957"></span><span class="hs-comment">--   &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-958"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9474;                     &#9474;                        &#9474;</span><span>
</span><span id="line-959"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9660;                     &#9474;                        &#9474;</span><span>
</span><span id="line-960"></span><span class="hs-comment">--          &#9474;                  &#9474;             tdRelPosEnc                &#9474;                        &#9474;</span><span>
</span><span id="line-961"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9660;                     &#9474;                        &#9474;</span><span>
</span><span id="line-962"></span><span class="hs-comment">--          &#9474;                  &#9474;              transpose                 &#9474;                        &#9474;</span><span>
</span><span id="line-963"></span><span class="hs-comment">--          &#9474;                  &#9474;                  &#9660;                     &#9660;                        &#9660;</span><span>
</span><span id="line-964"></span><span class="hs-comment">--          &#9474;                  &#9474;              transpose             unsqueeze                unsqueeze</span><span>
</span><span id="line-965"></span><span class="hs-comment">--          &#9660;                  &#9474;                  &#9474;                     &#9474;                        &#9474;</span><span>
</span><span id="line-966"></span><span class="hs-comment">-- (tInitialLayerNorm)         &#9474;                  &#9474;                     &#9474;                        &#9474;</span><span>
</span><span id="line-967"></span><span class="hs-comment">--          &#9660;                  &#9474;                  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                        &#9474;</span><span>
</span><span id="line-968"></span><span class="hs-comment">--  (tInitialDropout)          &#9474;                             &#9474;                                   &#9474;</span><span>
</span><span id="line-969"></span><span class="hs-comment">--          &#9660;                  &#9474;                             &#9474;                                   &#9474;</span><span>
</span><span id="line-970"></span><span class="hs-comment">--       tStack&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-971"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-972"></span><span class="hs-comment">--  (tFinalLayerNorm)</span><span>
</span><span id="line-973"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-974"></span><span class="hs-comment">--   (tFinalDropout)</span><span>
</span><span id="line-975"></span><span class="hs-comment">--          &#9474;</span><span>
</span><span id="line-976"></span><span class="hs-comment">--          &#9660;</span><span>
</span><span id="line-977"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-978"></span><span class="hs-comment">--     &#9474; output &#9474;</span><span>
</span><span id="line-979"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-980"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-981"></span><span id="local-6989586621679655879"><span id="local-6989586621679655880"><span id="local-6989586621679655881"><span id="local-6989586621679655882"><span id="local-6989586621679655883"><span id="local-6989586621679655884"><span id="local-6989586621679655885"><span id="local-6989586621679655886"><span id="local-6989586621679655887"><span id="local-6989586621679655888"><span id="local-6989586621679655889"><span id="local-6989586621679655890"><span id="local-6989586621679655891"><span id="local-6989586621679655892"><span id="local-6989586621679655893"><span id="local-6989586621679655894"><span id="local-6989586621679655895"><span id="local-6989586621679655896"><span id="local-6989586621679655897"><span id="local-6989586621679655898"><span id="local-6989586621679655899"><span id="local-6989586621679655900"><span id="local-6989586621679655901"><span id="local-6989586621679655902"><span id="local-6989586621679655903"><span id="local-6989586621679655904"><span id="local-6989586621679655905"><span id="local-6989586621679655906"><span id="local-6989586621679655907"><span id="local-6989586621679655908"><span id="local-6989586621679655909"><span id="local-6989586621679655910"><span id="local-6989586621679655911"><span id="local-6989586621679655912"><span id="local-6989586621679655913"><span id="local-6989586621679655914"><span id="local-6989586621679655915"><span id="local-6989586621679655916"><span id="local-6989586621679655917"><span id="local-6989586621679655918"><span id="local-6989586621679655919"><span id="local-6989586621679655920"><span id="local-6989586621679655921"><span id="local-6989586621679655922"><span id="local-6989586621679655923"><span id="local-6989586621679655924"><span id="local-6989586621679655925"><span id="local-6989586621679655926"><span class="hs-keyword">instance</span><span>
</span><span id="line-982"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-983"></span><span>      </span><span class="annot"><a href="#local-6989586621679655926"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span>
</span><span id="line-984"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655925"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655924"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655923"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655922"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655921"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-985"></span><span>      </span><span class="annot"><a href="#local-6989586621679655920"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-986"></span><span>      </span><span class="annot"><a href="#local-6989586621679655919"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-987"></span><span>      </span><span class="annot"><a href="#local-6989586621679655918"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-988"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-989"></span><span>      </span><span class="annot"><a href="#local-6989586621679655917"><span class="hs-identifier hs-type">initialDropout</span></a></span><span>
</span><span id="line-990"></span><span>      </span><span class="annot"><a href="#local-6989586621679655919"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-991"></span><span>      </span><span class="annot"><a href="#local-6989586621679655918"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-992"></span><span>      </span><span class="annot"><a href="#local-6989586621679655916"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-993"></span><span>      </span><span class="annot"><a href="#local-6989586621679655915"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-994"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-995"></span><span>      </span><span class="annot"><a href="#local-6989586621679655914"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span>
</span><span id="line-996"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655913"><span class="hs-identifier hs-type">decoderRelPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655912"><span class="hs-identifier hs-type">decoderRelPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655911"><span class="hs-identifier hs-type">decoderRelPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655910"><span class="hs-identifier hs-type">decoderRelPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655909"><span class="hs-identifier hs-type">decoderRelPosShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-997"></span><span>      </span><span class="annot"><a href="#local-6989586621679655915"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-998"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655908"><span class="hs-identifier hs-type">decoderRelPosEncGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655907"><span class="hs-identifier hs-type">decoderRelPosEncLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655906"><span class="hs-identifier hs-type">decoderRelPosEncDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655905"><span class="hs-identifier hs-type">decoderRelPosEncDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655904"><span class="hs-identifier hs-type">decoderRelPosEncShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-999"></span><span>      </span><span class="annot"><a href="#local-6989586621679655903"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1000"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1001"></span><span>      </span><span class="annot"><a href="#local-6989586621679655902"><span class="hs-identifier hs-type">stack</span></a></span><span>
</span><span id="line-1002"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679655916"><span class="hs-identifier hs-type">tensor1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1003"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655901"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655900"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655899"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655898"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655897"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1004"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-1005"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655908"><span class="hs-identifier hs-type">decoderRelPosEncGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655896"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1006"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655907"><span class="hs-identifier hs-type">decoderRelPosEncLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655895"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1007"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655906"><span class="hs-identifier hs-type">decoderRelPosEncDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655894"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1008"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679655905"><span class="hs-identifier hs-type">decoderRelPosEncDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655893"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1009"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-1010"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span>
</span><span id="line-1011"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1012"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1013"></span><span>                  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#TransposeF"><span class="hs-identifier hs-type">TransposeF</span></a></span><span>
</span><span id="line-1014"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1015"></span><span>                      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1016"></span><span>                      </span><span class="annot"><a href="#local-6989586621679655904"><span class="hs-identifier hs-type">decoderRelPosEncShape</span></a></span><span>
</span><span id="line-1017"></span><span>                  </span><span class="hs-special">)</span><span>
</span><span id="line-1018"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-1019"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679655892"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1020"></span><span>          </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-1021"></span><span>        </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-1022"></span><span>          </span><span class="annot"><a href="#local-6989586621679655891"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span>
</span><span id="line-1023"></span><span>          </span><span class="annot"><a href="#local-6989586621679655890"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span>
</span><span id="line-1024"></span><span>          </span><span class="annot"><a href="#local-6989586621679655889"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span>
</span><span id="line-1025"></span><span>          </span><span class="annot"><a href="#local-6989586621679655888"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span>
</span><span id="line-1026"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#UnsqueezeF"><span class="hs-identifier hs-type">UnsqueezeF</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679655887"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1027"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-1028"></span><span>      </span><span class="annot"><a href="#local-6989586621679655903"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-1029"></span><span>      </span><span class="annot"><a href="#local-6989586621679655886"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-1030"></span><span>      </span><span class="annot"><a href="#local-6989586621679655885"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1031"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1032"></span><span>      </span><span class="annot"><a href="#local-6989586621679655884"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span>
</span><span id="line-1033"></span><span>      </span><span class="annot"><a href="#local-6989586621679655886"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-1034"></span><span>      </span><span class="annot"><a href="#local-6989586621679655885"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-1035"></span><span>      </span><span class="annot"><a href="#local-6989586621679655883"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-1036"></span><span>      </span><span class="annot"><a href="#local-6989586621679655882"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1037"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1038"></span><span>      </span><span class="annot"><a href="#local-6989586621679655881"><span class="hs-identifier hs-type">finalDropout</span></a></span><span>
</span><span id="line-1039"></span><span>      </span><span class="annot"><a href="#local-6989586621679655883"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-1040"></span><span>      </span><span class="annot"><a href="#local-6989586621679655882"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-1041"></span><span>      </span><span class="annot"><a href="#local-6989586621679655880"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-1042"></span><span>      </span><span class="annot"><a href="#local-6989586621679655879"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-1043"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-1044"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-1045"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679655914"><span class="hs-identifier hs-type">relPosEnc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655926"><span class="hs-identifier hs-type">initialLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655917"><span class="hs-identifier hs-type">initialDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655902"><span class="hs-identifier hs-type">stack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655884"><span class="hs-identifier hs-type">finalLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655881"><span class="hs-identifier hs-type">finalDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1046"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655925"><span class="hs-identifier hs-type">decoderInputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655924"><span class="hs-identifier hs-type">decoderInputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655923"><span class="hs-identifier hs-type">decoderInputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655922"><span class="hs-identifier hs-type">decoderInputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655921"><span class="hs-identifier hs-type">decoderInputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1047"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655901"><span class="hs-identifier hs-type">encoderOutputGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655900"><span class="hs-identifier hs-type">encoderOutputLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655899"><span class="hs-identifier hs-type">encoderOutputDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655898"><span class="hs-identifier hs-type">encoderOutputDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655897"><span class="hs-identifier hs-type">encoderOutputShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1048"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655913"><span class="hs-identifier hs-type">decoderRelPosGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655912"><span class="hs-identifier hs-type">decoderRelPosLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655911"><span class="hs-identifier hs-type">decoderRelPosDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655910"><span class="hs-identifier hs-type">decoderRelPosDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655909"><span class="hs-identifier hs-type">decoderRelPosShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1049"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655896"><span class="hs-identifier hs-type">decoderAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655895"><span class="hs-identifier hs-type">decoderAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655894"><span class="hs-identifier hs-type">decoderAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655893"><span class="hs-identifier hs-type">decoderAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655892"><span class="hs-identifier hs-type">decoderAttentionMaskShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1050"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655891"><span class="hs-identifier hs-type">crossAttentionMaskGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655890"><span class="hs-identifier hs-type">crossAttentionMaskLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655889"><span class="hs-identifier hs-type">crossAttentionMaskDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655888"><span class="hs-identifier hs-type">crossAttentionMaskDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679655887"><span class="hs-identifier hs-type">crossAttentionMaskShape</span></a></span><span>
</span><span id="line-1051"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-1052"></span><span>    </span><span class="annot"><a href="#local-6989586621679655920"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-1053"></span><span>    </span><span class="annot"><a href="#local-6989586621679655880"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-1054"></span><span>    </span><span class="annot"><a href="#local-6989586621679655879"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-1055"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-1056"></span><span>  </span><span id="local-6989586621679655877"><span class="annot"><span class="annottext">forward :: GTransformer
  ()
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      decoderRelPosGradient
      decoderRelPosLayout
      decoderRelPosDevice
      decoderRelPosDataType
      decoderRelPosShape,
    Tensor
      decoderAttentionMaskGradient
      decoderAttentionMaskLayout
      decoderAttentionMaskDevice
      decoderAttentionMaskDataType
      decoderAttentionMaskShape,
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      crossAttentionMaskShape)
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679655877"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679655870"><span id="local-6989586621679655871"><span id="local-6989586621679655872"><span id="local-6989586621679655873"><span id="local-6989586621679655874"><span id="local-6989586621679655875"><span id="local-6989586621679655876"><span class="annot"><span class="annottext">initialLayerNorm
initialDropout
relPosEnc
stack
finalLayerNorm
finalDropout
()
tFinalDropout :: finalDropout
tFinalLayerNorm :: finalLayerNorm
tStack :: stack
tInitialDropout :: initialDropout
tInitialLayerNorm :: initialLayerNorm
tRelPosEnc :: relPosEnc
tPosEnc :: ()
tFinalDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalDropout
tFinalLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; finalLayerNorm
tStack :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; stack
tInitialDropout :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialDropout
tInitialLayerNorm :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; initialLayerNorm
tRelPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; relPosEnc
tPosEnc :: forall posEnc relPosEnc initialLayerNorm initialDropout stack
       finalLayerNorm finalDropout.
GTransformer
  posEnc
  relPosEnc
  initialLayerNorm
  initialDropout
  stack
  finalLayerNorm
  finalDropout
-&gt; posEnc
</span><a href="#local-6989586621679655870"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679655869"><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679655869"><span class="hs-identifier hs-var">decoderInput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655868"><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679655868"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655867"><span class="annot"><span class="annottext">Tensor
  decoderRelPosGradient
  decoderRelPosLayout
  decoderRelPosDevice
  decoderRelPosDataType
  decoderRelPosShape
</span><a href="#local-6989586621679655867"><span class="hs-identifier hs-var">decoderRelPos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655866"><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679655866"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679655865"><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679655865"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1057"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679655864"><span class="annot"><span class="annottext">decoderRelPosBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape)))
</span><a href="#local-6989586621679655864"><span class="hs-identifier hs-var hs-var">decoderRelPosBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1058"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  decoderRelPosGradient
  decoderRelPosLayout
  decoderRelPosDevice
  decoderRelPosDataType
  decoderRelPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice1)
     (Tensor
        decoderRelPosGradient
        decoderRelPosLayout
        decoderRelPosDevice
        decoderRelPosDataType
        decoderRelPosShape)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderRelPosGradient
  decoderRelPosLayout
  decoderRelPosDevice
  decoderRelPosDataType
  decoderRelPosShape
</span><a href="#local-6989586621679655867"><span class="hs-identifier hs-var">decoderRelPos</span></a></span><span>
</span><span id="line-1059"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice1)
  (Tensor
     decoderRelPosGradient
     decoderRelPosLayout
     decoderRelPosDevice
     decoderRelPosDataType
     decoderRelPosShape)
-&gt; (Tensor
      decoderRelPosGradient
      decoderRelPosLayout
      decoderRelPosDevice
      decoderRelPosDataType
      decoderRelPosShape
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            decoderRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         decoderRelPosEncShape,
       Generator generatorDevice2))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (Tensor
          decoderRelPosEncGradient
          decoderRelPosEncLayout
          decoderRelPosEncDevice
          decoderRelPosEncDataType
          decoderRelPosEncShape,
        Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         decoderRelPosEncShape))
-&gt; (Tensor
      decoderRelPosGradient
      decoderRelPosLayout
      decoderRelPosDevice
      decoderRelPosDataType
      decoderRelPosShape
    -&gt; Generator generatorDevice1
    -&gt; m (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            decoderRelPosEncShape,
          Generator generatorDevice2))
-&gt; Tensor
     decoderRelPosGradient
     decoderRelPosLayout
     decoderRelPosDevice
     decoderRelPosDataType
     decoderRelPosShape
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">relPosEnc
-&gt; Tensor
     decoderRelPosGradient
     decoderRelPosLayout
     decoderRelPosDevice
     decoderRelPosDataType
     decoderRelPosShape
-&gt; Generator generatorDevice1
-&gt; m (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        decoderRelPosEncShape,
      Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">relPosEnc
</span><a href="#local-6989586621679655875"><span class="hs-identifier hs-var">tRelPosEnc</span></a></span><span>
</span><span id="line-1060"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     decoderRelPosEncShape)
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      decoderRelPosEncShape
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               decoderRelPosEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 2))
        ('SelectDim ('ByIndex 3))
        decoderRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape))
forall k (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 2))
         ('SelectDim ('ByIndex 3))
         decoderRelPosEncShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            decoderRelPosEncShape)))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      decoderRelPosEncShape
    -&gt; m (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               decoderRelPosEncShape)))
-&gt; Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     decoderRelPosEncShape
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape'
 ~ TransposeF
     ('SelectDim ('ByIndex 2)) ('SelectDim ('ByIndex 3)) shape,
 SingI ('SelectDim ('ByIndex 2)), SingI ('SelectDim ('ByIndex 3)),
 MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, SingI selectDim0,
 SingI selectDim1, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">3</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1061"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 2))
        ('SelectDim ('ByIndex 3))
        decoderRelPosEncShape))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 2))
         ('SelectDim ('ByIndex 3))
         decoderRelPosEncShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  decoderRelPosEncShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              decoderRelPosEncShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">m (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              decoderRelPosEncShape)))
forall k (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">(m (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            decoderRelPosEncShape)))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         decoderRelPosEncGradient
         decoderRelPosEncLayout
         decoderRelPosEncDevice
         decoderRelPosEncDataType
         (TransposeF
            ('SelectDim ('ByIndex 1))
            ('SelectDim ('ByIndex 2))
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               decoderRelPosEncShape))))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 2))
         ('SelectDim ('ByIndex 3))
         decoderRelPosEncShape)
    -&gt; m (Tensor
            decoderRelPosEncGradient
            decoderRelPosEncLayout
            decoderRelPosEncDevice
            decoderRelPosEncDataType
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  decoderRelPosEncShape))))
-&gt; Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 2))
        ('SelectDim ('ByIndex 3))
        decoderRelPosEncShape)
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        decoderRelPosEncGradient
        decoderRelPosEncLayout
        decoderRelPosEncDevice
        decoderRelPosEncDataType
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              decoderRelPosEncShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape'
 ~ TransposeF
     ('SelectDim ('ByIndex 1)) ('SelectDim ('ByIndex 2)) shape,
 SingI ('SelectDim ('ByIndex 1)), SingI ('SelectDim ('ByIndex 2)),
 MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
forall (selectDim0 :: SelectDim (By Symbol Nat))
       (selectDim1 :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(shape' ~ TransposeF selectDim0 selectDim1 shape, SingI selectDim0,
 SingI selectDim1, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; m (Tensor gradient layout device dataType shape')
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#transpose"><span class="hs-identifier hs-var">transpose</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">2</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-1062"></span><span>        </span><span id="local-6989586621679655863"><span class="annot"><span class="annottext">decoderAttentionBias :: IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderRelPosEncGradient
        decoderAttentionMaskGradient)
     (Unify
        (Layout LayoutType)
        decoderRelPosEncLayout
        decoderAttentionMaskLayout)
     (Unify
        (Device (DeviceType Nat))
        decoderRelPosEncDevice
        decoderAttentionMaskDevice)
     (Unify
        (DataType DType)
        decoderRelPosEncDataType
        decoderAttentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              decoderRelPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
</span><a href="#local-6989586621679655863"><span class="hs-identifier hs-var hs-var">decoderAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1063"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape)))
</span><a href="#local-6989586621679655864"><span class="hs-identifier hs-var">decoderRelPosBias</span></a></span><span>
</span><span id="line-1064"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape)))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            decoderRelPosEncShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice2)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               decoderRelPosEncGradient
               decoderAttentionMaskGradient)
            (Unify
               (Layout LayoutType)
               decoderRelPosEncLayout
               decoderAttentionMaskLayout)
            (Unify
               (Device (DeviceType Nat))
               decoderRelPosEncDevice
               decoderAttentionMaskDevice)
            (Unify
               (DataType DType)
               decoderRelPosEncDataType
               decoderAttentionMaskDataType)
            (BroadcastShapesF
               (TransposeF
                  ('SelectDim ('ByIndex 1))
                  ('SelectDim ('ByIndex 2))
                  (TransposeF
                     ('SelectDim ('ByIndex 2))
                     ('SelectDim ('ByIndex 3))
                     decoderRelPosEncShape))
               (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice1)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           (TransposeF
              ('SelectDim ('ByIndex 1))
              ('SelectDim ('ByIndex 2))
              (TransposeF
                 ('SelectDim ('ByIndex 2))
                 ('SelectDim ('ByIndex 3))
                 decoderRelPosEncShape))
           (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     decoderRelPosEncGradient
     decoderAttentionMaskGradient)
  (Unify
     (Layout LayoutType)
     decoderRelPosEncLayout
     decoderAttentionMaskLayout)
  (Unify
     (Device (DeviceType Nat))
     decoderRelPosEncDevice
     decoderAttentionMaskDevice)
  (Unify
     (DataType DType)
     decoderRelPosEncDataType
     decoderAttentionMaskDataType)
  (BroadcastShapesF
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape))
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           (TransposeF
              ('SelectDim ('ByIndex 1))
              ('SelectDim ('ByIndex 2))
              (TransposeF
                 ('SelectDim ('ByIndex 2))
                 ('SelectDim ('ByIndex 3))
                 decoderRelPosEncShape))
           (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      decoderRelPosEncGradient
      decoderAttentionMaskGradient)
   (Unify
      (Layout LayoutType)
      decoderRelPosEncLayout
      decoderAttentionMaskLayout)
   (Unify
      (Device (DeviceType Nat))
      decoderRelPosEncDevice
      decoderAttentionMaskDevice)
   (Unify
      (DataType DType)
      decoderRelPosEncDataType
      decoderAttentionMaskDataType)
   (BroadcastShapesF
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            decoderRelPosEncShape))
      (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice2)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            decoderRelPosEncGradient
            decoderAttentionMaskGradient)
         (Unify
            (Layout LayoutType)
            decoderRelPosEncLayout
            decoderAttentionMaskLayout)
         (Unify
            (Device (DeviceType Nat))
            decoderRelPosEncDevice
            decoderAttentionMaskDevice)
         (Unify
            (DataType DType)
            decoderRelPosEncDataType
            decoderAttentionMaskDataType)
         (BroadcastShapesF
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  decoderRelPosEncShape))
            (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))))
-&gt; (Tensor
      decoderRelPosEncGradient
      decoderRelPosEncLayout
      decoderRelPosEncDevice
      decoderRelPosEncDataType
      (TransposeF
         ('SelectDim ('ByIndex 1))
         ('SelectDim ('ByIndex 2))
         (TransposeF
            ('SelectDim ('ByIndex 2))
            ('SelectDim ('ByIndex 3))
            decoderRelPosEncShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            decoderRelPosEncGradient
            decoderAttentionMaskGradient)
         (Unify
            (Layout LayoutType)
            decoderRelPosEncLayout
            decoderAttentionMaskLayout)
         (Unify
            (Device (DeviceType Nat))
            decoderRelPosEncDevice
            decoderAttentionMaskDevice)
         (Unify
            (DataType DType)
            decoderRelPosEncDataType
            decoderAttentionMaskDataType)
         (BroadcastShapesF
            (TransposeF
               ('SelectDim ('ByIndex 1))
               ('SelectDim ('ByIndex 2))
               (TransposeF
                  ('SelectDim ('ByIndex 2))
                  ('SelectDim ('ByIndex 3))
                  decoderRelPosEncShape))
            (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
-&gt; Tensor
     decoderRelPosEncGradient
     decoderRelPosEncLayout
     decoderRelPosEncDevice
     decoderRelPosEncDataType
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape))
-&gt; IxStateT
     m
     (Generator generatorDevice2)
     (Generator generatorDevice2)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           decoderRelPosEncGradient
           decoderAttentionMaskGradient)
        (Unify
           (Layout LayoutType)
           decoderRelPosEncLayout
           decoderAttentionMaskLayout)
        (Unify
           (Device (DeviceType Nat))
           decoderRelPosEncDevice
           decoderAttentionMaskDevice)
        (Unify
           (DataType DType)
           decoderRelPosEncDataType
           decoderAttentionMaskDataType)
        (BroadcastShapesF
           (TransposeF
              ('SelectDim ('ByIndex 1))
              ('SelectDim ('ByIndex 2))
              (TransposeF
                 ('SelectDim ('ByIndex 2))
                 ('SelectDim ('ByIndex 3))
                 decoderRelPosEncShape))
           (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  decoderRelPosEncGradient
  decoderRelPosEncLayout
  decoderRelPosEncDevice
  decoderRelPosEncDataType
  (TransposeF
     ('SelectDim ('ByIndex 1))
     ('SelectDim ('ByIndex 2))
     (TransposeF
        ('SelectDim ('ByIndex 2))
        ('SelectDim ('ByIndex 3))
        decoderRelPosEncShape))
-&gt; Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
-&gt; Tensor
     (decoderRelPosEncGradient &lt;|&gt; decoderAttentionMaskGradient)
     (decoderRelPosEncLayout &lt;+&gt; decoderAttentionMaskLayout)
     (decoderRelPosEncDevice &lt;+&gt; decoderAttentionMaskDevice)
     (decoderRelPosEncDataType &lt;+&gt; decoderAttentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              decoderRelPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
-&gt; Tensor
     decoderAttentionMaskGradient
     decoderAttentionMaskLayout
     decoderAttentionMaskDevice
     decoderAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
(shape' ~ UnsqueezeF selectDim shape, SingI selectDim) =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape'
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderAttentionMaskGradient
  decoderAttentionMaskLayout
  decoderAttentionMaskDevice
  decoderAttentionMaskDataType
  decoderAttentionMaskShape
</span><a href="#local-6989586621679655866"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1065"></span><span>        </span><span id="local-6989586621679655862"><span class="annot"><span class="annottext">crossAttentionBias :: Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
</span><a href="#local-6989586621679655862"><span class="hs-identifier hs-var hs-var">crossAttentionBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
-&gt; Tensor
     crossAttentionMaskGradient
     crossAttentionMaskLayout
     crossAttentionMaskDevice
     crossAttentionMaskDataType
     (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
forall (selectDim :: SelectDim (By Symbol Nat))
       (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
(shape' ~ UnsqueezeF selectDim shape, SingI selectDim) =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape'
</span><a href="Torch.GraduallyTyped.Tensor.IndexingSlicingJoining.html#unsqueeze"><span class="hs-identifier hs-var">unsqueeze</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SelectDim"><span class="hs-identifier hs-type">SelectDim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#ByIndex"><span class="hs-identifier hs-type">ByIndex</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  crossAttentionMaskShape
</span><a href="#local-6989586621679655865"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span><span>
</span><span id="line-1066"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1067"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        decoderInputGradient
        decoderInputLayout
        decoderInputDevice
        decoderInputDataType
        decoderInputShape)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  decoderInputGradient
  decoderInputLayout
  decoderInputDevice
  decoderInputDataType
  decoderInputShape
</span><a href="#local-6989586621679655869"><span class="hs-identifier hs-var">decoderInput</span></a></span><span>
</span><span id="line-1068"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     decoderInputGradient
     decoderInputLayout
     decoderInputDevice
     decoderInputDataType
     decoderInputShape)
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape
    -&gt; IxStateT
         m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (tensor0, Generator generatorDevice0))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (tensor0, Generator generatorDevice0))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; (Tensor
      decoderInputGradient
      decoderInputLayout
      decoderInputDevice
      decoderInputDataType
      decoderInputShape
    -&gt; Generator generatorDevice
    -&gt; m (tensor0, Generator generatorDevice0))
-&gt; Tensor
     decoderInputGradient
     decoderInputLayout
     decoderInputDevice
     decoderInputDataType
     decoderInputShape
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
-&gt; Tensor
     decoderInputGradient
     decoderInputLayout
     decoderInputDevice
     decoderInputDataType
     decoderInputShape
-&gt; Generator generatorDevice
-&gt; m (tensor0, Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialLayerNorm
</span><a href="#local-6989586621679655874"><span class="hs-identifier hs-var">tInitialLayerNorm</span></a></span><span>
</span><span id="line-1069"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice0) tensor0
-&gt; (tensor0
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (tensor0
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; tensor0
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">initialDropout
-&gt; tensor0
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">initialDropout
</span><a href="#local-6989586621679655873"><span class="hs-identifier hs-var">tInitialDropout</span></a></span><span>
</span><span id="line-1070"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679655861"><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679655861"><span class="hs-identifier hs-var">decoderInput'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1071"></span><span>                     </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderRelPosEncGradient
        decoderAttentionMaskGradient)
     (Unify
        (Layout LayoutType)
        decoderRelPosEncLayout
        decoderAttentionMaskLayout)
     (Unify
        (Device (DeviceType Nat))
        decoderRelPosEncDevice
        decoderAttentionMaskDevice)
     (Unify
        (DataType DType)
        decoderRelPosEncDataType
        decoderAttentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              decoderRelPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
</span><a href="#local-6989586621679655863"><span class="hs-identifier hs-var">decoderAttentionBias</span></a></span><span>
</span><span id="line-1072"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice1)
  (Generator generatorDevice2)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        decoderRelPosEncGradient
        decoderAttentionMaskGradient)
     (Unify
        (Layout LayoutType)
        decoderRelPosEncLayout
        decoderAttentionMaskLayout)
     (Unify
        (Device (DeviceType Nat))
        decoderRelPosEncDevice
        decoderAttentionMaskDevice)
     (Unify
        (DataType DType)
        decoderRelPosEncDataType
        decoderAttentionMaskDataType)
     (BroadcastShapesF
        (TransposeF
           ('SelectDim ('ByIndex 1))
           ('SelectDim ('ByIndex 2))
           (TransposeF
              ('SelectDim ('ByIndex 2))
              ('SelectDim ('ByIndex 3))
              decoderRelPosEncShape))
        (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         decoderRelPosEncGradient
         decoderAttentionMaskGradient)
      (Unify
         (Layout LayoutType)
         decoderRelPosEncLayout
         decoderAttentionMaskLayout)
      (Unify
         (Device (DeviceType Nat))
         decoderRelPosEncDevice
         decoderAttentionMaskDevice)
      (Unify
         (DataType DType)
         decoderRelPosEncDataType
         decoderAttentionMaskDataType)
      (BroadcastShapesF
         (TransposeF
            ('SelectDim ('ByIndex 1))
            ('SelectDim ('ByIndex 2))
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               decoderRelPosEncShape))
         (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice3) tensor3
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679655860"><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     decoderRelPosEncGradient
     decoderAttentionMaskGradient)
  (Unify
     (Layout LayoutType)
     decoderRelPosEncLayout
     decoderAttentionMaskLayout)
  (Unify
     (Device (DeviceType Nat))
     decoderRelPosEncDevice
     decoderAttentionMaskDevice)
  (Unify
     (DataType DType)
     decoderRelPosEncDataType
     decoderAttentionMaskDataType)
  (BroadcastShapesF
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape))
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
</span><a href="#local-6989586621679655860"><span class="hs-identifier hs-var">decoderAttentionBias'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-1073"></span><span>                                </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-1074"></span><span>                                  </span><span class="annot"><span class="annottext">stack
-&gt; (tensor1,
    Tensor
      encoderOutputGradient
      encoderOutputLayout
      encoderOutputDevice
      encoderOutputDataType
      encoderOutputShape,
    Tensor
      (Or
         (Gradient RequiresGradient)
         decoderRelPosEncGradient
         decoderAttentionMaskGradient)
      (Unify
         (Layout LayoutType)
         decoderRelPosEncLayout
         decoderAttentionMaskLayout)
      (Unify
         (Device (DeviceType Nat))
         decoderRelPosEncDevice
         decoderAttentionMaskDevice)
      (Unify
         (DataType DType)
         decoderRelPosEncDataType
         decoderAttentionMaskDataType)
      (BroadcastShapesF
         (TransposeF
            ('SelectDim ('ByIndex 1))
            ('SelectDim ('ByIndex 2))
            (TransposeF
               ('SelectDim ('ByIndex 2))
               ('SelectDim ('ByIndex 3))
               decoderRelPosEncShape))
         (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape)),
    Tensor
      crossAttentionMaskGradient
      crossAttentionMaskLayout
      crossAttentionMaskDevice
      crossAttentionMaskDataType
      (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape))
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span>
</span><span id="line-1075"></span><span>                                    </span><span class="annot"><span class="annottext">stack
</span><a href="#local-6989586621679655872"><span class="hs-identifier hs-var">tStack</span></a></span><span>
</span><span id="line-1076"></span><span>                                    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">tensor1
</span><a href="#local-6989586621679655861"><span class="hs-identifier hs-var">decoderInput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1077"></span><span>                                      </span><span class="annot"><span class="annottext">Tensor
  encoderOutputGradient
  encoderOutputLayout
  encoderOutputDevice
  encoderOutputDataType
  encoderOutputShape
</span><a href="#local-6989586621679655868"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1078"></span><span>                                      </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     decoderRelPosEncGradient
     decoderAttentionMaskGradient)
  (Unify
     (Layout LayoutType)
     decoderRelPosEncLayout
     decoderAttentionMaskLayout)
  (Unify
     (Device (DeviceType Nat))
     decoderRelPosEncDevice
     decoderAttentionMaskDevice)
  (Unify
     (DataType DType)
     decoderRelPosEncDataType
     decoderAttentionMaskDataType)
  (BroadcastShapesF
     (TransposeF
        ('SelectDim ('ByIndex 1))
        ('SelectDim ('ByIndex 2))
        (TransposeF
           ('SelectDim ('ByIndex 2))
           ('SelectDim ('ByIndex 3))
           decoderRelPosEncShape))
     (UnsqueezeF ('SelectDim ('ByIndex 1)) decoderAttentionMaskShape))
</span><a href="#local-6989586621679655860"><span class="hs-identifier hs-var">decoderAttentionBias'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-1079"></span><span>                                      </span><span class="annot"><span class="annottext">Tensor
  crossAttentionMaskGradient
  crossAttentionMaskLayout
  crossAttentionMaskDevice
  crossAttentionMaskDataType
  (UnsqueezeF ('SelectDim ('ByIndex 1)) crossAttentionMaskShape)
</span><a href="#local-6989586621679655862"><span class="hs-identifier hs-var">crossAttentionBias</span></a></span><span>
</span><span id="line-1080"></span><span>                                    </span><span class="hs-special">)</span><span>
</span><span id="line-1081"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-1082"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-1083"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalLayerNorm
</span><a href="#local-6989586621679655871"><span class="hs-identifier hs-var">tFinalLayerNorm</span></a></span><span>
</span><span id="line-1084"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorOutputDevice)
      output)
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">finalDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">finalDropout
</span><a href="#local-6989586621679655870"><span class="hs-identifier hs-var">tFinalDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-1085"></span></pre></body></html>