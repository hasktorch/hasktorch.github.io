<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE NoStarIsType #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# OPTIONS_GHC -v2 #-}</span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-23"></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">evalStateT</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier">SDType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDeviceType"><span class="hs-identifier">SDeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Activation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier">Gelu</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier">GeluNew</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier">Relu</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier">Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Linear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier">GLinear</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier">LinearBiasF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier">LinearWeightF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#linearSpec"><span class="hs-identifier">linearSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Normalization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier">LayerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier">LayerNormSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasBias"><span class="hs-identifier">HasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasBias"><span class="hs-identifier">SHasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html"><span class="hs-identifier">Torch.GraduallyTyped.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier">sMkGenerator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SRequiresGradient"><span class="hs-identifier">SRequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier">BroadcastShapesF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier">SName</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier">SSize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator">(:&amp;:)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Creation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Creation.html#sOnes"><span class="hs-identifier">sOnes</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier">TensorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Generic two-layer gate with activation function.</span><span>
</span><span id="line-52"></span><span class="hs-comment">--</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- - @layer0@ is the first layer.</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- - @activation@ is the activation function.</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- - @layer1@ is the second layer.</span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span>
</span><span id="line-57"></span><span>  </span><span id="GGate"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-var">GGate</span></a></span></span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577545"><span class="annot"><a href="#local-6989586621679577545"><span class="hs-identifier hs-type">layer0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577544"><span class="annot"><a href="#local-6989586621679577544"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577543"><span class="annot"><a href="#local-6989586621679577543"><span class="hs-identifier hs-type">layer1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-62"></span><span>  </span><span id="GGate"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-var">GGate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679577890"><span class="annot"><a href="#local-6989586621679577890"><span class="hs-identifier hs-type">layer0</span></a></span></span><span> </span><span id="local-6989586621679577889"><span class="annot"><a href="#local-6989586621679577889"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span id="local-6989586621679577888"><span class="annot"><a href="#local-6989586621679577888"><span class="hs-identifier hs-type">layer1</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-64"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | first gate layer</span><span>
</span><span id="line-65"></span><span>      </span><span id="gateLayer0"><span class="annot"><span class="annottext">GGate layer0 activation layer1 -&gt; layer0
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#gateLayer0"><span class="hs-identifier hs-var hs-var">gateLayer0</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577890"><span class="hs-identifier hs-type">layer0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-66"></span><span>      </span><span class="hs-comment">-- | gate activation</span><span>
</span><span id="line-67"></span><span>      </span><span id="gateActivation"><span class="annot"><span class="annottext">GGate layer0 activation layer1 -&gt; activation
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#gateActivation"><span class="hs-identifier hs-var hs-var">gateActivation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577889"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>      </span><span class="hs-comment">-- | second gate layer</span><span>
</span><span id="line-69"></span><span>      </span><span id="gateLayer1"><span class="annot"><span class="annottext">GGate layer0 activation layer1 -&gt; layer1
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#gateLayer1"><span class="hs-identifier hs-var hs-var">gateLayer1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577888"><span class="hs-identifier hs-type">layer1</span></a></span><span>
</span><span id="line-70"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577890"><span class="hs-identifier hs-type">layer0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577889"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577888"><span class="hs-identifier hs-type">layer1</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-74"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span id="local-6989586621679577538"><span class="annot"><a href="#local-6989586621679577538"><span class="hs-identifier hs-type hs-type">layer0</span></a></span></span><span> </span><span id="local-6989586621679577537"><span class="annot"><a href="#local-6989586621679577537"><span class="hs-identifier hs-type hs-type">activation</span></a></span></span><span> </span><span id="local-6989586621679577536"><span class="annot"><a href="#local-6989586621679577536"><span class="hs-identifier hs-type hs-type">layer1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-75"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577538"><span class="hs-identifier hs-type">layer0</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577537"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577536"><span class="hs-identifier hs-type">layer1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span id="local-6989586621679577532"><span id="local-6989586621679577533"><span id="local-6989586621679577534"><span id="local-6989586621679577535"><span class="hs-keyword">instance</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577535"><span class="hs-identifier hs-type">layer0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577535"><span class="hs-identifier hs-type">layer0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577533"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577533"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577532"><span class="hs-identifier hs-type">layer1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577532"><span class="hs-identifier hs-type">layer1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577535"><span class="hs-identifier hs-type">layer0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577533"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577532"><span class="hs-identifier hs-type">layer1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577535"><span class="hs-identifier hs-type">layer0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577533"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577532"><span class="hs-identifier hs-type">layer1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><a href="#local-6989586621679577534"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679577529"><span class="annot"><span class="annottext">initialize :: ModelSpec (GGate layer0 activation layer1)
-&gt; Generator generatorDevice
-&gt; m (GGate layer0 activation layer1, Generator generatorDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span id="local-6989586621679577527"><span class="annot"><a href="#local-6989586621679577527"><span class="hs-identifier hs-var">layer0Spec</span></a></span></span><span> </span><span id="local-6989586621679577526"><span class="annot"><a href="#local-6989586621679577526"><span class="hs-identifier hs-var">activationSpec</span></a></span></span><span> </span><span id="local-6989586621679577525"><span class="annot"><a href="#local-6989586621679577525"><span class="hs-identifier hs-var">layer1Spec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679577524"><span class="annot"><span class="annottext">layer0 :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) layer0
</span><a href="#local-6989586621679577524"><span class="hs-identifier hs-var hs-var">layer0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (layer0, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer0
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (layer0, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) layer0)
-&gt; (ModelSpec layer0
    -&gt; Generator generatorDevice
    -&gt; m (layer0, Generator generatorDevice))
-&gt; ModelSpec layer0
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer0
-&gt; Generator generatorDevice
-&gt; m (layer0, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec layer0
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) layer0)
-&gt; ModelSpec layer0
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer0
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer0
</span><a href="#local-6989586621679577527"><span class="hs-identifier hs-var">layer0Spec</span></a></span><span>
</span><span id="line-90"></span><span>        </span><span id="local-6989586621679577521"><span class="annot"><span class="annottext">activation :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  activation
</span><a href="#local-6989586621679577521"><span class="hs-identifier hs-var hs-var">activation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (activation, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (activation, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      activation)
-&gt; (ModelSpec activation
    -&gt; Generator generatorDevice
    -&gt; m (activation, Generator generatorDevice))
-&gt; ModelSpec activation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
-&gt; Generator generatorDevice
-&gt; m (activation, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec activation
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      activation)
-&gt; ModelSpec activation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
</span><a href="#local-6989586621679577526"><span class="hs-identifier hs-var">activationSpec</span></a></span><span>
</span><span id="line-91"></span><span>        </span><span id="local-6989586621679577520"><span class="annot"><span class="annottext">layer1 :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) layer1
</span><a href="#local-6989586621679577520"><span class="hs-identifier hs-var hs-var">layer1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (layer1, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer1
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (layer1, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) layer1)
-&gt; (ModelSpec layer1
    -&gt; Generator generatorDevice
    -&gt; m (layer1, Generator generatorDevice))
-&gt; ModelSpec layer1
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer1
-&gt; Generator generatorDevice
-&gt; m (layer1, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec layer1
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) layer1)
-&gt; ModelSpec layer1
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer1
</span><a href="#local-6989586621679577525"><span class="hs-identifier hs-var">layer1Spec</span></a></span><span>
</span><span id="line-92"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (GGate layer0 activation layer1)
-&gt; Generator generatorDevice
-&gt; m (GGate layer0 activation layer1, Generator generatorDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorDevice)
   (GGate layer0 activation layer1)
 -&gt; Generator generatorDevice
 -&gt; m (GGate layer0 activation layer1, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GGate layer0 activation layer1)
-&gt; Generator generatorDevice
-&gt; m (GGate layer0 activation layer1, Generator generatorDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">layer0 -&gt; activation -&gt; layer1 -&gt; GGate layer0 activation layer1
forall layer0 activation layer1.
layer0 -&gt; activation -&gt; layer1 -&gt; GGate layer0 activation layer1
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-var">GGate</span></a></span><span> </span><span class="annot"><span class="annottext">(layer0 -&gt; activation -&gt; layer1 -&gt; GGate layer0 activation layer1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer0
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (activation -&gt; layer1 -&gt; GGate layer0 activation layer1)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; Type -&gt; Type) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) layer0
</span><a href="#local-6989586621679577524"><span class="hs-identifier hs-var">layer0</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (activation -&gt; layer1 -&gt; GGate layer0 activation layer1)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (layer1 -&gt; GGate layer0 activation layer1)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  activation
</span><a href="#local-6989586621679577521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (layer1 -&gt; GGate layer0 activation layer1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) layer1
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GGate layer0 activation layer1)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) layer1
</span><a href="#local-6989586621679577520"><span class="hs-identifier hs-var">layer1</span></a></span></span></span></span></span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span id="local-6989586621679577516"><span id="local-6989586621679577517"><span id="local-6989586621679577518"><span class="hs-keyword">instance</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577518"><span class="hs-identifier hs-type">layer0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577517"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577516"><span class="hs-identifier hs-type">layer1</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577518"><span class="hs-identifier hs-type">layer0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577517"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577516"><span class="hs-identifier hs-type">layer1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>  </span><span id="local-6989586621679577512"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec (GGate layer0 activation layer1)
-&gt; StateDictKey -&gt; m (GGate layer0 activation layer1)
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span id="local-6989586621679577510"><span class="annot"><a href="#local-6989586621679577510"><span class="hs-identifier hs-var">layer0Spec</span></a></span></span><span> </span><span id="local-6989586621679577509"><span class="annot"><a href="#local-6989586621679577509"><span class="hs-identifier hs-var">activationSpec</span></a></span></span><span> </span><span id="local-6989586621679577508"><span class="annot"><a href="#local-6989586621679577508"><span class="hs-identifier hs-var">layer1Spec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679577507"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577507"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><span class="annottext">layer0 -&gt; activation -&gt; layer1 -&gt; GGate layer0 activation layer1
forall layer0 activation layer1.
layer0 -&gt; activation -&gt; layer1 -&gt; GGate layer0 activation layer1
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-var">GGate</span></a></span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">(layer0 -&gt; activation -&gt; layer1 -&gt; GGate layer0 activation layer1)
-&gt; m layer0
-&gt; m (activation -&gt; layer1 -&gt; GGate layer0 activation layer1)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer0 -&gt; StateDictKey -&gt; m layer0
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer0
</span><a href="#local-6989586621679577510"><span class="hs-identifier hs-var">layer0Spec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577507"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-104"></span><span>      </span><span class="annot"><span class="annottext">m (activation -&gt; layer1 -&gt; GGate layer0 activation layer1)
-&gt; m activation -&gt; m (layer1 -&gt; GGate layer0 activation layer1)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation -&gt; StateDictKey -&gt; m activation
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
</span><a href="#local-6989586621679577509"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577507"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">m (layer1 -&gt; GGate layer0 activation layer1)
-&gt; m layer1 -&gt; m (GGate layer0 activation layer1)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer1 -&gt; StateDictKey -&gt; m layer1
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec layer1
</span><a href="#local-6989586621679577508"><span class="hs-identifier hs-var">layer1Spec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577507"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679577505"><span class="annot"><span class="annottext">toStateDict :: StateDictKey -&gt; GGate layer0 activation layer1 -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679577503"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577503"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679577500"><span id="local-6989586621679577501"><span id="local-6989586621679577502"><span class="annot"><span class="annottext">layer0
activation
layer1
gateLayer1 :: layer1
gateActivation :: activation
gateLayer0 :: layer0
gateLayer1 :: forall layer0 activation layer1.
GGate layer0 activation layer1 -&gt; layer1
gateActivation :: forall layer0 activation layer1.
GGate layer0 activation layer1 -&gt; activation
gateLayer0 :: forall layer0 activation layer1.
GGate layer0 activation layer1 -&gt; layer0
</span><a href="#local-6989586621679577500"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; layer0 -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577503"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">layer0
</span><a href="#local-6989586621679577502"><span class="hs-identifier hs-var">gateLayer0</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; activation -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577503"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">activation
</span><a href="#local-6989586621679577501"><span class="hs-identifier hs-var">gateActivation</span></a></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; layer1 -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577503"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">layer1
</span><a href="#local-6989586621679577500"><span class="hs-identifier hs-var">gateLayer1</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span id="local-6989586621679577482"><span id="local-6989586621679577483"><span id="local-6989586621679577484"><span id="local-6989586621679577485"><span id="local-6989586621679577486"><span id="local-6989586621679577487"><span id="local-6989586621679577488"><span id="local-6989586621679577489"><span id="local-6989586621679577490"><span id="local-6989586621679577491"><span id="local-6989586621679577492"><span id="local-6989586621679577493"><span id="local-6989586621679577494"><span id="local-6989586621679577495"><span id="local-6989586621679577496"><span id="local-6989586621679577497"><span id="local-6989586621679577498"><span id="local-6989586621679577499"><span class="hs-keyword">instance</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><a href="#local-6989586621679577499"><span class="hs-identifier hs-type">layer0</span></a></span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577498"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577497"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577496"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577495"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577494"><span class="hs-identifier hs-type">shape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>      </span><span class="annot"><a href="#local-6989586621679577493"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-117"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577492"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577491"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577490"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577489"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577488"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>      </span><span class="annot"><a href="#local-6989586621679577487"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-120"></span><span>      </span><span class="annot"><a href="#local-6989586621679577486"><span class="hs-identifier hs-type">activation</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577492"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577491"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577490"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577489"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577488"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span class="annot"><a href="#local-6989586621679577487"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577492"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577491"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577490"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577489"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577488"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><a href="#local-6989586621679577487"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span class="annot"><a href="#local-6989586621679577485"><span class="hs-identifier hs-type">layer1</span></a></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577498"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577497"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577496"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577495"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577494"><span class="hs-identifier hs-type">shape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="annot"><a href="#local-6989586621679577487"><span class="hs-identifier hs-type">generatorDevice'</span></a></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577492"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577491"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577490"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577489"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577488"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><a href="#local-6989586621679577484"><span class="hs-identifier hs-type">generatorDevice''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-131"></span><span>    </span><span class="annot"><a href="#local-6989586621679577483"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577492"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577491"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577490"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577489"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577488"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621679577482"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="#local-6989586621679577484"><span class="hs-identifier hs-type">generatorDevice''</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577499"><span class="hs-identifier hs-type">layer0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577486"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577485"><span class="hs-identifier hs-type">layer1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577498"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577497"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577496"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577495"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577494"><span class="hs-identifier hs-type">shape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="#local-6989586621679577493"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="#local-6989586621679577483"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="#local-6989586621679577482"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span id="local-6989586621679577479"><span class="annot"><span class="annottext">forward :: GGate layer0 activation layer1
-&gt; Tensor gradient layout device dataType shape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679577475"><span id="local-6989586621679577476"><span id="local-6989586621679577477"><span class="annot"><span class="annottext">layer0
activation
layer1
gateLayer1 :: layer1
gateActivation :: activation
gateLayer0 :: layer0
gateLayer1 :: forall layer0 activation layer1.
GGate layer0 activation layer1 -&gt; layer1
gateActivation :: forall layer0 activation layer1.
GGate layer0 activation layer1 -&gt; activation
gateLayer0 :: forall layer0 activation layer1.
GGate layer0 activation layer1 -&gt; layer0
</span><a href="#local-6989586621679577475"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679577474"><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679577474"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679577473"><span class="annot"><span class="annottext">activate :: Tensor gradient layout device dataType shape
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice') output
</span><a href="#local-6989586621679577473"><span class="hs-identifier hs-var hs-var">activate</span></a></span></span><span> </span><span id="local-6989586621679577472"><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679577472"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-143"></span><span>          </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor gradient layout device dataType shape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679577472"><span class="hs-identifier hs-var">input'</span></a></span><span>
</span><span id="line-144"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor gradient layout device dataType shape)
-&gt; (Tensor gradient layout device dataType shape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice')
         (Tensor gradient' layout' device' dataType' shape'))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice')
     (Tensor gradient' layout' device' dataType' shape')
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor gradient' layout' device' dataType' shape',
       Generator generatorDevice'))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice')
     (Tensor gradient' layout' device' dataType' shape')
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor gradient' layout' device' dataType' shape',
        Generator generatorDevice'))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice')
      (Tensor gradient' layout' device' dataType' shape'))
-&gt; (Tensor gradient layout device dataType shape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor gradient' layout' device' dataType' shape',
          Generator generatorDevice'))
-&gt; Tensor gradient layout device dataType shape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice')
     (Tensor gradient' layout' device' dataType' shape')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">layer0
-&gt; Tensor gradient layout device dataType shape
-&gt; Generator generatorDevice
-&gt; m (Tensor gradient' layout' device' dataType' shape',
      Generator generatorDevice')
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">layer0
</span><a href="#local-6989586621679577477"><span class="hs-identifier hs-var">gateLayer0</span></a></span><span>
</span><span id="line-145"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice')
  (Tensor gradient' layout' device' dataType' shape')
-&gt; (Tensor gradient' layout' device' dataType' shape'
    -&gt; IxStateT
         m (Generator generatorDevice') (Generator generatorDevice') output)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice') output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice'
 -&gt; m (output, Generator generatorDevice'))
-&gt; IxStateT
     m (Generator generatorDevice') (Generator generatorDevice') output
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice'
  -&gt; m (output, Generator generatorDevice'))
 -&gt; IxStateT
      m (Generator generatorDevice') (Generator generatorDevice') output)
-&gt; (Tensor gradient' layout' device' dataType' shape'
    -&gt; Generator generatorDevice'
    -&gt; m (output, Generator generatorDevice'))
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; IxStateT
     m (Generator generatorDevice') (Generator generatorDevice') output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">activation
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Generator generatorDevice'
-&gt; m (output, Generator generatorDevice')
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">activation
</span><a href="#local-6989586621679577476"><span class="hs-identifier hs-var">gateActivation</span></a></span><span>
</span><span id="line-146"></span><span>        </span><span id="local-6989586621679577471"><span class="annot"><span class="annottext">gate :: Tensor gradient layout device dataType shape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
</span><a href="#local-6989586621679577471"><span class="hs-identifier hs-var hs-var">gate</span></a></span></span><span> </span><span id="local-6989586621679577470"><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679577470"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">output -&gt; output -&gt; output
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">(output -&gt; output -&gt; output)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice') output
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice')
     (output -&gt; output)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; Type -&gt; Type) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice') output
</span><a href="#local-6989586621679577473"><span class="hs-identifier hs-var">activate</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679577470"><span class="hs-identifier hs-var">input'</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice')
  (output -&gt; output)
-&gt; IxStateT
     m
     (Generator generatorDevice')
     (Generator generatorOutputDevice)
     output
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice'
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice')
     (Generator generatorOutputDevice)
     output
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice'
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice')
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor gradient layout device dataType shape
    -&gt; Generator generatorDevice'
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; Tensor gradient layout device dataType shape
-&gt; IxStateT
     m
     (Generator generatorDevice')
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">layer1
-&gt; Tensor gradient layout device dataType shape
-&gt; Generator generatorDevice'
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">layer1
</span><a href="#local-6989586621679577475"><span class="hs-identifier hs-var">gateLayer1</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor gradient layout device dataType shape
 -&gt; IxStateT
      m
      (Generator generatorDevice')
      (Generator generatorOutputDevice)
      output)
-&gt; Tensor gradient layout device dataType shape
-&gt; IxStateT
     m
     (Generator generatorDevice')
     (Generator generatorOutputDevice)
     output
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679577470"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor gradient layout device dataType shape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
</span><a href="#local-6989586621679577474"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor gradient layout device dataType shape)
-&gt; (Tensor gradient layout device dataType shape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor gradient layout device dataType shape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
</span><a href="#local-6989586621679577471"><span class="hs-identifier hs-var">gate</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Generic transformer feed-forward network.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- - @inputLayerNorm@ is the layer normalization for the input.</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- - @inputTransformation@ is the input transformation.</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- - @activation@ is the activation function.</span><span>
</span><span id="line-154"></span><span class="hs-comment">-- - @activationDropout@ is the activation dropout layer.</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- - @outputProjection@ is the output projection.</span><span>
</span><span id="line-156"></span><span class="hs-comment">-- - @outputDropout@ is the dropout layer for the output.</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- - @outputLayerNorm@ is the layer normalization for the output.</span><span>
</span><span id="line-158"></span><span class="hs-keyword">data</span><span>
</span><span id="line-159"></span><span>  </span><span id="GTransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span></span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577468"><span class="annot"><a href="#local-6989586621679577468"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577467"><span class="annot"><a href="#local-6989586621679577467"><span class="hs-identifier hs-type">inputTransformation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577466"><span class="annot"><a href="#local-6989586621679577466"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577465"><span class="annot"><a href="#local-6989586621679577465"><span class="hs-identifier hs-type">activationDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577464"><span class="annot"><a href="#local-6989586621679577464"><span class="hs-identifier hs-type">outputProjection</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577463"><span class="annot"><a href="#local-6989586621679577463"><span class="hs-identifier hs-type">outputDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577462"><span class="annot"><a href="#local-6989586621679577462"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="GTransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679577711"><span class="annot"><a href="#local-6989586621679577711"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679577710"><span class="annot"><a href="#local-6989586621679577710"><span class="hs-identifier hs-type">inputTransformation</span></a></span></span><span> </span><span id="local-6989586621679577709"><span class="annot"><a href="#local-6989586621679577709"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span id="local-6989586621679577708"><span class="annot"><a href="#local-6989586621679577708"><span class="hs-identifier hs-type">activationDropout</span></a></span></span><span> </span><span id="local-6989586621679577707"><span class="annot"><a href="#local-6989586621679577707"><span class="hs-identifier hs-type">outputProjection</span></a></span></span><span> </span><span id="local-6989586621679577706"><span class="annot"><a href="#local-6989586621679577706"><span class="hs-identifier hs-type">outputDropout</span></a></span></span><span> </span><span id="local-6989586621679577705"><span class="annot"><a href="#local-6989586621679577705"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | input layer norm</span><span>
</span><span id="line-171"></span><span>      </span><span id="ffnInputLayerNorm"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; inputLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#ffnInputLayerNorm"><span class="hs-identifier hs-var hs-var">ffnInputLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577711"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-comment">-- | input transformation</span><span>
</span><span id="line-173"></span><span>      </span><span id="ffnInputTransformation"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; inputTransformation
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#ffnInputTransformation"><span class="hs-identifier hs-var hs-var">ffnInputTransformation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577710"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>      </span><span class="hs-comment">-- | activation</span><span>
</span><span id="line-175"></span><span>      </span><span id="ffnActivation"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; activation
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#ffnActivation"><span class="hs-identifier hs-var hs-var">ffnActivation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577709"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>      </span><span class="hs-comment">-- | activation dropout</span><span>
</span><span id="line-177"></span><span>      </span><span id="ffnActivationDropout"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; activationDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#ffnActivationDropout"><span class="hs-identifier hs-var hs-var">ffnActivationDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577708"><span class="hs-identifier hs-type">activationDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-178"></span><span>      </span><span class="hs-comment">-- | output projection</span><span>
</span><span id="line-179"></span><span>      </span><span id="ffnOutputProjection"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputProjection
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#ffnOutputProjection"><span class="hs-identifier hs-var hs-var">ffnOutputProjection</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577707"><span class="hs-identifier hs-type">outputProjection</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>      </span><span class="hs-comment">-- | output dropout</span><span>
</span><span id="line-181"></span><span>      </span><span id="ffnOutputDropout"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#ffnOutputDropout"><span class="hs-identifier hs-var hs-var">ffnOutputDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577706"><span class="hs-identifier hs-type">outputDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-182"></span><span>      </span><span class="hs-comment">-- | output layer norm</span><span>
</span><span id="line-183"></span><span>      </span><span id="ffnOutputLayerNorm"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#ffnOutputLayerNorm"><span class="hs-identifier hs-var hs-var">ffnOutputLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679577705"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577711"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577710"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577709"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577708"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577707"><span class="hs-identifier hs-type">outputProjection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577706"><span class="hs-identifier hs-type">outputDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577705"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-188"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span id="local-6989586621679577453"><span class="annot"><a href="#local-6989586621679577453"><span class="hs-identifier hs-type hs-type">inputLayerNorm</span></a></span></span><span> </span><span id="local-6989586621679577452"><span class="annot"><a href="#local-6989586621679577452"><span class="hs-identifier hs-type hs-type">inputTransformation</span></a></span></span><span> </span><span id="local-6989586621679577451"><span class="annot"><a href="#local-6989586621679577451"><span class="hs-identifier hs-type hs-type">activation</span></a></span></span><span> </span><span id="local-6989586621679577450"><span class="annot"><a href="#local-6989586621679577450"><span class="hs-identifier hs-type hs-type">activationDropout</span></a></span></span><span> </span><span id="local-6989586621679577449"><span class="annot"><a href="#local-6989586621679577449"><span class="hs-identifier hs-type hs-type">outputProjection</span></a></span></span><span> </span><span id="local-6989586621679577448"><span class="annot"><a href="#local-6989586621679577448"><span class="hs-identifier hs-type hs-type">outputDropout</span></a></span></span><span> </span><span id="local-6989586621679577447"><span class="annot"><a href="#local-6989586621679577447"><span class="hs-identifier hs-type hs-type">outputLayerNorm</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577453"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577452"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577451"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577450"><span class="hs-identifier hs-type">activationDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577449"><span class="hs-identifier hs-type">outputProjection</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577448"><span class="hs-identifier hs-type">outputDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577447"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Specifies the layer normalization for the input.</span><span>
</span><span id="line-192"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-193"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577446"><span class="annot"><a href="#local-6989586621679577446"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577445"><span class="annot"><a href="#local-6989586621679577445"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577444"><span class="annot"><a href="#local-6989586621679577444"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577443"><span class="annot"><a href="#local-6989586621679577443"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577442"><span class="annot"><a href="#local-6989586621679577442"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-199"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679577440"><span class="annot"><a href="#local-6989586621679577440"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577439"><span class="annot"><a href="#local-6989586621679577439"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577438"><span class="annot"><a href="#local-6989586621679577438"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577437"><span class="annot"><a href="#local-6989586621679577437"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577440"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577439"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577438"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679577437"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-203"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679577436"><span class="annot"><a href="#local-6989586621679577436"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577435"><span class="annot"><a href="#local-6989586621679577435"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577434"><span class="annot"><a href="#local-6989586621679577434"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577433"><span class="annot"><a href="#local-6989586621679577433"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-type">FFNInputLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577436"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577435"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577434"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577433"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679577430"><span class="annot"><a href="#local-6989586621679577430"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577429"><span class="annot"><a href="#local-6989586621679577429"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577428"><span class="annot"><a href="#local-6989586621679577428"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577427"><span class="annot"><a href="#local-6989586621679577427"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-208"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-type">FFNInputLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577430"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577429"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577428"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577427"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679577425"><span class="annot"><a href="#local-6989586621679577425"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577424"><span class="annot"><a href="#local-6989586621679577424"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577423"><span class="annot"><a href="#local-6989586621679577423"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577422"><span class="annot"><a href="#local-6989586621679577422"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-210"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577425"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577424"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577423"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679577422"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>  </span><span id="FFNInputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-var">FFNInputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679577419"><span class="annot"><a href="#local-6989586621679577419"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577418"><span class="annot"><a href="#local-6989586621679577418"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577417"><span class="annot"><a href="#local-6989586621679577417"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577416"><span class="annot"><a href="#local-6989586621679577416"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-214"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-type">FFNInputLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577419"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577418"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577417"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577416"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-comment">-- | Specifies the first input projection.</span><span>
</span><span id="line-217"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-218"></span><span>  </span><span id="FFNInputTransformationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier hs-var">FFNInputTransformationF</span></a></span></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577415"><span class="annot"><a href="#local-6989586621679577415"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577414"><span class="annot"><a href="#local-6989586621679577414"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577413"><span class="annot"><a href="#local-6989586621679577413"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577412"><span class="annot"><a href="#local-6989586621679577412"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577411"><span class="annot"><a href="#local-6989586621679577411"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577410"><span class="annot"><a href="#local-6989586621679577410"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>  </span><span id="FFNInputTransformationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier hs-var">FFNInputTransformationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679577409"><span class="annot"><a href="#local-6989586621679577409"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577408"><span class="annot"><a href="#local-6989586621679577408"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577407"><span class="annot"><a href="#local-6989586621679577407"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577406"><span class="annot"><a href="#local-6989586621679577406"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577405"><span class="annot"><a href="#local-6989586621679577405"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-230"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier hs-type">LinearWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577409"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577408"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577407"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577406"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577405"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier hs-type">LinearBiasF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577409"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577408"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577407"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577405"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>  </span><span id="FFNInputTransformationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier hs-var">FFNInputTransformationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679577404"><span class="annot"><a href="#local-6989586621679577404"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577403"><span class="annot"><a href="#local-6989586621679577403"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577402"><span class="annot"><a href="#local-6989586621679577402"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577401"><span class="annot"><a href="#local-6989586621679577401"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577400"><span class="annot"><a href="#local-6989586621679577400"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-type">GGate</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-237"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier hs-type">LinearWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577404"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577403"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577402"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577401"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577400"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-238"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier hs-type">LinearBiasF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577404"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577403"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577402"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577400"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-type">GeluNew</span></a></span><span>
</span><span id="line-242"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-243"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-244"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier hs-type">LinearWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577404"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577403"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577402"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577401"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577400"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier hs-type">LinearBiasF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577404"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577403"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577402"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577400"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>  </span><span id="FFNInputTransformationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier hs-var">FFNInputTransformationF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679577399"><span class="annot"><a href="#local-6989586621679577399"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577398"><span class="annot"><a href="#local-6989586621679577398"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577397"><span class="annot"><a href="#local-6989586621679577397"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577396"><span class="annot"><a href="#local-6989586621679577396"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577395"><span class="annot"><a href="#local-6989586621679577395"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-251"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier hs-type">LinearWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577399"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577398"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577397"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577396"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577395"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier hs-type">LinearBiasF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577399"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577398"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577397"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577395"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | Specifies the activation.</span><span>
</span><span id="line-256"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-257"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577394"><span class="annot"><a href="#local-6989586621679577394"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-type">Relu</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-type">GeluNew</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-type">Relu</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-267"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-268"></span><span>
</span><span id="line-269"></span><span class="hs-comment">-- | Specifies the activation dropout.</span><span>
</span><span id="line-270"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-271"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577393"><span class="annot"><a href="#local-6989586621679577393"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-275"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span>
</span><span id="line-279"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Specifies the output projection.</span><span>
</span><span id="line-284"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-285"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577392"><span class="annot"><a href="#local-6989586621679577392"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577391"><span class="annot"><a href="#local-6989586621679577391"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577390"><span class="annot"><a href="#local-6989586621679577390"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577389"><span class="annot"><a href="#local-6989586621679577389"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577388"><span class="annot"><a href="#local-6989586621679577388"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577387"><span class="annot"><a href="#local-6989586621679577387"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-294"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679577386"><span class="annot"><a href="#local-6989586621679577386"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577385"><span class="annot"><a href="#local-6989586621679577385"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577384"><span class="annot"><a href="#local-6989586621679577384"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577383"><span class="annot"><a href="#local-6989586621679577383"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577382"><span class="annot"><a href="#local-6989586621679577382"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-296"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-297"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier hs-type">LinearWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577386"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577385"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577384"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577382"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577383"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier hs-type">LinearBiasF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577386"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577385"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577384"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577383"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-300"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679577381"><span class="annot"><a href="#local-6989586621679577381"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577380"><span class="annot"><a href="#local-6989586621679577380"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577379"><span class="annot"><a href="#local-6989586621679577379"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577378"><span class="annot"><a href="#local-6989586621679577378"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577377"><span class="annot"><a href="#local-6989586621679577377"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-301"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-type">FFNOutputProjectionF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577381"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577380"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577379"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577378"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577377"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-302"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679577376"><span class="annot"><a href="#local-6989586621679577376"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577375"><span class="annot"><a href="#local-6989586621679577375"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577374"><span class="annot"><a href="#local-6989586621679577374"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577373"><span class="annot"><a href="#local-6989586621679577373"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577372"><span class="annot"><a href="#local-6989586621679577372"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-305"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier hs-type">LinearWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577376"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577375"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577374"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577372"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577373"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-306"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier hs-type">LinearBiasF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577376"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577375"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577374"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577373"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679577371"><span class="annot"><a href="#local-6989586621679577371"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577370"><span class="annot"><a href="#local-6989586621679577370"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577369"><span class="annot"><a href="#local-6989586621679577369"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577368"><span class="annot"><a href="#local-6989586621679577368"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577367"><span class="annot"><a href="#local-6989586621679577367"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-309"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-type">FFNOutputProjectionF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577371"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577370"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577369"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577368"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577367"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-310"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679577366"><span class="annot"><a href="#local-6989586621679577366"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577365"><span class="annot"><a href="#local-6989586621679577365"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577364"><span class="annot"><a href="#local-6989586621679577364"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577363"><span class="annot"><a href="#local-6989586621679577363"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577362"><span class="annot"><a href="#local-6989586621679577362"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-type">FFNOutputProjectionF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577366"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577365"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577364"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577363"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577362"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span id="local-6989586621679577361"><span class="annot"><a href="#local-6989586621679577361"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577360"><span class="annot"><a href="#local-6989586621679577360"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577359"><span class="annot"><a href="#local-6989586621679577359"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577358"><span class="annot"><a href="#local-6989586621679577358"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577357"><span class="annot"><a href="#local-6989586621679577357"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-314"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-315"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearWeightF"><span class="hs-identifier hs-type">LinearWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577361"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577360"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577359"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577357"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577358"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearBiasF"><span class="hs-identifier hs-type">LinearBiasF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577361"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577360"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577359"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577358"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-317"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>  </span><span id="FFNOutputProjectionF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-var">FFNOutputProjectionF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679577356"><span class="annot"><a href="#local-6989586621679577356"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577355"><span class="annot"><a href="#local-6989586621679577355"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577354"><span class="annot"><a href="#local-6989586621679577354"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577353"><span class="annot"><a href="#local-6989586621679577353"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577352"><span class="annot"><a href="#local-6989586621679577352"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-type">FFNOutputProjectionF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577356"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577355"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577354"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577353"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577352"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | Specifies the dropout for the output.</span><span>
</span><span id="line-322"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-323"></span><span>  </span><span id="FFNOutputDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputDropoutF"><span class="hs-identifier hs-var">FFNOutputDropoutF</span></a></span></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577351"><span class="annot"><a href="#local-6989586621679577351"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-325"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-327"></span><span>  </span><span id="FFNOutputDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputDropoutF"><span class="hs-identifier hs-var">FFNOutputDropoutF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="hs-comment">-- | Specifies the layer normalization for the output.</span><span>
</span><span id="line-330"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-331"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577350"><span class="annot"><a href="#local-6989586621679577350"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577349"><span class="annot"><a href="#local-6989586621679577349"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577348"><span class="annot"><a href="#local-6989586621679577348"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577347"><span class="annot"><a href="#local-6989586621679577347"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679577346"><span class="annot"><a href="#local-6989586621679577346"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-338"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679577345"><span class="annot"><a href="#local-6989586621679577345"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577344"><span class="annot"><a href="#local-6989586621679577344"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577343"><span class="annot"><a href="#local-6989586621679577343"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577342"><span class="annot"><a href="#local-6989586621679577342"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-type">FFNOutputLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577345"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577344"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577343"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577342"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679577341"><span class="annot"><a href="#local-6989586621679577341"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577340"><span class="annot"><a href="#local-6989586621679577340"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577339"><span class="annot"><a href="#local-6989586621679577339"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577338"><span class="annot"><a href="#local-6989586621679577338"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-344"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577341"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577340"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577339"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679577338"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679577337"><span class="annot"><a href="#local-6989586621679577337"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577336"><span class="annot"><a href="#local-6989586621679577336"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577335"><span class="annot"><a href="#local-6989586621679577335"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577334"><span class="annot"><a href="#local-6989586621679577334"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-346"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-type">FFNOutputLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577337"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577336"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577335"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577334"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span id="local-6989586621679577333"><span class="annot"><a href="#local-6989586621679577333"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577332"><span class="annot"><a href="#local-6989586621679577332"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577331"><span class="annot"><a href="#local-6989586621679577331"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577330"><span class="annot"><a href="#local-6989586621679577330"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577333"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577332"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577331"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679577330"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>  </span><span id="FFNOutputLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-var">FFNOutputLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679577329"><span class="annot"><a href="#local-6989586621679577329"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577328"><span class="annot"><a href="#local-6989586621679577328"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577327"><span class="annot"><a href="#local-6989586621679577327"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577326"><span class="annot"><a href="#local-6989586621679577326"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-352"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-type">FFNOutputLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577329"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577328"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577327"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577326"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | Specifies the parameters of the transformer feed forward network.</span><span>
</span><span id="line-355"></span><span class="hs-comment">--</span><span>
</span><span id="line-356"></span><span class="hs-comment">-- - @style@: the style of the transformer feed forward network, e.g. 'ST5', 'SByT5', etc.</span><span>
</span><span id="line-357"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the network's parameters.</span><span>
</span><span id="line-358"></span><span class="hs-comment">-- - @device@: the computational device on which the parameters are allocated.</span><span>
</span><span id="line-359"></span><span class="hs-comment">-- - @dataType@: the data type of the parameters.</span><span>
</span><span id="line-360"></span><span class="hs-comment">-- - @queryEmbedDim@: the dimension of the query embedding.</span><span>
</span><span id="line-361"></span><span class="hs-comment">-- - @ffnDim@: the dimension of the feed forward network's hidden state.</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- - @dropoutP@: the dropout rate.</span><span>
</span><span id="line-363"></span><span class="hs-comment">-- - @eps@: the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-364"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#transformerFeedForwardNetworkSpec"><span class="hs-identifier hs-type">transformerFeedForwardNetworkSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679577590"><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679577589"><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679577588"><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679577587"><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679577586"><span class="annot"><a href="#local-6989586621679577586"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577585"><span class="annot"><a href="#local-6989586621679577585"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-366"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-368"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-370"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577586"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577585"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-372"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-376"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputLayerNormF"><span class="hs-identifier hs-type">FFNInputLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577586"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNInputTransformationF"><span class="hs-identifier hs-type">FFNInputTransformationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577586"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577585"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-378"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-379"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputProjectionF"><span class="hs-identifier hs-type">FFNOutputProjectionF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577586"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577585"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-381"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputDropoutF"><span class="hs-identifier hs-type">FFNOutputDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNOutputLayerNormF"><span class="hs-identifier hs-type">FFNOutputLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577586"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span id="transformerFeedForwardNetworkSpec"><span class="annot"><span class="annottext">transformerFeedForwardNetworkSpec :: STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerFeedForwardNetwork
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputDropoutF style)
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#transformerFeedForwardNetworkSpec"><span class="hs-identifier hs-var hs-var">transformerFeedForwardNetworkSpec</span></a></span></span><span> </span><span id="local-6989586621679577324"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679577323"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679577323"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679577322"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679577322"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679577321"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679577321"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679577320"><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679577319"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679577318"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577318"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679577317"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577317"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679577316"><span class="annot"><span class="annottext">inputLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679577316"><span class="hs-identifier hs-var hs-var">inputLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577313"><span class="hs-identifier hs-var">layerNormWithoutBiasSpec</span></a></span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577313"><span class="hs-identifier hs-var">layerNormWithoutBiasSpec</span></a></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>      </span><span class="annot"><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>      </span><span class="annot"><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577308"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>      </span><span class="annot"><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-393"></span><span>      </span><span id="local-6989586621679577303"><span class="annot"><span class="annottext">inputTransformationSpec :: STransformerStyle style
-&gt; ModelSpec
     (FFNInputTransformationF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679577303"><span class="hs-identifier hs-var hs-var">inputTransformationSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel ())
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel ())))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel ()))
</span><a href="#local-6989586621679577302"><span class="hs-identifier hs-var">weightSpecWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><span class="annottext">NamedModel
  (GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel ()))
-&gt; GeluNew
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
-&gt; GGate
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel ())))
     GeluNew
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ffnDim, queryEmbedDim])))
           (NamedModel ())))
forall layer0 activation layer1.
layer0 -&gt; activation -&gt; layer1 -&gt; GGate layer0 activation layer1
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GGate"><span class="hs-identifier hs-var">GGate</span></a></span><span>
</span><span id="line-396"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_0.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel ())
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel ())))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel ()))
</span><a href="#local-6989586621679577302"><span class="hs-identifier hs-var">weightSpecWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>          </span><span class="annot"><span class="annottext">GeluNew
</span><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-var">GeluNew</span></a></span><span>
</span><span id="line-398"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel ())
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel ())))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel ()))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel ()))
</span><a href="#local-6989586621679577302"><span class="hs-identifier hs-var">weightSpecWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel
      (TensorSpec
         gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-400"></span><span>      </span><span class="annot"><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel
      (TensorSpec
         gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-401"></span><span>      </span><span class="annot"><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel
      (TensorSpec
         gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-402"></span><span>      </span><span class="annot"><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel
      (TensorSpec
         gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[ffnDim, queryEmbedDim])))
   (NamedModel
      (TensorSpec
         gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[ffnDim, queryEmbedDim])))
         (NamedModel
            (TensorSpec
               gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[ffnDim, queryEmbedDim])))
     (NamedModel
        (TensorSpec
           gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (TensorSpec
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ffnDim, queryEmbedDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-404"></span><span>      </span><span class="annot"><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (FFNInputTransformationF
     style gradient device dataType queryEmbedDim ffnDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-405"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-type">activationSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577590"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>      </span><span id="local-6989586621679577299"><span class="annot"><span class="annottext">activationSpec :: STransformerStyle style -&gt; ModelSpec (FFNActivationF style)
</span><a href="#local-6989586621679577299"><span class="hs-identifier hs-var hs-var">activationSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
Relu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-var">Relu</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
GeluNew
</span><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-var">GeluNew</span></a></span><span>
</span><span id="line-408"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
Relu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-var">Relu</span></a></span><span>
</span><span id="line-411"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-412"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-413"></span><span>      </span><span class="annot"><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-414"></span><span>      </span><span id="local-6989586621679577296"><span class="annot"><span class="annottext">activationDropoutSpec :: STransformerStyle style -&gt; ModelSpec (FFNActivationDropoutF style)
</span><a href="#local-6989586621679577296"><span class="hs-identifier hs-var hs-var">activationDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577318"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-415"></span><span>      </span><span class="annot"><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577318"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-416"></span><span>      </span><span class="annot"><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577318"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-417"></span><span>      </span><span class="annot"><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577318"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="annot"><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577318"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-419"></span><span>      </span><span class="annot"><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>      </span><span class="annot"><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec (FFNActivationDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-422"></span><span>      </span><span id="local-6989586621679577294"><span class="annot"><span class="annottext">outputProjectionSpec :: STransformerStyle style
-&gt; ModelSpec
     (FFNOutputProjectionF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679577294"><span class="hs-identifier hs-var hs-var">outputProjectionSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel ()))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim, ffnDim])))
   (NamedModel ())
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel ())))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel ()))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel ()))
</span><a href="#local-6989586621679577302"><span class="hs-identifier hs-var">weightSpecWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel ()))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim, ffnDim])))
   (NamedModel ())
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel ())))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel ())
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel ()))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel ()))
</span><a href="#local-6989586621679577302"><span class="hs-identifier hs-var">weightSpecWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim, ffnDim])))
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim, ffnDim])))
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span class="annot"><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim, ffnDim])))
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span class="annot"><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim, ffnDim])))
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLinear
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim, ffnDim])))
   (NamedModel
      (TensorSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         ('Shape '[queryEmbedDim])))
 -&gt; NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim, ffnDim])))
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[queryEmbedDim])))))
-&gt; GLinear
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim, ffnDim])))
     (NamedModel
        (TensorSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           ('Shape '[queryEmbedDim])))
-&gt; NamedModel
     (GLinear
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim, ffnDim])))
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[queryEmbedDim]))))
forall (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var">weightSpecWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679577319"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-429"></span><span>      </span><span class="annot"><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (FFNOutputProjectionF
     style gradient device dataType queryEmbedDim ffnDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-430"></span><span>      </span><span id="local-6989586621679577293"><span class="annot"><span class="annottext">outputDropoutSpec :: STransformerStyle style -&gt; Dropout
</span><a href="#local-6989586621679577293"><span class="hs-identifier hs-var hs-var">outputDropoutSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577318"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-431"></span><span>      </span><span id="local-6989586621679577292"><span class="annot"><span class="annottext">outputLayerNormSpec :: STransformerStyle style
-&gt; ModelSpec
     (FFNOutputLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679577292"><span class="hs-identifier hs-var hs-var">outputLayerNormSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577308"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-434"></span><span>      </span><span class="annot"><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577308"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-435"></span><span>      </span><span class="annot"><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577308"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; NamedModel
     (LayerNormSpec
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span> </span><span class="annot"><span class="annottext">LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577308"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (FFNOutputLayerNormF style gradient device dataType queryEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-439"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
-&gt; ModelSpec
     (FFNInputTransformationF
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; ModelSpec (FFNActivationF style)
-&gt; ModelSpec (FFNActivationDropoutF style)
-&gt; ModelSpec
     (FFNOutputProjectionF
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; Dropout
-&gt; ModelSpec
     (FFNOutputLayerNormF style gradient device dataType queryEmbedDim)
-&gt; GTransformerFeedForwardNetwork
     (ModelSpec
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim))
     (ModelSpec
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim))
     (ModelSpec (FFNActivationF style))
     (ModelSpec (FFNActivationDropoutF style))
     (ModelSpec
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim))
     Dropout
     (ModelSpec
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
inputLayerNorm
-&gt; inputTransformation
-&gt; activation
-&gt; activationDropout
-&gt; outputProjection
-&gt; outputDropout
-&gt; outputLayerNorm
-&gt; GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-440"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679577316"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (FFNInputTransformationF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679577303"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; ModelSpec (FFNActivationF style)
</span><a href="#local-6989586621679577299"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; ModelSpec (FFNActivationDropoutF style)
</span><a href="#local-6989586621679577296"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (FFNOutputProjectionF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679577294"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; Dropout
</span><a href="#local-6989586621679577293"><span class="hs-identifier hs-var">outputDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (FFNOutputLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679577292"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679577324"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span class="annot"><a href="#local-6989586621679577302"><span class="hs-identifier hs-type">weightSpecWithoutBias</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679577719"><span class="annot"><a href="#local-6989586621679577719"><span class="hs-identifier hs-type">inputDim</span></a></span></span><span> </span><span id="local-6989586621679577718"><span class="annot"><a href="#local-6989586621679577718"><span class="hs-identifier hs-type">outputDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-450"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577719"><span class="hs-identifier hs-type">inputDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-451"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577718"><span class="hs-identifier hs-type">outputDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-452"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-453"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-454"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679577718"><span class="hs-identifier hs-type">outputDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679577719"><span class="hs-identifier hs-type">inputDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>    </span><span id="local-6989586621679577302"><span class="annot"><span class="annottext">weightSpecWithoutBias :: SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel ()))
</span><a href="#local-6989586621679577302"><span class="hs-identifier hs-var hs-var">weightSpecWithoutBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (LinearWeightF gradient device dataType inputDim outputDim))
        (NamedModel
           (LinearBiasF 'WithoutBias gradient device dataType outputDim)))
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (LinearWeightF gradient device dataType inputDim outputDim))
        (NamedModel
           (LinearBiasF hasBias gradient device dataType outputDim)))
</span><a href="Torch.GraduallyTyped.NN.Linear.html#linearSpec"><span class="hs-identifier hs-var">linearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679577323"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679577322"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679577321"><span class="hs-identifier hs-var">dataType</span></a></span><span>
</span><span id="line-458"></span><span>    </span><span class="annot"><a href="#local-6989586621679577300"><span class="hs-identifier hs-type">weightSpecWithBias</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-459"></span><span>      </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679577716"><span class="annot"><a href="#local-6989586621679577716"><span class="hs-identifier hs-type">inputDim</span></a></span></span><span> </span><span id="local-6989586621679577715"><span class="annot"><a href="#local-6989586621679577715"><span class="hs-identifier hs-type">outputDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-460"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577716"><span class="hs-identifier hs-type">inputDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-461"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577715"><span class="hs-identifier hs-type">outputDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-462"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-463"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#GLinear"><span class="hs-identifier hs-type">GLinear</span></a></span><span>
</span><span id="line-464"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679577715"><span class="hs-identifier hs-type">outputDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679577716"><span class="hs-identifier hs-type">inputDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577589"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679577588"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577587"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679577715"><span class="hs-identifier hs-type">outputDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>    </span><span id="local-6989586621679577300"><span class="annot"><span class="annottext">weightSpecWithBias :: SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (Tensor
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[outputDim, inputDim])))
        (NamedModel
           (Tensor
              gradient ('Layout 'Dense) device dataType ('Shape '[outputDim]))))
</span><a href="#local-6989586621679577300"><span class="hs-identifier hs-var hs-var">weightSpecWithBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (LinearWeightF gradient device dataType inputDim outputDim))
        (NamedModel
           (LinearBiasF 'WithBias gradient device dataType outputDim)))
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; ModelSpec
     (GLinear
        (NamedModel
           (LinearWeightF gradient device dataType inputDim outputDim))
        (NamedModel
           (LinearBiasF hasBias gradient device dataType outputDim)))
</span><a href="Torch.GraduallyTyped.NN.Linear.html#linearSpec"><span class="hs-identifier hs-var">linearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679577323"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679577322"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679577321"><span class="hs-identifier hs-var">dataType</span></a></span><span>
</span><span id="line-468"></span><span>    </span><span id="local-6989586621679577313"><span class="annot"><span class="annottext">layerNormWithoutBiasSpec :: LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577313"><span class="hs-identifier hs-var hs-var">layerNormWithoutBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[queryEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679577323"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679577322"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679577321"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577317"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-469"></span><span>    </span><span id="local-6989586621679577308"><span class="annot"><span class="annottext">layerNormWithBiasSpec :: LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679577308"><span class="hs-identifier hs-var hs-var">layerNormWithBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[queryEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679577323"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679577322"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679577321"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679577320"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577317"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-470"></span><span>
</span><span id="line-471"></span><span id="local-6989586621679577279"><span id="local-6989586621679577280"><span id="local-6989586621679577281"><span id="local-6989586621679577282"><span id="local-6989586621679577283"><span id="local-6989586621679577284"><span id="local-6989586621679577285"><span id="local-6989586621679577286"><span class="hs-keyword">instance</span><span>
</span><span id="line-472"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577286"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577286"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577284"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577284"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577283"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577283"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577282"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577282"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-476"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577281"><span class="hs-identifier hs-type">outputProjection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577281"><span class="hs-identifier hs-type">outputProjection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577280"><span class="hs-identifier hs-type">outputDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577280"><span class="hs-identifier hs-type">outputDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577279"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577279"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-480"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577286"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577284"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577283"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577282"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577281"><span class="hs-identifier hs-type">outputProjection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577280"><span class="hs-identifier hs-type">outputDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577279"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577286"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577284"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577283"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577282"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577281"><span class="hs-identifier hs-type">outputProjection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577280"><span class="hs-identifier hs-type">outputDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577279"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-484"></span><span>    </span><span class="annot"><a href="#local-6989586621679577285"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-485"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-486"></span><span>  </span><span id="local-6989586621679577277"><span class="annot"><span class="annottext">initialize :: ModelSpec
  (GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm)
-&gt; Generator generatorDevice
-&gt; m (GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm,
      Generator generatorDevice)
</span><a href="#local-6989586621679577277"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span id="local-6989586621679577276"><span class="annot"><a href="#local-6989586621679577276"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span></span><span> </span><span id="local-6989586621679577275"><span class="annot"><a href="#local-6989586621679577275"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span></span><span> </span><span id="local-6989586621679577274"><span class="annot"><a href="#local-6989586621679577274"><span class="hs-identifier hs-var">activationSpec</span></a></span></span><span> </span><span id="local-6989586621679577273"><span class="annot"><a href="#local-6989586621679577273"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span></span><span> </span><span id="local-6989586621679577272"><span class="annot"><a href="#local-6989586621679577272"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span></span><span> </span><span id="local-6989586621679577271"><span class="annot"><a href="#local-6989586621679577271"><span class="hs-identifier hs-var">outputDropoutSpec</span></a></span></span><span> </span><span id="local-6989586621679577270"><span class="annot"><a href="#local-6989586621679577270"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679577269"><span class="annot"><span class="annottext">inputLayerNorm :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  inputLayerNorm
</span><a href="#local-6989586621679577269"><span class="hs-identifier hs-var hs-var">inputLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (inputLayerNorm, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputLayerNorm
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (inputLayerNorm, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      inputLayerNorm)
-&gt; (ModelSpec inputLayerNorm
    -&gt; Generator generatorDevice
    -&gt; m (inputLayerNorm, Generator generatorDevice))
-&gt; ModelSpec inputLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputLayerNorm
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputLayerNorm
-&gt; Generator generatorDevice
-&gt; m (inputLayerNorm, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec inputLayerNorm
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      inputLayerNorm)
-&gt; ModelSpec inputLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputLayerNorm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputLayerNorm
</span><a href="#local-6989586621679577276"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span>
</span><span id="line-488"></span><span>        </span><span id="local-6989586621679577268"><span class="annot"><span class="annottext">inputTransformation :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  inputTransformation
</span><a href="#local-6989586621679577268"><span class="hs-identifier hs-var hs-var">inputTransformation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (inputTransformation, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputTransformation
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (inputTransformation, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      inputTransformation)
-&gt; (ModelSpec inputTransformation
    -&gt; Generator generatorDevice
    -&gt; m (inputTransformation, Generator generatorDevice))
-&gt; ModelSpec inputTransformation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputTransformation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputTransformation
-&gt; Generator generatorDevice
-&gt; m (inputTransformation, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec inputTransformation
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      inputTransformation)
-&gt; ModelSpec inputTransformation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputTransformation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputTransformation
</span><a href="#local-6989586621679577275"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span>
</span><span id="line-489"></span><span>        </span><span id="local-6989586621679577267"><span class="annot"><span class="annottext">activation :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  activation
</span><a href="#local-6989586621679577267"><span class="hs-identifier hs-var hs-var">activation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (activation, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (activation, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      activation)
-&gt; (ModelSpec activation
    -&gt; Generator generatorDevice
    -&gt; m (activation, Generator generatorDevice))
-&gt; ModelSpec activation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
-&gt; Generator generatorDevice
-&gt; m (activation, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec activation
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      activation)
-&gt; ModelSpec activation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
</span><a href="#local-6989586621679577274"><span class="hs-identifier hs-var">activationSpec</span></a></span><span>
</span><span id="line-490"></span><span>        </span><span id="local-6989586621679577266"><span class="annot"><span class="annottext">activationDropout :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  activationDropout
</span><a href="#local-6989586621679577266"><span class="hs-identifier hs-var hs-var">activationDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (activationDropout, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activationDropout
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (activationDropout, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      activationDropout)
-&gt; (ModelSpec activationDropout
    -&gt; Generator generatorDevice
    -&gt; m (activationDropout, Generator generatorDevice))
-&gt; ModelSpec activationDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activationDropout
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activationDropout
-&gt; Generator generatorDevice
-&gt; m (activationDropout, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec activationDropout
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      activationDropout)
-&gt; ModelSpec activationDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activationDropout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activationDropout
</span><a href="#local-6989586621679577273"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span>
</span><span id="line-491"></span><span>        </span><span id="local-6989586621679577265"><span class="annot"><span class="annottext">outputProjection :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  outputProjection
</span><a href="#local-6989586621679577265"><span class="hs-identifier hs-var hs-var">outputProjection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (outputProjection, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputProjection
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (outputProjection, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      outputProjection)
-&gt; (ModelSpec outputProjection
    -&gt; Generator generatorDevice
    -&gt; m (outputProjection, Generator generatorDevice))
-&gt; ModelSpec outputProjection
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputProjection
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputProjection
-&gt; Generator generatorDevice
-&gt; m (outputProjection, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec outputProjection
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      outputProjection)
-&gt; ModelSpec outputProjection
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputProjection
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputProjection
</span><a href="#local-6989586621679577272"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span>
</span><span id="line-492"></span><span>        </span><span id="local-6989586621679577264"><span class="annot"><span class="annottext">outputDropout :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  outputDropout
</span><a href="#local-6989586621679577264"><span class="hs-identifier hs-var hs-var">outputDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (outputDropout, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputDropout
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (outputDropout, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      outputDropout)
-&gt; (ModelSpec outputDropout
    -&gt; Generator generatorDevice
    -&gt; m (outputDropout, Generator generatorDevice))
-&gt; ModelSpec outputDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputDropout
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputDropout
-&gt; Generator generatorDevice
-&gt; m (outputDropout, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec outputDropout
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      outputDropout)
-&gt; ModelSpec outputDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputDropout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputDropout
</span><a href="#local-6989586621679577271"><span class="hs-identifier hs-var">outputDropoutSpec</span></a></span><span>
</span><span id="line-493"></span><span>        </span><span id="local-6989586621679577263"><span class="annot"><span class="annottext">outputLayerNorm :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  outputLayerNorm
</span><a href="#local-6989586621679577263"><span class="hs-identifier hs-var hs-var">outputLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (outputLayerNorm, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputLayerNorm
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (outputLayerNorm, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      outputLayerNorm)
-&gt; (ModelSpec outputLayerNorm
    -&gt; Generator generatorDevice
    -&gt; m (outputLayerNorm, Generator generatorDevice))
-&gt; ModelSpec outputLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputLayerNorm
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputLayerNorm
-&gt; Generator generatorDevice
-&gt; m (outputLayerNorm, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec outputLayerNorm
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      outputLayerNorm)
-&gt; ModelSpec outputLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputLayerNorm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputLayerNorm
</span><a href="#local-6989586621679577270"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span>
</span><span id="line-494"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm)
-&gt; Generator generatorDevice
-&gt; m (GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm,
      Generator generatorDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorDevice)
   (GTransformerFeedForwardNetwork
      inputLayerNorm
      inputTransformation
      activation
      activationDropout
      outputProjection
      outputDropout
      outputLayerNorm)
 -&gt; Generator generatorDevice
 -&gt; m (GTransformerFeedForwardNetwork
         inputLayerNorm
         inputTransformation
         activation
         activationDropout
         outputProjection
         outputDropout
         outputLayerNorm,
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; Generator generatorDevice
-&gt; m (GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm,
      Generator generatorDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-495"></span><span>          </span><span class="annot"><span class="annottext">inputLayerNorm
-&gt; inputTransformation
-&gt; activation
-&gt; activationDropout
-&gt; outputProjection
-&gt; outputDropout
-&gt; outputLayerNorm
-&gt; GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm
forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
inputLayerNorm
-&gt; inputTransformation
-&gt; activation
-&gt; activationDropout
-&gt; outputProjection
-&gt; outputDropout
-&gt; outputLayerNorm
-&gt; GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-496"></span><span>            </span><span class="annot"><span class="annottext">(inputLayerNorm
 -&gt; inputTransformation
 -&gt; activation
 -&gt; activationDropout
 -&gt; outputProjection
 -&gt; outputDropout
 -&gt; outputLayerNorm
 -&gt; GTransformerFeedForwardNetwork
      inputLayerNorm
      inputTransformation
      activation
      activationDropout
      outputProjection
      outputDropout
      outputLayerNorm)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (inputTransformation
      -&gt; activation
      -&gt; activationDropout
      -&gt; outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; Type -&gt; Type) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  inputLayerNorm
</span><a href="#local-6989586621679577269"><span class="hs-identifier hs-var">inputLayerNorm</span></a></span><span>
</span><span id="line-497"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (inputTransformation
   -&gt; activation
   -&gt; activationDropout
   -&gt; outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputTransformation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (activation
      -&gt; activationDropout
      -&gt; outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  inputTransformation
</span><a href="#local-6989586621679577268"><span class="hs-identifier hs-var">inputTransformation</span></a></span><span>
</span><span id="line-498"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (activation
   -&gt; activationDropout
   -&gt; outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activation
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (activationDropout
      -&gt; outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  activation
</span><a href="#local-6989586621679577267"><span class="hs-identifier hs-var">activation</span></a></span><span>
</span><span id="line-499"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (activationDropout
   -&gt; outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     activationDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  activationDropout
</span><a href="#local-6989586621679577266"><span class="hs-identifier hs-var">activationDropout</span></a></span><span>
</span><span id="line-500"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputProjection
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  outputProjection
</span><a href="#local-6989586621679577265"><span class="hs-identifier hs-var">outputProjection</span></a></span><span>
</span><span id="line-501"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputDropout
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  outputDropout
</span><a href="#local-6989586621679577264"><span class="hs-identifier hs-var">outputDropout</span></a></span><span>
</span><span id="line-502"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     outputLayerNorm
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  outputLayerNorm
</span><a href="#local-6989586621679577263"><span class="hs-identifier hs-var">outputLayerNorm</span></a></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-503"></span><span>
</span><span id="line-504"></span><span id="local-6989586621679577256"><span id="local-6989586621679577257"><span id="local-6989586621679577258"><span id="local-6989586621679577259"><span id="local-6989586621679577260"><span id="local-6989586621679577261"><span id="local-6989586621679577262"><span class="hs-keyword">instance</span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577262"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-506"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577261"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-507"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577260"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-508"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577259"><span class="hs-identifier hs-type">activationDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577258"><span class="hs-identifier hs-type">outputProjection</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577257"><span class="hs-identifier hs-type">outputDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577256"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-513"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577262"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577261"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577260"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577259"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577258"><span class="hs-identifier hs-type">outputProjection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577257"><span class="hs-identifier hs-type">outputDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577256"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-515"></span><span>  </span><span id="local-6989586621679577253"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec
  (GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm)
-&gt; StateDictKey
-&gt; m (GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
</span><a href="#local-6989586621679577253"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span id="local-6989586621679577252"><span class="annot"><a href="#local-6989586621679577252"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span></span><span> </span><span id="local-6989586621679577251"><span class="annot"><a href="#local-6989586621679577251"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span></span><span> </span><span id="local-6989586621679577250"><span class="annot"><a href="#local-6989586621679577250"><span class="hs-identifier hs-var">activationSpec</span></a></span></span><span> </span><span id="local-6989586621679577249"><span class="annot"><a href="#local-6989586621679577249"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span></span><span> </span><span id="local-6989586621679577248"><span class="annot"><a href="#local-6989586621679577248"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span></span><span> </span><span id="local-6989586621679577247"><span class="annot"><a href="#local-6989586621679577247"><span class="hs-identifier hs-var">outputDropoutSpec</span></a></span></span><span> </span><span id="local-6989586621679577246"><span class="annot"><a href="#local-6989586621679577246"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679577245"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><span class="annottext">inputLayerNorm
-&gt; inputTransformation
-&gt; activation
-&gt; activationDropout
-&gt; outputProjection
-&gt; outputDropout
-&gt; outputLayerNorm
-&gt; GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm
forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
inputLayerNorm
-&gt; inputTransformation
-&gt; activation
-&gt; activationDropout
-&gt; outputProjection
-&gt; outputDropout
-&gt; outputLayerNorm
-&gt; GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-517"></span><span>      </span><span class="annot"><span class="annottext">(inputLayerNorm
 -&gt; inputTransformation
 -&gt; activation
 -&gt; activationDropout
 -&gt; outputProjection
 -&gt; outputDropout
 -&gt; outputLayerNorm
 -&gt; GTransformerFeedForwardNetwork
      inputLayerNorm
      inputTransformation
      activation
      activationDropout
      outputProjection
      outputDropout
      outputLayerNorm)
-&gt; m inputLayerNorm
-&gt; m (inputTransformation
      -&gt; activation
      -&gt; activationDropout
      -&gt; outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputLayerNorm -&gt; StateDictKey -&gt; m inputLayerNorm
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputLayerNorm
</span><a href="#local-6989586621679577252"><span class="hs-identifier hs-var">inputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-518"></span><span>      </span><span class="annot"><span class="annottext">m (inputTransformation
   -&gt; activation
   -&gt; activationDropout
   -&gt; outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; m inputTransformation
-&gt; m (activation
      -&gt; activationDropout
      -&gt; outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputTransformation
-&gt; StateDictKey -&gt; m inputTransformation
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec inputTransformation
</span><a href="#local-6989586621679577251"><span class="hs-identifier hs-var">inputTransformationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-519"></span><span>      </span><span class="annot"><span class="annottext">m (activation
   -&gt; activationDropout
   -&gt; outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; m activation
-&gt; m (activationDropout
      -&gt; outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation -&gt; StateDictKey -&gt; m activation
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
</span><a href="#local-6989586621679577250"><span class="hs-identifier hs-var">activationSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-520"></span><span>      </span><span class="annot"><span class="annottext">m (activationDropout
   -&gt; outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; m activationDropout
-&gt; m (outputProjection
      -&gt; outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec activationDropout -&gt; StateDictKey -&gt; m activationDropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec activationDropout
</span><a href="#local-6989586621679577249"><span class="hs-identifier hs-var">activationDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-521"></span><span>      </span><span class="annot"><span class="annottext">m (outputProjection
   -&gt; outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; m outputProjection
-&gt; m (outputDropout
      -&gt; outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputProjection -&gt; StateDictKey -&gt; m outputProjection
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputProjection
</span><a href="#local-6989586621679577248"><span class="hs-identifier hs-var">outputProjectionSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-522"></span><span>      </span><span class="annot"><span class="annottext">m (outputDropout
   -&gt; outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; m outputDropout
-&gt; m (outputLayerNorm
      -&gt; GTransformerFeedForwardNetwork
           inputLayerNorm
           inputTransformation
           activation
           activationDropout
           outputProjection
           outputDropout
           outputLayerNorm)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputDropout -&gt; StateDictKey -&gt; m outputDropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputDropout
</span><a href="#local-6989586621679577247"><span class="hs-identifier hs-var">outputDropoutSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-523"></span><span>      </span><span class="annot"><span class="annottext">m (outputLayerNorm
   -&gt; GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
-&gt; m outputLayerNorm
-&gt; m (GTransformerFeedForwardNetwork
        inputLayerNorm
        inputTransformation
        activation
        activationDropout
        outputProjection
        outputDropout
        outputLayerNorm)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputLayerNorm -&gt; StateDictKey -&gt; m outputLayerNorm
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec outputLayerNorm
</span><a href="#local-6989586621679577246"><span class="hs-identifier hs-var">outputLayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577245"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span id="local-6989586621679577244"><span class="annot"><span class="annottext">toStateDict :: StateDictKey
-&gt; GTransformerFeedForwardNetwork
     inputLayerNorm
     inputTransformation
     activation
     activationDropout
     outputProjection
     outputDropout
     outputLayerNorm
-&gt; m ()
</span><a href="#local-6989586621679577244"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679577243"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679577236"><span id="local-6989586621679577237"><span id="local-6989586621679577238"><span id="local-6989586621679577239"><span id="local-6989586621679577240"><span id="local-6989586621679577241"><span id="local-6989586621679577242"><span class="annot"><span class="annottext">inputLayerNorm
inputTransformation
activation
activationDropout
outputProjection
outputDropout
outputLayerNorm
ffnOutputLayerNorm :: outputLayerNorm
ffnOutputDropout :: outputDropout
ffnOutputProjection :: outputProjection
ffnActivationDropout :: activationDropout
ffnActivation :: activation
ffnInputTransformation :: inputTransformation
ffnInputLayerNorm :: inputLayerNorm
ffnOutputLayerNorm :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputLayerNorm
ffnOutputDropout :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputDropout
ffnOutputProjection :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputProjection
ffnActivationDropout :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; activationDropout
ffnActivation :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; activation
ffnInputTransformation :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; inputTransformation
ffnInputLayerNorm :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; inputLayerNorm
</span><a href="#local-6989586621679577236"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-525"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; inputLayerNorm -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">inputLayerNorm
</span><a href="#local-6989586621679577242"><span class="hs-identifier hs-var">ffnInputLayerNorm</span></a></span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; inputTransformation -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">inputTransformation
</span><a href="#local-6989586621679577241"><span class="hs-identifier hs-var">ffnInputTransformation</span></a></span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; activation -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">activation
</span><a href="#local-6989586621679577240"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; activationDropout -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">activationDropout
</span><a href="#local-6989586621679577239"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-529"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; outputProjection -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">outputProjection
</span><a href="#local-6989586621679577238"><span class="hs-identifier hs-var">ffnOutputProjection</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; outputDropout -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">outputDropout
</span><a href="#local-6989586621679577237"><span class="hs-identifier hs-var">ffnOutputDropout</span></a></span><span>
</span><span id="line-531"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; outputLayerNorm -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679577243"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">outputLayerNorm
</span><a href="#local-6989586621679577236"><span class="hs-identifier hs-var">ffnOutputLayerNorm</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span class="hs-comment">-- | 'HasForward' instance for 'GTransformerFeedForwardNetwork'.</span><span>
</span><span id="line-535"></span><span class="hs-comment">--</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-537"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-538"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-539"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;        &#9474;</span><span>
</span><span id="line-540"></span><span class="hs-comment">--           &#9474;            &#9474;</span><span>
</span><span id="line-541"></span><span class="hs-comment">--           &#9660;            &#9474;</span><span>
</span><span id="line-542"></span><span class="hs-comment">--  (ffnInputLayerNorm)   &#9474;</span><span>
</span><span id="line-543"></span><span class="hs-comment">--           &#9660;            &#9474;</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- ffnInputTransformation &#9474;</span><span>
</span><span id="line-545"></span><span class="hs-comment">--           &#9660;            &#9474;</span><span>
</span><span id="line-546"></span><span class="hs-comment">--     ffnActivation      &#9474;</span><span>
</span><span id="line-547"></span><span class="hs-comment">--           &#9660;            &#9474;</span><span>
</span><span id="line-548"></span><span class="hs-comment">-- (ffnActivationDropout) &#9474;</span><span>
</span><span id="line-549"></span><span class="hs-comment">--           &#9660;            &#9474;</span><span>
</span><span id="line-550"></span><span class="hs-comment">--   ffnOutputProjecton   &#9474;</span><span>
</span><span id="line-551"></span><span class="hs-comment">--           &#9660;            &#9474;</span><span>
</span><span id="line-552"></span><span class="hs-comment">--    ffnOutputDropout    &#9474;</span><span>
</span><span id="line-553"></span><span class="hs-comment">--           &#9474;            &#9474;</span><span>
</span><span id="line-554"></span><span class="hs-comment">--           &#9660;            &#9474;</span><span>
</span><span id="line-555"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-556"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-557"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-558"></span><span class="hs-comment">--  (ffnOutputLayerNorm)</span><span>
</span><span id="line-559"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-560"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-561"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-562"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-563"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-565"></span><span id="local-6989586621679577205"><span id="local-6989586621679577206"><span id="local-6989586621679577207"><span id="local-6989586621679577208"><span id="local-6989586621679577209"><span id="local-6989586621679577210"><span id="local-6989586621679577211"><span id="local-6989586621679577212"><span id="local-6989586621679577213"><span id="local-6989586621679577214"><span id="local-6989586621679577215"><span id="local-6989586621679577216"><span id="local-6989586621679577217"><span id="local-6989586621679577218"><span id="local-6989586621679577219"><span id="local-6989586621679577220"><span id="local-6989586621679577221"><span id="local-6989586621679577222"><span id="local-6989586621679577223"><span id="local-6989586621679577224"><span id="local-6989586621679577225"><span id="local-6989586621679577226"><span id="local-6989586621679577227"><span id="local-6989586621679577228"><span id="local-6989586621679577229"><span id="local-6989586621679577230"><span id="local-6989586621679577231"><span id="local-6989586621679577232"><span id="local-6989586621679577233"><span id="local-6989586621679577234"><span id="local-6989586621679577235"><span class="hs-keyword">instance</span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-567"></span><span>      </span><span class="annot"><a href="#local-6989586621679577235"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span>
</span><span id="line-568"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577234"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577233"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577232"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577231"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577230"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>      </span><span class="annot"><a href="#local-6989586621679577229"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-570"></span><span>      </span><span class="annot"><a href="#local-6989586621679577228"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-571"></span><span>      </span><span class="annot"><a href="#local-6989586621679577227"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-572"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><a href="#local-6989586621679577226"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span>
</span><span id="line-574"></span><span>      </span><span class="annot"><a href="#local-6989586621679577228"><span class="hs-identifier hs-type">tensor0</span></a></span><span>
</span><span id="line-575"></span><span>      </span><span class="annot"><a href="#local-6989586621679577227"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span class="annot"><a href="#local-6989586621679577225"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span class="annot"><a href="#local-6989586621679577224"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-578"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-579"></span><span>      </span><span class="annot"><a href="#local-6989586621679577223"><span class="hs-identifier hs-type">activation</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="annot"><a href="#local-6989586621679577225"><span class="hs-identifier hs-type">tensor1</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><a href="#local-6989586621679577224"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span>
</span><span id="line-582"></span><span>      </span><span class="annot"><a href="#local-6989586621679577222"><span class="hs-identifier hs-type">tensor2</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="annot"><a href="#local-6989586621679577221"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-584"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-585"></span><span>      </span><span class="annot"><a href="#local-6989586621679577220"><span class="hs-identifier hs-type">activationDropout</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><a href="#local-6989586621679577222"><span class="hs-identifier hs-type">tensor2</span></a></span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><a href="#local-6989586621679577221"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span>
</span><span id="line-588"></span><span>      </span><span class="annot"><a href="#local-6989586621679577219"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-589"></span><span>      </span><span class="annot"><a href="#local-6989586621679577218"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-590"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="annot"><a href="#local-6989586621679577217"><span class="hs-identifier hs-type">outputProjection</span></a></span><span>
</span><span id="line-592"></span><span>      </span><span class="annot"><a href="#local-6989586621679577219"><span class="hs-identifier hs-type">tensor3</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="annot"><a href="#local-6989586621679577218"><span class="hs-identifier hs-type">generatorDevice3</span></a></span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><a href="#local-6989586621679577216"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-595"></span><span>      </span><span class="annot"><a href="#local-6989586621679577215"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-597"></span><span>      </span><span class="annot"><a href="#local-6989586621679577214"><span class="hs-identifier hs-type">outputDropout</span></a></span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><a href="#local-6989586621679577216"><span class="hs-identifier hs-type">tensor4</span></a></span><span>
</span><span id="line-599"></span><span>      </span><span class="annot"><a href="#local-6989586621679577215"><span class="hs-identifier hs-type">generatorDevice4</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577213"><span class="hs-identifier hs-type">queryGradient5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577212"><span class="hs-identifier hs-type">queryLayout5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577211"><span class="hs-identifier hs-type">queryDevice5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577210"><span class="hs-identifier hs-type">queryDataType5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577209"><span class="hs-identifier hs-type">queryShape5</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>      </span><span class="annot"><a href="#local-6989586621679577208"><span class="hs-identifier hs-type">generatorDevice5</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-602"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><a href="#local-6989586621679577207"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679577234"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577213"><span class="hs-identifier hs-type">queryGradient5</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679577233"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577212"><span class="hs-identifier hs-type">queryLayout5</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679577232"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577211"><span class="hs-identifier hs-type">queryDevice5</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679577231"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577210"><span class="hs-identifier hs-type">queryDataType5</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577230"><span class="hs-identifier hs-type">queryShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577209"><span class="hs-identifier hs-type">queryShape5</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>      </span><span class="annot"><a href="#local-6989586621679577208"><span class="hs-identifier hs-type">generatorDevice5</span></a></span><span>
</span><span id="line-606"></span><span>      </span><span class="annot"><a href="#local-6989586621679577206"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-607"></span><span>      </span><span class="annot"><a href="#local-6989586621679577205"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-608"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-609"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577235"><span class="hs-identifier hs-type">inputLayerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577226"><span class="hs-identifier hs-type">inputTransformation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577223"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577220"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577217"><span class="hs-identifier hs-type">outputProjection</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577214"><span class="hs-identifier hs-type">outputDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577207"><span class="hs-identifier hs-type">outputLayerNorm</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577234"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577233"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577232"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577231"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679577230"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="#local-6989586621679577229"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="#local-6989586621679577206"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-614"></span><span>    </span><span class="annot"><a href="#local-6989586621679577205"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-616"></span><span>  </span><span id="local-6989586621679577203"><span class="annot"><span class="annottext">forward :: GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679577203"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679577196"><span id="local-6989586621679577197"><span id="local-6989586621679577198"><span id="local-6989586621679577199"><span id="local-6989586621679577200"><span id="local-6989586621679577201"><span id="local-6989586621679577202"><span class="annot"><span class="annottext">inputLayerNorm
inputTransformation
activation
activationDropout
outputProjection
outputDropout
outputLayerNorm
ffnOutputLayerNorm :: outputLayerNorm
ffnOutputDropout :: outputDropout
ffnOutputProjection :: outputProjection
ffnActivationDropout :: activationDropout
ffnActivation :: activation
ffnInputTransformation :: inputTransformation
ffnInputLayerNorm :: inputLayerNorm
ffnOutputLayerNorm :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputLayerNorm
ffnOutputDropout :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputDropout
ffnOutputProjection :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; outputProjection
ffnActivationDropout :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; activationDropout
ffnActivation :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; activation
ffnInputTransformation :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; inputTransformation
ffnInputLayerNorm :: forall inputLayerNorm inputTransformation activation
       activationDropout outputProjection outputDropout outputLayerNorm.
GTransformerFeedForwardNetwork
  inputLayerNorm
  inputTransformation
  activation
  activationDropout
  outputProjection
  outputDropout
  outputLayerNorm
-&gt; inputLayerNorm
</span><a href="#local-6989586621679577196"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679577195"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679577195"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-618"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679577195"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-619"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxStateT
         m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (tensor0, Generator generatorDevice0))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (tensor0, Generator generatorDevice0))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice0) tensor0)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; m (tensor0, Generator generatorDevice0))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice0) tensor0
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">inputLayerNorm
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (tensor0, Generator generatorDevice0)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">inputLayerNorm
</span><a href="#local-6989586621679577202"><span class="hs-identifier hs-var">ffnInputLayerNorm</span></a></span><span>
</span><span id="line-620"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice0) tensor0
-&gt; (tensor0
    -&gt; IxStateT
         m
         (Generator generatorDevice0)
         (Generator generatorDevice1)
         tensor1)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice1) tensor1
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice0
 -&gt; m (tensor1, Generator generatorDevice1))
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice0
  -&gt; m (tensor1, Generator generatorDevice1))
 -&gt; IxStateT
      m
      (Generator generatorDevice0)
      (Generator generatorDevice1)
      tensor1)
-&gt; (tensor0
    -&gt; Generator generatorDevice0
    -&gt; m (tensor1, Generator generatorDevice1))
-&gt; tensor0
-&gt; IxStateT
     m (Generator generatorDevice0) (Generator generatorDevice1) tensor1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">inputTransformation
-&gt; tensor0
-&gt; Generator generatorDevice0
-&gt; m (tensor1, Generator generatorDevice1)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">inputTransformation
</span><a href="#local-6989586621679577201"><span class="hs-identifier hs-var">ffnInputTransformation</span></a></span><span>
</span><span id="line-621"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice1) tensor1
-&gt; (tensor1
    -&gt; IxStateT
         m
         (Generator generatorDevice1)
         (Generator generatorDevice2)
         tensor2)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice2) tensor2
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice1
 -&gt; m (tensor2, Generator generatorDevice2))
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice1
  -&gt; m (tensor2, Generator generatorDevice2))
 -&gt; IxStateT
      m
      (Generator generatorDevice1)
      (Generator generatorDevice2)
      tensor2)
-&gt; (tensor1
    -&gt; Generator generatorDevice1
    -&gt; m (tensor2, Generator generatorDevice2))
-&gt; tensor1
-&gt; IxStateT
     m (Generator generatorDevice1) (Generator generatorDevice2) tensor2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">activation
-&gt; tensor1
-&gt; Generator generatorDevice1
-&gt; m (tensor2, Generator generatorDevice2)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">activation
</span><a href="#local-6989586621679577200"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-622"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice2) tensor2
-&gt; (tensor2
    -&gt; IxStateT
         m
         (Generator generatorDevice2)
         (Generator generatorDevice3)
         tensor3)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice3) tensor3
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice2
 -&gt; m (tensor3, Generator generatorDevice3))
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice2
  -&gt; m (tensor3, Generator generatorDevice3))
 -&gt; IxStateT
      m
      (Generator generatorDevice2)
      (Generator generatorDevice3)
      tensor3)
-&gt; (tensor2
    -&gt; Generator generatorDevice2
    -&gt; m (tensor3, Generator generatorDevice3))
-&gt; tensor2
-&gt; IxStateT
     m (Generator generatorDevice2) (Generator generatorDevice3) tensor3
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">activationDropout
-&gt; tensor2
-&gt; Generator generatorDevice2
-&gt; m (tensor3, Generator generatorDevice3)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">activationDropout
</span><a href="#local-6989586621679577199"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-623"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice3) tensor3
-&gt; (tensor3
    -&gt; IxStateT
         m
         (Generator generatorDevice3)
         (Generator generatorDevice4)
         tensor4)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice4) tensor4
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice3
 -&gt; m (tensor4, Generator generatorDevice4))
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice3
  -&gt; m (tensor4, Generator generatorDevice4))
 -&gt; IxStateT
      m
      (Generator generatorDevice3)
      (Generator generatorDevice4)
      tensor4)
-&gt; (tensor3
    -&gt; Generator generatorDevice3
    -&gt; m (tensor4, Generator generatorDevice4))
-&gt; tensor3
-&gt; IxStateT
     m (Generator generatorDevice3) (Generator generatorDevice4) tensor4
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">outputProjection
-&gt; tensor3
-&gt; Generator generatorDevice3
-&gt; m (tensor4, Generator generatorDevice4)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">outputProjection
</span><a href="#local-6989586621679577198"><span class="hs-identifier hs-var">ffnOutputProjection</span></a></span><span>
</span><span id="line-624"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice4) tensor4
-&gt; (tensor4
    -&gt; IxStateT
         m
         (Generator generatorDevice4)
         (Generator generatorDevice5)
         (Tensor
            queryGradient5
            queryLayout5
            queryDevice5
            queryDataType5
            queryShape5))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice5)
     (Tensor
        queryGradient5
        queryLayout5
        queryDevice5
        queryDataType5
        queryShape5)
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice4
 -&gt; m (Tensor
         queryGradient5
         queryLayout5
         queryDevice5
         queryDataType5
         queryShape5,
       Generator generatorDevice5))
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorDevice5)
     (Tensor
        queryGradient5
        queryLayout5
        queryDevice5
        queryDataType5
        queryShape5)
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice4
  -&gt; m (Tensor
          queryGradient5
          queryLayout5
          queryDevice5
          queryDataType5
          queryShape5,
        Generator generatorDevice5))
 -&gt; IxStateT
      m
      (Generator generatorDevice4)
      (Generator generatorDevice5)
      (Tensor
         queryGradient5
         queryLayout5
         queryDevice5
         queryDataType5
         queryShape5))
-&gt; (tensor4
    -&gt; Generator generatorDevice4
    -&gt; m (Tensor
            queryGradient5
            queryLayout5
            queryDevice5
            queryDataType5
            queryShape5,
          Generator generatorDevice5))
-&gt; tensor4
-&gt; IxStateT
     m
     (Generator generatorDevice4)
     (Generator generatorDevice5)
     (Tensor
        queryGradient5
        queryLayout5
        queryDevice5
        queryDataType5
        queryShape5)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">outputDropout
-&gt; tensor4
-&gt; Generator generatorDevice4
-&gt; m (Tensor
        queryGradient5
        queryLayout5
        queryDevice5
        queryDataType5
        queryShape5,
      Generator generatorDevice5)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">outputDropout
</span><a href="#local-6989586621679577197"><span class="hs-identifier hs-var">ffnOutputDropout</span></a></span><span>
</span><span id="line-625"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice5)
  (Tensor
     queryGradient5
     queryLayout5
     queryDevice5
     queryDataType5
     queryShape5)
-&gt; (Tensor
      queryGradient5 queryLayout5 queryDevice5 queryDataType5 queryShape5
    -&gt; IxStateT
         m
         (Generator generatorDevice5)
         (Generator generatorDevice5)
         (Tensor
            (Or (Gradient RequiresGradient) queryGradient queryGradient5)
            (Unify (Layout LayoutType) queryLayout queryLayout5)
            (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
            (Unify (DataType DType) queryDataType queryDataType5)
            (BroadcastShapesF queryShape queryShape5)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice5)
     (Tensor
        (Or (Gradient RequiresGradient) queryGradient queryGradient5)
        (Unify (Layout LayoutType) queryLayout queryLayout5)
        (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
        (Unify (DataType DType) queryDataType queryDataType5)
        (BroadcastShapesF queryShape queryShape5))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) queryGradient queryGradient5)
  (Unify (Layout LayoutType) queryLayout queryLayout5)
  (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
  (Unify (DataType DType) queryDataType queryDataType5)
  (BroadcastShapesF queryShape queryShape5)
-&gt; IxStateT
     m
     (Generator generatorDevice5)
     (Generator generatorDevice5)
     (Tensor
        (Or (Gradient RequiresGradient) queryGradient queryGradient5)
        (Unify (Layout LayoutType) queryLayout queryLayout5)
        (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
        (Unify (DataType DType) queryDataType queryDataType5)
        (BroadcastShapesF queryShape queryShape5))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or (Gradient RequiresGradient) queryGradient queryGradient5)
   (Unify (Layout LayoutType) queryLayout queryLayout5)
   (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
   (Unify (DataType DType) queryDataType queryDataType5)
   (BroadcastShapesF queryShape queryShape5)
 -&gt; IxStateT
      m
      (Generator generatorDevice5)
      (Generator generatorDevice5)
      (Tensor
         (Or (Gradient RequiresGradient) queryGradient queryGradient5)
         (Unify (Layout LayoutType) queryLayout queryLayout5)
         (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
         (Unify (DataType DType) queryDataType queryDataType5)
         (BroadcastShapesF queryShape queryShape5)))
-&gt; (Tensor
      queryGradient5 queryLayout5 queryDevice5 queryDataType5 queryShape5
    -&gt; Tensor
         (Or (Gradient RequiresGradient) queryGradient queryGradient5)
         (Unify (Layout LayoutType) queryLayout queryLayout5)
         (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
         (Unify (DataType DType) queryDataType queryDataType5)
         (BroadcastShapesF queryShape queryShape5))
-&gt; Tensor
     queryGradient5 queryLayout5 queryDevice5 queryDataType5 queryShape5
-&gt; IxStateT
     m
     (Generator generatorDevice5)
     (Generator generatorDevice5)
     (Tensor
        (Or (Gradient RequiresGradient) queryGradient queryGradient5)
        (Unify (Layout LayoutType) queryLayout queryLayout5)
        (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
        (Unify (DataType DType) queryDataType queryDataType5)
        (BroadcastShapesF queryShape queryShape5))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679577195"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     queryGradient5 queryLayout5 queryDevice5 queryDataType5 queryShape5
-&gt; Tensor
     (queryGradient &lt;|&gt; queryGradient5)
     (queryLayout &lt;+&gt; queryLayout5)
     (queryDevice &lt;+&gt; queryDevice5)
     (queryDataType &lt;+&gt; queryDataType5)
     (BroadcastShapesF queryShape queryShape5)
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice5)
  (Tensor
     (Or (Gradient RequiresGradient) queryGradient queryGradient5)
     (Unify (Layout LayoutType) queryLayout queryLayout5)
     (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
     (Unify (DataType DType) queryDataType queryDataType5)
     (BroadcastShapesF queryShape queryShape5))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) queryGradient queryGradient5)
      (Unify (Layout LayoutType) queryLayout queryLayout5)
      (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
      (Unify (DataType DType) queryDataType queryDataType5)
      (BroadcastShapesF queryShape queryShape5)
    -&gt; IxStateT
         m
         (Generator generatorDevice5)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice5
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice5)
     (Generator generatorOutputDevice)
     output
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice5
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice5)
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor
      (Or (Gradient RequiresGradient) queryGradient queryGradient5)
      (Unify (Layout LayoutType) queryLayout queryLayout5)
      (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
      (Unify (DataType DType) queryDataType queryDataType5)
      (BroadcastShapesF queryShape queryShape5)
    -&gt; Generator generatorDevice5
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) queryGradient queryGradient5)
     (Unify (Layout LayoutType) queryLayout queryLayout5)
     (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
     (Unify (DataType DType) queryDataType queryDataType5)
     (BroadcastShapesF queryShape queryShape5)
-&gt; IxStateT
     m
     (Generator generatorDevice5)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">outputLayerNorm
-&gt; Tensor
     (Or (Gradient RequiresGradient) queryGradient queryGradient5)
     (Unify (Layout LayoutType) queryLayout queryLayout5)
     (Unify (Device (DeviceType Nat)) queryDevice queryDevice5)
     (Unify (DataType DType) queryDataType queryDataType5)
     (BroadcastShapesF queryShape queryShape5)
-&gt; Generator generatorDevice5
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">outputLayerNorm
</span><a href="#local-6989586621679577196"><span class="hs-identifier hs-var">ffnOutputLayerNorm</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-627"></span><span>
</span><span id="line-628"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#testFFN"><span class="hs-identifier hs-type">testFFN</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-629"></span><span id="testFFN"><span class="annot"><span class="annottext">testFFN :: IO
  (Tensor
     ('Gradient 'WithGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Float)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
           'Dim ('Name &quot;*&quot;) ('Size 3)]))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#testFFN"><span class="hs-identifier hs-var hs-var">testFFN</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-630"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679577193"><span class="annot"><span class="annottext">gradient :: SGradient ('Gradient 'WithGradient)
</span><a href="#local-6989586621679577193"><span class="hs-identifier hs-var hs-var">gradient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
-&gt; SGradient ('Gradient 'WithGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithGradient"><span class="hs-identifier hs-var">SWithGradient</span></a></span><span>
</span><span id="line-631"></span><span>      </span><span id="local-6989586621679577190"><span class="annot"><span class="annottext">device :: SDevice ('Device 'CPU)
</span><a href="#local-6989586621679577190"><span class="hs-identifier hs-var hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDeviceType 'CPU -&gt; SDevice ('Device 'CPU)
forall (deviceType :: DeviceType Nat).
SDeviceType deviceType -&gt; SDevice ('Device deviceType)
</span><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-var">SDevice</span></a></span><span> </span><span class="annot"><span class="annottext">SDeviceType 'CPU
</span><a href="Torch.GraduallyTyped.Device.html#SCPU"><span class="hs-identifier hs-var">SCPU</span></a></span><span>
</span><span id="line-632"></span><span>      </span><span id="local-6989586621679577187"><span class="annot"><span class="annottext">dataType :: SDataType ('DataType 'Float)
</span><a href="#local-6989586621679577187"><span class="hs-identifier hs-var hs-var">dataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDType 'Float -&gt; SDataType ('DataType 'Float)
forall (dType :: DType).
SDType dType -&gt; SDataType ('DataType dType)
</span><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-var">SDataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDType 'Float
</span><a href="Torch.GraduallyTyped.DType.html#SFloat"><span class="hs-identifier hs-var">SFloat</span></a></span><span>
</span><span id="line-633"></span><span>      </span><span id="local-6989586621679577184"><span class="annot"><span class="annottext">ffnDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
</span><a href="#local-6989586621679577184"><span class="hs-identifier hs-var hs-var">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 2) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 2 =&gt; SSize ('Size 2)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-634"></span><span>      </span><span id="local-6989586621679577181"><span class="annot"><span class="annottext">queryEmbedDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679577181"><span class="hs-identifier hs-var hs-var">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 3) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 3 =&gt; SSize ('Size 3)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">3</span></span><span>
</span><span id="line-635"></span><span>      </span><span id="local-6989586621679577180"><span class="annot"><span class="annottext">dropoutP :: Double
</span><a href="#local-6989586621679577180"><span class="hs-identifier hs-var hs-var">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-636"></span><span>      </span><span id="local-6989586621679577179"><span class="annot"><span class="annottext">eps :: Double
</span><a href="#local-6989586621679577179"><span class="hs-identifier hs-var hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-6</span></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679577178"><span class="annot"><span class="annottext">g :: Generator ('Device 'CPU)
</span><a href="#local-6989586621679577178"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU) -&gt; Word64 -&gt; Generator ('Device 'CPU)
forall (device :: Device (DeviceType Nat)).
SDevice device -&gt; Word64 -&gt; Generator device
</span><a href="Torch.GraduallyTyped.Random.html#sMkGenerator"><span class="hs-identifier hs-var">sMkGenerator</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679577190"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-638"></span><span>      </span><span id="local-6989586621679577177"><span class="annot"><span class="annottext">spec :: NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
</span><a href="#local-6989586621679577177"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ())
forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;ffn.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (NamedModel
      (LayerNormSpec
         'WithoutBias
         ('Gradient 'WithGradient)
         ('Device 'CPU)
         ('DataType 'Float)
         ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
   (GGate
      (NamedModel
         (GLinear
            (NamedModel
               (TensorSpec
                  ('Gradient 'WithGradient)
                  ('Layout 'Dense)
                  ('Device 'CPU)
                  ('DataType 'Float)
                  ('Shape
                     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
            (NamedModel ())))
      GeluNew
      (NamedModel
         (GLinear
            (NamedModel
               (TensorSpec
                  ('Gradient 'WithGradient)
                  ('Layout 'Dense)
                  ('Device 'CPU)
                  ('DataType 'Float)
                  ('Shape
                     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
            (NamedModel ()))))
   GeluNew
   Dropout
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               ('Gradient 'WithGradient)
               ('Layout 'Dense)
               ('Device 'CPU)
               ('DataType 'Float)
               ('Shape
                  '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
         (NamedModel ())))
   Dropout
   ()
 -&gt; NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNormSpec
               'WithoutBias
               ('Gradient 'WithGradient)
               ('Device 'CPU)
               ('DataType 'Float)
               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
         (GGate
            (NamedModel
               (GLinear
                  (NamedModel
                     (TensorSpec
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                  (NamedModel ())))
            GeluNew
            (NamedModel
               (GLinear
                  (NamedModel
                     (TensorSpec
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                  (NamedModel ()))))
         GeluNew
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     ('Gradient 'WithGradient)
                     ('Layout 'Dense)
                     ('Device 'CPU)
                     ('DataType 'Float)
                     ('Shape
                        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
               (NamedModel ())))
         Dropout
         ()))
-&gt; GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ()
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNormSpec
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (TensorSpec
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; SGradient ('Gradient 'WithGradient)
-&gt; SDevice ('Device 'CPU)
-&gt; SDataType ('DataType 'Float)
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
-&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerFeedForwardNetwork
        (FFNInputLayerNormF
           'ByT5
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Dim ('Name &quot;*&quot;) ('Size 3)))
        (FFNInputTransformationF
           'ByT5
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Dim ('Name &quot;*&quot;) ('Size 3))
           ('Dim ('Name &quot;*&quot;) ('Size 2)))
        (FFNActivationF 'ByT5)
        (FFNActivationDropoutF 'ByT5)
        (FFNOutputProjectionF
           'ByT5
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Dim ('Name &quot;*&quot;) ('Size 3))
           ('Dim ('Name &quot;*&quot;) ('Size 2)))
        (FFNOutputDropoutF 'ByT5)
        (FFNOutputLayerNormF
           'ByT5
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Dim ('Name &quot;*&quot;) ('Size 3))))
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformerFeedForwardNetwork
        (FFNInputLayerNormF style gradient device dataType queryEmbedDim)
        (FFNInputTransformationF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNOutputProjectionF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputDropoutF style)
        (FFNOutputLayerNormF style gradient device dataType queryEmbedDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GFeedForwardNetwork.html#transformerFeedForwardNetworkSpec"><span class="hs-identifier hs-var">transformerFeedForwardNetworkSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithGradient)
</span><a href="#local-6989586621679577193"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679577190"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Float)
</span><a href="#local-6989586621679577187"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679577181"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
</span><a href="#local-6989586621679577184"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577180"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679577179"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679577176"><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNorm
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
</span><a href="#local-6989586621679577176"><span class="hs-identifier hs-var">ffn</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679577175"><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679577175"><span class="hs-identifier hs-var">g'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ()))
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (NamedModel
        (GTransformerFeedForwardNetwork
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
           (GGate
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ())))
              GeluNew
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ()))))
           GeluNew
           Dropout
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                 (NamedModel ())))
           Dropout
           ()),
      Generator ('Device 'CPU))
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ()))
NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
</span><a href="#local-6989586621679577177"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679577178"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-640"></span><span>  </span><span id="local-6989586621679577174"><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNorm
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
</span><a href="#local-6989586621679577174"><span class="hs-identifier hs-var">ffn'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(StateT
   StateDict
   IO
   (NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNorm
               'WithoutBias
               ('Gradient 'WithGradient)
               ('Device 'CPU)
               ('DataType 'Float)
               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
         (GGate
            (NamedModel
               (GLinear
                  (NamedModel
                     (Tensor
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                  (NamedModel ())))
            GeluNew
            (NamedModel
               (GLinear
                  (NamedModel
                     (Tensor
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                  (NamedModel ()))))
         GeluNew
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (Tensor
                     ('Gradient 'WithGradient)
                     ('Layout 'Dense)
                     ('Device 'CPU)
                     ('DataType 'Float)
                     ('Shape
                        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
               (NamedModel ())))
         Dropout
         ()))
 -&gt; StateDict
 -&gt; IO
      (NamedModel
         (GTransformerFeedForwardNetwork
            (NamedModel
               (LayerNorm
                  'WithoutBias
                  ('Gradient 'WithGradient)
                  ('Device 'CPU)
                  ('DataType 'Float)
                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
            (GGate
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device 'CPU)
                           ('DataType 'Float)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                     (NamedModel ())))
               GeluNew
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device 'CPU)
                           ('DataType 'Float)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                     (NamedModel ()))))
            GeluNew
            Dropout
            (NamedModel
               (GLinear
                  (NamedModel
                     (Tensor
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                  (NamedModel ())))
            Dropout
            ())))
-&gt; StateDict
-&gt; StateT
     StateDict
     IO
     (NamedModel
        (GTransformerFeedForwardNetwork
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
           (GGate
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ())))
              GeluNew
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ()))))
           GeluNew
           Dropout
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                 (NamedModel ())))
           Dropout
           ()))
-&gt; IO
     (NamedModel
        (GTransformerFeedForwardNetwork
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
           (GGate
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ())))
              GeluNew
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ()))))
           GeluNew
           Dropout
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                 (NamedModel ())))
           Dropout
           ()))
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">StateT
  StateDict
  IO
  (NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ()))
-&gt; StateDict
-&gt; IO
     (NamedModel
        (GTransformerFeedForwardNetwork
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
           (GGate
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ())))
              GeluNew
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ()))))
           GeluNew
           Dropout
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                 (NamedModel ())))
           Dropout
           ()))
forall (m :: Type -&gt; Type) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m a
</span><span class="hs-identifier hs-var">evalStateT</span></span><span> </span><span class="annot"><span class="annottext">StateDict
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span> </span><span class="annot"><span class="annottext">(StateT
   StateDict
   IO
   (NamedModel
      (GTransformerFeedForwardNetwork
         (NamedModel
            (LayerNorm
               'WithoutBias
               ('Gradient 'WithGradient)
               ('Device 'CPU)
               ('DataType 'Float)
               ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
         (GGate
            (NamedModel
               (GLinear
                  (NamedModel
                     (Tensor
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                  (NamedModel ())))
            GeluNew
            (NamedModel
               (GLinear
                  (NamedModel
                     (Tensor
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                  (NamedModel ()))))
         GeluNew
         Dropout
         (NamedModel
            (GLinear
               (NamedModel
                  (Tensor
                     ('Gradient 'WithGradient)
                     ('Layout 'Dense)
                     ('Device 'CPU)
                     ('DataType 'Float)
                     ('Shape
                        '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
               (NamedModel ())))
         Dropout
         ()))
 -&gt; IO
      (NamedModel
         (GTransformerFeedForwardNetwork
            (NamedModel
               (LayerNorm
                  'WithoutBias
                  ('Gradient 'WithGradient)
                  ('Device 'CPU)
                  ('DataType 'Float)
                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
            (GGate
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device 'CPU)
                           ('DataType 'Float)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                     (NamedModel ())))
               GeluNew
               (NamedModel
                  (GLinear
                     (NamedModel
                        (Tensor
                           ('Gradient 'WithGradient)
                           ('Layout 'Dense)
                           ('Device 'CPU)
                           ('DataType 'Float)
                           ('Shape
                              '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                     (NamedModel ()))))
            GeluNew
            Dropout
            (NamedModel
               (GLinear
                  (NamedModel
                     (Tensor
                        ('Gradient 'WithGradient)
                        ('Layout 'Dense)
                        ('Device 'CPU)
                        ('DataType 'Float)
                        ('Shape
                           '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                  (NamedModel ())))
            Dropout
            ())))
-&gt; StateT
     StateDict
     IO
     (NamedModel
        (GTransformerFeedForwardNetwork
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
           (GGate
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ())))
              GeluNew
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ()))))
           GeluNew
           Dropout
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                 (NamedModel ())))
           Dropout
           ()))
-&gt; IO
     (NamedModel
        (GTransformerFeedForwardNetwork
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
           (GGate
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ())))
              GeluNew
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ()))))
           GeluNew
           Dropout
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                 (NamedModel ())))
           Dropout
           ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="annottext">StateDictKey
-&gt; NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ())
-&gt; StateT StateDict IO ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNorm
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
</span><a href="#local-6989586621679577176"><span class="hs-identifier hs-var">ffn</span></a></span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><span class="annottext">ModelSpec
  (NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ()))
-&gt; StateDictKey
-&gt; StateT
     StateDict
     IO
     (NamedModel
        (GTransformerFeedForwardNetwork
           (NamedModel
              (LayerNorm
                 'WithoutBias
                 ('Gradient 'WithGradient)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
           (GGate
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ())))
              GeluNew
              (NamedModel
                 (GLinear
                    (NamedModel
                       (Tensor
                          ('Gradient 'WithGradient)
                          ('Layout 'Dense)
                          ('Device 'CPU)
                          ('DataType 'Float)
                          ('Shape
                             '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                    (NamedModel ()))))
           GeluNew
           Dropout
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
                 (NamedModel ())))
           Dropout
           ()))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (NamedModel
     (GTransformerFeedForwardNetwork
        (NamedModel
           (LayerNorm
              'WithoutBias
              ('Gradient 'WithGradient)
              ('Device 'CPU)
              ('DataType 'Float)
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
        (GGate
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ())))
           GeluNew
           (NamedModel
              (GLinear
                 (NamedModel
                    (Tensor
                       ('Gradient 'WithGradient)
                       ('Layout 'Dense)
                       ('Device 'CPU)
                       ('DataType 'Float)
                       ('Shape
                          '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
                 (NamedModel ()))))
        GeluNew
        Dropout
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
              (NamedModel ())))
        Dropout
        ()))
NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNormSpec
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
</span><a href="#local-6989586621679577177"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679577171"><span class="annot"><span class="annottext">batchDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
</span><a href="#local-6989586621679577171"><span class="hs-identifier hs-var hs-var">batchDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 2) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 2 =&gt; SSize ('Size 2)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">2</span></span><span>
</span><span id="line-644"></span><span>      </span><span id="local-6989586621679577170"><span class="annot"><span class="annottext">seqDim :: SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
</span><a href="#local-6989586621679577170"><span class="hs-identifier hs-var hs-var">seqDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">KnownSymbol &quot;*&quot; =&gt; SName ('Name &quot;*&quot;)
forall (name :: Symbol). KnownSymbol name =&gt; SName ('Name name)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SName"><span class="hs-identifier hs-var">SName</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span> </span><span class="annot"><span class="annottext">SName ('Name &quot;*&quot;)
-&gt; SSize ('Size 1) -&gt; SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
forall (name :: Name Symbol) (size :: Size Nat).
SName name -&gt; SSize size -&gt; SDim ('Dim name size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%26%3A"><span class="hs-operator hs-var">:&amp;:</span></a></span><span> </span><span class="annot"><span class="annottext">KnownNat 1 =&gt; SSize ('Size 1)
forall (size :: Nat). KnownNat size =&gt; SSize ('Size size)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SSize"><span class="hs-identifier hs-var">SSize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-number">1</span></span><span>
</span><span id="line-645"></span><span>      </span><span id="local-6989586621679577169"><span class="annot"><span class="annottext">sOnes' :: SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679577169"><span class="hs-identifier hs-var hs-var">sOnes'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TensorSpec
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  dataType
  shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
TensorSpec gradient layout device dataType shape
-&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Creation.html#sOnes"><span class="hs-identifier hs-var">sOnes</span></a></span><span> </span><span class="annot"><span class="annottext">(TensorSpec
   ('Gradient 'WithoutGradient)
   ('Layout 'Dense)
   ('Device 'CPU)
   dataType
   shape
 -&gt; Tensor
      ('Gradient 'WithoutGradient)
      ('Layout 'Dense)
      ('Device 'CPU)
      dataType
      shape)
-&gt; (SShape shape
    -&gt; TensorSpec
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         dataType
         shape)
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((SShape shape
  -&gt; TensorSpec
       ('Gradient 'WithoutGradient)
       ('Layout 'Dense)
       ('Device 'CPU)
       dataType
       shape)
 -&gt; SShape shape
 -&gt; Tensor
      ('Gradient 'WithoutGradient)
      ('Layout 'Dense)
      ('Device 'CPU)
      dataType
      shape)
-&gt; (SDataType dataType
    -&gt; SShape shape
    -&gt; TensorSpec
         ('Gradient 'WithoutGradient)
         ('Layout 'Dense)
         ('Device 'CPU)
         dataType
         shape)
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SGradient ('Gradient 'WithoutGradient)
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice ('Device 'CPU)
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; TensorSpec
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape shape
-&gt; TensorSpec gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.Type.html#TensorSpec"><span class="hs-identifier hs-var">TensorSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
-&gt; SGradient ('Gradient 'WithoutGradient)
forall (requiresGradient :: RequiresGradient).
SRequiresGradient requiresGradient
-&gt; SGradient ('Gradient requiresGradient)
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-var">SGradient</span></a></span><span> </span><span class="annot"><span class="annottext">SRequiresGradient 'WithoutGradient
</span><a href="Torch.GraduallyTyped.RequiresGradient.html#SWithoutGradient"><span class="hs-identifier hs-var">SWithoutGradient</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice ('Device 'CPU)
</span><a href="#local-6989586621679577190"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-646"></span><span>      </span><span id="local-6989586621679577164"><span class="annot"><span class="annottext">query :: Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
        'Dim ('Name &quot;*&quot;) ('Size 3)])
</span><a href="#local-6989586621679577164"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Float)
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
           'Dim ('Name &quot;*&quot;) ('Size 3)])
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Float)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
           'Dim ('Name &quot;*&quot;) ('Size 3)])
forall (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
SDataType dataType
-&gt; SShape shape
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     dataType
     shape
</span><a href="#local-6989586621679577169"><span class="hs-identifier hs-var">sOnes'</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType ('DataType 'Float)
</span><a href="#local-6989586621679577187"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList
  '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
     'Dim ('Name &quot;*&quot;) ('Size 3)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
           'Dim ('Name &quot;*&quot;) ('Size 3)])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList
   '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
      'Dim ('Name &quot;*&quot;) ('Size 3)]
 -&gt; SShape
      ('Shape
         '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
            'Dim ('Name &quot;*&quot;) ('Size 3)]))
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
        'Dim ('Name &quot;*&quot;) ('Size 3)]
-&gt; SShape
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
           'Dim ('Name &quot;*&quot;) ('Size 3)])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
</span><a href="#local-6989586621679577171"><span class="hs-identifier hs-var">batchDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 2))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 3)]
-&gt; SList
     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
        'Dim ('Name &quot;*&quot;) ('Size 3)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
</span><a href="#local-6989586621679577170"><span class="hs-identifier hs-var">seqDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 1))
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3)]
-&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 1), 'Dim ('Name &quot;*&quot;) ('Size 3)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
</span><a href="#local-6989586621679577181"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ('Dim ('Name &quot;*&quot;) ('Size 3))
-&gt; SList '[] -&gt; SList '[ 'Dim ('Name &quot;*&quot;) ('Size 3)]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-647"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679577163"><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
        'Dim ('Name &quot;*&quot;) ('Size 3)])
</span><a href="#local-6989586621679577163"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNorm
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
-&gt; Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     ('Device 'CPU)
     ('DataType 'Float)
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
           'Dim ('Name &quot;*&quot;) ('Size 3)])
-&gt; Generator ('Device 'CPU)
-&gt; IO
     (Tensor
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Float)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
              'Dim ('Name &quot;*&quot;) ('Size 3)]),
      Generator ('Device 'CPU))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformerFeedForwardNetwork
     (NamedModel
        (LayerNorm
           'WithoutBias
           ('Gradient 'WithGradient)
           ('Device 'CPU)
           ('DataType 'Float)
           ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 3)])))
     (GGate
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ())))
        GeluNew
        (NamedModel
           (GLinear
              (NamedModel
                 (Tensor
                    ('Gradient 'WithGradient)
                    ('Layout 'Dense)
                    ('Device 'CPU)
                    ('DataType 'Float)
                    ('Shape
                       '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 3)])))
              (NamedModel ()))))
     GeluNew
     Dropout
     (NamedModel
        (GLinear
           (NamedModel
              (Tensor
                 ('Gradient 'WithGradient)
                 ('Layout 'Dense)
                 ('Device 'CPU)
                 ('DataType 'Float)
                 ('Shape
                    '[ 'Dim ('Name &quot;*&quot;) ('Size 3), 'Dim ('Name &quot;*&quot;) ('Size 2)])))
           (NamedModel ())))
     Dropout
     ())
</span><a href="#local-6989586621679577174"><span class="hs-identifier hs-var">ffn'</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithoutGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
        'Dim ('Name &quot;*&quot;) ('Size 3)])
</span><a href="#local-6989586621679577164"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Generator ('Device 'CPU)
</span><a href="#local-6989586621679577175"><span class="hs-identifier hs-var">g'</span></a></span><span>
</span><span id="line-648"></span><span>  </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
        'Dim ('Name &quot;*&quot;) ('Size 3)])
-&gt; IO
     (Tensor
        ('Gradient 'WithGradient)
        ('Layout 'Dense)
        ('Device 'CPU)
        ('DataType 'Float)
        ('Shape
           '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
              'Dim ('Name &quot;*&quot;) ('Size 3)]))
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  ('Gradient 'WithGradient)
  ('Layout 'Dense)
  ('Device 'CPU)
  ('DataType 'Float)
  ('Shape
     '[ 'Dim ('Name &quot;*&quot;) ('Size 2), 'Dim ('Name &quot;*&quot;) ('Size 1),
        'Dim ('Name &quot;*&quot;) ('Size 3)])
</span><a href="#local-6989586621679577163"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-649"></span></pre></body></html>