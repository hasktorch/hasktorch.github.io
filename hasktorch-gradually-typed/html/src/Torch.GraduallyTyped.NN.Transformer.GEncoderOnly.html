<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderOnly</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed.Trans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">IxMonadTrans</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ilift</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Data.Kind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">fromSing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">GHC.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Nat</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier">Symbol</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Sparse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier">Embedding</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier">EmbeddingSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GLMHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#GLMHeadF"><span class="hs-identifier">GLMHeadF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#lmHeadSpec"><span class="hs-identifier">lmHeadSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerEncoderF"><span class="hs-identifier">TransformerEncoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier">transformerEncoderSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier">HasDropout</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier">SHasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier">Catch</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier">forgetIsChecked</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.Maybe.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.TypeLits.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier">SNat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier">BroadcastShapesF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier">mulScalar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">Prelude</span></a></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Data type that is used to represent whether the encoder-only transformer model has a scaled embedding.</span><span>
</span><span id="line-50"></span><span id="local-6989586621679716532"><span id="local-6989586621679716533"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderOnlyTransformerHasEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerHasEmbedScaling</span></a></span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="EncoderOnlyTransformerWithEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithEmbedScaling</span></a></span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EncoderOnlyTransformerWithoutEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithoutEmbedScaling</span></a></span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679716526"><span id="local-6989586621679716528"><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
$c/= :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
== :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
$c== :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716506"><span id="local-6989586621679716508"><span id="local-6989586621679716511"><span id="local-6989586621679716514"><span id="local-6989586621679716517"><span id="local-6989586621679716519"><span id="local-6989586621679716521"><span class="annot"><span class="annottext">Eq EncoderOnlyTransformerHasEmbedScaling
EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Ordering
EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
$cmin :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
max :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
$cmax :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling
&gt;= :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
$c&gt;= :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
&gt; :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
$c&gt; :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
&lt;= :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
$c&lt;= :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
&lt; :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
$c&lt; :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Bool
compare :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Ordering
$ccompare :: EncoderOnlyTransformerHasEmbedScaling
-&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716499"><span id="local-6989586621679716501"><span id="local-6989586621679716503"><span class="annot"><span class="annottext">Int -&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; ShowS
[EncoderOnlyTransformerHasEmbedScaling] -&gt; ShowS
EncoderOnlyTransformerHasEmbedScaling -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EncoderOnlyTransformerHasEmbedScaling] -&gt; ShowS
$cshowList :: [EncoderOnlyTransformerHasEmbedScaling] -&gt; ShowS
show :: EncoderOnlyTransformerHasEmbedScaling -&gt; String
$cshow :: EncoderOnlyTransformerHasEmbedScaling -&gt; String
showsPrec :: Int -&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; ShowS
$cshowsPrec :: Int -&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x.
Rep EncoderOnlyTransformerHasEmbedScaling x
-&gt; EncoderOnlyTransformerHasEmbedScaling
forall x.
EncoderOnlyTransformerHasEmbedScaling
-&gt; Rep EncoderOnlyTransformerHasEmbedScaling x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x.
Rep EncoderOnlyTransformerHasEmbedScaling x
-&gt; EncoderOnlyTransformerHasEmbedScaling
$cfrom :: forall x.
EncoderOnlyTransformerHasEmbedScaling
-&gt; Rep EncoderOnlyTransformerHasEmbedScaling x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderOnlyTransformerHasEmbedScaling</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderOnlyTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679717401"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderOnlyTransformerHasEmbedScaling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717401"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderOnlyTransformerHasEmbedScaling</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717401"><span class="hs-identifier hs-type">generatorDevice</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679716485"><span class="annot"><span class="annottext">initialize :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
ModelSpec EncoderOnlyTransformerHasEmbedScaling
-&gt; Generator generatorDevice
-&gt; m (EncoderOnlyTransformerHasEmbedScaling,
      Generator generatorDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span id="local-6989586621679716483"><span class="annot"><span class="annottext">ModelSpec EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679716483"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span></span><span> </span><span id="local-6989586621679716482"><span class="annot"><span class="annottext">Generator generatorDevice
</span><a href="#local-6989586621679716482"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ModelSpec EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679716483"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Generator generatorDevice
</span><a href="#local-6989586621679716482"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderOnlyTransformerHasEmbedScaling</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679716471"><span class="annot"><span class="annottext">fromStateDict :: forall (m :: * -&gt; *).
(MonadIO m, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec EncoderOnlyTransformerHasEmbedScaling
-&gt; StateDictKey -&gt; m EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span id="local-6989586621679716469"><span class="annot"><span class="annottext">ModelSpec EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679716469"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679716469"><span class="hs-identifier hs-var">hasEmbedScaling</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span id="local-6989586621679716463"><span class="annot"><span class="annottext">toStateDict :: forall (m :: * -&gt; *).
(MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; EncoderOnlyTransformerHasEmbedScaling -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | Generic encoder-only transformer model.</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- This is a transformer model that only encodes the input, e.g. BERT.</span><span>
</span><span id="line-66"></span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span class="hs-comment">-- - @inputEmbedDim@: the dimension of the input embedding.</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- - @encoder@: a transformer encoder.</span><span>
</span><span id="line-69"></span><span class="hs-comment">-- - @encoderEmbedding@: an embedding layer for the input.</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- - @encoderTypeEmbedding@: an embedding layer for the type of the input.</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- - @head@: a head layer for the output.</span><span>
</span><span id="line-72"></span><span id="local-6989586621679716460"><span id="local-6989586621679716461"></span></span><span class="hs-keyword">data</span><span>
</span><span id="line-73"></span><span>  </span><span id="GEncoderOnlyTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-var">GEncoderOnlyTransformer</span></a></span></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717340"><span class="annot"><a href="#local-6989586621679717340"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717344"><span class="annot"><a href="#local-6989586621679717344"><span class="hs-identifier hs-type">encoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717343"><span class="annot"><a href="#local-6989586621679717343"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717342"><span class="annot"><a href="#local-6989586621679717342"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717341"><span class="annot"><a href="#local-6989586621679717341"><span class="hs-identifier hs-type">head</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-80"></span><span>  </span><span id="GEncoderOnlyTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-var">GEncoderOnlyTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679717380"><span class="annot"><a href="#local-6989586621679717380"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679717379"><span class="annot"><a href="#local-6989586621679717379"><span class="hs-identifier hs-type">encoder</span></a></span></span><span> </span><span id="local-6989586621679717378"><span class="annot"><a href="#local-6989586621679717378"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span></span><span> </span><span id="local-6989586621679717377"><span class="annot"><a href="#local-6989586621679717377"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span></span><span> </span><span id="local-6989586621679717376"><span class="annot"><a href="#local-6989586621679717376"><span class="hs-identifier hs-type">head</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | input embedding dim for scaling</span><span>
</span><span id="line-83"></span><span>      </span><span id="eotInputEmbedDim"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotInputEmbedDim"><span class="hs-identifier hs-var hs-var">eotInputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717380"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span>      </span><span class="hs-comment">-- | encoder</span><span>
</span><span id="line-85"></span><span>      </span><span id="eotEncoder"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; encoder
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotEncoder"><span class="hs-identifier hs-var hs-var">eotEncoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717379"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-86"></span><span>      </span><span class="hs-comment">-- | encoder embedding</span><span>
</span><span id="line-87"></span><span>      </span><span id="eotEmbedding"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; encoderEmbedding
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotEmbedding"><span class="hs-identifier hs-var hs-var">eotEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717378"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-88"></span><span>      </span><span class="hs-comment">-- | encoder type embedding</span><span>
</span><span id="line-89"></span><span>      </span><span id="eotTypeEmbedding"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; encoderTypeEmbedding
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotTypeEmbedding"><span class="hs-identifier hs-var hs-var">eotTypeEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717377"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>      </span><span class="hs-comment">-- | encoder head</span><span>
</span><span id="line-91"></span><span>      </span><span id="eotHead"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotHead"><span class="hs-identifier hs-var hs-var">eotHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717376"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>      </span><span class="hs-comment">-- | encoder embedding scaling</span><span>
</span><span id="line-93"></span><span>      </span><span id="eotEmbedScaling"><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotEmbedScaling"><span class="hs-identifier hs-var hs-var">eotEmbedScaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderOnlyTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-95"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717380"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717379"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717378"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717377"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717376"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679716438"><span id="local-6989586621679716440"><span id="local-6989586621679716451"><span class="annot"><span class="annottext">Int
-&gt; GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
(Show encoder, Show encoderEmbedding, Show encoderTypeEmbedding,
 Show head) =&gt;
Int
-&gt; GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; ShowS
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
(Show encoder, Show encoderEmbedding, Show encoderTypeEmbedding,
 Show head) =&gt;
[GEncoderOnlyTransformer
   inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head]
-&gt; ShowS
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
(Show encoder, Show encoderEmbedding, Show encoderTypeEmbedding,
 Show head) =&gt;
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; String
showList :: [GEncoderOnlyTransformer
   inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head]
-&gt; ShowS
$cshowList :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
(Show encoder, Show encoderEmbedding, Show encoderTypeEmbedding,
 Show head) =&gt;
[GEncoderOnlyTransformer
   inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head]
-&gt; ShowS
show :: GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; String
$cshow :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
(Show encoder, Show encoderEmbedding, Show encoderTypeEmbedding,
 Show head) =&gt;
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; String
showsPrec :: Int
-&gt; GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; ShowS
$cshowsPrec :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
(Show encoder, Show encoderEmbedding, Show encoderTypeEmbedding,
 Show head) =&gt;
Int
-&gt; GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head x.
Rep
  (GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head)
  x
-&gt; GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head x.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; Rep
     (GEncoderOnlyTransformer
        inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head)
     x
$cto :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head x.
Rep
  (GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head)
  x
-&gt; GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
$cfrom :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head x.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; Rep
     (GEncoderOnlyTransformer
        inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-99"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span id="local-6989586621679716431"><span id="local-6989586621679716432"><span id="local-6989586621679716433"><span id="local-6989586621679716434"><span id="local-6989586621679716435"><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716435"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716434"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716433"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716432"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716431"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-100"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716435"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716434"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716433"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716432"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716431"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-103"></span><span>  </span><span id="GEncoderOnlyTransformerF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformerF"><span class="hs-identifier hs-var">GEncoderOnlyTransformerF</span></a></span></span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716430"><span class="annot"><a href="#local-6989586621679716430"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716429"><span class="annot"><a href="#local-6989586621679716429"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716428"><span class="annot"><a href="#local-6989586621679716428"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716427"><span class="annot"><a href="#local-6989586621679716427"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716426"><span class="annot"><a href="#local-6989586621679716426"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716425"><span class="annot"><a href="#local-6989586621679716425"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716424"><span class="annot"><a href="#local-6989586621679716424"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716423"><span class="annot"><a href="#local-6989586621679716423"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716422"><span class="annot"><a href="#local-6989586621679716422"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716421"><span class="annot"><a href="#local-6989586621679716421"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716420"><span class="annot"><a href="#local-6989586621679716420"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716419"><span class="annot"><a href="#local-6989586621679716419"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716418"><span class="annot"><a href="#local-6989586621679716418"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716417"><span class="annot"><a href="#local-6989586621679716417"><span class="hs-identifier hs-type">typeVocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716416"><span class="annot"><a href="#local-6989586621679716416"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasDropout"><span class="hs-identifier hs-type">HasDropout</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-121"></span><span>  </span><span id="GEncoderOnlyTransformerF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformerF"><span class="hs-identifier hs-var">GEncoderOnlyTransformerF</span></a></span></span><span> </span><span id="local-6989586621679716401"><span id="local-6989586621679716402"><span id="local-6989586621679716403"><span id="local-6989586621679716404"><span id="local-6989586621679716405"><span id="local-6989586621679716406"><span id="local-6989586621679716407"><span id="local-6989586621679716408"><span id="local-6989586621679716409"><span id="local-6989586621679716410"><span id="local-6989586621679716411"><span id="local-6989586621679716412"><span id="local-6989586621679716413"><span id="local-6989586621679716414"><span id="local-6989586621679716415"><span class="annot"><a href="#local-6989586621679716415"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716414"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716413"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716412"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716411"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716410"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716409"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716408"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716407"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716406"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716405"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716404"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716403"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716402"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716401"><span class="hs-identifier hs-type">hasDropout</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="annot"><a href="#local-6989586621679716406"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TransformerEncoderF"><span class="hs-identifier hs-type">TransformerEncoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716415"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716413"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716412"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716411"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716410"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716409"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716408"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716407"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716406"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716405"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716404"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716401"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTEmbeddingF"><span class="hs-identifier hs-type">EOTEmbeddingF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716415"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716412"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716411"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716410"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716406"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716403"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTTypeEmbeddingF"><span class="hs-identifier hs-type">EOTTypeEmbeddingF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716415"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716412"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716411"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716410"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716406"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716402"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTHeadF"><span class="hs-identifier hs-type">EOTHeadF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716415"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716414"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716412"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716411"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716410"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716406"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716403"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Specifies the embedding layer of the encoder-only transformer model.</span><span>
</span><span id="line-130"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-131"></span><span>  </span><span id="EOTEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTEmbeddingF"><span class="hs-identifier hs-var">EOTEmbeddingF</span></a></span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716399"><span class="annot"><a href="#local-6989586621679716399"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716398"><span class="annot"><a href="#local-6989586621679716398"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716397"><span class="annot"><a href="#local-6989586621679716397"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716396"><span class="annot"><a href="#local-6989586621679716396"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716395"><span class="annot"><a href="#local-6989586621679716395"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716394"><span class="annot"><a href="#local-6989586621679716394"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-140"></span><span>  </span><span id="EOTEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTEmbeddingF"><span class="hs-identifier hs-var">EOTEmbeddingF</span></a></span></span><span> </span><span id="local-6989586621679716389"><span id="local-6989586621679716390"><span id="local-6989586621679716391"><span id="local-6989586621679716392"><span id="local-6989586621679716393"><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="#local-6989586621679716393"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716392"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716391"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716390"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716389"><span class="hs-identifier hs-type">vocabDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716393"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679716392"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716391"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716389"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716390"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-comment">-- | Specifies the type embedding layer of the encoder-only transformer model.</span><span>
</span><span id="line-144"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-145"></span><span>  </span><span id="EOTTypeEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTTypeEmbeddingF"><span class="hs-identifier hs-var">EOTTypeEmbeddingF</span></a></span></span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716388"><span class="annot"><a href="#local-6989586621679716388"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716387"><span class="annot"><a href="#local-6989586621679716387"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716386"><span class="annot"><a href="#local-6989586621679716386"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716385"><span class="annot"><a href="#local-6989586621679716385"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716384"><span class="annot"><a href="#local-6989586621679716384"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716383"><span class="annot"><a href="#local-6989586621679716383"><span class="hs-identifier hs-type">typeVocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-153"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-154"></span><span>  </span><span id="EOTTypeEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTTypeEmbeddingF"><span class="hs-identifier hs-var">EOTTypeEmbeddingF</span></a></span></span><span> </span><span id="local-6989586621679716378"><span id="local-6989586621679716379"><span id="local-6989586621679716380"><span id="local-6989586621679716381"><span id="local-6989586621679716382"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716382"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716381"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716380"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716379"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716378"><span class="hs-identifier hs-type">typeVocabDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716382"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679716381"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716380"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716378"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716379"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>  </span><span id="EOTTypeEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTTypeEmbeddingF"><span class="hs-identifier hs-var">EOTTypeEmbeddingF</span></a></span></span><span> </span><span id="local-6989586621679716373"><span id="local-6989586621679716374"><span id="local-6989586621679716375"><span id="local-6989586621679716376"><span id="local-6989586621679716377"><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716377"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716376"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716375"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716374"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716373"><span class="hs-identifier hs-type">typeVocabDim</span></a></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTTypeEmbeddingF"><span class="hs-identifier hs-type">EOTTypeEmbeddingF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716377"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716376"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716375"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716374"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716373"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- | Specifies the head layer of the encoder-only transformer model.</span><span>
</span><span id="line-160"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-161"></span><span>  </span><span id="EOTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTHeadF"><span class="hs-identifier hs-var">EOTHeadF</span></a></span></span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716372"><span class="annot"><a href="#local-6989586621679716372"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716371"><span class="annot"><a href="#local-6989586621679716371"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716370"><span class="annot"><a href="#local-6989586621679716370"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716369"><span class="annot"><a href="#local-6989586621679716369"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716368"><span class="annot"><a href="#local-6989586621679716368"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716367"><span class="annot"><a href="#local-6989586621679716367"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679716366"><span class="annot"><a href="#local-6989586621679716366"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Symbol</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-type">Nat</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-171"></span><span>  </span><span id="EOTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTHeadF"><span class="hs-identifier hs-var">EOTHeadF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithoutHead"><span class="hs-identifier hs-type">WithoutHead</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>  </span><span id="EOTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTHeadF"><span class="hs-identifier hs-var">EOTHeadF</span></a></span></span><span> </span><span id="local-6989586621679716360"><span id="local-6989586621679716361"><span id="local-6989586621679716362"><span id="local-6989586621679716363"><span id="local-6989586621679716364"><span id="local-6989586621679716365"><span class="annot"><a href="#local-6989586621679716365"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithLMHead"><span class="hs-identifier hs-type">WithLMHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716361"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716360"><span class="hs-identifier hs-type">vocabDim</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#GLMHeadF"><span class="hs-identifier hs-type">GLMHeadF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716365"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716364"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716363"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716362"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716361"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716360"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Specifies the parameters of an encoder-only transformer model.</span><span>
</span><span id="line-177"></span><span class="hs-comment">--</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- - @style@: the style of the encoder-only transformer model, e.g. 'SBERT', 'SRoBERTa', etc.</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- - @transformerHead@: the head of the encoder-only transformer model.</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- - @numLayers@: the number of layers of the encoder-only transformer model.</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the model parameters</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- - @device@: the computational device on which the model is allocated.</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- - @dataType@: the data type of the model parameters.</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- - @headDim@: the dimension of all transformer heads in the encoder-only transformer model.</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- - @headEmbedDim@: the dimension of the transformer head embeddings.</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- - @embedDim@: the dimension of the transformer embeddings.</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- - @inputEmbedDim@: the dimension of the input embeddings.</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- - @ffnDim@: the dimension of the feed-forward network.</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- - @posEncDim@: the dimension of the positional embeddings.</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- - @vocabDim@: the dimension of the vocabulary.</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- - @typeVocabDim@: the dimension of the type vocabulary.</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- - @dropoutP@: the dropout rate.</span><span>
</span><span id="line-193"></span><span class="hs-comment">-- - @eps@: the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-194"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#encoderOnlyTransformerSpec"><span class="hs-identifier hs-type">encoderOnlyTransformerSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-195"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679717332"><span class="annot"><a href="#local-6989586621679717332"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679717330"><span class="annot"><a href="#local-6989586621679717330"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679717328"><span class="annot"><a href="#local-6989586621679717328"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679717326"><span class="annot"><a href="#local-6989586621679717326"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679717324"><span class="annot"><a href="#local-6989586621679717324"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679717322"><span class="annot"><a href="#local-6989586621679717322"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679717320"><span class="annot"><a href="#local-6989586621679717320"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679717319"><span class="annot"><a href="#local-6989586621679717319"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679717318"><span class="annot"><a href="#local-6989586621679717318"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679717317"><span class="annot"><a href="#local-6989586621679717317"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679717316"><span class="annot"><a href="#local-6989586621679717316"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679717315"><span class="annot"><a href="#local-6989586621679717315"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679717314"><span class="annot"><a href="#local-6989586621679717314"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679717313"><span class="annot"><a href="#local-6989586621679717313"><span class="hs-identifier hs-type">typeVocabDim</span></a></span></span><span> </span><span id="local-6989586621679717312"><span class="annot"><a href="#local-6989586621679717312"><span class="hs-identifier hs-type">hasDropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717332"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717330"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717328"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717326"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717324"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717322"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717320"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717319"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717318"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717317"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717316"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717315"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717314"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717313"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasDropout"><span class="hs-identifier hs-type">SHasDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717312"><span class="hs-identifier hs-type">hasDropout</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformerF"><span class="hs-identifier hs-type">GEncoderOnlyTransformerF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717332"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717330"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717328"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717326"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717324"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717322"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717320"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717319"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717318"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717317"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717316"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717315"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717314"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717313"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717312"><span class="hs-identifier hs-type">hasDropout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span id="encoderOnlyTransformerSpec"><span class="annot"><span class="annottext">encoderOnlyTransformerSpec :: forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat))
       (typeVocabDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; SDim typeVocabDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderOnlyTransformerF
        style
        transformerHead
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        posEncDim
        vocabDim
        typeVocabDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#encoderOnlyTransformerSpec"><span class="hs-identifier hs-var hs-var">encoderOnlyTransformerSpec</span></a></span></span><span> </span><span id="local-6989586621679716358"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716358"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679716357"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679716357"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679716356"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679716356"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679716355"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679716355"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679716354"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679716354"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679716353"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679716353"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679716352"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679716352"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679716351"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679716351"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679716350"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679716350"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679716349"><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679716349"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679716348"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679716348"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679716347"><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679716347"><span class="hs-identifier hs-var">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679716346"><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679716346"><span class="hs-identifier hs-var">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679716345"><span class="annot"><span class="annottext">SDim typeVocabDim
</span><a href="#local-6989586621679716345"><span class="hs-identifier hs-var">typeVocabDim</span></a></span></span><span> </span><span id="local-6989586621679716344"><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679716344"><span class="hs-identifier hs-var">hasDropout</span></a></span></span><span> </span><span id="local-6989586621679716343"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679716343"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679716342"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679716342"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679716341"><span class="annot"><span class="annottext">encoderSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TERelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEInitialDropoutF style hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (SADropoutF style hasDropout)
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style hasDropout)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNOutputDropoutF style hasDropout)
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEFinalDropoutF style hasDropout)))
</span><a href="#local-6989586621679716341"><span class="hs-identifier hs-var hs-var">encoderSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="annot"><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-217"></span><span>      </span><span class="annot"><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-219"></span><span>      </span><span class="annot"><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-220"></span><span>      </span><span class="annot"><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;bert.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679716314"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;roberta.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679716314"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="annot"><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span id="local-6989586621679716306"><span class="annot"><span class="annottext">embeddingSpec :: STransformerStyle style
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
</span><a href="#local-6989586621679716306"><span class="hs-identifier hs-var hs-var">embeddingSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="annot"><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;bert.embeddings.word_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679716288"><span class="hs-identifier hs-var">embeddingSpec'</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;roberta.embeddings.word_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679716288"><span class="hs-identifier hs-var">embeddingSpec'</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span id="local-6989586621679716282"><span class="annot"><span class="annottext">typeEmbeddingSpec :: STransformerStyle style
-&gt; ModelSpec
     (EOTTypeEmbeddingF
        style gradient device dataType inputEmbedDim typeVocabDim)
</span><a href="#local-6989586621679716282"><span class="hs-identifier hs-var hs-var">typeEmbeddingSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-236"></span><span>      </span><span class="annot"><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;bert.embeddings.token_type_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  typeVocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679716264"><span class="hs-identifier hs-var">typeEmbeddingSpec'</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;roberta.embeddings.token_type_embeddings.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  typeVocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679716264"><span class="hs-identifier hs-var">typeEmbeddingSpec'</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span id="local-6989586621679716258"><span class="annot"><span class="annottext">headSpec :: STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; ModelSpec
     (EOTHeadF
        style
        transformerHead
        gradient
        device
        dataType
        inputEmbedDim
        vocabDim)
</span><a href="#local-6989586621679716258"><span class="hs-identifier hs-var hs-var">headSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-244"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;cls.predictions.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679716235"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BERT
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall model. StateDictKey -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;lm_head.&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall {style :: TransformerStyle}.
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679716235"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-type">embedScalingSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717332"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderOnlyTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span id="local-6989586621679716226"><span class="annot"><span class="annottext">embedScalingSpec :: STransformerStyle style -&gt; EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679716226"><span class="hs-identifier hs-var hs-var">embedScalingSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">undefined</span></a></span><span>
</span><span id="line-258"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
SDim inputEmbedDim
-&gt; encoder
-&gt; encoderEmbedding
-&gt; encoderTypeEmbedding
-&gt; head
-&gt; EncoderOnlyTransformerHasEmbedScaling
-&gt; GEncoderOnlyTransformer
     inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-var">GEncoderOnlyTransformer</span></a></span><span>
</span><span id="line-259"></span><span>        </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679716349"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span>
</span><span id="line-260"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TERelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEInitialDropoutF style hasDropout))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                (DropoutF style hasDropout)))
                          (SADropoutF style hasDropout)
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style hasDropout)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNOutputDropoutF style hasDropout)
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEFinalDropoutF style hasDropout)))
</span><a href="#local-6989586621679716341"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716358"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
</span><a href="#local-6989586621679716306"><span class="hs-identifier hs-var">embeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716358"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; ModelSpec
     (EOTTypeEmbeddingF
        style gradient device dataType inputEmbedDim typeVocabDim)
</span><a href="#local-6989586621679716282"><span class="hs-identifier hs-var">typeEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716358"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; ModelSpec
     (EOTHeadF
        style
        transformerHead
        gradient
        device
        dataType
        inputEmbedDim
        vocabDim)
</span><a href="#local-6989586621679716258"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716358"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679716357"><span class="hs-identifier hs-var">transformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679716226"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716358"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="#local-6989586621679716314"><span class="hs-identifier hs-type">encoderSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621679716314"><span class="annot"><span class="annottext">encoderSpec' :: STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style hasDropout))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             (DropoutF style hasDropout)))
                       (SADropoutF style hasDropout)
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style hasDropout)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNOutputDropoutF style hasDropout)
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style hasDropout))
</span><a href="#local-6989586621679716314"><span class="hs-identifier hs-var hs-var">encoderSpec'</span></a></span></span><span> </span><span id="local-6989586621679716205"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716205"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (hasDropout :: HasDropout).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SHasDropout hasDropout
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (TransformerEncoderF
        style
        numLayers
        gradient
        device
        dataType
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        posEncDim
        hasDropout)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier hs-var">transformerEncoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716205"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679716356"><span class="hs-identifier hs-var">numLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679716355"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679716354"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679716353"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679716352"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679716351"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679716350"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679716349"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679716348"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679716347"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">SHasDropout hasDropout
</span><a href="#local-6989586621679716344"><span class="hs-identifier hs-var">hasDropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679716343"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679716342"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621679716288"><span class="annot"><span class="annottext">embeddingSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679716288"><span class="hs-identifier hs-var hs-var">embeddingSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679716355"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679716354"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679716353"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679716346"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679716349"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679716264"><span class="annot"><span class="annottext">typeEmbeddingSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  typeVocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679716264"><span class="hs-identifier hs-var hs-var">typeEmbeddingSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679716355"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679716354"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679716353"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim typeVocabDim
</span><a href="#local-6989586621679716345"><span class="hs-identifier hs-var">typeVocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679716349"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/cmxygbwkg9vwm5iizgff5i2x5awqcjjn-singletons-base-lib-singletons-base-3.1-haddock-doc/share/doc/singletons-base/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="#local-6989586621679716235"><span class="hs-identifier hs-type">headSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679716235"><span class="annot"><span class="annottext">headSpec' :: STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679716235"><span class="hs-identifier hs-var hs-var">headSpec'</span></a></span></span><span> </span><span id="local-6989586621679716201"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716201"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputEmbedDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; ModelSpec
     (GLMHeadF style gradient device dataType inputEmbedDim vocabDim)
</span><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#lmHeadSpec"><span class="hs-identifier hs-var">lmHeadSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679716201"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679716355"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679716354"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679716353"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679716349"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679716346"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679716342"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-274"></span><span>  </span><span id="local-6989586621679716199"><span id="local-6989586621679717179"><span id="local-6989586621679717180"><span id="local-6989586621679717181"><span id="local-6989586621679717182"><span id="local-6989586621679717183"><span id="local-6989586621679717184"><span id="local-6989586621679717185"><span id="local-6989586621679717186"><span id="local-6989586621679717187"><span id="local-6989586621679717188"><span id="local-6989586621679717189"><span id="local-6989586621679717190"><span id="local-6989586621679717191"><span id="local-6989586621679717192"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717192"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717191"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717190"><span class="hs-identifier hs-type">encoder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717189"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717188"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717189"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717187"><span class="hs-identifier hs-type">encoderEmbedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717186"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717185"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717186"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717184"><span class="hs-identifier hs-type">encoderTypeEmbedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717183"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-277"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717182"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717183"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717181"><span class="hs-identifier hs-type">head'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717180"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-279"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717179"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717192"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717188"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717185"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717182"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><a href="#local-6989586621679717191"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717179"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717190"><span class="hs-identifier hs-type">encoder'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717187"><span class="hs-identifier hs-type">encoderEmbedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717184"><span class="hs-identifier hs-type">encoderTypeEmbedding'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717181"><span class="hs-identifier hs-type">head'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="#local-6989586621679717180"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621679716195"><span id="local-6989586621679716197"><span id="local-6989586621679717174"><span id="local-6989586621679717175"><span id="local-6989586621679717176"><span id="local-6989586621679717177"><span id="local-6989586621679717178"><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717178"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717177"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717176"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717175"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717174"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717178"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717177"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717176"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717175"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span id="local-6989586621679716193"><span id="local-6989586621679716194"></span></span><span class="hs-keyword">data</span><span>
</span><span id="line-290"></span><span>  </span><span id="GSimplifiedEncoderOnlyTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderOnlyTransformer</span></a></span></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717149"><span class="annot"><a href="#local-6989586621679717149"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717148"><span class="annot"><a href="#local-6989586621679717148"><span class="hs-identifier hs-type">mkPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717147"><span class="annot"><a href="#local-6989586621679717147"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679717146"><span class="annot"><a href="#local-6989586621679717146"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-296"></span><span>  </span><span id="GSimplifiedEncoderOnlyTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderOnlyTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-297"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679717169"><span class="annot"><a href="#local-6989586621679717169"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span id="local-6989586621679717168"><span class="annot"><a href="#local-6989586621679717168"><span class="hs-identifier hs-type">mkPos</span></a></span></span><span> </span><span id="local-6989586621679717167"><span class="annot"><a href="#local-6989586621679717167"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span></span><span> </span><span id="local-6989586621679717166"><span class="annot"><a href="#local-6989586621679717166"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | encoder-only model</span><span>
</span><span id="line-299"></span><span>      </span><span id="seotModel"><span class="annot"><span class="annottext">forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; model
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#seotModel"><span class="hs-identifier hs-var hs-var">seotModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717169"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-300"></span><span>      </span><span class="hs-comment">-- | make input positions</span><span>
</span><span id="line-301"></span><span>      </span><span id="seotMkPos"><span class="annot"><span class="annottext">forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; mkPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#seotMkPos"><span class="hs-identifier hs-var hs-var">seotMkPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717168"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-302"></span><span>      </span><span class="hs-comment">-- | make padding mask</span><span>
</span><span id="line-303"></span><span>      </span><span id="seotMkPaddingMask"><span class="annot"><span class="annottext">forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; mkPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#seotMkPaddingMask"><span class="hs-identifier hs-var hs-var">seotMkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717167"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>      </span><span class="hs-comment">-- | make attention mask</span><span>
</span><span id="line-305"></span><span>      </span><span id="seotMkAttentionMask"><span class="annot"><span class="annottext">forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; mkAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#seotMkAttentionMask"><span class="hs-identifier hs-var hs-var">seotMkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717166"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717169"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717168"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717167"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717166"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679716180"><span id="local-6989586621679716186"><span class="annot"><span class="annottext">GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall model mkPos mkPaddingMask mkAttentionMask.
(Eq model, Eq mkPos, Eq mkPaddingMask, Eq mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
/= :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
$c/= :: forall model mkPos mkPaddingMask mkAttentionMask.
(Eq model, Eq mkPos, Eq mkPaddingMask, Eq mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
== :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
$c== :: forall model mkPos mkPaddingMask mkAttentionMask.
(Eq model, Eq mkPos, Eq mkPaddingMask, Eq mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716153"><span id="local-6989586621679716155"><span id="local-6989586621679716158"><span id="local-6989586621679716161"><span id="local-6989586621679716164"><span id="local-6989586621679716170"><span id="local-6989586621679716176"><span class="annot"><span class="annottext">GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {model} {mkPos} {mkPaddingMask} {mkAttentionMask}.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
Eq
  (GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask)
forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Ordering
forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
min :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
$cmin :: forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
max :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
$cmax :: forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
&gt;= :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
$c&gt;= :: forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
&gt; :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
$c&gt; :: forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
&lt;= :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
$c&lt;= :: forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
&lt; :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
$c&lt; :: forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Bool
compare :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Ordering
$ccompare :: forall model mkPos mkPaddingMask mkAttentionMask.
(Ord model, Ord mkPos, Ord mkPaddingMask, Ord mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716142"><span id="local-6989586621679716144"><span id="local-6989586621679716151"><span class="annot"><span class="annottext">Int
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall model mkPos mkPaddingMask mkAttentionMask.
(Show model, Show mkPos, Show mkPaddingMask,
 Show mkAttentionMask) =&gt;
Int
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; ShowS
forall model mkPos mkPaddingMask mkAttentionMask.
(Show model, Show mkPos, Show mkPaddingMask,
 Show mkAttentionMask) =&gt;
[GSimplifiedEncoderOnlyTransformer
   model mkPos mkPaddingMask mkAttentionMask]
-&gt; ShowS
forall model mkPos mkPaddingMask mkAttentionMask.
(Show model, Show mkPos, Show mkPaddingMask,
 Show mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; String
showList :: [GSimplifiedEncoderOnlyTransformer
   model mkPos mkPaddingMask mkAttentionMask]
-&gt; ShowS
$cshowList :: forall model mkPos mkPaddingMask mkAttentionMask.
(Show model, Show mkPos, Show mkPaddingMask,
 Show mkAttentionMask) =&gt;
[GSimplifiedEncoderOnlyTransformer
   model mkPos mkPaddingMask mkAttentionMask]
-&gt; ShowS
show :: GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; String
$cshow :: forall model mkPos mkPaddingMask mkAttentionMask.
(Show model, Show mkPos, Show mkPaddingMask,
 Show mkAttentionMask) =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; String
showsPrec :: Int
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; ShowS
$cshowsPrec :: forall model mkPos mkPaddingMask mkAttentionMask.
(Show model, Show mkPos, Show mkPaddingMask,
 Show mkAttentionMask) =&gt;
Int
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall model mkPos mkPaddingMask mkAttentionMask x.
Rep
  (GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask)
  x
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
forall model mkPos mkPaddingMask mkAttentionMask x.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; Rep
     (GSimplifiedEncoderOnlyTransformer
        model mkPos mkPaddingMask mkAttentionMask)
     x
$cto :: forall model mkPos mkPaddingMask mkAttentionMask x.
Rep
  (GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask)
  x
-&gt; GSimplifiedEncoderOnlyTransformer
     model mkPos mkPaddingMask mkAttentionMask
$cfrom :: forall model mkPos mkPaddingMask mkAttentionMask x.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; Rep
     (GSimplifiedEncoderOnlyTransformer
        model mkPos mkPaddingMask mkAttentionMask)
     x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>
</span><span id="line-310"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-311"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span id="local-6989586621679716136"><span id="local-6989586621679716137"><span id="local-6989586621679716138"><span id="local-6989586621679716139"><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716139"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716138"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716137"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716136"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716139"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716138"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716137"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716136"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-315"></span><span>  </span><span id="local-6989586621679716134"><span id="local-6989586621679717133"><span id="local-6989586621679717134"><span id="local-6989586621679717135"><span id="local-6989586621679717136"><span id="local-6989586621679717137"><span id="local-6989586621679717138"><span id="local-6989586621679717139"><span id="local-6989586621679717140"><span id="local-6989586621679717141"><span id="local-6989586621679717142"><span id="local-6989586621679717143"><span id="local-6989586621679717144"><span id="local-6989586621679717145"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717145"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717144"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717143"><span class="hs-identifier hs-type">model'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717142"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717141"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717142"><span class="hs-identifier hs-type">generatorDevice0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717140"><span class="hs-identifier hs-type">mkPos'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717139"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717138"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717139"><span class="hs-identifier hs-type">generatorDevice1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717137"><span class="hs-identifier hs-type">mkPaddingMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717136"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717135"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717136"><span class="hs-identifier hs-type">generatorDevice2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717134"><span class="hs-identifier hs-type">mkAttentionMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717133"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717145"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717141"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717138"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717135"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="#local-6989586621679717144"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717143"><span class="hs-identifier hs-type">model'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717140"><span class="hs-identifier hs-type">mkPos'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717137"><span class="hs-identifier hs-type">mkPaddingMask'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717134"><span class="hs-identifier hs-type">mkAttentionMask'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>    </span><span class="annot"><a href="#local-6989586621679717133"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-325"></span><span>
</span><span id="line-326"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-327"></span><span>  </span><span id="local-6989586621679716130"><span id="local-6989586621679716132"><span id="local-6989586621679717129"><span id="local-6989586621679717130"><span id="local-6989586621679717131"><span id="local-6989586621679717132"><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717132"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717131"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717130"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717129"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-328"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717132"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717131"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717130"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717129"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- | Input data type for use with an encoder-only transformer.</span><span>
</span><span id="line-331"></span><span id="local-6989586621679716128"><span id="local-6989586621679716129"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderOnlyTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-var">EncoderOnlyTransformerInput</span></a></span></span><span> </span><span id="local-6989586621679717104"><span class="annot"><a href="#local-6989586621679717104"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679717103"><span class="annot"><a href="#local-6989586621679717103"><span class="hs-identifier hs-type">inputType</span></a></span></span><span> </span><span id="local-6989586621679717102"><span class="annot"><a href="#local-6989586621679717102"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679717101"><span class="annot"><a href="#local-6989586621679717101"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-332"></span><span>  </span><span id="EncoderOnlyTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-var">EncoderOnlyTransformerInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679717124"><span class="annot"><a href="#local-6989586621679717124"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679717123"><span class="annot"><a href="#local-6989586621679717123"><span class="hs-identifier hs-type">inputType</span></a></span></span><span> </span><span id="local-6989586621679717122"><span class="annot"><a href="#local-6989586621679717122"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679717121"><span class="annot"><a href="#local-6989586621679717121"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="eotInput"><span class="annot"><span class="annottext">forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotInput"><span class="hs-identifier hs-var hs-var">eotInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717124"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-335"></span><span>      </span><span id="eotInputType"><span class="annot"><span class="annottext">forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; inputType
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotInputType"><span class="hs-identifier hs-var hs-var">eotInputType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717123"><span class="hs-identifier hs-type">inputType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-336"></span><span>      </span><span id="eotPos"><span class="annot"><span class="annottext">forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; pos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotPos"><span class="hs-identifier hs-var hs-var">eotPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717122"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-337"></span><span>      </span><span id="eotAttentionMask"><span class="annot"><span class="annottext">forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotAttentionMask"><span class="hs-identifier hs-var hs-var">eotAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717121"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-339"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-type">EncoderOnlyTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717124"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717123"><span class="hs-identifier hs-type">inputType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717122"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717121"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679716115"><span id="local-6989586621679716121"><span class="annot"><span class="annottext">EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall input inputType pos attentionMask.
(Eq input, Eq inputType, Eq pos, Eq attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
/= :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
$c/= :: forall input inputType pos attentionMask.
(Eq input, Eq inputType, Eq pos, Eq attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
== :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
$c== :: forall input inputType pos attentionMask.
(Eq input, Eq inputType, Eq pos, Eq attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716088"><span id="local-6989586621679716090"><span id="local-6989586621679716093"><span id="local-6989586621679716096"><span id="local-6989586621679716099"><span id="local-6989586621679716105"><span id="local-6989586621679716111"><span class="annot"><span class="annottext">EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {input} {inputType} {pos} {attentionMask}.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
Eq (EncoderOnlyTransformerInput input inputType pos attentionMask)
forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Ordering
forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
min :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
$cmin :: forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
max :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
$cmax :: forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
&gt;= :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
$c&gt;= :: forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
&gt; :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
$c&gt; :: forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
&lt;= :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
$c&lt;= :: forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
&lt; :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
$c&lt; :: forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Bool
compare :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Ordering
$ccompare :: forall input inputType pos attentionMask.
(Ord input, Ord inputType, Ord pos, Ord attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716077"><span id="local-6989586621679716079"><span id="local-6989586621679716086"><span class="annot"><span class="annottext">Int
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall input inputType pos attentionMask.
(Show input, Show inputType, Show pos, Show attentionMask) =&gt;
Int
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; ShowS
forall input inputType pos attentionMask.
(Show input, Show inputType, Show pos, Show attentionMask) =&gt;
[EncoderOnlyTransformerInput input inputType pos attentionMask]
-&gt; ShowS
forall input inputType pos attentionMask.
(Show input, Show inputType, Show pos, Show attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; String
showList :: [EncoderOnlyTransformerInput input inputType pos attentionMask]
-&gt; ShowS
$cshowList :: forall input inputType pos attentionMask.
(Show input, Show inputType, Show pos, Show attentionMask) =&gt;
[EncoderOnlyTransformerInput input inputType pos attentionMask]
-&gt; ShowS
show :: EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; String
$cshow :: forall input inputType pos attentionMask.
(Show input, Show inputType, Show pos, Show attentionMask) =&gt;
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; String
showsPrec :: Int
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; ShowS
$cshowsPrec :: forall input inputType pos attentionMask.
(Show input, Show inputType, Show pos, Show attentionMask) =&gt;
Int
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall input inputType pos attentionMask x.
Rep
  (EncoderOnlyTransformerInput input inputType pos attentionMask) x
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
forall input inputType pos attentionMask x.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Rep
     (EncoderOnlyTransformerInput input inputType pos attentionMask) x
$cto :: forall input inputType pos attentionMask x.
Rep
  (EncoderOnlyTransformerInput input inputType pos attentionMask) x
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
$cfrom :: forall input inputType pos attentionMask x.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Rep
     (EncoderOnlyTransformerInput input inputType pos attentionMask) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>
</span><span id="line-342"></span><span id="local-6989586621679716072"><span id="local-6989586621679716073"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderOnlyTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderOnlyTransformerInput</span></a></span></span><span> </span><span id="local-6989586621679717092"><span class="annot"><a href="#local-6989586621679717092"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679717091"><span class="annot"><a href="#local-6989586621679717091"><span class="hs-identifier hs-type">inputType</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-343"></span><span>  </span><span id="SimplifiedEncoderOnlyTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderOnlyTransformerInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679717098"><span class="annot"><a href="#local-6989586621679717098"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679717097"><span class="annot"><a href="#local-6989586621679717097"><span class="hs-identifier hs-type">inputType</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-345"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="seotInput"><span class="annot"><span class="annottext">forall input inputType.
SimplifiedEncoderOnlyTransformerInput input inputType -&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#seotInput"><span class="hs-identifier hs-var hs-var">seotInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717098"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-346"></span><span>      </span><span id="seotInputType"><span class="annot"><span class="annottext">forall input inputType.
SimplifiedEncoderOnlyTransformerInput input inputType -&gt; inputType
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#seotInputType"><span class="hs-identifier hs-var hs-var">seotInputType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717097"><span class="hs-identifier hs-type">inputType</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderOnlyTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717098"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717097"><span class="hs-identifier hs-type">inputType</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679716063"><span id="local-6989586621679716067"><span class="annot"><span class="annottext">SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall input inputType.
(Eq input, Eq inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
/= :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
$c/= :: forall input inputType.
(Eq input, Eq inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
== :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
$c== :: forall input inputType.
(Eq input, Eq inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716040"><span id="local-6989586621679716042"><span id="local-6989586621679716045"><span id="local-6989586621679716048"><span id="local-6989586621679716051"><span id="local-6989586621679716055"><span id="local-6989586621679716059"><span class="annot"><span class="annottext">SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {input} {inputType}.
(Ord input, Ord inputType) =&gt;
Eq (SimplifiedEncoderOnlyTransformerInput input inputType)
forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; Ordering
forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
min :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
$cmin :: forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
max :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
$cmax :: forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
&gt;= :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
$c&gt;= :: forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
&gt; :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
$c&gt; :: forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
&lt;= :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
$c&lt;= :: forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
&lt; :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
$c&lt; :: forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; Bool
compare :: SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; Ordering
$ccompare :: forall input inputType.
(Ord input, Ord inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679716031"><span id="local-6989586621679716033"><span id="local-6989586621679716038"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall input inputType.
(Show input, Show inputType) =&gt;
Int
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; ShowS
forall input inputType.
(Show input, Show inputType) =&gt;
[SimplifiedEncoderOnlyTransformerInput input inputType] -&gt; ShowS
forall input inputType.
(Show input, Show inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType -&gt; String
showList :: [SimplifiedEncoderOnlyTransformerInput input inputType] -&gt; ShowS
$cshowList :: forall input inputType.
(Show input, Show inputType) =&gt;
[SimplifiedEncoderOnlyTransformerInput input inputType] -&gt; ShowS
show :: SimplifiedEncoderOnlyTransformerInput input inputType -&gt; String
$cshow :: forall input inputType.
(Show input, Show inputType) =&gt;
SimplifiedEncoderOnlyTransformerInput input inputType -&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; ShowS
$cshowsPrec :: forall input inputType.
(Show input, Show inputType) =&gt;
Int
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall input inputType x.
Rep (SimplifiedEncoderOnlyTransformerInput input inputType) x
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
forall input inputType x.
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; Rep (SimplifiedEncoderOnlyTransformerInput input inputType) x
$cto :: forall input inputType x.
Rep (SimplifiedEncoderOnlyTransformerInput input inputType) x
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
$cfrom :: forall input inputType x.
SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; Rep (SimplifiedEncoderOnlyTransformerInput input inputType) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="hs-comment">-- | Output data type for use with an encoder-only transformer.</span><span>
</span><span id="line-352"></span><span id="local-6989586621679716026"><span id="local-6989586621679716027"></span></span><span class="hs-keyword">data</span><span> </span><span id="EncoderOnlyTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-var">EncoderOnlyTransformerOutput</span></a></span></span><span> </span><span id="local-6989586621679717087"><span class="annot"><a href="#local-6989586621679717087"><span class="hs-identifier hs-type">output</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-353"></span><span>  </span><span id="EncoderOnlyTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-var">EncoderOnlyTransformerOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679717089"><span class="annot"><a href="#local-6989586621679717089"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="eotOutput"><span class="annot"><span class="annottext">forall output. EncoderOnlyTransformerOutput output -&gt; output
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#eotOutput"><span class="hs-identifier hs-var hs-var">eotOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717089"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-type">EncoderOnlyTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717089"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679716019"><span id="local-6989586621679716022"><span class="annot"><span class="annottext">EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
forall output.
Eq output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
$c/= :: forall output.
Eq output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
== :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
$c== :: forall output.
Eq output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679715998"><span id="local-6989586621679716000"><span id="local-6989586621679716003"><span id="local-6989586621679716006"><span id="local-6989586621679716009"><span id="local-6989586621679716012"><span id="local-6989586621679716015"><span class="annot"><span class="annottext">EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {output}.
Ord output =&gt;
Eq (EncoderOnlyTransformerOutput output)
forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Ordering
forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
min :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
$cmin :: forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
max :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
$cmax :: forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output
&gt;= :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
$c&gt;= :: forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
&gt; :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
$c&gt; :: forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
&lt;= :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
$c&lt;= :: forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
&lt; :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
$c&lt; :: forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Bool
compare :: EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Ordering
$ccompare :: forall output.
Ord output =&gt;
EncoderOnlyTransformerOutput output
-&gt; EncoderOnlyTransformerOutput output -&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679715990"><span id="local-6989586621679715992"><span id="local-6989586621679715996"><span class="annot"><span class="annottext">Int -&gt; EncoderOnlyTransformerOutput output -&gt; ShowS
forall output.
Show output =&gt;
Int -&gt; EncoderOnlyTransformerOutput output -&gt; ShowS
forall output.
Show output =&gt;
[EncoderOnlyTransformerOutput output] -&gt; ShowS
forall output.
Show output =&gt;
EncoderOnlyTransformerOutput output -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [EncoderOnlyTransformerOutput output] -&gt; ShowS
$cshowList :: forall output.
Show output =&gt;
[EncoderOnlyTransformerOutput output] -&gt; ShowS
show :: EncoderOnlyTransformerOutput output -&gt; String
$cshow :: forall output.
Show output =&gt;
EncoderOnlyTransformerOutput output -&gt; String
showsPrec :: Int -&gt; EncoderOnlyTransformerOutput output -&gt; ShowS
$cshowsPrec :: forall output.
Show output =&gt;
Int -&gt; EncoderOnlyTransformerOutput output -&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall output x.
Rep (EncoderOnlyTransformerOutput output) x
-&gt; EncoderOnlyTransformerOutput output
forall output x.
EncoderOnlyTransformerOutput output
-&gt; Rep (EncoderOnlyTransformerOutput output) x
$cto :: forall output x.
Rep (EncoderOnlyTransformerOutput output) x
-&gt; EncoderOnlyTransformerOutput output
$cfrom :: forall output x.
EncoderOnlyTransformerOutput output
-&gt; Rep (EncoderOnlyTransformerOutput output) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span id="local-6989586621679715985"><span id="local-6989586621679715986"></span></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderOnlyTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderOnlyTransformerOutput</span></a></span></span><span> </span><span id="local-6989586621679717078"><span class="annot"><a href="#local-6989586621679717078"><span class="hs-identifier hs-type">output</span></a></span></span><span> </span><span id="local-6989586621679717077"><span class="annot"><a href="#local-6989586621679717077"><span class="hs-identifier hs-type">paddingMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-361"></span><span>  </span><span id="SimplifiedEncoderOnlyTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderOnlyTransformerOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679717084"><span class="annot"><a href="#local-6989586621679717084"><span class="hs-identifier hs-type">output</span></a></span></span><span> </span><span id="local-6989586621679717083"><span class="annot"><a href="#local-6989586621679717083"><span class="hs-identifier hs-type">paddingMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="seotOutput"><span class="annot"><span class="annottext">forall output paddingMask.
SimplifiedEncoderOnlyTransformerOutput output paddingMask -&gt; output
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#seotOutput"><span class="hs-identifier hs-var hs-var">seotOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717084"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-364"></span><span>      </span><span id="sedtPaddingMask"><span class="annot"><span class="annottext">forall output paddingMask.
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; paddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#sedtPaddingMask"><span class="hs-identifier hs-var hs-var">sedtPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679717083"><span class="hs-identifier hs-type">paddingMask</span></a></span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderOnlyTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717084"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717083"><span class="hs-identifier hs-type">paddingMask</span></a></span><span>
</span><span id="line-367"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679715976"><span id="local-6989586621679715980"><span class="annot"><span class="annottext">SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall output paddingMask.
(Eq output, Eq paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
/= :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
$c/= :: forall output paddingMask.
(Eq output, Eq paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
== :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
$c== :: forall output paddingMask.
(Eq output, Eq paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679715953"><span id="local-6989586621679715955"><span id="local-6989586621679715958"><span id="local-6989586621679715961"><span id="local-6989586621679715964"><span id="local-6989586621679715968"><span id="local-6989586621679715972"><span class="annot"><span class="annottext">SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Ordering
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall {output} {paddingMask}.
(Ord output, Ord paddingMask) =&gt;
Eq (SimplifiedEncoderOnlyTransformerOutput output paddingMask)
forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Ordering
forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
min :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
$cmin :: forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
max :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
$cmax :: forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
&gt;= :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
$c&gt;= :: forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
&gt; :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
$c&gt; :: forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
&lt;= :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
$c&lt;= :: forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
&lt; :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
$c&lt; :: forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Bool
compare :: SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Ordering
$ccompare :: forall output paddingMask.
(Ord output, Ord paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Ordering
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679715944"><span id="local-6989586621679715946"><span id="local-6989586621679715951"><span class="annot"><span class="annottext">Int
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; ShowS
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall output paddingMask.
(Show output, Show paddingMask) =&gt;
Int
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; ShowS
forall output paddingMask.
(Show output, Show paddingMask) =&gt;
[SimplifiedEncoderOnlyTransformerOutput output paddingMask]
-&gt; ShowS
forall output paddingMask.
(Show output, Show paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask -&gt; String
showList :: [SimplifiedEncoderOnlyTransformerOutput output paddingMask]
-&gt; ShowS
$cshowList :: forall output paddingMask.
(Show output, Show paddingMask) =&gt;
[SimplifiedEncoderOnlyTransformerOutput output paddingMask]
-&gt; ShowS
show :: SimplifiedEncoderOnlyTransformerOutput output paddingMask -&gt; String
$cshow :: forall output paddingMask.
(Show output, Show paddingMask) =&gt;
SimplifiedEncoderOnlyTransformerOutput output paddingMask -&gt; String
showsPrec :: Int
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; ShowS
$cshowsPrec :: forall output paddingMask.
(Show output, Show paddingMask) =&gt;
Int
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; ShowS
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall output paddingMask x.
Rep (SimplifiedEncoderOnlyTransformerOutput output paddingMask) x
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
forall output paddingMask x.
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Rep
     (SimplifiedEncoderOnlyTransformerOutput output paddingMask) x
$cto :: forall output paddingMask x.
Rep (SimplifiedEncoderOnlyTransformerOutput output paddingMask) x
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
$cfrom :: forall output paddingMask x.
SimplifiedEncoderOnlyTransformerOutput output paddingMask
-&gt; Rep
     (SimplifiedEncoderOnlyTransformerOutput output paddingMask) x
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-comment">-- | 'HasForward' instance for encoder-only transformers with optional scaling and head.</span><span>
</span><span id="line-370"></span><span class="hs-comment">--</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-372"></span><span class="hs-comment">--    &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;    &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-373"></span><span class="hs-comment">--    &#9474; input &#9474;    &#9474; inputType &#9474;  &#9474; pos &#9474;  &#9474; attentionMask &#9474;</span><span>
</span><span id="line-374"></span><span class="hs-comment">--    &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;    &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9516;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-375"></span><span class="hs-comment">--        &#9474;              &#9474;           &#9474;            &#9474;</span><span>
</span><span id="line-376"></span><span class="hs-comment">--        &#9660;              &#9660;           &#9474;            &#9474;</span><span>
</span><span id="line-377"></span><span class="hs-comment">--  eotEmbedding  eotTypeEmbedding   &#9474;            &#9474;</span><span>
</span><span id="line-378"></span><span class="hs-comment">--        &#9660;              &#9660;           &#9474;            &#9474;</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- (embedScaling)  (embedScaling)    &#9474;            &#9474;</span><span>
</span><span id="line-380"></span><span class="hs-comment">--        &#9474;              &#9474;           &#9474;            &#9474;</span><span>
</span><span id="line-381"></span><span class="hs-comment">--        &#9492;&#9472;&#9472;&#9472;&#9472;&#9658;add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;           &#9474;            &#9474;</span><span>
</span><span id="line-382"></span><span class="hs-comment">--               &#9474;                   &#9474;            &#9474;</span><span>
</span><span id="line-383"></span><span class="hs-comment">--               &#9660;                   &#9474;            &#9474;</span><span>
</span><span id="line-384"></span><span class="hs-comment">--          eotEncoder&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-385"></span><span class="hs-comment">--               &#9660;</span><span>
</span><span id="line-386"></span><span class="hs-comment">--           (eotHead)</span><span>
</span><span id="line-387"></span><span class="hs-comment">--               &#9474;</span><span>
</span><span id="line-388"></span><span class="hs-comment">--               &#9660;</span><span>
</span><span id="line-389"></span><span class="hs-comment">--          &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-390"></span><span class="hs-comment">--          &#9474; output &#9474;</span><span>
</span><span id="line-391"></span><span class="hs-comment">--          &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-393"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-394"></span><span>  </span><span id="local-6989586621679717009"><span id="local-6989586621679717010"><span id="local-6989586621679717011"><span id="local-6989586621679717012"><span id="local-6989586621679717013"><span id="local-6989586621679717014"><span id="local-6989586621679717015"><span id="local-6989586621679717016"><span id="local-6989586621679717017"><span id="local-6989586621679717018"><span id="local-6989586621679717019"><span id="local-6989586621679717020"><span id="local-6989586621679717021"><span id="local-6989586621679717022"><span id="local-6989586621679717023"><span id="local-6989586621679717024"><span id="local-6989586621679717025"><span id="local-6989586621679717026"><span id="local-6989586621679717027"><span id="local-6989586621679717028"><span id="local-6989586621679717029"><span id="local-6989586621679717030"><span id="local-6989586621679717031"><span id="local-6989586621679717032"><span id="local-6989586621679717033"><span id="local-6989586621679717034"><span id="local-6989586621679717035"><span id="local-6989586621679717036"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span class="annot"><a href="#local-6989586621679717036"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><a href="#local-6989586621679717035"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><a href="#local-6989586621679717034"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span class="annot"><a href="#local-6989586621679717033"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span>
</span><span id="line-399"></span><span>      </span><span class="annot"><a href="#local-6989586621679717032"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><a href="#local-6989586621679717033"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717031"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717030"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717029"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717028"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717027"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-402"></span><span>      </span><span class="annot"><a href="#local-6989586621679717026"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span>
</span><span id="line-403"></span><span>      </span><span class="annot"><a href="#local-6989586621679717025"><span class="hs-identifier hs-type">inputType</span></a></span><span>
</span><span id="line-404"></span><span>      </span><span class="annot"><a href="#local-6989586621679717032"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice</span></a></span><span>
</span><span id="line-405"></span><span>      </span><span class="annot"><a href="#local-6989586621679717024"><span class="hs-identifier hs-type">typeEmbeddingOutput</span></a></span><span>
</span><span id="line-406"></span><span>      </span><span class="annot"><a href="#local-6989586621679717023"><span class="hs-identifier hs-type">typeEmbeddingGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-407"></span><span>    </span><span class="annot"><a href="#local-6989586621679717024"><span class="hs-identifier hs-type">typeEmbeddingOutput</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-type">~</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717022"><span class="hs-identifier hs-type">gradient''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717021"><span class="hs-identifier hs-type">layout''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717020"><span class="hs-identifier hs-type">device''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717019"><span class="hs-identifier hs-type">dataType''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717018"><span class="hs-identifier hs-type">shape''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-408"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-409"></span><span>      </span><span class="annot"><a href="#local-6989586621679717017"><span class="hs-identifier hs-type">encoder</span></a></span><span>
</span><span id="line-410"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-411"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679717031"><span class="hs-identifier hs-type">gradient'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717022"><span class="hs-identifier hs-type">gradient''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679717030"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717021"><span class="hs-identifier hs-type">layout''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679717029"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717020"><span class="hs-identifier hs-type">device''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679717028"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717019"><span class="hs-identifier hs-type">dataType''</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717027"><span class="hs-identifier hs-type">shape'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717018"><span class="hs-identifier hs-type">shape''</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-416"></span><span>        </span><span class="annot"><a href="#local-6989586621679717016"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><a href="#local-6989586621679717015"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-418"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>      </span><span class="annot"><a href="#local-6989586621679717023"><span class="hs-identifier hs-type">typeEmbeddingGeneratorOutputDevice</span></a></span><span>
</span><span id="line-420"></span><span>      </span><span class="annot"><a href="#local-6989586621679717014"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span class="annot"><a href="#local-6989586621679717013"><span class="hs-identifier hs-type">encoderGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717027"><span class="hs-identifier hs-type">shape'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717018"><span class="hs-identifier hs-type">shape''</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><a href="#local-6989586621679717012"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><a href="#local-6989586621679717014"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-426"></span><span>      </span><span class="annot"><a href="#local-6989586621679717013"><span class="hs-identifier hs-type">encoderGeneratorOutputDevice</span></a></span><span>
</span><span id="line-427"></span><span>      </span><span class="annot"><a href="#local-6989586621679717011"><span class="hs-identifier hs-type">headOutput</span></a></span><span>
</span><span id="line-428"></span><span>      </span><span class="annot"><a href="#local-6989586621679717010"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-430"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717009"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717017"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717036"><span class="hs-identifier hs-type">encoderEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717026"><span class="hs-identifier hs-type">encoderTypeEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717012"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-type">EncoderOnlyTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717035"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717025"><span class="hs-identifier hs-type">inputType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717016"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717015"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>    </span><span class="annot"><a href="#local-6989586621679717034"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-type">EncoderOnlyTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679717011"><span class="hs-identifier hs-type">headOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><a href="#local-6989586621679717010"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>  </span><span id="local-6989586621679715872"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderOnlyTransformerOutput headOutput,
      Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679715865"><span id="local-6989586621679715866"><span id="local-6989586621679715867"><span id="local-6989586621679715868"><span id="local-6989586621679715869"><span id="local-6989586621679715870"><span class="annot"><span class="annottext">encoderEmbedding
encoderTypeEmbedding
encoder
head
SDim inputEmbedDim
EncoderOnlyTransformerHasEmbedScaling
eotEmbedScaling :: EncoderOnlyTransformerHasEmbedScaling
eotHead :: head
eotTypeEmbedding :: encoderTypeEmbedding
eotEmbedding :: encoderEmbedding
eotEncoder :: encoder
eotInputEmbedDim :: SDim inputEmbedDim
eotEmbedScaling :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; EncoderOnlyTransformerHasEmbedScaling
eotHead :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; head
eotTypeEmbedding :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; encoderTypeEmbedding
eotEmbedding :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; encoderEmbedding
eotEncoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; encoder
eotInputEmbedDim :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       encoderEmbedding encoderTypeEmbedding head.
GEncoderOnlyTransformer
  inputEmbedDim encoder encoderEmbedding encoderTypeEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="#local-6989586621679715865"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-type">EncoderOnlyTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679715861"><span id="local-6989586621679715862"><span id="local-6989586621679715863"><span id="local-6989586621679715864"><span class="annot"><span class="annottext">input
inputType
pos
attentionMask
eotAttentionMask :: attentionMask
eotPos :: pos
eotInputType :: inputType
eotInput :: input
eotAttentionMask :: forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; attentionMask
eotPos :: forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; pos
eotInputType :: forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; inputType
eotInput :: forall input inputType pos attentionMask.
EncoderOnlyTransformerInput input inputType pos attentionMask
-&gt; input
</span><a href="#local-6989586621679715861"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679715860"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679715860"><span class="hs-identifier hs-var">scaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Floating a =&gt; a -&gt; a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">sqrt</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsChecked a -&gt; a
</span><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier hs-var">forgetIsChecked</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall name size. Dim name size -&gt; size
</span><a href="Torch.GraduallyTyped.Shape.Type.html#dimSize"><span class="hs-identifier hs-var">dimSize</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><a href="../file:///nix/store/53aqqxvip62j3fkmz3ijr9pig0rgbrmg-singletons-lib-singletons-3.0.1-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">fromSing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679715870"><span class="hs-identifier hs-var">eotInputEmbedDim</span></a></span><span>
</span><span id="line-439"></span><span>        </span><span id="local-6989586621679715856"><span class="annot"><span class="annottext">embeddedInput :: IxStateT
  m
  (Generator generatorDevice)
  (Generator embeddingGeneratorOutputDevice)
  (Tensor gradient' layout' device' dataType' shape')
</span><a href="#local-6989586621679715856"><span class="hs-identifier hs-var hs-var">embeddedInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-440"></span><span>          </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679715864"><span class="hs-identifier hs-var">eotInput</span></a></span><span>
</span><span id="line-441"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">encoderEmbedding
</span><a href="#local-6989586621679715868"><span class="hs-identifier hs-var">eotEmbedding</span></a></span><span>
</span><span id="line-442"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span>
</span><span id="line-443"></span><span>              </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-444"></span><span>                    </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithoutEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-445"></span><span>                    </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall other (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(Scalar other, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; other -&gt; m (Tensor gradient layout device dataType shape)
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier hs-var">mulScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679715860"><span class="hs-identifier hs-var">scaling</span></a></span><span>
</span><span id="line-446"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>                </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679715865"><span class="hs-identifier hs-var">eotEmbedScaling</span></a></span><span>
</span><span id="line-448"></span><span>        </span><span id="local-6989586621679715853"><span class="annot"><span class="annottext">embeddedInputType :: IxStateT
  m
  (Generator embeddingGeneratorOutputDevice)
  (Generator typeEmbeddingGeneratorOutputDevice)
  (Tensor gradient'' layout'' device'' dataType'' shape'')
</span><a href="#local-6989586621679715853"><span class="hs-identifier hs-var hs-var">embeddedInputType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-449"></span><span>          </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">inputType
</span><a href="#local-6989586621679715863"><span class="hs-identifier hs-var">eotInputType</span></a></span><span>
</span><span id="line-450"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">encoderTypeEmbedding
</span><a href="#local-6989586621679715867"><span class="hs-identifier hs-var">eotTypeEmbedding</span></a></span><span>
</span><span id="line-451"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span>
</span><span id="line-452"></span><span>              </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-453"></span><span>                    </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithoutEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-454"></span><span>                    </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderOnlyTransformerWithEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall other (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(Scalar other, MonadThrow m) =&gt;
Tensor gradient layout device dataType shape
-&gt; other -&gt; m (Tensor gradient layout device dataType shape)
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier hs-var">mulScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679715860"><span class="hs-identifier hs-var">scaling</span></a></span><span>
</span><span id="line-455"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>                </span><span class="annot"><span class="annottext">EncoderOnlyTransformerHasEmbedScaling
</span><a href="#local-6989586621679715865"><span class="hs-identifier hs-var">eotEmbedScaling</span></a></span><span>
</span><span id="line-457"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-458"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator embeddingGeneratorOutputDevice)
  (Tensor gradient' layout' device' dataType' shape')
</span><a href="#local-6989586621679715856"><span class="hs-identifier hs-var">embeddedInput</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k1} (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator embeddingGeneratorOutputDevice)
  (Generator typeEmbeddingGeneratorOutputDevice)
  (Tensor gradient'' layout'' device'' dataType'' shape'')
</span><a href="#local-6989586621679715853"><span class="hs-identifier hs-var">embeddedInputType</span></a></span><span>
</span><span id="line-459"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: (* -&gt; *) -&gt; k -&gt; k -&gt; * -&gt; *) (m :: * -&gt; *) a
       (i :: k).
(IxMonadTrans t, Monad m) =&gt;
m a -&gt; t m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ilift</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)])
       (shape'' :: Shape [Dim (Name Symbol) (Size Nat)]) (m :: * -&gt; *).
(MonadThrow m, shape'' ~ BroadcastShapesF shape shape',
 Catch shape'') =&gt;
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; m (Tensor
        (gradient &lt;|&gt; gradient')
        (layout &lt;+&gt; layout')
        (device &lt;+&gt; device')
        (dataType &lt;+&gt; dataType')
        shape'')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier hs-var">add</span></a></span><span>
</span><span id="line-460"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679715850"><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient' gradient'')
  (Unify (Layout LayoutType) layout' layout'')
  (Unify (Device (DeviceType Nat)) device' device'')
  (Unify (DataType DType) dataType' dataType'')
  (BroadcastShapesF shape' shape'')
</span><a href="#local-6989586621679715850"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">encoder
</span><a href="#local-6989586621679715869"><span class="hs-identifier hs-var">eotEncoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient' gradient'')
  (Unify (Layout LayoutType) layout' layout'')
  (Unify (Device (DeviceType Nat)) device' device'')
  (Unify (DataType DType) dataType' dataType'')
  (BroadcastShapesF shape' shape'')
</span><a href="#local-6989586621679715850"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679715862"><span class="hs-identifier hs-var">eotPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attentionMask
</span><a href="#local-6989586621679715861"><span class="hs-identifier hs-var">eotAttentionMask</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679715866"><span class="hs-identifier hs-var">eotHead</span></a></span><span>
</span><span id="line-462"></span><span>            </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall output. output -&gt; EncoderOnlyTransformerOutput output
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-var">EncoderOnlyTransformerOutput</span></a></span><span>
</span><span id="line-463"></span><span>
</span><span id="line-464"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-465"></span><span>  </span><span id="local-6989586621679716891"><span id="local-6989586621679716892"><span id="local-6989586621679716893"><span id="local-6989586621679716894"><span id="local-6989586621679716895"><span id="local-6989586621679716896"><span id="local-6989586621679716897"><span id="local-6989586621679716898"><span id="local-6989586621679716899"><span id="local-6989586621679716900"><span id="local-6989586621679716901"><span id="local-6989586621679716902"><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-466"></span><span>      </span><span class="annot"><a href="#local-6989586621679716902"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-467"></span><span>      </span><span class="annot"><a href="#local-6989586621679716901"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-468"></span><span>      </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-469"></span><span>      </span><span class="annot"><a href="#local-6989586621679716899"><span class="hs-identifier hs-type">paddingMask</span></a></span><span>
</span><span id="line-470"></span><span>      </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-472"></span><span>      </span><span class="annot"><a href="#local-6989586621679716898"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span class="annot"><a href="#local-6989586621679716899"><span class="hs-identifier hs-type">paddingMask</span></a></span><span>
</span><span id="line-474"></span><span>      </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-475"></span><span>      </span><span class="annot"><a href="#local-6989586621679716897"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-476"></span><span>      </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-477"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><a href="#local-6989586621679716896"><span class="hs-identifier hs-type">mkPos</span></a></span><span>
</span><span id="line-479"></span><span>      </span><span class="annot"><a href="#local-6989586621679716901"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-480"></span><span>      </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-481"></span><span>      </span><span class="annot"><a href="#local-6989586621679716895"><span class="hs-identifier hs-type">pos</span></a></span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-484"></span><span>      </span><span class="annot"><a href="#local-6989586621679716894"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-485"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-type">EncoderOnlyTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716901"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716893"><span class="hs-identifier hs-type">inputType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716895"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716897"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-type">EncoderOnlyTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716892"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>      </span><span class="annot"><a href="#local-6989586621679716891"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716894"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716896"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716902"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716898"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderOnlyTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716901"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716893"><span class="hs-identifier hs-type">inputType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>    </span><span class="annot"><a href="#local-6989586621679716900"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderOnlyTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716892"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679716899"><span class="hs-identifier hs-type">paddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>    </span><span class="annot"><a href="#local-6989586621679716891"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-496"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-497"></span><span>  </span><span id="local-6989586621679715826"><span class="annot"><span class="annottext">forward :: forall (m :: * -&gt; *).
MonadThrow m =&gt;
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; SimplifiedEncoderOnlyTransformerInput input inputType
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderOnlyTransformerOutput output paddingMask,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679715826"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GSimplifiedEncoderOnlyTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderOnlyTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679715822"><span id="local-6989586621679715823"><span id="local-6989586621679715824"><span id="local-6989586621679715825"><span class="annot"><span class="annottext">mkPaddingMask
mkAttentionMask
mkPos
model
seotMkAttentionMask :: mkAttentionMask
seotMkPaddingMask :: mkPaddingMask
seotMkPos :: mkPos
seotModel :: model
seotMkAttentionMask :: forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; mkAttentionMask
seotMkPaddingMask :: forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; mkPaddingMask
seotMkPos :: forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; mkPos
seotModel :: forall model mkPos mkPaddingMask mkAttentionMask.
GSimplifiedEncoderOnlyTransformer
  model mkPos mkPaddingMask mkAttentionMask
-&gt; model
</span><a href="#local-6989586621679715822"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderOnlyTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679715820"><span id="local-6989586621679715821"><span class="annot"><span class="annottext">input
inputType
seotInputType :: inputType
seotInput :: input
seotInputType :: forall input inputType.
SimplifiedEncoderOnlyTransformerInput input inputType -&gt; inputType
seotInput :: forall input inputType.
SimplifiedEncoderOnlyTransformerInput input inputType -&gt; input
</span><a href="#local-6989586621679715820"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-499"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679715819"><span class="annot"><span class="annottext">paddingMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  paddingMask
</span><a href="#local-6989586621679715819"><span class="hs-identifier hs-var hs-var">paddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
</span><a href="#local-6989586621679715823"><span class="hs-identifier hs-var">seotMkPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679715821"><span class="hs-identifier hs-var">seotInput</span></a></span><span>
</span><span id="line-500"></span><span>            </span><span id="local-6989586621679715818"><span class="annot"><span class="annottext">pos :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) pos
</span><a href="#local-6989586621679715818"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPos
</span><a href="#local-6989586621679715824"><span class="hs-identifier hs-var">seotMkPos</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679715821"><span class="hs-identifier hs-var">seotInput</span></a></span><span>
</span><span id="line-501"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  paddingMask
</span><a href="#local-6989586621679715819"><span class="hs-identifier hs-var">paddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall {k1} (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) pos
</span><a href="#local-6989586621679715818"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-502"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>        </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679715817"><span class="annot"><span class="annottext">paddingMask
</span><a href="#local-6989586621679715817"><span class="hs-identifier hs-var">paddingMask</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679715816"><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679715816"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-504"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679715815"><span class="annot"><span class="annottext">attentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  attentionMask
</span><a href="#local-6989586621679715815"><span class="hs-identifier hs-var hs-var">attentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkAttentionMask
</span><a href="#local-6989586621679715822"><span class="hs-identifier hs-var">seotMkAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">paddingMask
</span><a href="#local-6989586621679715817"><span class="hs-identifier hs-var">paddingMask</span></a></span><span>
</span><span id="line-505"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">forall input inputType pos attentionMask.
input
-&gt; inputType
-&gt; pos
-&gt; attentionMask
-&gt; EncoderOnlyTransformerInput input inputType pos attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerInput"><span class="hs-identifier hs-var">EncoderOnlyTransformerInput</span></a></span><span>
</span><span id="line-506"></span><span>                         </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679715821"><span class="hs-identifier hs-var">seotInput</span></a></span><span>
</span><span id="line-507"></span><span>                         </span><span class="annot"><span class="annottext">inputType
</span><a href="#local-6989586621679715820"><span class="hs-identifier hs-var">seotInputType</span></a></span><span>
</span><span id="line-508"></span><span>                         </span><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679715816"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-509"></span><span>                         </span><span class="annot"><span class="annottext">forall {k1} {k2} (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  attentionMask
</span><a href="#local-6989586621679715815"><span class="hs-identifier hs-var">attentionMask</span></a></span><span>
</span><span id="line-510"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/hlan16hghcygrr1n0fqljpsq2978pxwg-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679715825"><span class="hs-identifier hs-var">seotModel</span></a></span><span>
</span><span id="line-512"></span><span>                       </span><span class="annot"><span class="annottext">forall {k1} (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EncoderOnlyTransformerOutput"><span class="hs-identifier hs-type">EncoderOnlyTransformerOutput</span></a></span><span> </span><span id="local-6989586621679715814"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679715814"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-513"></span><span>                                </span><span class="annot"><span class="annottext">forall {k} (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/63793hdp0xr2k87xmzbhjz0cpd7vssdh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/9z106fx3296sgdwa5s05xi381ayi6qfk-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall output paddingMask.
output
-&gt; paddingMask
-&gt; SimplifiedEncoderOnlyTransformerOutput output paddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#SimplifiedEncoderOnlyTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderOnlyTransformerOutput</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679715814"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">paddingMask
</span><a href="#local-6989586621679715817"><span class="hs-identifier hs-var">paddingMask</span></a></span><span>
</span><span id="line-514"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>             </span><span class="hs-special">)</span><span>
</span><span id="line-516"></span></pre></body></html>