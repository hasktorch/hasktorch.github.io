<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">Control.Monad.Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">MonadThrow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier">SDType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderOnly</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTEmbeddingF"><span class="hs-identifier">EOTEmbeddingF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTEncoderF"><span class="hs-identifier">EOTEncoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTHeadF"><span class="hs-identifier">EOTHeadF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTTypeEmbeddingF"><span class="hs-identifier">EOTTypeEmbeddingF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier">GEncoderOnlyTransformer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#encoderOnlyTransformerSpec"><span class="hs-identifier">encoderOnlyTransformerSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMaskC"><span class="hs-identifier">MkTransformerPaddingMaskC</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier">SRoBERTa</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier">RoBERTa</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier">mkTransformerInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerPaddingMask"><span class="hs-identifier">mkTransformerPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier">SGetDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-comment">-- | RoBERTa dType.</span><span>
</span><span id="line-32"></span><span class="hs-keyword">type</span><span> </span><span id="RoBERTaDType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDType"><span class="hs-identifier hs-var">RoBERTaDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | RoBERTa dType singleton.</span><span>
</span><span id="line-35"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDType"><span class="hs-identifier hs-type">robertaDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier hs-type">SDType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDType"><span class="hs-identifier hs-type">RoBERTaDType</span></a></span><span>
</span><span id="line-36"></span><span id="robertaDType"><span class="annot"><span class="annottext">robertaDType :: SDType RoBERTaDType
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDType"><span class="hs-identifier hs-var hs-var">robertaDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI RoBERTaDType =&gt; Sing RoBERTaDType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDType"><span class="hs-identifier hs-type">RoBERTaDType</span></a></span><span>
</span><span id="line-37"></span><span>
</span><span id="line-38"></span><span class="hs-comment">-- | RoBERTa data type.</span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span id="RoBERTaDataType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDataType"><span class="hs-identifier hs-var">RoBERTaDataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDType"><span class="hs-identifier hs-type">RoBERTaDType</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | RoBERTa data type singleton.</span><span>
</span><span id="line-42"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDataType"><span class="hs-identifier hs-type">robertaDataType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDataType"><span class="hs-identifier hs-type">RoBERTaDataType</span></a></span><span>
</span><span id="line-43"></span><span id="robertaDataType"><span class="annot"><span class="annottext">robertaDataType :: SDataType RoBERTaDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDataType"><span class="hs-identifier hs-var hs-var">robertaDataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI RoBERTaDataType =&gt; Sing RoBERTaDataType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDataType"><span class="hs-identifier hs-type">RoBERTaDataType</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | RoBERTa dropout rate.</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- 'dropout_rate = 0.1'</span><span>
</span><span id="line-47"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDropoutP"><span class="hs-identifier hs-type">robertaDropoutP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-48"></span><span id="robertaDropoutP"><span class="annot"><span class="annottext">robertaDropoutP :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDropoutP"><span class="hs-identifier hs-var hs-var">robertaDropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- | RoBERTa positional encoding dimension.</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- Note the two extra dimensions.</span><span>
</span><span id="line-53"></span><span class="hs-keyword">type</span><span> </span><span id="RoBERTaPosEncDim"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaPosEncDim"><span class="hs-identifier hs-var">RoBERTaPosEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">514</span></span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-comment">-- | RoBERTa positional encoding dimension singleton.</span><span>
</span><span id="line-56"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaPosEncDim"><span class="hs-identifier hs-type">robertaPosEncDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaPosEncDim"><span class="hs-identifier hs-type">RoBERTaPosEncDim</span></a></span><span>
</span><span id="line-57"></span><span id="robertaPosEncDim"><span class="annot"><span class="annottext">robertaPosEncDim :: SDim RoBERTaPosEncDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaPosEncDim"><span class="hs-identifier hs-var hs-var">robertaPosEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI RoBERTaPosEncDim =&gt; Sing RoBERTaPosEncDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaPosEncDim"><span class="hs-identifier hs-type">RoBERTaPosEncDim</span></a></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">-- | RoBERTa layer-norm epsilon.</span><span>
</span><span id="line-60"></span><span class="hs-comment">-- 'layer_norm_epsilon = 1e-5'</span><span>
</span><span id="line-61"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaEps"><span class="hs-identifier hs-type">robertaEps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-62"></span><span id="robertaEps"><span class="annot"><span class="annottext">robertaEps :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaEps"><span class="hs-identifier hs-var hs-var">robertaEps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-5</span></span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">-- | RoBERTa maximum number of position embeddings.</span><span>
</span><span id="line-65"></span><span class="hs-comment">-- 'max_position_embeddings = 514'</span><span>
</span><span id="line-66"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaMaxPositionEmbeddings"><span class="hs-identifier hs-type">robertaMaxPositionEmbeddings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-67"></span><span id="robertaMaxPositionEmbeddings"><span class="annot"><span class="annottext">robertaMaxPositionEmbeddings :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaMaxPositionEmbeddings"><span class="hs-identifier hs-var hs-var">robertaMaxPositionEmbeddings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">514</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-comment">-- | RoBERTa padding token id.</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- 'pad_token_id = 1'</span><span>
</span><span id="line-71"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaPadTokenId"><span class="hs-identifier hs-type">robertaPadTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-72"></span><span id="robertaPadTokenId"><span class="annot"><span class="annottext">robertaPadTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaPadTokenId"><span class="hs-identifier hs-var hs-var">robertaPadTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-comment">-- | RoBERTa begin-of-sentence token id.</span><span>
</span><span id="line-75"></span><span class="hs-comment">-- 'bos_token_id = 0'</span><span>
</span><span id="line-76"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaBOSTokenId"><span class="hs-identifier hs-type">robertaBOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-77"></span><span id="robertaBOSTokenId"><span class="annot"><span class="annottext">robertaBOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaBOSTokenId"><span class="hs-identifier hs-var hs-var">robertaBOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span class="hs-comment">-- | RoBERTa end-of-sentence token id.</span><span>
</span><span id="line-80"></span><span class="hs-comment">-- 'eos_token_id = 0'</span><span>
</span><span id="line-81"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaEOSTokenId"><span class="hs-identifier hs-type">robertaEOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-82"></span><span id="robertaEOSTokenId"><span class="annot"><span class="annottext">robertaEOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaEOSTokenId"><span class="hs-identifier hs-var hs-var">robertaEOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">-- | RoBERTa attention mask bias</span><span>
</span><span id="line-85"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaAttentionMaskBias"><span class="hs-identifier hs-type">robertaAttentionMaskBias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-86"></span><span id="robertaAttentionMaskBias"><span class="annot"><span class="annottext">robertaAttentionMaskBias :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaAttentionMaskBias"><span class="hs-identifier hs-var hs-var">robertaAttentionMaskBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10000</span></span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-comment">-- | Generic RoBERTa model data type.</span><span>
</span><span id="line-89"></span><span class="hs-keyword">data</span><span>
</span><span id="line-90"></span><span>  </span><span id="GRoBERTaModel"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-var">GRoBERTaModel</span></a></span></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531928"><span class="annot"><a href="#local-6989586621679531928"><span class="hs-identifier hs-type">robertaModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>  </span><span id="GRoBERTaModel"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-var">GRoBERTaModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679532029"><span class="annot"><a href="#local-6989586621679532029"><span class="hs-identifier hs-type">robertaModel</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="robertaModel"><span class="annot"><span class="annottext">GRoBERTaModel robertaModel -&gt; robertaModel
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaModel"><span class="hs-identifier hs-var hs-var">robertaModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679532029"><span class="hs-identifier hs-type">robertaModel</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-type">GRoBERTaModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679532029"><span class="hs-identifier hs-type">robertaModel</span></a></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-type">GRoBERTaModel</span></a></span><span> </span><span id="local-6989586621679531925"><span class="annot"><a href="#local-6989586621679531925"><span class="hs-identifier hs-type hs-type">robertaModel</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-type">GRoBERTaModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531925"><span class="hs-identifier hs-type">robertaModel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-102"></span><span>  </span><span id="RoBERTaModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaModelF"><span class="hs-identifier hs-var">RoBERTaModelF</span></a></span></span><span>
</span><span id="line-103"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531924"><span class="annot"><a href="#local-6989586621679531924"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531923"><span class="annot"><a href="#local-6989586621679531923"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531922"><span class="annot"><a href="#local-6989586621679531922"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531921"><span class="annot"><a href="#local-6989586621679531921"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531920"><span class="annot"><a href="#local-6989586621679531920"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531919"><span class="annot"><a href="#local-6989586621679531919"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531918"><span class="annot"><a href="#local-6989586621679531918"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531917"><span class="annot"><a href="#local-6989586621679531917"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531916"><span class="annot"><a href="#local-6989586621679531916"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531915"><span class="annot"><a href="#local-6989586621679531915"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679531914"><span class="annot"><a href="#local-6989586621679531914"><span class="hs-identifier hs-type">typeVocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-116"></span><span>  </span><span id="RoBERTaModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaModelF"><span class="hs-identifier hs-var">RoBERTaModelF</span></a></span></span><span> </span><span id="local-6989586621679531913"><span class="annot"><a href="#local-6989586621679531913"><span class="hs-identifier hs-type hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679531912"><span class="annot"><a href="#local-6989586621679531912"><span class="hs-identifier hs-type hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679531911"><span class="annot"><a href="#local-6989586621679531911"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679531910"><span class="annot"><a href="#local-6989586621679531910"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679531909"><span class="annot"><a href="#local-6989586621679531909"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679531908"><span class="annot"><a href="#local-6989586621679531908"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679531907"><span class="annot"><a href="#local-6989586621679531907"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679531906"><span class="annot"><a href="#local-6989586621679531906"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679531905"><span class="annot"><a href="#local-6989586621679531905"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679531904"><span class="annot"><a href="#local-6989586621679531904"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679531903"><span class="annot"><a href="#local-6989586621679531903"><span class="hs-identifier hs-type hs-type">typeVocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-117"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-type">GRoBERTaModel</span></a></span><span>
</span><span id="line-118"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#GEncoderOnlyTransformer"><span class="hs-identifier hs-type">GEncoderOnlyTransformer</span></a></span><span>
</span><span id="line-119"></span><span>          </span><span class="annot"><a href="#local-6989586621679531906"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-120"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTEncoderF"><span class="hs-identifier hs-type">EOTEncoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531912"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531911"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531910"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDataType"><span class="hs-identifier hs-type">RoBERTaDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531909"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531908"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531907"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531906"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531905"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaPosEncDim"><span class="hs-identifier hs-type">RoBERTaPosEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTEmbeddingF"><span class="hs-identifier hs-type">EOTEmbeddingF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531911"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531910"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDataType"><span class="hs-identifier hs-type">RoBERTaDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531906"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531904"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTTypeEmbeddingF"><span class="hs-identifier hs-type">EOTTypeEmbeddingF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531911"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531910"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDataType"><span class="hs-identifier hs-type">RoBERTaDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531906"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531903"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#EOTHeadF"><span class="hs-identifier hs-type">EOTHeadF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531913"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531911"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531910"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaDataType"><span class="hs-identifier hs-type">RoBERTaDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531906"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531904"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="hs-comment">-- | Specifies the parameters of a RoBERTa model.</span><span>
</span><span id="line-127"></span><span class="hs-comment">--</span><span>
</span><span id="line-128"></span><span class="hs-comment">-- - @transformerHead@: the head of the RoBERTa model.</span><span>
</span><span id="line-129"></span><span class="hs-comment">-- - @numLayers@: the number of layers in the RoBERTa model.</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the RoBERTa model.</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- - @device@: the computational device on which the RoBERTa model parameters are to be allocated.</span><span>
</span><span id="line-132"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaModelSpec"><span class="hs-identifier hs-type">robertaModelSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679531901"><span class="annot"><a href="#local-6989586621679531901"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679531900"><span class="annot"><a href="#local-6989586621679531900"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679531899"><span class="annot"><a href="#local-6989586621679531899"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679531898"><span class="annot"><a href="#local-6989586621679531898"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679531897"><span class="annot"><a href="#local-6989586621679531897"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679531896"><span class="annot"><a href="#local-6989586621679531896"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679531895"><span class="annot"><a href="#local-6989586621679531895"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679531894"><span class="annot"><a href="#local-6989586621679531894"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679531893"><span class="annot"><a href="#local-6989586621679531893"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679531892"><span class="annot"><a href="#local-6989586621679531892"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679531891"><span class="annot"><a href="#local-6989586621679531891"><span class="hs-identifier hs-type">typeVocabDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531897"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-135"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531896"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-136"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531895"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-137"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531894"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-138"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531893"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531892"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531891"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531901"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531900"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531899"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531898"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaModelF"><span class="hs-identifier hs-type">RoBERTaModelF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531901"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531900"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531899"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531898"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531897"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531896"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531895"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531894"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531893"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531892"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531891"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span id="robertaModelSpec"><span class="annot"><span class="annottext">robertaModelSpec :: STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; ModelSpec
     (RoBERTaModelF
        transformerHead
        numLayers
        gradient
        device
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        vocabDim
        typeVocabDim)
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaModelSpec"><span class="hs-identifier hs-var hs-var">robertaModelSpec</span></a></span></span><span> </span><span id="local-6989586621679531890"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679531890"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679531889"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679531889"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679531888"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679531888"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679531887"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679531887"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">GEncoderOnlyTransformer
  inputEmbedDim
  (NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              RoBERTaDataType
              RoBERTaPosEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias
              gradient
              device
              RoBERTaDataType
              ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                RoBERTaDataType
                                ('Shape '[inputEmbedDim])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      RoBERTaDataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      RoBERTaDataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      RoBERTaDataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      RoBERTaDataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                RoBERTaDataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ()))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        RoBERTaDataType
        vocabDim
        inputEmbedDim
        'Nothing))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        RoBERTaDataType
        typeVocabDim
        inputEmbedDim
        'Nothing))
  (ModelSpec
     (EOTHeadF
        'RoBERTa
        transformerHead
        gradient
        device
        RoBERTaDataType
        inputEmbedDim
        vocabDim))
-&gt; GRoBERTaModel
     (GEncoderOnlyTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    RoBERTaDataType
                    RoBERTaPosEncDim
                    inputEmbedDim
                    'Nothing))
              ()
              (NamedModel
                 (LayerNormSpec
                    'WithBias
                    gradient
                    device
                    RoBERTaDataType
                    ('Shape '[inputEmbedDim])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      RoBERTaDataType
                                      ('Shape '[inputEmbedDim])))))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[ffnDim])))))
                                Gelu
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      RoBERTaDataType
                                      ('Shape '[inputEmbedDim])))))))))
              ()
              ()))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              RoBERTaDataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              RoBERTaDataType
              typeVocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EOTHeadF
              'RoBERTa
              transformerHead
              gradient
              device
              RoBERTaDataType
              inputEmbedDim
              vocabDim)))
forall robertaModel. robertaModel -&gt; GRoBERTaModel robertaModel
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-var">GRoBERTaModel</span></a></span><span> </span><span class="annot"><span class="annottext">(GEncoderOnlyTransformer
   inputEmbedDim
   (NamedModel
      (GTransformer
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               RoBERTaDataType
               RoBERTaPosEncDim
               inputEmbedDim
               'Nothing))
         ()
         (NamedModel
            (LayerNormSpec
               'WithBias
               gradient
               device
               RoBERTaDataType
               ('Shape '[inputEmbedDim])))
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           ()
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias
                                 gradient
                                 device
                                 RoBERTaDataType
                                 ('Shape '[inputEmbedDim])))))
                     ()
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           ()
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       RoBERTaDataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       RoBERTaDataType
                                       ('Shape '[ffnDim])))))
                           Gelu
                           ()
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       RoBERTaDataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       RoBERTaDataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias
                                 gradient
                                 device
                                 RoBERTaDataType
                                 ('Shape '[inputEmbedDim])))))))))
         ()
         ()))
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         RoBERTaDataType
         vocabDim
         inputEmbedDim
         'Nothing))
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         RoBERTaDataType
         typeVocabDim
         inputEmbedDim
         'Nothing))
   (ModelSpec
      (EOTHeadF
         'RoBERTa
         transformerHead
         gradient
         device
         RoBERTaDataType
         inputEmbedDim
         vocabDim))
 -&gt; GRoBERTaModel
      (GEncoderOnlyTransformer
         inputEmbedDim
         (NamedModel
            (GTransformer
               (NamedModel
                  (EmbeddingSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     RoBERTaDataType
                     RoBERTaPosEncDim
                     inputEmbedDim
                     'Nothing))
               ()
               (NamedModel
                  (LayerNormSpec
                     'WithBias
                     gradient
                     device
                     RoBERTaDataType
                     ('Shape '[inputEmbedDim])))
               Dropout
               (NamedModel
                  (GTransformerStack
                     (VectorSpec
                        numLayers
                        (GTransformerBlock
                           (NamedModel
                              (GSelfAttention
                                 ()
                                 (NamedModel
                                    (GMultiHeadAttention
                                       headDim
                                       headEmbedDim
                                       embedDim
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[embedDim, inputEmbedDim])))
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[embedDim])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[embedDim, inputEmbedDim])))
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[embedDim])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[embedDim, inputEmbedDim])))
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[embedDim])))))
                                       (NamedModel
                                          (GLinear
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[inputEmbedDim, embedDim])))
                                             (NamedModel
                                                (Tensor
                                                   gradient
                                                   ('Layout 'Dense)
                                                   device
                                                   RoBERTaDataType
                                                   ('Shape '[inputEmbedDim])))))
                                       Dropout))
                                 Dropout
                                 (NamedModel
                                    (LayerNorm
                                       'WithBias
                                       gradient
                                       device
                                       RoBERTaDataType
                                       ('Shape '[inputEmbedDim])))))
                           ()
                           (NamedModel
                              (GTransformerFeedForwardNetwork
                                 ()
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[ffnDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[ffnDim])))))
                                 Gelu
                                 ()
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[inputEmbedDim, ffnDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             RoBERTaDataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout
                                 (NamedModel
                                    (LayerNorm
                                       'WithBias
                                       gradient
                                       device
                                       RoBERTaDataType
                                       ('Shape '[inputEmbedDim])))))))))
               ()
               ()))
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               RoBERTaDataType
               vocabDim
               inputEmbedDim
               'Nothing))
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               RoBERTaDataType
               typeVocabDim
               inputEmbedDim
               'Nothing))
         (ModelSpec
            (EOTHeadF
               'RoBERTa
               transformerHead
               gradient
               device
               RoBERTaDataType
               inputEmbedDim
               vocabDim))))
-&gt; GEncoderOnlyTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (NamedModel
              (EmbeddingSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 RoBERTaDataType
                 RoBERTaPosEncDim
                 inputEmbedDim
                 'Nothing))
           ()
           (NamedModel
              (LayerNormSpec
                 'WithBias
                 gradient
                 device
                 RoBERTaDataType
                 ('Shape '[inputEmbedDim])))
           Dropout
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             ()
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[embedDim, inputEmbedDim])))
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[embedDim])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[embedDim, inputEmbedDim])))
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[embedDim])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[embedDim, inputEmbedDim])))
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[embedDim])))))
                                   (NamedModel
                                      (GLinear
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[inputEmbedDim, embedDim])))
                                         (NamedModel
                                            (Tensor
                                               gradient
                                               ('Layout 'Dense)
                                               device
                                               RoBERTaDataType
                                               ('Shape '[inputEmbedDim])))))
                                   Dropout))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   gradient
                                   device
                                   RoBERTaDataType
                                   ('Shape '[inputEmbedDim])))))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         RoBERTaDataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         RoBERTaDataType
                                         ('Shape '[ffnDim])))))
                             Gelu
                             ()
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         RoBERTaDataType
                                         ('Shape '[inputEmbedDim, ffnDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         RoBERTaDataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout
                             (NamedModel
                                (LayerNorm
                                   'WithBias
                                   gradient
                                   device
                                   RoBERTaDataType
                                   ('Shape '[inputEmbedDim])))))))))
           ()
           ()))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           RoBERTaDataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           RoBERTaDataType
           typeVocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EOTHeadF
           'RoBERTa
           transformerHead
           gradient
           device
           RoBERTaDataType
           inputEmbedDim
           vocabDim))
-&gt; GRoBERTaModel
     (GEncoderOnlyTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    RoBERTaDataType
                    RoBERTaPosEncDim
                    inputEmbedDim
                    'Nothing))
              ()
              (NamedModel
                 (LayerNormSpec
                    'WithBias
                    gradient
                    device
                    RoBERTaDataType
                    ('Shape '[inputEmbedDim])))
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                ()
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  RoBERTaDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      RoBERTaDataType
                                      ('Shape '[inputEmbedDim])))))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[ffnDim])))))
                                Gelu
                                ()
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            RoBERTaDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      RoBERTaDataType
                                      ('Shape '[inputEmbedDim])))))))))
              ()
              ()))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              RoBERTaDataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              RoBERTaDataType
              typeVocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EOTHeadF
              'RoBERTa
              transformerHead
              gradient
              device
              RoBERTaDataType
              inputEmbedDim
              vocabDim)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
-&gt; STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType RoBERTaDataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim RoBERTaPosEncDim
-&gt; SDim vocabDim
-&gt; SDim typeVocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderOnlyTransformer
        inputEmbedDim
        (EOTEncoderF
           'RoBERTa
           numLayers
           gradient
           device
           RoBERTaDataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           RoBERTaPosEncDim)
        (EOTEmbeddingF
           'RoBERTa gradient device RoBERTaDataType inputEmbedDim vocabDim)
        (EOTTypeEmbeddingF
           'RoBERTa
           gradient
           device
           RoBERTaDataType
           inputEmbedDim
           typeVocabDim)
        (EOTHeadF
           'RoBERTa
           transformerHead
           gradient
           device
           RoBERTaDataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat))
       (typeVocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; SDim typeVocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderOnlyTransformer
        inputEmbedDim
        (EOTEncoderF
           style
           numLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EOTEmbeddingF
           style gradient device dataType inputEmbedDim vocabDim)
        (EOTTypeEmbeddingF
           style gradient device dataType inputEmbedDim typeVocabDim)
        (EOTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderOnly.html#encoderOnlyTransformerSpec"><span class="hs-identifier hs-var">encoderOnlyTransformerSpec</span></a></span><span>
</span><span id="line-150"></span><span>      </span><span class="annot"><span class="annottext">STransformerStyle 'RoBERTa
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span>
</span><span id="line-151"></span><span>      </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679531890"><span class="hs-identifier hs-var">transformerHead</span></a></span><span>
</span><span id="line-152"></span><span>      </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679531889"><span class="hs-identifier hs-var">numLayers</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679531888"><span class="hs-identifier hs-var">gradient</span></a></span><span>
</span><span id="line-154"></span><span>      </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679531887"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-155"></span><span>      </span><span class="annot"><span class="annottext">SDataType RoBERTaDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDataType"><span class="hs-identifier hs-var">robertaDataType</span></a></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headDim =&gt; Sing headDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679531897"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headEmbedDim =&gt; Sing headEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679531896"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI embedDim =&gt; Sing embedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679531895"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI inputEmbedDim =&gt; Sing inputEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679531894"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI ffnDim =&gt; Sing ffnDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679531893"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>      </span><span class="annot"><span class="annottext">SDim RoBERTaPosEncDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaPosEncDim"><span class="hs-identifier hs-var">robertaPosEncDim</span></a></span><span>
</span><span id="line-162"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI vocabDim =&gt; Sing vocabDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679531892"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI typeVocabDim =&gt; Sing typeVocabDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679531891"><span class="hs-identifier hs-type">typeVocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaDropoutP"><span class="hs-identifier hs-var">robertaDropoutP</span></a></span><span>
</span><span id="line-165"></span><span>      </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaEps"><span class="hs-identifier hs-var">robertaEps</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span id="local-6989586621679531886"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531886"><span class="hs-identifier hs-type">spec</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-type">GRoBERTaModel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531886"><span class="hs-identifier hs-type">spec</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-168"></span><span>  </span><span id="local-6989586621679531882"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec (GRoBERTaModel spec)
-&gt; StateDictKey -&gt; m (GRoBERTaModel spec)
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-type">GRoBERTaModel</span></a></span><span> </span><span id="local-6989586621679531880"><span class="annot"><a href="#local-6989586621679531880"><span class="hs-identifier hs-var">spec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679531879"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679531879"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">spec -&gt; GRoBERTaModel spec
forall robertaModel. robertaModel -&gt; GRoBERTaModel robertaModel
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-var">GRoBERTaModel</span></a></span><span> </span><span class="annot"><span class="annottext">(spec -&gt; GRoBERTaModel spec) -&gt; m spec -&gt; m (GRoBERTaModel spec)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec spec -&gt; StateDictKey -&gt; m spec
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec spec
</span><a href="#local-6989586621679531880"><span class="hs-identifier hs-var">spec</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679531879"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span id="local-6989586621679531877"><span class="annot"><span class="annottext">toStateDict :: StateDictKey -&gt; GRoBERTaModel spec -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679531875"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679531875"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#GRoBERTaModel"><span class="hs-identifier hs-type">GRoBERTaModel</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679531874"><span class="annot"><span class="annottext">spec
robertaModel :: spec
robertaModel :: forall robertaModel. GRoBERTaModel robertaModel -&gt; robertaModel
</span><a href="#local-6989586621679531874"><span class="hs-glyph hs-var hs-var">..</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; spec -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679531875"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">spec
</span><a href="#local-6989586621679531874"><span class="hs-identifier hs-var">robertaModel</span></a></span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#mkRoBERTaInput"><span class="hs-identifier hs-type">mkRoBERTaInput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-172"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679531872"><span class="annot"><a href="#local-6989586621679531872"><span class="hs-identifier hs-type">batchDim</span></a></span></span><span> </span><span id="local-6989586621679531871"><span class="annot"><a href="#local-6989586621679531871"><span class="hs-identifier hs-type">seqDim</span></a></span></span><span> </span><span id="local-6989586621679531870"><span class="annot"><a href="#local-6989586621679531870"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679531869"><span class="annot"><a href="#local-6989586621679531869"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679531868"><span class="annot"><a href="#local-6989586621679531868"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier hs-type">MonadThrow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531869"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-174"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531872"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531871"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>    </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679531872"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679531871"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-179"></span><span>              </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-180"></span><span>                 </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span>
</span><span id="line-181"></span><span>               </span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>              </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679531872"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679531871"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-183"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679531872"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679531871"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="#local-6989586621679531868"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-186"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-187"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithoutGradient"><span class="hs-identifier hs-type">WithoutGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-189"></span><span>          </span><span class="annot"><a href="#local-6989586621679531870"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-190"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679531872"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679531871"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531872"><span class="hs-identifier hs-type">batchDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531871"><span class="hs-identifier hs-type">seqDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531870"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="#local-6989586621679531869"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531868"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-198"></span><span id="mkRoBERTaInput"><span class="annot"><span class="annottext">mkRoBERTaInput :: SDim batchDim
-&gt; SDim seqDim -&gt; SDevice device -&gt; [[Int]] -&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#mkRoBERTaInput"><span class="hs-identifier hs-var hs-var">mkRoBERTaInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
forall (batchDim :: Dim (Name Symbol) (Size Nat))
       (seqDim :: Dim (Name Symbol) (Size Nat))
       (device :: Device (DeviceType Nat)) (m :: * -&gt; *) output.
(MonadThrow m, SGetDim batchDim, SGetDim seqDim,
 'Shape '[batchDim, seqDim]
 ~ Seq
     ('Shape
        '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize,
           'Dim ('Name &quot;*&quot;) 'UncheckedSize]
      &lt;+&gt; 'Shape '[batchDim, seqDim])
     ('Shape '[batchDim, seqDim]),
 output
 ~ Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     device
     ('DataType 'Int64)
     ('Shape '[batchDim, seqDim])) =&gt;
Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier hs-var">mkTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaPadTokenId"><span class="hs-identifier hs-var">robertaPadTokenId</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#mkRoBERTaPaddingMask"><span class="hs-identifier hs-type">mkRoBERTaPaddingMask</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679531866"><span class="annot"><a href="#local-6989586621679531866"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679531865"><span class="annot"><a href="#local-6989586621679531865"><span class="hs-identifier hs-type">layout</span></a></span></span><span> </span><span id="local-6989586621679531864"><span class="annot"><a href="#local-6989586621679531864"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679531863"><span class="annot"><a href="#local-6989586621679531863"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679531862"><span class="annot"><a href="#local-6989586621679531862"><span class="hs-identifier hs-type">shape</span></a></span></span><span> </span><span id="local-6989586621679531861"><span class="annot"><a href="#local-6989586621679531861"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMaskC"><span class="hs-identifier hs-type">MkTransformerPaddingMaskC</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531865"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531864"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531863"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531862"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531861"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531866"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531865"><span class="hs-identifier hs-type">layout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531864"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531863"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531862"><span class="hs-identifier hs-type">shape</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="#local-6989586621679531861"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-205"></span><span id="mkRoBERTaPaddingMask"><span class="annot"><span class="annottext">mkRoBERTaPaddingMask :: Tensor gradient layout device dataType shape -&gt; output
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#mkRoBERTaPaddingMask"><span class="hs-identifier hs-var hs-var">mkRoBERTaPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Tensor gradient layout device dataType shape -&gt; output
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]) output.
MkTransformerPaddingMaskC layout device dataType shape output =&gt;
Int -&gt; Tensor gradient layout device dataType shape -&gt; output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerPaddingMask"><span class="hs-identifier hs-var">mkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaPadTokenId"><span class="hs-identifier hs-var">robertaPadTokenId</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">data</span><span> </span><span id="RoBERTaInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaInput"><span class="hs-identifier hs-var">RoBERTaInput</span></a></span></span><span> </span><span id="local-6989586621679531860"><span class="annot"><a href="#local-6989586621679531860"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="RoBERTaInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaInput"><span class="hs-identifier hs-var">RoBERTaInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679531858"><span class="annot"><a href="#local-6989586621679531858"><span class="hs-identifier hs-type">input</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="robertaInput"><span class="annot"><span class="annottext">RoBERTaInput input -&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#robertaInput"><span class="hs-identifier hs-var hs-var">robertaInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679531858"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaInput"><span class="hs-identifier hs-type">RoBERTaInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531858"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span id="local-6989586621679531851"><span id="local-6989586621679531853"><span id="local-6989586621679531855"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679531849"><span class="annot"><a href="#local-6989586621679531849"><span class="hs-keyword hs-type">stock</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679531849"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.RoBERTa.Common.html#RoBERTaInput"><span class="hs-identifier hs-type">RoBERTaInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679531849"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-218"></span></pre></body></html>