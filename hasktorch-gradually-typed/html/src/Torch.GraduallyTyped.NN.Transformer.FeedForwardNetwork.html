<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE NoStarIsType #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin TypeLevel.Rewrite
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyRightAssociativeL
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL2
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL2C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL3
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL3C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL4
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL4C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL5
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL5C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL6
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL6C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL7
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL7C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL8
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL8C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrRightAssociativeL
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL2
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL2C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL3
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL3C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL4
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL4C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL5
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL5C #-}</span><span>
</span><span id="line-44"></span><span class="hs-pragma">{-# OPTIONS_GHC -v2 -Wall #-}</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">sing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier">Dense</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Activation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier">Gelu</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier">GeluNew</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier">Relu</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier">Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Functional.Linear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier">LinearWithBiasF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier">LinearWithoutBiasF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Functional.Normalization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithBiasF"><span class="hs-identifier">LayerNormWithBiasF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithoutBiasF"><span class="hs-identifier">LayerNormWithoutBiasF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Linear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier">Linear</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier">LinearSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Normalization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier">LayerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier">LayerNormSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasBias"><span class="hs-identifier">HasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#SHasBias"><span class="hs-identifier">SHasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html"><span class="hs-identifier">Torch.GraduallyTyped.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier">Generator</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#sGeneratorToDevice"><span class="hs-identifier">sGeneratorToDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html"><span class="hs-identifier">Torch.GraduallyTyped.Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier">Scalar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier">BroadcastShapesF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier">SGetDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier">SGetShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-comment">-- | Generic transformer feed-forward network.</span><span>
</span><span id="line-77"></span><span class="hs-comment">-- Needs to be specialized to a given transformer type, e.g. 'T5'.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- See 'TransformerFeedForwardNetwork'.</span><span>
</span><span id="line-79"></span><span class="hs-keyword">data</span><span>
</span><span id="line-80"></span><span>  </span><span id="GTransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807134"><span class="annot"><a href="#local-6989586621679807134"><span class="hs-identifier hs-type">inputWeight1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807133"><span class="annot"><a href="#local-6989586621679807133"><span class="hs-identifier hs-type">inputWeight2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807132"><span class="annot"><a href="#local-6989586621679807132"><span class="hs-identifier hs-type">outputWeight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807131"><span class="annot"><a href="#local-6989586621679807131"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807130"><span class="annot"><a href="#local-6989586621679807130"><span class="hs-identifier hs-type">activationDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807129"><span class="annot"><a href="#local-6989586621679807129"><span class="hs-identifier hs-type">layerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807128"><span class="annot"><a href="#local-6989586621679807128"><span class="hs-identifier hs-type">dropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-89"></span><span>  </span><span id="GTransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807344"><span class="annot"><a href="#local-6989586621679807344"><span class="hs-identifier hs-type">inputWeight1</span></a></span></span><span> </span><span id="local-6989586621679807343"><span class="annot"><a href="#local-6989586621679807343"><span class="hs-identifier hs-type">inputWeight2</span></a></span></span><span> </span><span id="local-6989586621679807342"><span class="annot"><a href="#local-6989586621679807342"><span class="hs-identifier hs-type">outputWeight</span></a></span></span><span> </span><span id="local-6989586621679807341"><span class="annot"><a href="#local-6989586621679807341"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span id="local-6989586621679807340"><span class="annot"><a href="#local-6989586621679807340"><span class="hs-identifier hs-type">activationDropout</span></a></span></span><span> </span><span id="local-6989586621679807339"><span class="annot"><a href="#local-6989586621679807339"><span class="hs-identifier hs-type">layerNorm</span></a></span></span><span> </span><span id="local-6989586621679807338"><span class="annot"><a href="#local-6989586621679807338"><span class="hs-identifier hs-type">dropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | first input weight</span><span>
</span><span id="line-92"></span><span>      </span><span id="ffnInputWeight1"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnInputWeight1"><span class="hs-identifier hs-var hs-var">ffnInputWeight1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807344"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-comment">-- | second input weight</span><span>
</span><span id="line-94"></span><span>      </span><span id="ffnInputWeight2"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnInputWeight2"><span class="hs-identifier hs-var hs-var">ffnInputWeight2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807343"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span>      </span><span class="hs-comment">-- | output weight</span><span>
</span><span id="line-96"></span><span>      </span><span id="ffnOutputWeight"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnOutputWeight"><span class="hs-identifier hs-var hs-var">ffnOutputWeight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807342"><span class="hs-identifier hs-type">outputWeight</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-97"></span><span>      </span><span class="hs-comment">-- | activation</span><span>
</span><span id="line-98"></span><span>      </span><span id="ffnActivation"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnActivation"><span class="hs-identifier hs-var hs-var">ffnActivation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807341"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-comment">-- | activation dropout</span><span>
</span><span id="line-100"></span><span>      </span><span id="ffnActivationDropout"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnActivationDropout"><span class="hs-identifier hs-var hs-var">ffnActivationDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807340"><span class="hs-identifier hs-type">activationDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-comment">-- | feed-forward layer norm</span><span>
</span><span id="line-102"></span><span>      </span><span id="ffnLayerNorm"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnLayerNorm"><span class="hs-identifier hs-var hs-var">ffnLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807339"><span class="hs-identifier hs-type">layerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>      </span><span class="hs-comment">-- | feed-forward dropout</span><span>
</span><span id="line-104"></span><span>      </span><span id="ffnDropout"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnDropout"><span class="hs-identifier hs-var hs-var">ffnDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679807338"><span class="hs-identifier hs-type">dropout</span></a></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807344"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807343"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807342"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807341"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807340"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807339"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807338"><span class="hs-identifier hs-type">dropout</span></a></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | Transformer feed-forward network.</span><span>
</span><span id="line-109"></span><span class="hs-keyword">data</span><span>
</span><span id="line-110"></span><span>  </span><span id="TransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span></span><span>
</span><span id="line-111"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807119"><span class="annot"><a href="#local-6989586621679807119"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807118"><span class="annot"><a href="#local-6989586621679807118"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807117"><span class="annot"><a href="#local-6989586621679807117"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807116"><span class="annot"><a href="#local-6989586621679807116"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807115"><span class="annot"><a href="#local-6989586621679807115"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807114"><span class="annot"><a href="#local-6989586621679807114"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="TransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807304"><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679807303"><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807302"><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807301"><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807300"><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807299"><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-120"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-121"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-type">FFNInputWeight1F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-type">FFNInputWeight2F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-type">FFNOutputWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-type">FFNLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-type">FFNDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807304"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807303"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807302"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807301"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807300"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807299"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="hs-keyword">data</span><span>
</span><span id="line-131"></span><span>  </span><span id="TransformerFeedForwardNetworkSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetworkSpec"><span class="hs-identifier hs-var">TransformerFeedForwardNetworkSpec</span></a></span></span><span>
</span><span id="line-132"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807111"><span class="annot"><a href="#local-6989586621679807111"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807110"><span class="annot"><a href="#local-6989586621679807110"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807109"><span class="annot"><a href="#local-6989586621679807109"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807108"><span class="annot"><a href="#local-6989586621679807108"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807107"><span class="annot"><a href="#local-6989586621679807107"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807106"><span class="annot"><a href="#local-6989586621679807106"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span id="TransformerFeedForwardNetworkSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetworkSpec"><span class="hs-identifier hs-var">TransformerFeedForwardNetworkSpec</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679807104"><span class="annot"><a href="#local-6989586621679807104"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679807103"><span class="annot"><a href="#local-6989586621679807103"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807102"><span class="annot"><a href="#local-6989586621679807102"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807101"><span class="annot"><a href="#local-6989586621679807101"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807100"><span class="annot"><a href="#local-6989586621679807100"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807099"><span class="annot"><a href="#local-6989586621679807099"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-141"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807104"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807103"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807102"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807101"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807100"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-146"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807099"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetworkSpec"><span class="hs-identifier hs-type">TransformerFeedForwardNetworkSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807104"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807103"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807102"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807101"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807100"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807099"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span id="local-6989586621679807098"><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679807097"><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807096"><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807095"><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807094"><span class="annot"><a href="#local-6989586621679807094"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807093"><span class="annot"><a href="#local-6989586621679807093"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetworkSpec"><span class="hs-identifier hs-type">TransformerFeedForwardNetworkSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807098"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807097"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807096"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807095"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807094"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807093"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-154"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807092"><span class="annot"><a href="#local-6989586621679807092"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807091"><span class="annot"><a href="#local-6989586621679807091"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807090"><span class="annot"><a href="#local-6989586621679807090"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807089"><span class="annot"><a href="#local-6989586621679807089"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807088"><span class="annot"><a href="#local-6989586621679807088"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807087"><span class="annot"><a href="#local-6989586621679807087"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-161"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-163"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679807086"><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807085"><span class="annot"><a href="#local-6989586621679807085"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807084"><span class="annot"><a href="#local-6989586621679807084"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807083"><span class="annot"><a href="#local-6989586621679807083"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807082"><span class="annot"><a href="#local-6989586621679807082"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807086"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807085"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807084"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807083"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807082"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-164"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679807081"><span class="annot"><a href="#local-6989586621679807081"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807080"><span class="annot"><a href="#local-6989586621679807080"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807079"><span class="annot"><a href="#local-6989586621679807079"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807078"><span class="annot"><a href="#local-6989586621679807078"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807077"><span class="annot"><a href="#local-6989586621679807077"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-type">FFNInputWeight1F</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807081"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807080"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807079"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807078"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807077"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-165"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679807076"><span class="annot"><a href="#local-6989586621679807076"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807075"><span class="annot"><a href="#local-6989586621679807075"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807074"><span class="annot"><a href="#local-6989586621679807074"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807073"><span class="annot"><a href="#local-6989586621679807073"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807072"><span class="annot"><a href="#local-6989586621679807072"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807076"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807075"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807074"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807073"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807072"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-166"></span><span>
</span><span id="line-167"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-168"></span><span>  </span><span id="FFNInputWeight2F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-var">FFNInputWeight2F</span></a></span></span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807071"><span class="annot"><a href="#local-6989586621679807071"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807070"><span class="annot"><a href="#local-6989586621679807070"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807069"><span class="annot"><a href="#local-6989586621679807069"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807068"><span class="annot"><a href="#local-6989586621679807068"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807067"><span class="annot"><a href="#local-6989586621679807067"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807066"><span class="annot"><a href="#local-6989586621679807066"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-175"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-177"></span><span>  </span><span id="FFNInputWeight2F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-var">FFNInputWeight2F</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679807065"><span class="annot"><a href="#local-6989586621679807065"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807064"><span class="annot"><a href="#local-6989586621679807064"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807063"><span class="annot"><a href="#local-6989586621679807063"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807062"><span class="annot"><a href="#local-6989586621679807062"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807061"><span class="annot"><a href="#local-6989586621679807061"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807065"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807064"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807063"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807062"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807061"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-178"></span><span>  </span><span id="FFNInputWeight2F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-var">FFNInputWeight2F</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679807060"><span class="annot"><a href="#local-6989586621679807060"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807059"><span class="annot"><a href="#local-6989586621679807059"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807058"><span class="annot"><a href="#local-6989586621679807058"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807057"><span class="annot"><a href="#local-6989586621679807057"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807056"><span class="annot"><a href="#local-6989586621679807056"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-181"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807055"><span class="annot"><a href="#local-6989586621679807055"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807054"><span class="annot"><a href="#local-6989586621679807054"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807053"><span class="annot"><a href="#local-6989586621679807053"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807052"><span class="annot"><a href="#local-6989586621679807052"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807051"><span class="annot"><a href="#local-6989586621679807051"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807050"><span class="annot"><a href="#local-6989586621679807050"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-188"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679807049"><span class="annot"><a href="#local-6989586621679807049"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807048"><span class="annot"><a href="#local-6989586621679807048"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807047"><span class="annot"><a href="#local-6989586621679807047"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807046"><span class="annot"><a href="#local-6989586621679807046"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807045"><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807049"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807048"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807047"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807045"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807046"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-191"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679807044"><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807043"><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807042"><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807041"><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807040"><span class="annot"><a href="#local-6989586621679807040"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-type">FFNOutputWeightF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807044"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807043"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807042"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807041"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807040"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679807039"><span class="annot"><a href="#local-6989586621679807039"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807038"><span class="annot"><a href="#local-6989586621679807038"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807037"><span class="annot"><a href="#local-6989586621679807037"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807036"><span class="annot"><a href="#local-6989586621679807036"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679807035"><span class="annot"><a href="#local-6989586621679807035"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807039"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807038"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807037"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807035"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807036"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-195"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807034"><span class="annot"><a href="#local-6989586621679807034"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-type">Relu</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-type">GeluNew</span></a></span><span>
</span><span id="line-201"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-202"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-203"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-type">Relu</span></a></span><span>
</span><span id="line-204"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-205"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-206"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#GPT2"><span class="hs-identifier hs-type">GPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-209"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807031"><span class="annot"><a href="#local-6989586621679807031"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-213"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-214"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span>
</span><span id="line-215"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-216"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#GPT2"><span class="hs-identifier hs-type">GPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-223"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807030"><span class="annot"><a href="#local-6989586621679807030"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807029"><span class="annot"><a href="#local-6989586621679807029"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807028"><span class="annot"><a href="#local-6989586621679807028"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807027"><span class="annot"><a href="#local-6989586621679807027"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807026"><span class="annot"><a href="#local-6989586621679807026"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679807025"><span class="annot"><a href="#local-6989586621679807025"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807024"><span class="annot"><a href="#local-6989586621679807024"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807023"><span class="annot"><a href="#local-6989586621679807023"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807022"><span class="annot"><a href="#local-6989586621679807022"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807025"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807024"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807023"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807022"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679807021"><span class="annot"><a href="#local-6989586621679807021"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807020"><span class="annot"><a href="#local-6989586621679807020"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807019"><span class="annot"><a href="#local-6989586621679807019"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807018"><span class="annot"><a href="#local-6989586621679807018"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-type">FFNLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807021"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807020"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807019"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807018"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679807017"><span class="annot"><a href="#local-6989586621679807017"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679807016"><span class="annot"><a href="#local-6989586621679807016"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679807015"><span class="annot"><a href="#local-6989586621679807015"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679807014"><span class="annot"><a href="#local-6989586621679807014"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807017"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807016"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807015"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679807014"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-236"></span><span>  </span><span id="FFNDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-var">FFNDropoutF</span></a></span></span><span>
</span><span id="line-237"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679807013"><span class="annot"><a href="#local-6989586621679807013"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-238"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-240"></span><span>  </span><span id="FFNDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-var">FFNDropoutF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span id="local-6989586621679806999"><span id="local-6989586621679807000"><span id="local-6989586621679807001"><span id="local-6989586621679807002"><span id="local-6989586621679807003"><span id="local-6989586621679807004"><span id="local-6989586621679807005"><span id="local-6989586621679807006"><span id="local-6989586621679807007"><span id="local-6989586621679807008"><span id="local-6989586621679807009"><span id="local-6989586621679807010"><span id="local-6989586621679807011"><span id="local-6989586621679807012"><span class="hs-keyword">instance</span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-type">FFNInputWeight1F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807008"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807007"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807006"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><a href="#local-6989586621679807005"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-type">FFNInputWeight2F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807008"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807007"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807006"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807005"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807005"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-247"></span><span>    </span><span class="annot"><a href="#local-6989586621679807004"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-type">FFNOutputWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807008"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807007"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807006"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807004"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807004"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><a href="#local-6989586621679807003"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807003"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807003"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-251"></span><span>    </span><span class="annot"><a href="#local-6989586621679807002"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-252"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807002"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807002"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-253"></span><span>    </span><span class="annot"><a href="#local-6989586621679807001"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-type">FFNLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807008"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807007"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807001"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807001"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-255"></span><span>    </span><span class="annot"><a href="#local-6989586621679807000"><span class="hs-identifier hs-type">dropout</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-type">FFNDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-256"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807000"><span class="hs-identifier hs-type">dropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807000"><span class="hs-identifier hs-type">dropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807008"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807007"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807006"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="#local-6989586621679806999"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807011"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807010"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807008"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807007"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679807006"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="#local-6989586621679807009"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>  </span><span id="local-6989586621679806996"><span class="annot"><span class="annottext">initialize :: ModelSpec
  (TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim)
-&gt; Generator generatorDevice
-&gt; m (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim,
      Generator device)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetworkSpec"><span class="hs-identifier hs-type">TransformerFeedForwardNetworkSpec</span></a></span><span> </span><span id="local-6989586621679806994"><span class="annot"><a href="#local-6989586621679806994"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679806993"><span class="annot"><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679806992"><span class="annot"><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679806991"><span class="annot"><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679806990"><span class="annot"><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679806989"><span class="annot"><a href="#local-6989586621679806989"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679806988"><span class="annot"><a href="#local-6989586621679806988"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679806987"><span class="annot"><a href="#local-6989586621679806987"><span class="hs-identifier hs-var">eps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806986"><span class="annot"><span class="annottext">Generator generatorDevice
</span><a href="#local-6989586621679806986"><span class="hs-identifier hs-var">generator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679806985"><span class="annot"><span class="annottext">generator' :: Generator device
</span><a href="#local-6989586621679806985"><span class="hs-identifier hs-var hs-var">generator'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SDevice device -&gt; Generator generatorDevice -&gt; Generator device
forall (generatorDevice' :: Device (DeviceType Nat))
       (generatorDevice :: Device (DeviceType Nat)).
SDevice generatorDevice'
-&gt; Generator generatorDevice -&gt; Generator generatorDevice'
</span><a href="Torch.GraduallyTyped.Random.html#sGeneratorToDevice"><span class="hs-identifier hs-var">sGeneratorToDevice</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">Generator generatorDevice
</span><a href="#local-6989586621679806986"><span class="hs-identifier hs-var">generator</span></a></span><span>
</span><span id="line-266"></span><span>        </span><span id="local-6989586621679806984"><span class="annot"><span class="annottext">inputWeight1WithoutBiasSpec :: LinearSpec
  'WithoutBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806984"><span class="hs-identifier hs-var hs-var">inputWeight1WithoutBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; LinearSpec
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806989"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-267"></span><span>        </span><span id="local-6989586621679806981"><span class="annot"><span class="annottext">inputWeight1WithBiasSpec :: LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806981"><span class="hs-identifier hs-var hs-var">inputWeight1WithBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; LinearSpec
     'WithBias gradient device dataType queryEmbedDim ffnDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806989"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-268"></span><span>        </span><span id="local-6989586621679806979"><span class="annot"><span class="annottext">inputWeight1 :: IxStateT m (Generator device) (Generator device) inputWeight1
</span><a href="#local-6989586621679806979"><span class="hs-identifier hs-var hs-var">inputWeight1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator device -&gt; m (inputWeight1, Generator device))
-&gt; IxStateT m (Generator device) (Generator device) inputWeight1
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator device -&gt; m (inputWeight1, Generator device))
 -&gt; IxStateT m (Generator device) (Generator device) inputWeight1)
-&gt; (ModelSpec inputWeight1
    -&gt; Generator device -&gt; m (inputWeight1, Generator device))
-&gt; ModelSpec inputWeight1
-&gt; IxStateT m (Generator device) (Generator device) inputWeight1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize
   inputWeight1 generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec inputWeight1
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807012"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec inputWeight1
 -&gt; IxStateT m (Generator device) (Generator device) inputWeight1)
-&gt; ModelSpec inputWeight1
-&gt; IxStateT m (Generator device) (Generator device) inputWeight1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-269"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806994"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-270"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
LinearSpec
  'WithoutBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806984"><span class="hs-identifier hs-var">inputWeight1WithoutBiasSpec</span></a></span><span>
</span><span id="line-271"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
LinearSpec
  'WithoutBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806984"><span class="hs-identifier hs-var">inputWeight1WithoutBiasSpec</span></a></span><span>
</span><span id="line-272"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806981"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span>
</span><span id="line-273"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806981"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806981"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span>
</span><span id="line-275"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806981"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span>
</span><span id="line-276"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806981"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span>
</span><span id="line-277"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight1
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-278"></span><span>        </span><span id="local-6989586621679806967"><span class="annot"><span class="annottext">inputWeight2 :: IxStateT m (Generator device) (Generator device) inputWeight2
</span><a href="#local-6989586621679806967"><span class="hs-identifier hs-var hs-var">inputWeight2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator device -&gt; m (inputWeight2, Generator device))
-&gt; IxStateT m (Generator device) (Generator device) inputWeight2
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator device -&gt; m (inputWeight2, Generator device))
 -&gt; IxStateT m (Generator device) (Generator device) inputWeight2)
-&gt; (ModelSpec inputWeight2
    -&gt; Generator device -&gt; m (inputWeight2, Generator device))
-&gt; ModelSpec inputWeight2
-&gt; IxStateT m (Generator device) (Generator device) inputWeight2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize
   inputWeight2 generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec inputWeight2
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807005"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec inputWeight2
 -&gt; IxStateT m (Generator device) (Generator device) inputWeight2)
-&gt; ModelSpec inputWeight2
-&gt; IxStateT m (Generator device) (Generator device) inputWeight2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-279"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806994"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-280"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; LinearSpec
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806989"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-282"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec inputWeight2
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-288"></span><span>        </span><span id="local-6989586621679806966"><span class="annot"><span class="annottext">outputWeightWithoutBiasSpec :: LinearSpec
  'WithoutBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806966"><span class="hs-identifier hs-var hs-var">outputWeightWithoutBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; LinearSpec
     'WithoutBias gradient device dataType ffnDim queryEmbedDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806989"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span id="local-6989586621679806965"><span class="annot"><span class="annottext">outputWeightWithBiasSpec :: LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806965"><span class="hs-identifier hs-var hs-var">outputWeightWithBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; LinearSpec
     'WithBias gradient device dataType ffnDim queryEmbedDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806989"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-290"></span><span>        </span><span id="local-6989586621679806964"><span class="annot"><span class="annottext">outputWeight :: IxStateT m (Generator device) (Generator device) outputWeight
</span><a href="#local-6989586621679806964"><span class="hs-identifier hs-var hs-var">outputWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator device -&gt; m (outputWeight, Generator device))
-&gt; IxStateT m (Generator device) (Generator device) outputWeight
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator device -&gt; m (outputWeight, Generator device))
 -&gt; IxStateT m (Generator device) (Generator device) outputWeight)
-&gt; (ModelSpec outputWeight
    -&gt; Generator device -&gt; m (outputWeight, Generator device))
-&gt; ModelSpec outputWeight
-&gt; IxStateT m (Generator device) (Generator device) outputWeight
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize
   outputWeight generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec outputWeight
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807004"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec outputWeight
 -&gt; IxStateT m (Generator device) (Generator device) outputWeight)
-&gt; ModelSpec outputWeight
-&gt; IxStateT m (Generator device) (Generator device) outputWeight
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-291"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806994"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
LinearSpec
  'WithoutBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806966"><span class="hs-identifier hs-var">outputWeightWithoutBiasSpec</span></a></span><span>
</span><span id="line-293"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
LinearSpec
  'WithoutBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806966"><span class="hs-identifier hs-var">outputWeightWithoutBiasSpec</span></a></span><span>
</span><span id="line-294"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806965"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span>
</span><span id="line-295"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806965"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806965"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span>
</span><span id="line-297"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806965"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span>
</span><span id="line-298"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806965"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span>
</span><span id="line-299"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec outputWeight
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-300"></span><span>        </span><span id="local-6989586621679806963"><span class="annot"><span class="annottext">activation :: IxStateT m (Generator device) (Generator device) activation
</span><a href="#local-6989586621679806963"><span class="hs-identifier hs-var hs-var">activation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator device -&gt; m (activation, Generator device))
-&gt; IxStateT m (Generator device) (Generator device) activation
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator device -&gt; m (activation, Generator device))
 -&gt; IxStateT m (Generator device) (Generator device) activation)
-&gt; (ModelSpec activation
    -&gt; Generator device -&gt; m (activation, Generator device))
-&gt; ModelSpec activation
-&gt; IxStateT m (Generator device) (Generator device) activation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize
   activation generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec activation
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807003"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec activation
 -&gt; IxStateT m (Generator device) (Generator device) activation)
-&gt; ModelSpec activation
-&gt; IxStateT m (Generator device) (Generator device) activation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-301"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806994"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-302"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
Relu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-var">Relu</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
GeluNew
</span><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-var">GeluNew</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-306"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
Relu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-var">Relu</span></a></span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span>
</span><span id="line-309"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activation
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-310"></span><span>        </span><span id="local-6989586621679806959"><span class="annot"><span class="annottext">activationDropout :: IxStateT m (Generator device) (Generator device) activationDropout
</span><a href="#local-6989586621679806959"><span class="hs-identifier hs-var hs-var">activationDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator device -&gt; m (activationDropout, Generator device))
-&gt; IxStateT
     m (Generator device) (Generator device) activationDropout
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator device -&gt; m (activationDropout, Generator device))
 -&gt; IxStateT
      m (Generator device) (Generator device) activationDropout)
-&gt; (ModelSpec activationDropout
    -&gt; Generator device -&gt; m (activationDropout, Generator device))
-&gt; ModelSpec activationDropout
-&gt; IxStateT
     m (Generator device) (Generator device) activationDropout
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize
   activationDropout generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec activationDropout
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807002"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec activationDropout
 -&gt; IxStateT
      m (Generator device) (Generator device) activationDropout)
-&gt; ModelSpec activationDropout
-&gt; IxStateT
     m (Generator device) (Generator device) activationDropout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-311"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806994"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-312"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806988"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-313"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806988"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-314"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806988"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-315"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806988"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-316"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806988"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-317"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-318"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-319"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec activationDropout
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-320"></span><span>        </span><span id="local-6989586621679806957"><span class="annot"><span class="annottext">layerNormWithoutBiasSpec :: LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806957"><span class="hs-identifier hs-var hs-var">layerNormWithoutBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[queryEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806987"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-321"></span><span>        </span><span id="local-6989586621679806953"><span class="annot"><span class="annottext">layerNormWithBiasSpec :: LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806953"><span class="hs-identifier hs-var hs-var">layerNormWithBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[queryEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806993"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806992"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806991"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806990"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806987"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-322"></span><span>        </span><span id="local-6989586621679806952"><span class="annot"><span class="annottext">layerNorm :: IxStateT m (Generator device) (Generator device) layerNorm
</span><a href="#local-6989586621679806952"><span class="hs-identifier hs-var hs-var">layerNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator device -&gt; m (layerNorm, Generator device))
-&gt; IxStateT m (Generator device) (Generator device) layerNorm
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator device -&gt; m (layerNorm, Generator device))
 -&gt; IxStateT m (Generator device) (Generator device) layerNorm)
-&gt; (ModelSpec layerNorm
    -&gt; Generator device -&gt; m (layerNorm, Generator device))
-&gt; ModelSpec layerNorm
-&gt; IxStateT m (Generator device) (Generator device) layerNorm
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize
   layerNorm generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec layerNorm
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807001"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec layerNorm
 -&gt; IxStateT m (Generator device) (Generator device) layerNorm)
-&gt; ModelSpec layerNorm
-&gt; IxStateT m (Generator device) (Generator device) layerNorm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-323"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806994"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-324"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806957"><span class="hs-identifier hs-var">layerNormWithoutBiasSpec</span></a></span><span>
</span><span id="line-325"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806957"><span class="hs-identifier hs-var">layerNormWithoutBiasSpec</span></a></span><span>
</span><span id="line-326"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806953"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-327"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806953"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-328"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806953"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-329"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806953"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-330"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806953"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span>
</span><span id="line-331"></span><span>            </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ModelSpec layerNorm
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-332"></span><span>        </span><span id="local-6989586621679806951"><span class="annot"><span class="annottext">dropout :: IxStateT m (Generator device) (Generator device) Dropout
</span><a href="#local-6989586621679806951"><span class="hs-identifier hs-var hs-var">dropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator device -&gt; m (Dropout, Generator device))
-&gt; IxStateT m (Generator device) (Generator device) Dropout
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator device -&gt; m (Dropout, Generator device))
 -&gt; IxStateT m (Generator device) (Generator device) Dropout)
-&gt; (Dropout -&gt; Generator device -&gt; m (Dropout, Generator device))
-&gt; Dropout
-&gt; IxStateT m (Generator device) (Generator device) Dropout
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasInitialize
   dropout generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec dropout
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679807000"><span class="hs-identifier hs-type">dropout</span></a></span><span> </span><span class="annot"><span class="annottext">(Dropout
 -&gt; IxStateT m (Generator device) (Generator device) Dropout)
-&gt; Dropout
-&gt; IxStateT m (Generator device) (Generator device) Dropout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806988"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-333"></span><span>        </span><span id="local-6989586621679806950"><span class="annot"><span class="annottext">gffn :: IxStateT
  m
  (Generator device)
  (Generator device)
  (GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     Dropout)
</span><a href="#local-6989586621679806950"><span class="hs-identifier hs-var hs-var">gffn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-334"></span><span>          </span><span class="annot"><span class="annottext">inputWeight1
-&gt; inputWeight2
-&gt; outputWeight
-&gt; activation
-&gt; activationDropout
-&gt; layerNorm
-&gt; Dropout
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     Dropout
forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
inputWeight1
-&gt; inputWeight2
-&gt; outputWeight
-&gt; activation
-&gt; activationDropout
-&gt; layerNorm
-&gt; dropout
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     dropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-335"></span><span>            </span><span class="annot"><span class="annottext">(inputWeight1
 -&gt; inputWeight2
 -&gt; outputWeight
 -&gt; activation
 -&gt; activationDropout
 -&gt; layerNorm
 -&gt; Dropout
 -&gt; GTransformerFeedForwardNetwork
      inputWeight1
      inputWeight2
      outputWeight
      activation
      activationDropout
      layerNorm
      Dropout)
-&gt; IxStateT m (Generator device) (Generator device) inputWeight1
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (inputWeight2
      -&gt; outputWeight
      -&gt; activation
      -&gt; activationDropout
      -&gt; layerNorm
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           Dropout)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; Type -&gt; Type) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT m (Generator device) (Generator device) inputWeight1
</span><a href="#local-6989586621679806979"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span>
</span><span id="line-336"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (inputWeight2
   -&gt; outputWeight
   -&gt; activation
   -&gt; activationDropout
   -&gt; layerNorm
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        Dropout)
-&gt; IxStateT m (Generator device) (Generator device) inputWeight2
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (outputWeight
      -&gt; activation
      -&gt; activationDropout
      -&gt; layerNorm
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           Dropout)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT m (Generator device) (Generator device) inputWeight2
</span><a href="#local-6989586621679806967"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span>
</span><span id="line-337"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (outputWeight
   -&gt; activation
   -&gt; activationDropout
   -&gt; layerNorm
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        Dropout)
-&gt; IxStateT m (Generator device) (Generator device) outputWeight
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (activation
      -&gt; activationDropout
      -&gt; layerNorm
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           Dropout)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT m (Generator device) (Generator device) outputWeight
</span><a href="#local-6989586621679806964"><span class="hs-identifier hs-var">outputWeight</span></a></span><span>
</span><span id="line-338"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (activation
   -&gt; activationDropout
   -&gt; layerNorm
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        Dropout)
-&gt; IxStateT m (Generator device) (Generator device) activation
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (activationDropout
      -&gt; layerNorm
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           Dropout)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT m (Generator device) (Generator device) activation
</span><a href="#local-6989586621679806963"><span class="hs-identifier hs-var">activation</span></a></span><span>
</span><span id="line-339"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (activationDropout
   -&gt; layerNorm
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        Dropout)
-&gt; IxStateT
     m (Generator device) (Generator device) activationDropout
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (layerNorm
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           Dropout)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT m (Generator device) (Generator device) activationDropout
</span><a href="#local-6989586621679806959"><span class="hs-identifier hs-var">activationDropout</span></a></span><span>
</span><span id="line-340"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (layerNorm
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        Dropout)
-&gt; IxStateT m (Generator device) (Generator device) layerNorm
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (Dropout
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           Dropout)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT m (Generator device) (Generator device) layerNorm
</span><a href="#local-6989586621679806952"><span class="hs-identifier hs-var">layerNorm</span></a></span><span>
</span><span id="line-341"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (Dropout
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        Dropout)
-&gt; IxStateT m (Generator device) (Generator device) Dropout
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        Dropout)
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT m (Generator device) (Generator device) Dropout
</span><a href="#local-6989586621679806951"><span class="hs-identifier hs-var">dropout</span></a></span><span>
</span><span id="line-342"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim)
-&gt; Generator device
-&gt; m (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim,
      Generator device)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     Dropout)
</span><a href="#local-6989586621679806950"><span class="hs-identifier hs-var">gffn</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator device)
  (Generator device)
  (GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     Dropout)
-&gt; (GTransformerFeedForwardNetwork
      inputWeight1
      inputWeight2
      outputWeight
      activation
      activationDropout
      layerNorm
      Dropout
    -&gt; IxStateT
         m
         (Generator device)
         (Generator device)
         (TransformerFeedForwardNetwork
            style gradient device dataType queryEmbedDim ffnDim))
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim)
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TransformerFeedForwardNetwork
  style gradient device dataType queryEmbedDim ffnDim
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(TransformerFeedForwardNetwork
   style gradient device dataType queryEmbedDim ffnDim
 -&gt; IxStateT
      m
      (Generator device)
      (Generator device)
      (TransformerFeedForwardNetwork
         style gradient device dataType queryEmbedDim ffnDim))
-&gt; (GTransformerFeedForwardNetwork
      inputWeight1
      inputWeight2
      outputWeight
      activation
      activationDropout
      layerNorm
      Dropout
    -&gt; TransformerFeedForwardNetwork
         style gradient device dataType queryEmbedDim ffnDim)
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     Dropout
-&gt; IxStateT
     m
     (Generator device)
     (Generator device)
     (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  Dropout
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)).
GTransformerFeedForwardNetwork
  (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNActivationF style)
  (FFNActivationDropoutF style)
  (FFNLayerNormF style gradient device dataType queryEmbedDim)
  (FFNDropoutF style)
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Generator device
</span><a href="#local-6989586621679806985"><span class="hs-identifier hs-var">generator'</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span id="local-6989586621679806943"><span id="local-6989586621679806944"><span id="local-6989586621679806945"><span id="local-6989586621679806946"><span id="local-6989586621679806947"><span id="local-6989586621679806948"><span class="hs-keyword">instance</span><span>
</span><span id="line-345"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806947"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806946"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806945"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806944"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806943"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-349"></span><span>  </span><span id="local-6989586621679806939"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec
  (TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetworkSpec"><span class="hs-identifier hs-type">TransformerFeedForwardNetworkSpec</span></a></span><span> </span><span id="local-6989586621679806937"><span class="annot"><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679806936"><span class="annot"><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679806935"><span class="annot"><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679806934"><span class="annot"><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679806933"><span class="annot"><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679806932"><span class="annot"><a href="#local-6989586621679806932"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679806931"><span class="annot"><a href="#local-6989586621679806931"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679806930"><span class="annot"><a href="#local-6989586621679806930"><span class="hs-identifier hs-var">eps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806929"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679806928"><span class="annot"><span class="annottext">inputWeight1WithoutBiasSpec :: LinearSpec
  'WithoutBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806928"><span class="hs-identifier hs-var hs-var">inputWeight1WithoutBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; LinearSpec
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806932"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-351"></span><span>        </span><span id="local-6989586621679806927"><span class="annot"><span class="annottext">inputWeight1WithBiasSpec :: LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806927"><span class="hs-identifier hs-var hs-var">inputWeight1WithBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; LinearSpec
     'WithBias gradient device dataType queryEmbedDim ffnDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806932"><span class="hs-identifier hs-var">ffnDim</span></a></span><span>
</span><span id="line-352"></span><span>        </span><span id="local-6989586621679806926"><span class="annot"><span class="annottext">inputWeight1 :: STransformerStyle style
-&gt; m (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679806926"><span class="hs-identifier hs-var hs-var">inputWeight1</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim)
LinearSpec
  'WithoutBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806928"><span class="hs-identifier hs-var">inputWeight1WithoutBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim)
LinearSpec
  'WithoutBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806928"><span class="hs-identifier hs-var">inputWeight1WithoutBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_0.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>        </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806927"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806927"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806927"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806927"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType queryEmbedDim ffnDim)
LinearSpec 'WithBias gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806927"><span class="hs-identifier hs-var">inputWeight1WithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-360"></span><span>        </span><span id="local-6989586621679806925"><span class="annot"><span class="annottext">inputWeight2 :: STransformerStyle style
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679806925"><span class="hs-identifier hs-var hs-var">inputWeight2</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType queryEmbedDim ffnDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim queryEmbedDim
-&gt; SDim ffnDim
-&gt; LinearSpec
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806932"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>        </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-368"></span><span>        </span><span id="local-6989586621679806924"><span class="annot"><span class="annottext">outputWeightWithoutBiasSpec :: LinearSpec
  'WithoutBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806924"><span class="hs-identifier hs-var hs-var">outputWeightWithoutBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; LinearSpec
     'WithoutBias gradient device dataType ffnDim queryEmbedDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806932"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-369"></span><span>        </span><span id="local-6989586621679806923"><span class="annot"><span class="annottext">outputWeightWithBiasSpec :: LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806923"><span class="hs-identifier hs-var hs-var">outputWeightWithBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim ffnDim
-&gt; SDim queryEmbedDim
-&gt; LinearSpec
     'WithBias gradient device dataType ffnDim queryEmbedDim
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputDim :: Dim (Name Symbol) (Size Nat))
       (outputDim :: Dim (Name Symbol) (Size Nat)).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputDim
-&gt; SDim outputDim
-&gt; LinearSpec hasBias gradient device dataType inputDim outputDim
</span><a href="Torch.GraduallyTyped.NN.Linear.html#LinearSpec"><span class="hs-identifier hs-var">LinearSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679806932"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621679806922"><span class="annot"><span class="annottext">outputWeight :: STransformerStyle style
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679806922"><span class="hs-identifier hs-var hs-var">outputWeight</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType ffnDim queryEmbedDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim)
LinearSpec
  'WithoutBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806924"><span class="hs-identifier hs-var">outputWeightWithoutBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType ffnDim queryEmbedDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim)
LinearSpec
  'WithoutBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806924"><span class="hs-identifier hs-var">outputWeightWithoutBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806923"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806923"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806923"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806923"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (Linear 'WithBias gradient device dataType ffnDim queryEmbedDim)
LinearSpec 'WithBias gradient device dataType ffnDim queryEmbedDim
</span><a href="#local-6989586621679806923"><span class="hs-identifier hs-var">outputWeightWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-378"></span><span>        </span><span id="local-6989586621679806921"><span class="annot"><span class="annottext">activation :: STransformerStyle style -&gt; m (FFNActivationF style)
</span><a href="#local-6989586621679806921"><span class="hs-identifier hs-var hs-var">activation</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Relu -&gt; StateDictKey -&gt; m Relu
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec Relu
Relu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-var">Relu</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec GeluNew -&gt; StateDictKey -&gt; m GeluNew
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec GeluNew
GeluNew
</span><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-var">GeluNew</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-380"></span><span>        </span><span class="annot"><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu -&gt; StateDictKey -&gt; m Gelu
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-381"></span><span>        </span><span class="annot"><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu -&gt; StateDictKey -&gt; m Gelu
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-382"></span><span>        </span><span class="annot"><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Relu -&gt; StateDictKey -&gt; m Relu
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec Relu
Relu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-var">Relu</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-383"></span><span>        </span><span class="annot"><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu -&gt; StateDictKey -&gt; m Gelu
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-384"></span><span>        </span><span class="annot"><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu -&gt; StateDictKey -&gt; m Gelu
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec Gelu
Gelu
</span><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-var">Gelu</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-385"></span><span>        </span><span class="annot"><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNActivationF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-386"></span><span>        </span><span id="local-6989586621679806920"><span class="annot"><span class="annottext">activationDropout :: STransformerStyle style -&gt; m (FFNActivationDropoutF style)
</span><a href="#local-6989586621679806920"><span class="hs-identifier hs-var hs-var">activationDropout</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Dropout -&gt; StateDictKey -&gt; m Dropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806931"><span class="hs-identifier hs-var">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-387"></span><span>        </span><span class="annot"><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Dropout -&gt; StateDictKey -&gt; m Dropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806931"><span class="hs-identifier hs-var">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-388"></span><span>        </span><span class="annot"><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Dropout -&gt; StateDictKey -&gt; m Dropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806931"><span class="hs-identifier hs-var">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-389"></span><span>        </span><span class="annot"><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Dropout -&gt; StateDictKey -&gt; m Dropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806931"><span class="hs-identifier hs-var">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-390"></span><span>        </span><span class="annot"><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Dropout -&gt; StateDictKey -&gt; m Dropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806931"><span class="hs-identifier hs-var">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec () -&gt; StateDictKey -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNActivationDropoutF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-394"></span><span>        </span><span id="local-6989586621679806919"><span class="annot"><span class="annottext">layerNormWithoutBiasSpec :: LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806919"><span class="hs-identifier hs-var hs-var">layerNormWithoutBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[queryEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithoutBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithoutBias"><span class="hs-identifier hs-var">SWithoutBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806930"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-395"></span><span>        </span><span id="local-6989586621679806918"><span class="annot"><span class="annottext">layerNormWithBiasSpec :: LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var hs-var">layerNormWithBiasSpec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape ('Shape '[queryEmbedDim])
-&gt; Double
-&gt; LayerNormSpec
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
forall (hasBias :: HasBias) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (normalizedShape :: Shape [Dim (Name Symbol) (Size Nat)]).
SHasBias hasBias
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SShape normalizedShape
-&gt; Double
-&gt; LayerNormSpec hasBias gradient device dataType normalizedShape
</span><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNormSpec"><span class="hs-identifier hs-var">LayerNormSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SHasBias 'WithBias
</span><a href="Torch.GraduallyTyped.NN.Type.html#SWithBias"><span class="hs-identifier hs-var">SWithBias</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679806936"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679806935"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679806934"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679806933"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806930"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-396"></span><span>        </span><span id="local-6989586621679806917"><span class="annot"><span class="annottext">layerNorm :: STransformerStyle style
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679806917"><span class="hs-identifier hs-var hs-var">layerNorm</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806919"><span class="hs-identifier hs-var">layerNormWithoutBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
LayerNormSpec
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806919"><span class="hs-identifier hs-var">layerNormWithoutBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>        </span><span class="annot"><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
LayerNormSpec
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
</span><a href="#local-6989586621679806918"><span class="hs-identifier hs-var">layerNormWithBiasSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNLayerNormF style gradient device dataType queryEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-404"></span><span>        </span><span id="local-6989586621679806916"><span class="annot"><span class="annottext">dropout :: STransformerStyle style -&gt; m Dropout
</span><a href="#local-6989586621679806916"><span class="hs-identifier hs-var hs-var">dropout</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec Dropout -&gt; StateDictKey -&gt; m Dropout
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
ModelSpec model -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Dropout
</span><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-var">Dropout</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679806931"><span class="hs-identifier hs-var">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806929"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-405"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNActivationF style)
  (FFNActivationDropoutF style)
  (FFNLayerNormF style gradient device dataType queryEmbedDim)
  Dropout
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)).
GTransformerFeedForwardNetwork
  (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNActivationF style)
  (FFNActivationDropoutF style)
  (FFNLayerNormF style gradient device dataType queryEmbedDim)
  (FFNDropoutF style)
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-406"></span><span>          </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (FFNInputWeight1F
      style gradient device dataType queryEmbedDim ffnDim)
   (FFNInputWeight2F
      style gradient device dataType queryEmbedDim ffnDim)
   (FFNOutputWeightF
      style gradient device dataType queryEmbedDim ffnDim)
   (FFNActivationF style)
   (FFNActivationDropoutF style)
   (FFNLayerNormF style gradient device dataType queryEmbedDim)
   Dropout
 -&gt; TransformerFeedForwardNetwork
      style gradient device dataType queryEmbedDim ffnDim)
-&gt; m (GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
-&gt; m (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
-&gt; FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; FFNActivationF style
-&gt; FFNActivationDropoutF style
-&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
-&gt; Dropout
-&gt; GTransformerFeedForwardNetwork
     (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
     (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
     (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
     (FFNActivationF style)
     (FFNActivationDropoutF style)
     (FFNLayerNormF style gradient device dataType queryEmbedDim)
     Dropout
forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
inputWeight1
-&gt; inputWeight2
-&gt; outputWeight
-&gt; activation
-&gt; activationDropout
-&gt; layerNorm
-&gt; dropout
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     dropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-407"></span><span>                  </span><span class="annot"><span class="annottext">(FFNInputWeight1F
   style gradient device dataType queryEmbedDim ffnDim
 -&gt; FFNInputWeight2F
      style gradient device dataType queryEmbedDim ffnDim
 -&gt; FFNOutputWeightF
      style gradient device dataType queryEmbedDim ffnDim
 -&gt; FFNActivationF style
 -&gt; FFNActivationDropoutF style
 -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
 -&gt; Dropout
 -&gt; GTransformerFeedForwardNetwork
      (FFNInputWeight1F
         style gradient device dataType queryEmbedDim ffnDim)
      (FFNInputWeight2F
         style gradient device dataType queryEmbedDim ffnDim)
      (FFNOutputWeightF
         style gradient device dataType queryEmbedDim ffnDim)
      (FFNActivationF style)
      (FFNActivationDropoutF style)
      (FFNLayerNormF style gradient device dataType queryEmbedDim)
      Dropout)
-&gt; m (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim
      -&gt; FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim
      -&gt; FFNActivationF style
      -&gt; FFNActivationDropoutF style
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           Dropout)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679806926"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-408"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
   -&gt; FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim
   -&gt; FFNActivationF style
   -&gt; FFNActivationDropoutF style
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim
      -&gt; FFNActivationF style
      -&gt; FFNActivationDropoutF style
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           Dropout)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679806925"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-409"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
   -&gt; FFNActivationF style
   -&gt; FFNActivationDropoutF style
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; m (FFNActivationF style
      -&gt; FFNActivationDropoutF style
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           Dropout)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679806922"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-410"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNActivationF style
   -&gt; FFNActivationDropoutF style
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
-&gt; m (FFNActivationF style)
-&gt; m (FFNActivationDropoutF style
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           Dropout)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style -&gt; m (FFNActivationF style)
</span><a href="#local-6989586621679806921"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-411"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNActivationDropoutF style
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
-&gt; m (FFNActivationDropoutF style)
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           Dropout)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style -&gt; m (FFNActivationDropoutF style)
</span><a href="#local-6989586621679806920"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-412"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim)
-&gt; m (Dropout
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           Dropout)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679806917"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-413"></span><span>                  </span><span class="annot"><span class="annottext">m (Dropout
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
-&gt; m Dropout
-&gt; m (GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        Dropout)
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style -&gt; m Dropout
</span><a href="#local-6989586621679806916"><span class="hs-identifier hs-var">dropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679806937"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-414"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>  </span><span id="local-6989586621679806914"><span class="annot"><span class="annottext">toStateDict :: StateDictKey
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679806912"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679806905"><span id="local-6989586621679806906"><span id="local-6989586621679806907"><span id="local-6989586621679806908"><span id="local-6989586621679806909"><span id="local-6989586621679806910"><span id="local-6989586621679806911"><span class="annot"><span class="annottext">FFNDropoutF style
FFNLayerNormF style gradient device dataType queryEmbedDim
FFNActivationDropoutF style
FFNActivationF style
FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF style
ffnLayerNorm :: FFNLayerNormF style gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF style
ffnActivation :: FFNActivationF style
ffnOutputWeight :: FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679806905"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-416"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679806904"><span class="annot"><span class="annottext">inputWeight1 :: STransformerStyle style
-&gt; FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679806904"><span class="hs-identifier hs-var hs-var">inputWeight1</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_0.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>        </span><span class="annot"><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>        </span><span class="annot"><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>        </span><span class="annot"><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-423"></span><span>        </span><span class="annot"><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-424"></span><span>        </span><span id="local-6989586621679806903"><span class="annot"><span class="annottext">inputWeight2 :: STransformerStyle style
-&gt; FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679806903"><span class="hs-identifier hs-var hs-var">inputWeight2</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-425"></span><span>        </span><span class="annot"><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>        </span><span class="annot"><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-427"></span><span>        </span><span class="annot"><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-428"></span><span>        </span><span class="annot"><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-429"></span><span>        </span><span class="annot"><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-430"></span><span>        </span><span class="annot"><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-431"></span><span>        </span><span class="annot"><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-432"></span><span>        </span><span id="local-6989586621679806902"><span class="annot"><span class="annottext">outputWeight :: STransformerStyle style
-&gt; FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679806902"><span class="hs-identifier hs-var hs-var">outputWeight</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>        </span><span class="annot"><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>        </span><span class="annot"><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>        </span><span class="annot"><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>        </span><span class="annot"><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span>        </span><span class="annot"><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-438"></span><span>        </span><span class="annot"><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-439"></span><span>        </span><span class="annot"><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-440"></span><span>        </span><span id="local-6989586621679806901"><span class="annot"><span class="annottext">layerNorm :: STransformerStyle style
-&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
-&gt; m ()
</span><a href="#local-6989586621679806901"><span class="hs-identifier hs-var hs-var">layerNorm</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>        </span><span class="annot"><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>        </span><span class="annot"><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>        </span><span class="annot"><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>        </span><span class="annot"><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>        </span><span class="annot"><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model (m :: Type -&gt; Type).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679806912"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>        </span><span class="annot"><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNLayerNormF style gradient device dataType queryEmbedDim -&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-448"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-449"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679806904"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806911"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-450"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679806903"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806910"><span class="hs-identifier hs-var">ffnInputWeight2</span></a></span><span>
</span><span id="line-451"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679806902"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806909"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-452"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
-&gt; m ()
</span><a href="#local-6989586621679806901"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679806948"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNLayerNormF style gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679806906"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-453"></span><span>          </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-456"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806900"><span class="annot"><a href="#local-6989586621679806900"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806899"><span class="annot"><a href="#local-6989586621679806899"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806898"><span class="annot"><a href="#local-6989586621679806898"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679806897"><span class="annot"><a href="#local-6989586621679806897"><span class="hs-identifier hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-462"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-463"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679806896"><span class="annot"><a href="#local-6989586621679806896"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679806895"><span class="annot"><a href="#local-6989586621679806895"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679806894"><span class="annot"><a href="#local-6989586621679806894"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-464"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-465"></span><span>      </span><span class="annot"><a href="#local-6989586621679806894"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-type">LinearWithoutBiasF</span></a></span><span>
</span><span id="line-467"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806896"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806895"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-468"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-type">LinearWithoutBiasF</span></a></span><span>
</span><span id="line-469"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806895"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806896"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithoutBiasF"><span class="hs-identifier hs-type">LayerNormWithoutBiasF</span></a></span><span>
</span><span id="line-471"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806896"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>                  </span><span class="annot"><a href="#local-6989586621679806894"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-473"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679806893"><span class="annot"><a href="#local-6989586621679806893"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679806892"><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679806891"><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806893"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806892"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806891"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679806890"><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679806889"><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679806888"><span class="annot"><a href="#local-6989586621679806888"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-478"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-479"></span><span>      </span><span class="annot"><a href="#local-6989586621679806888"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-480"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-481"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-484"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806889"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-486"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithBiasF"><span class="hs-identifier hs-type">LayerNormWithBiasF</span></a></span><span>
</span><span id="line-487"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806890"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>                  </span><span class="annot"><a href="#local-6989586621679806888"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-490"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-493"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679806887"><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679806886"><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679806885"><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithBiasF"><span class="hs-identifier hs-type">LayerNormWithBiasF</span></a></span><span>
</span><span id="line-495"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-498"></span><span>          </span><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-499"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-500"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-502"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-503"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679806887"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679806886"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-505"></span><span>                  </span><span class="annot"><a href="#local-6989586621679806885"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-506"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'T5@.</span><span>
</span><span id="line-511"></span><span class="hs-comment">--</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-513"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-514"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-515"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-516"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-517"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-518"></span><span class="hs-comment">--      ffnLayerNorm     &#9474;</span><span>
</span><span id="line-519"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-520"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-521"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-522"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-523"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-524"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-525"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-526"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-527"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-528"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-529"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-530"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-531"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-532"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-533"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-534"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-535"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-536"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-538"></span><span id="local-6989586621679806872"><span id="local-6989586621679806873"><span id="local-6989586621679806874"><span id="local-6989586621679806875"><span id="local-6989586621679806876"><span id="local-6989586621679806877"><span id="local-6989586621679806878"><span id="local-6989586621679806879"><span id="local-6989586621679806880"><span id="local-6989586621679806881"><span id="local-6989586621679806882"><span id="local-6989586621679806883"><span id="local-6989586621679806884"><span class="hs-keyword">instance</span><span>
</span><span id="line-539"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-540"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-541"></span><span>    </span><span class="annot"><a href="#local-6989586621679806882"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-542"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-543"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806881"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806880"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-545"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806876"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806875"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806874"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806873"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><a href="#local-6989586621679806872"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806876"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806880"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806877"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806874"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806883"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806873"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806881"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806879"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806878"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806875"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806884"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><a href="#local-6989586621679806876"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><a href="#local-6989586621679806882"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-555"></span><span>    </span><span class="annot"><a href="#local-6989586621679806872"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679806869"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'T5 gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679806861"><span id="local-6989586621679806862"><span id="local-6989586621679806863"><span id="local-6989586621679806864"><span id="local-6989586621679806865"><span id="local-6989586621679806866"><span id="local-6989586621679806867"><span class="annot"><span class="annottext">FFNDropoutF 'T5
FFNLayerNormF 'T5 gradient device dataType queryEmbedDim
FFNActivationDropoutF 'T5
FFNActivationF 'T5
FFNOutputWeightF 'T5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F 'T5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F 'T5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'T5
ffnLayerNorm :: FFNLayerNormF 'T5 gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'T5
ffnActivation :: FFNActivationF 'T5
ffnOutputWeight :: FFNOutputWeightF 'T5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F 'T5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F 'T5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679806861"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806860"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806860"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806860"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-560"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'T5 gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679806862"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-561"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F 'T5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806867"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-562"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Relu
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Relu
FFNActivationF 'T5
</span><a href="#local-6989586621679806864"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-563"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNActivationDropoutF 'T5
</span><a href="#local-6989586621679806863"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-564"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify
                   (Device (DeviceType Nat))
                   device
                   (Unify (Device (DeviceType Nat)) device queryDevice))
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF 'T5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806865"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-565"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          generatorOutputDevice
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
          Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNDropoutF 'T5
</span><a href="#local-6989586621679806861"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-566"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(output
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; output)
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806860"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (queryDevice &lt;+&gt; generatorOutputDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-567"></span><span>
</span><span id="line-568"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'ByT5@.</span><span>
</span><span id="line-569"></span><span class="hs-comment">--</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-571"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-572"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-573"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-574"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-575"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-576"></span><span class="hs-comment">--      ffnLayerNorm     &#9474;</span><span>
</span><span id="line-577"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-578"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-579"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-580"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-581"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-582"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-583"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-584"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-585"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-586"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-587"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-588"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-589"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-590"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-591"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-592"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-593"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-594"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-596"></span><span id="local-6989586621679806847"><span id="local-6989586621679806848"><span id="local-6989586621679806849"><span id="local-6989586621679806850"><span id="local-6989586621679806851"><span id="local-6989586621679806852"><span id="local-6989586621679806853"><span id="local-6989586621679806854"><span id="local-6989586621679806855"><span id="local-6989586621679806856"><span id="local-6989586621679806857"><span id="local-6989586621679806858"><span id="local-6989586621679806859"><span class="hs-keyword">instance</span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806859"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-598"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806858"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-599"></span><span>    </span><span class="annot"><a href="#local-6989586621679806857"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-600"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-601"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806856"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806855"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-602"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806854"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-603"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806853"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806852"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806851"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806850"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806849"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806858"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806848"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806859"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><a href="#local-6989586621679806847"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806852"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806853"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806851"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-607"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-608"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806855"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806852"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806849"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806858"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806848"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806856"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806854"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806853"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806850"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806859"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>    </span><span class="annot"><a href="#local-6989586621679806851"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="#local-6989586621679806857"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-613"></span><span>    </span><span class="annot"><a href="#local-6989586621679806847"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-615"></span><span>  </span><span id="local-6989586621679806845"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'ByT5 gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679806845"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679806838"><span id="local-6989586621679806839"><span id="local-6989586621679806840"><span id="local-6989586621679806841"><span id="local-6989586621679806842"><span id="local-6989586621679806843"><span id="local-6989586621679806844"><span class="annot"><span class="annottext">FFNDropoutF 'ByT5
FFNLayerNormF 'ByT5 gradient device dataType queryEmbedDim
FFNActivationDropoutF 'ByT5
FFNActivationF 'ByT5
FFNOutputWeightF
  'ByT5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'ByT5
ffnLayerNorm :: FFNLayerNormF 'ByT5 gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'ByT5
ffnActivation :: FFNActivationF 'ByT5
ffnOutputWeight :: FFNOutputWeightF
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679806838"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806837"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806837"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-616"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679806836"><span class="annot"><span class="annottext">activate :: Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679806836"><span class="hs-identifier hs-var hs-var">activate</span></a></span></span><span> </span><span id="local-6989586621679806835"><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679806835"><span class="hs-identifier hs-var">query'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-617"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679806835"><span class="hs-identifier hs-var">query'</span></a></span><span>
</span><span id="line-618"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806844"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-619"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GeluNew
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GeluNew
FFNActivationF 'ByT5
</span><a href="#local-6989586621679806841"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-620"></span><span>        </span><span id="local-6989586621679806834"><span class="annot"><span class="annottext">gate :: Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679806834"><span class="hs-identifier hs-var hs-var">gate</span></a></span></span><span> </span><span id="local-6989586621679806833"><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679806833"><span class="hs-identifier hs-var">query'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     gradient
     (Or (Gradient RequiresGradient) gradient queryGradient))
  (Unify
     (Layout LayoutType)
     ('Layout 'Dense)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
  (Unify
     (Device (DeviceType Nat))
     device
     (Unify (Device (DeviceType Nat)) device queryDevice))
  (Unify
     (DataType DType)
     dataType
     (Unify (DataType DType) dataType queryDataType))
  (LinearWithoutBiasF
     ('Shape '[ffnDim, queryEmbedDim])
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      gradient
      (Or (Gradient RequiresGradient) gradient queryGradient))
   (Unify
      (Layout LayoutType)
      ('Layout 'Dense)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
   (Unify
      (Device (DeviceType Nat))
      device
      (Unify (Device (DeviceType Nat)) device queryDevice))
   (Unify
      (DataType DType)
      dataType
      (Unify (DataType DType) dataType queryDataType))
   (LinearWithoutBiasF
      ('Shape '[ffnDim, queryEmbedDim])
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
 -&gt; Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
 -&gt; Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
      -&gt; Tensor
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient))
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType))
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 k2 (f :: k1 -&gt; k2 -&gt; Type -&gt; Type) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679806836"><span class="hs-identifier hs-var">activate</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679806833"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
   -&gt; Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806843"><span class="hs-identifier hs-var">ffnInputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or (Gradient RequiresGradient) gradient queryGradient)
   (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
   (Unify (Device (DeviceType Nat)) device queryDevice)
   (Unify (DataType DType) dataType queryDataType)
   (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679806833"><span class="hs-identifier hs-var">query'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-621"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-622"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806837"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-623"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'ByT5 gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679806839"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-624"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679806834"><span class="hs-identifier hs-var">gate</span></a></span><span>
</span><span id="line-625"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GeluNew
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GeluNew
FFNActivationF 'ByT5
</span><a href="#local-6989586621679806841"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-626"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNActivationDropoutF 'ByT5
</span><a href="#local-6989586621679806840"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-627"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify
                   (Device (DeviceType Nat))
                   device
                   (Unify (Device (DeviceType Nat)) device queryDevice))
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'ByT5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806842"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-628"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          generatorOutputDevice
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
          Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNDropoutF 'ByT5
</span><a href="#local-6989586621679806838"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-629"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(output
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; output)
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806837"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (queryDevice &lt;+&gt; generatorOutputDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-630"></span><span>
</span><span id="line-631"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'BART@.</span><span>
</span><span id="line-632"></span><span class="hs-comment">--</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-634"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-635"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-636"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-637"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-638"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-639"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-640"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-641"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-642"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-643"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-644"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-645"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-646"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-647"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-648"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-649"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-650"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-651"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-652"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-653"></span><span class="hs-comment">--      ffnLayerNorm</span><span>
</span><span id="line-654"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-655"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-656"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-657"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-658"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-660"></span><span id="local-6989586621679806819"><span id="local-6989586621679806820"><span id="local-6989586621679806821"><span id="local-6989586621679806822"><span id="local-6989586621679806823"><span id="local-6989586621679806824"><span id="local-6989586621679806825"><span id="local-6989586621679806826"><span id="local-6989586621679806827"><span id="local-6989586621679806828"><span id="local-6989586621679806829"><span id="local-6989586621679806830"><span id="local-6989586621679806831"><span class="hs-keyword">instance</span><span>
</span><span id="line-661"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806831"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-662"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806830"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-663"></span><span>    </span><span class="annot"><a href="#local-6989586621679806829"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-664"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-665"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806828"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806827"><span class="hs-identifier hs-type">queryGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806826"><span class="hs-identifier hs-type">queryLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-667"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806825"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806824"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806823"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806822"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806821"><span class="hs-identifier hs-type">queryDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806830"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806820"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806831"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-670"></span><span>    </span><span class="annot"><a href="#local-6989586621679806819"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-671"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806825"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806825"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806824"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806823"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806825"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806824"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806823"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-672"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-673"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-674"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806828"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806825"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806822"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806830"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806820"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-675"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806827"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806826"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806824"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806821"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806831"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span>    </span><span class="annot"><a href="#local-6989586621679806823"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-677"></span><span>    </span><span class="annot"><a href="#local-6989586621679806829"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-678"></span><span>    </span><span class="annot"><a href="#local-6989586621679806819"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-679"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-680"></span><span>  </span><span id="local-6989586621679806817"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'BART gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679806817"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679806810"><span id="local-6989586621679806811"><span id="local-6989586621679806812"><span id="local-6989586621679806813"><span id="local-6989586621679806814"><span id="local-6989586621679806815"><span id="local-6989586621679806816"><span class="annot"><span class="annottext">FFNDropoutF 'BART
FFNLayerNormF 'BART gradient device dataType queryEmbedDim
FFNActivationDropoutF 'BART
FFNActivationF 'BART
FFNOutputWeightF
  'BART gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'BART gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BART gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'BART
ffnLayerNorm :: FFNLayerNormF 'BART gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'BART
ffnActivation :: FFNActivationF 'BART
ffnOutputWeight :: FFNOutputWeightF
  'BART gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'BART gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'BART gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679806810"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806809"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806809"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-681"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-682"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806809"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-683"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BART gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806816"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-684"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gelu
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Gelu
FFNActivationF 'BART
</span><a href="#local-6989586621679806813"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-685"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNActivationDropoutF 'BART
</span><a href="#local-6989586621679806812"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-686"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice))
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify (Device (DeviceType Nat)) device queryDevice)
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify (Device (DeviceType Nat)) device queryDevice)
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify (Device (DeviceType Nat)) device queryDevice)
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'BART gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806814"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-687"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify (Device (DeviceType Nat)) device queryDevice)
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify (Device (DeviceType Nat)) device queryDevice)
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          generatorOutputDevice
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
          Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNDropoutF 'BART
</span><a href="#local-6989586621679806810"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-688"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               queryGradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               queryLayout
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
            (Unify
               (DataType DType)
               queryDataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (BroadcastShapesF
               queryShape
               (LinearWithBiasF
                  ('Shape '[queryEmbedDim, ffnDim])
                  ('Shape '[queryEmbedDim])
                  (LinearWithBiasF
                     ('Shape '[ffnDim, queryEmbedDim])
                     ('Shape '[ffnDim])
                     queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     queryGradient
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient)))
  (Unify
     (Layout LayoutType)
     queryLayout
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
  (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
  (Unify
     (DataType DType)
     queryDataType
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType)))
  (BroadcastShapesF
     queryShape
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      queryGradient
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient)))
   (Unify
      (Layout LayoutType)
      queryLayout
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
   (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
   (Unify
      (DataType DType)
      queryDataType
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType)))
   (BroadcastShapesF
      queryShape
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806809"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (queryDevice &lt;+&gt; generatorOutputDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorOutputDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorOutputDevice
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; Generator generatorOutputDevice
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; Generator generatorOutputDevice
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'BART gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679806811"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-690"></span><span>
</span><span id="line-691"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'BERT@.</span><span>
</span><span id="line-692"></span><span class="hs-comment">--</span><span>
</span><span id="line-693"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-694"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-695"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-696"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-697"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-698"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-699"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-700"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-701"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-702"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-703"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-704"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-705"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-706"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-707"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-708"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-709"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-710"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-711"></span><span class="hs-comment">--      ffnLayerNorm</span><span>
</span><span id="line-712"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-713"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-714"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-715"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-716"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-718"></span><span id="local-6989586621679806796"><span id="local-6989586621679806797"><span id="local-6989586621679806798"><span id="local-6989586621679806799"><span id="local-6989586621679806800"><span id="local-6989586621679806801"><span id="local-6989586621679806802"><span id="local-6989586621679806803"><span id="local-6989586621679806804"><span id="local-6989586621679806805"><span id="local-6989586621679806806"><span id="local-6989586621679806807"><span id="local-6989586621679806808"><span class="hs-keyword">instance</span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806808"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-720"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806807"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-721"></span><span>    </span><span class="annot"><a href="#local-6989586621679806806"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-723"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806805"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806804"><span class="hs-identifier hs-type">queryGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806803"><span class="hs-identifier hs-type">queryLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806802"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806801"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806800"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-726"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806799"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806798"><span class="hs-identifier hs-type">queryDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-727"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806807"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806797"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806808"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-728"></span><span>    </span><span class="annot"><a href="#local-6989586621679806796"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-729"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806802"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806802"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806801"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806800"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-730"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-731"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-732"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806805"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806802"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806799"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806807"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806797"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806804"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806803"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806801"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806798"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806808"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>    </span><span class="annot"><a href="#local-6989586621679806800"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-735"></span><span>    </span><span class="annot"><a href="#local-6989586621679806806"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-736"></span><span>    </span><span class="annot"><a href="#local-6989586621679806796"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-738"></span><span>  </span><span id="local-6989586621679806794"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'BERT gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679806794"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679806787"><span id="local-6989586621679806788"><span id="local-6989586621679806789"><span id="local-6989586621679806790"><span id="local-6989586621679806791"><span id="local-6989586621679806792"><span id="local-6989586621679806793"><span class="annot"><span class="annottext">FFNDropoutF 'BERT
FFNLayerNormF 'BERT gradient device dataType queryEmbedDim
FFNActivationDropoutF 'BERT
FFNActivationF 'BERT
FFNOutputWeightF
  'BERT gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'BERT gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'BERT
ffnLayerNorm :: FFNLayerNormF 'BERT gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'BERT
ffnActivation :: FFNActivationF 'BERT
ffnOutputWeight :: FFNOutputWeightF
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679806787"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806786"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806786"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-739"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-740"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806786"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-741"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BERT gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806793"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-742"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gelu
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Gelu
FFNActivationF 'BERT
</span><a href="#local-6989586621679806790"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-743"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'BERT gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806791"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-744"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          generatorOutputDevice
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
          Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNDropoutF 'BERT
</span><a href="#local-6989586621679806787"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-745"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               queryGradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               queryLayout
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
            (Unify
               (DataType DType)
               queryDataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (BroadcastShapesF
               queryShape
               (LinearWithBiasF
                  ('Shape '[queryEmbedDim, ffnDim])
                  ('Shape '[queryEmbedDim])
                  (LinearWithBiasF
                     ('Shape '[ffnDim, queryEmbedDim])
                     ('Shape '[ffnDim])
                     queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     queryGradient
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient)))
  (Unify
     (Layout LayoutType)
     queryLayout
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
  (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
  (Unify
     (DataType DType)
     queryDataType
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType)))
  (BroadcastShapesF
     queryShape
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      queryGradient
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient)))
   (Unify
      (Layout LayoutType)
      queryLayout
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
   (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
   (Unify
      (DataType DType)
      queryDataType
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType)))
   (BroadcastShapesF
      queryShape
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806786"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (queryDevice &lt;+&gt; generatorOutputDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorOutputDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorOutputDevice
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; Generator generatorOutputDevice
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; Generator generatorOutputDevice
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'BERT gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679806788"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'RoBERTa@.</span><span>
</span><span id="line-749"></span><span class="hs-comment">--</span><span>
</span><span id="line-750"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-751"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-752"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-753"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-754"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-755"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-756"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-757"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-758"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-759"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-760"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-761"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-762"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-763"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-764"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-765"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-766"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-767"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-768"></span><span class="hs-comment">--      ffnLayerNorm</span><span>
</span><span id="line-769"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-770"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-771"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-772"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-773"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-775"></span><span id="local-6989586621679806773"><span id="local-6989586621679806774"><span id="local-6989586621679806775"><span id="local-6989586621679806776"><span id="local-6989586621679806777"><span id="local-6989586621679806778"><span id="local-6989586621679806779"><span id="local-6989586621679806780"><span id="local-6989586621679806781"><span id="local-6989586621679806782"><span id="local-6989586621679806783"><span id="local-6989586621679806784"><span id="local-6989586621679806785"><span class="hs-keyword">instance</span><span>
</span><span id="line-776"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806785"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-777"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806784"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-778"></span><span>    </span><span class="annot"><a href="#local-6989586621679806783"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-779"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-780"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806782"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806781"><span class="hs-identifier hs-type">queryGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-781"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806780"><span class="hs-identifier hs-type">queryLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806779"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806778"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806777"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806776"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806775"><span class="hs-identifier hs-type">queryDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806784"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806774"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806785"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-785"></span><span>    </span><span class="annot"><a href="#local-6989586621679806773"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-786"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806779"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806779"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806778"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806777"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-788"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-789"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806782"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806779"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806776"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806784"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806774"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806781"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806780"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806778"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806775"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806785"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>    </span><span class="annot"><a href="#local-6989586621679806777"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-792"></span><span>    </span><span class="annot"><a href="#local-6989586621679806783"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-793"></span><span>    </span><span class="annot"><a href="#local-6989586621679806773"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-794"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-795"></span><span>  </span><span id="local-6989586621679806771"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679806771"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679806764"><span id="local-6989586621679806765"><span id="local-6989586621679806766"><span id="local-6989586621679806767"><span id="local-6989586621679806768"><span id="local-6989586621679806769"><span id="local-6989586621679806770"><span class="annot"><span class="annottext">FFNDropoutF 'RoBERTa
FFNLayerNormF 'RoBERTa gradient device dataType queryEmbedDim
FFNActivationDropoutF 'RoBERTa
FFNActivationF 'RoBERTa
FFNOutputWeightF
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'RoBERTa
ffnLayerNorm :: FFNLayerNormF 'RoBERTa gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'RoBERTa
ffnActivation :: FFNActivationF 'RoBERTa
ffnOutputWeight :: FFNOutputWeightF
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679806764"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806763"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806763"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-796"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-797"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806763"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-798"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806770"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-799"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gelu
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Gelu
FFNActivationF 'RoBERTa
</span><a href="#local-6989586621679806767"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-800"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806768"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-801"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          generatorOutputDevice
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
          Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNDropoutF 'RoBERTa
</span><a href="#local-6989586621679806764"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-802"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               queryGradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               queryLayout
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
            (Unify
               (DataType DType)
               queryDataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (BroadcastShapesF
               queryShape
               (LinearWithBiasF
                  ('Shape '[queryEmbedDim, ffnDim])
                  ('Shape '[queryEmbedDim])
                  (LinearWithBiasF
                     ('Shape '[ffnDim, queryEmbedDim])
                     ('Shape '[ffnDim])
                     queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     queryGradient
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient)))
  (Unify
     (Layout LayoutType)
     queryLayout
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
  (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
  (Unify
     (DataType DType)
     queryDataType
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType)))
  (BroadcastShapesF
     queryShape
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      queryGradient
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient)))
   (Unify
      (Layout LayoutType)
      queryLayout
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
   (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
   (Unify
      (DataType DType)
      queryDataType
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType)))
   (BroadcastShapesF
      queryShape
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806763"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (queryDevice &lt;+&gt; generatorOutputDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-803"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorOutputDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorOutputDevice
  -&gt; m (output, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; Generator generatorOutputDevice
    -&gt; m (output, Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify (Device (DeviceType Nat)) queryDevice generatorOutputDevice)
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; Generator generatorOutputDevice
-&gt; m (output, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'RoBERTa gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679806765"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-804"></span><span>
</span><span id="line-805"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'Pegasus@.</span><span>
</span><span id="line-806"></span><span class="hs-comment">--</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-808"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-809"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-810"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-811"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-812"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-813"></span><span class="hs-comment">--      ffnLayerNorm     &#9474;</span><span>
</span><span id="line-814"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-815"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-816"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-817"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-818"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-819"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-820"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-821"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-822"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-823"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-824"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-825"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-826"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-827"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-828"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-829"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-830"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-831"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-833"></span><span id="local-6989586621679806750"><span id="local-6989586621679806751"><span id="local-6989586621679806752"><span id="local-6989586621679806753"><span id="local-6989586621679806754"><span id="local-6989586621679806755"><span id="local-6989586621679806756"><span id="local-6989586621679806757"><span id="local-6989586621679806758"><span id="local-6989586621679806759"><span id="local-6989586621679806760"><span id="local-6989586621679806761"><span id="local-6989586621679806762"><span class="hs-keyword">instance</span><span>
</span><span id="line-834"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806762"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-835"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806761"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-836"></span><span>    </span><span class="annot"><a href="#local-6989586621679806760"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-837"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-838"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806759"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806758"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-839"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806757"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-840"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806756"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806755"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806754"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-841"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806753"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806752"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-842"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806761"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806751"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806762"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-843"></span><span>    </span><span class="annot"><a href="#local-6989586621679806750"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679806755"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806756"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806754"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-844"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-845"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-846"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806758"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806755"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806752"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806761"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806751"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-847"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806759"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806757"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806756"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806753"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679806762"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>    </span><span class="annot"><a href="#local-6989586621679806754"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-849"></span><span>    </span><span class="annot"><a href="#local-6989586621679806760"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-850"></span><span>    </span><span class="annot"><a href="#local-6989586621679806750"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-851"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-852"></span><span>  </span><span id="local-6989586621679806748"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'Pegasus gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="#local-6989586621679806748"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679806741"><span id="local-6989586621679806742"><span id="local-6989586621679806743"><span id="local-6989586621679806744"><span id="local-6989586621679806745"><span id="local-6989586621679806746"><span id="local-6989586621679806747"><span class="annot"><span class="annottext">FFNDropoutF 'Pegasus
FFNLayerNormF 'Pegasus gradient device dataType queryEmbedDim
FFNActivationDropoutF 'Pegasus
FFNActivationF 'Pegasus
FFNOutputWeightF
  'Pegasus gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'Pegasus
ffnLayerNorm :: FFNLayerNormF 'Pegasus gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'Pegasus
ffnActivation :: FFNActivationF 'Pegasus
ffnOutputWeight :: FFNOutputWeightF
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679806741"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679806740"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806740"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-853"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall (m :: Type -&gt; Type) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   output
 -&gt; Generator generatorDevice
 -&gt; m (output, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-854"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806740"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-855"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LayerNormWithBiasF
             ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
          Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'Pegasus gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679806742"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-856"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithBiasF
        ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithBiasF
         ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithBiasF
         ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithBiasF
        ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithBiasF
        ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806747"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-857"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
          Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Relu
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Relu
FFNActivationF 'Pegasus
</span><a href="#local-6989586621679806744"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-858"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNActivationDropoutF 'Pegasus
</span><a href="#local-6989586621679806743"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-859"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  (LayerNormWithBiasF
                     ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
       Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify
                   (Device (DeviceType Nat))
                   device
                   (Unify (Device (DeviceType Nat)) device queryDevice))
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                ('Shape '[ffnDim])
                (LayerNormWithBiasF
                   ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  (LayerNormWithBiasF
                     ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
          Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'Pegasus gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679806745"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-860"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator generatorOutputDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  (LayerNormWithBiasF
                     ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; m (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall (m :: Type -&gt; Type) i j a.
(i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; m (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          generatorOutputDevice
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                ('Shape '[ffnDim])
                (LayerNormWithBiasF
                   ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator generatorOutputDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         generatorOutputDevice
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; m (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            generatorOutputDevice
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  (LayerNormWithBiasF
                     ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
          Generator generatorOutputDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator generatorOutputDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; m (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        generatorOutputDevice
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: Type -&gt; Type).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout
FFNDropoutF 'Pegasus
</span><a href="#local-6989586621679806741"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-861"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         output)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(output
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      generatorOutputDevice
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; output)
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679806740"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     generatorOutputDevice
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (queryDevice &lt;+&gt; generatorOutputDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-862"></span></pre></body></html>