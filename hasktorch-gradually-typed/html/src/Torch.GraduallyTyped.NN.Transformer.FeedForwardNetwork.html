<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE NoStarIsType #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# OPTIONS_GHC -fplugin TypeLevel.Rewrite
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyRightAssociativeL
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL2
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL2C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL3
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL3C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL4
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL4C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL5
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL5C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL6
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL6C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL7
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL7C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL8
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.UnifyIdempotenceL8C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrRightAssociativeL
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL2
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL2C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL3
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL3C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL4
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL4C
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL5
                -fplugin-opt=TypeLevel.Rewrite:Torch.GraduallyTyped.Unify.OrIdempotenceL5C #-}</span><span>
</span><span id="line-44"></span><span class="hs-pragma">{-# OPTIONS_GHC -v2 -Wall #-}</span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">sing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SList</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier">Torch.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier">Dense</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Activation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier">Gelu</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier">GeluNew</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier">Relu</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier">Dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Functional.Linear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier">LinearWithBiasF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier">LinearWithoutBiasF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Functional.Normalization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithBiasF"><span class="hs-identifier">LayerNormWithBiasF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithoutBiasF"><span class="hs-identifier">LayerNormWithoutBiasF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Linear</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier">Linear</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Normalization</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier">LayerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#HasBias"><span class="hs-identifier">HasBias</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html"><span class="hs-identifier">Torch.GraduallyTyped.Random</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier">Generator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html"><span class="hs-identifier">Torch.GraduallyTyped.Scalar</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier">Scalar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier">BroadcastShapesF</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator">(:|:)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-identifier">add</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier">SGetDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier">SGetShape</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator">(&lt;|&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Generic transformer feed-forward network.</span><span>
</span><span id="line-78"></span><span class="hs-comment">-- Needs to be specialized to a given transformer type, e.g. 'T5'.</span><span>
</span><span id="line-79"></span><span class="hs-comment">-- See 'TransformerFeedForwardNetwork'.</span><span>
</span><span id="line-80"></span><span class="hs-keyword">data</span><span>
</span><span id="line-81"></span><span>  </span><span id="GTransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753740"><span class="annot"><a href="#local-6989586621679753740"><span class="hs-identifier hs-type">inputWeight1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753739"><span class="annot"><a href="#local-6989586621679753739"><span class="hs-identifier hs-type">inputWeight2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753738"><span class="annot"><a href="#local-6989586621679753738"><span class="hs-identifier hs-type">outputWeight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753737"><span class="annot"><a href="#local-6989586621679753737"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753736"><span class="annot"><a href="#local-6989586621679753736"><span class="hs-identifier hs-type">activationDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753735"><span class="annot"><a href="#local-6989586621679753735"><span class="hs-identifier hs-type">layerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753734"><span class="annot"><a href="#local-6989586621679753734"><span class="hs-identifier hs-type">dropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-90"></span><span>  </span><span id="GTransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679753952"><span class="annot"><a href="#local-6989586621679753952"><span class="hs-identifier hs-type">inputWeight1</span></a></span></span><span> </span><span id="local-6989586621679753951"><span class="annot"><a href="#local-6989586621679753951"><span class="hs-identifier hs-type">inputWeight2</span></a></span></span><span> </span><span id="local-6989586621679753950"><span class="annot"><a href="#local-6989586621679753950"><span class="hs-identifier hs-type">outputWeight</span></a></span></span><span> </span><span id="local-6989586621679753949"><span class="annot"><a href="#local-6989586621679753949"><span class="hs-identifier hs-type">activation</span></a></span></span><span> </span><span id="local-6989586621679753948"><span class="annot"><a href="#local-6989586621679753948"><span class="hs-identifier hs-type">activationDropout</span></a></span></span><span> </span><span id="local-6989586621679753947"><span class="annot"><a href="#local-6989586621679753947"><span class="hs-identifier hs-type">layerNorm</span></a></span></span><span> </span><span id="local-6989586621679753946"><span class="annot"><a href="#local-6989586621679753946"><span class="hs-identifier hs-type">dropout</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | first input weight</span><span>
</span><span id="line-93"></span><span>      </span><span id="ffnInputWeight1"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnInputWeight1"><span class="hs-identifier hs-var hs-var">ffnInputWeight1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679753952"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-comment">-- | second input weight</span><span>
</span><span id="line-95"></span><span>      </span><span id="ffnInputWeight2"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnInputWeight2"><span class="hs-identifier hs-var hs-var">ffnInputWeight2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679753951"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-96"></span><span>      </span><span class="hs-comment">-- | output weight</span><span>
</span><span id="line-97"></span><span>      </span><span id="ffnOutputWeight"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnOutputWeight"><span class="hs-identifier hs-var hs-var">ffnOutputWeight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679753950"><span class="hs-identifier hs-type">outputWeight</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-comment">-- | activation</span><span>
</span><span id="line-99"></span><span>      </span><span id="ffnActivation"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnActivation"><span class="hs-identifier hs-var hs-var">ffnActivation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679753949"><span class="hs-identifier hs-type">activation</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-comment">-- | activation dropout</span><span>
</span><span id="line-101"></span><span>      </span><span id="ffnActivationDropout"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnActivationDropout"><span class="hs-identifier hs-var hs-var">ffnActivationDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679753948"><span class="hs-identifier hs-type">activationDropout</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-comment">-- | feed-forward layer norm</span><span>
</span><span id="line-103"></span><span>      </span><span id="ffnLayerNorm"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnLayerNorm"><span class="hs-identifier hs-var hs-var">ffnLayerNorm</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679753947"><span class="hs-identifier hs-type">layerNorm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-comment">-- | feed-forward dropout</span><span>
</span><span id="line-105"></span><span>      </span><span id="ffnDropout"><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#ffnDropout"><span class="hs-identifier hs-var hs-var">ffnDropout</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679753946"><span class="hs-identifier hs-type">dropout</span></a></span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753952"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753951"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753950"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753949"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753948"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753947"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753946"><span class="hs-identifier hs-type">dropout</span></a></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Transformer feed-forward network.</span><span>
</span><span id="line-110"></span><span class="hs-keyword">data</span><span>
</span><span id="line-111"></span><span>  </span><span id="TransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753725"><span class="annot"><a href="#local-6989586621679753725"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753724"><span class="annot"><a href="#local-6989586621679753724"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753723"><span class="annot"><a href="#local-6989586621679753723"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753722"><span class="annot"><a href="#local-6989586621679753722"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753721"><span class="annot"><a href="#local-6989586621679753721"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753720"><span class="annot"><a href="#local-6989586621679753720"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753719"><span class="annot"><a href="#local-6989586621679753719"><span class="hs-identifier hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>  </span><span id="TransformerFeedForwardNetwork"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679753916"><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679753915"><span class="annot"><a href="#local-6989586621679753915"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753914"><span class="annot"><a href="#local-6989586621679753914"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753913"><span class="annot"><a href="#local-6989586621679753913"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753912"><span class="annot"><a href="#local-6989586621679753912"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753911"><span class="annot"><a href="#local-6989586621679753911"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679753910"><span class="annot"><a href="#local-6989586621679753910"><span class="hs-identifier hs-type">dropoutP</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-123"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-type">FFNInputWeight1F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753915"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753914"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753913"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753912"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753911"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-124"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-type">FFNInputWeight2F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753915"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753914"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753913"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753912"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753911"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-type">FFNOutputWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753915"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753914"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753913"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753912"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753911"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753910"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-type">FFNLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753915"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753914"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753913"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753912"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-type">FFNDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753910"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753916"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753915"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753914"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753913"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753912"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753911"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753910"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-133"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753717"><span class="annot"><a href="#local-6989586621679753717"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753716"><span class="annot"><a href="#local-6989586621679753716"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753715"><span class="annot"><a href="#local-6989586621679753715"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753714"><span class="annot"><a href="#local-6989586621679753714"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753713"><span class="annot"><a href="#local-6989586621679753713"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753712"><span class="annot"><a href="#local-6989586621679753712"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679753711"><span class="annot"><a href="#local-6989586621679753711"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753710"><span class="annot"><a href="#local-6989586621679753710"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753709"><span class="annot"><a href="#local-6989586621679753709"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753708"><span class="annot"><a href="#local-6989586621679753708"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753707"><span class="annot"><a href="#local-6989586621679753707"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753711"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753710"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753709"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753708"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753707"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753706"><span class="annot"><a href="#local-6989586621679753706"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753705"><span class="annot"><a href="#local-6989586621679753705"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753704"><span class="annot"><a href="#local-6989586621679753704"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753703"><span class="annot"><a href="#local-6989586621679753703"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753702"><span class="annot"><a href="#local-6989586621679753702"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-type">FFNInputWeight1F</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753706"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753705"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753704"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753703"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753702"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-144"></span><span>  </span><span id="FFNInputWeight1F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-var">FFNInputWeight1F</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679753701"><span class="annot"><a href="#local-6989586621679753701"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753700"><span class="annot"><a href="#local-6989586621679753700"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753699"><span class="annot"><a href="#local-6989586621679753699"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753698"><span class="annot"><a href="#local-6989586621679753698"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753697"><span class="annot"><a href="#local-6989586621679753697"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753701"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753700"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753699"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753698"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753697"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-147"></span><span>  </span><span id="FFNInputWeight2F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-var">FFNInputWeight2F</span></a></span></span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753696"><span class="annot"><a href="#local-6989586621679753696"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753695"><span class="annot"><a href="#local-6989586621679753695"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753694"><span class="annot"><a href="#local-6989586621679753694"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753693"><span class="annot"><a href="#local-6989586621679753693"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753692"><span class="annot"><a href="#local-6989586621679753692"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753691"><span class="annot"><a href="#local-6989586621679753691"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-156"></span><span>  </span><span id="FFNInputWeight2F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-var">FFNInputWeight2F</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753690"><span class="annot"><a href="#local-6989586621679753690"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753689"><span class="annot"><a href="#local-6989586621679753689"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753688"><span class="annot"><a href="#local-6989586621679753688"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753687"><span class="annot"><a href="#local-6989586621679753687"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753686"><span class="annot"><a href="#local-6989586621679753686"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753690"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753689"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753688"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753687"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753686"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span id="FFNInputWeight2F"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-var">FFNInputWeight2F</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679753685"><span class="annot"><a href="#local-6989586621679753685"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753684"><span class="annot"><a href="#local-6989586621679753684"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753683"><span class="annot"><a href="#local-6989586621679753683"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753682"><span class="annot"><a href="#local-6989586621679753682"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753681"><span class="annot"><a href="#local-6989586621679753681"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-160"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753680"><span class="annot"><a href="#local-6989586621679753680"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753679"><span class="annot"><a href="#local-6989586621679753679"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753678"><span class="annot"><a href="#local-6989586621679753678"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753677"><span class="annot"><a href="#local-6989586621679753677"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753676"><span class="annot"><a href="#local-6989586621679753676"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753675"><span class="annot"><a href="#local-6989586621679753675"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-169"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679753674"><span class="annot"><a href="#local-6989586621679753674"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753673"><span class="annot"><a href="#local-6989586621679753673"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753672"><span class="annot"><a href="#local-6989586621679753672"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753671"><span class="annot"><a href="#local-6989586621679753671"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753670"><span class="annot"><a href="#local-6989586621679753670"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753674"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753673"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753672"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753670"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753671"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-170"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753669"><span class="annot"><a href="#local-6989586621679753669"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753668"><span class="annot"><a href="#local-6989586621679753668"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753667"><span class="annot"><a href="#local-6989586621679753667"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753666"><span class="annot"><a href="#local-6989586621679753666"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753665"><span class="annot"><a href="#local-6989586621679753665"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-type">FFNOutputWeightF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753669"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753668"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753667"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753666"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753665"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span id="FFNOutputWeightF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-var">FFNOutputWeightF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679753664"><span class="annot"><a href="#local-6989586621679753664"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753663"><span class="annot"><a href="#local-6989586621679753663"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753662"><span class="annot"><a href="#local-6989586621679753662"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753661"><span class="annot"><a href="#local-6989586621679753661"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753660"><span class="annot"><a href="#local-6989586621679753660"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Linear.html#Linear"><span class="hs-identifier hs-type">Linear</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753664"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753663"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753662"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753660"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753661"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-174"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753659"><span class="annot"><a href="#local-6989586621679753659"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-176"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-177"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-178"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-type">Relu</span></a></span><span>
</span><span id="line-179"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#GeluNew"><span class="hs-identifier hs-type">GeluNew</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Relu"><span class="hs-identifier hs-type">Relu</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-185"></span><span>  </span><span id="FFNActivationF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-var">FFNActivationF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#GPT2"><span class="hs-identifier hs-type">GPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Activation.html#Gelu"><span class="hs-identifier hs-type">Gelu</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-188"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753656"><span class="annot"><a href="#local-6989586621679753656"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753655"><span class="annot"><a href="#local-6989586621679753655"><span class="hs-identifier hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679753654"><span class="annot"><a href="#local-6989586621679753654"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753654"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753653"><span class="annot"><a href="#local-6989586621679753653"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753653"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-195"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679753652"><span class="annot"><a href="#local-6989586621679753652"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753652"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-196"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679753651"><span class="annot"><a href="#local-6989586621679753651"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753651"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679753650"><span class="annot"><a href="#local-6989586621679753650"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753650"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-198"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679753649"><span class="annot"><a href="#local-6989586621679753649"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753649"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span id="FFNActivationDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-var">FFNActivationDropoutF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#GPT2"><span class="hs-identifier hs-type">GPT2</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-203"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753648"><span class="annot"><a href="#local-6989586621679753648"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753647"><span class="annot"><a href="#local-6989586621679753647"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753646"><span class="annot"><a href="#local-6989586621679753646"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753645"><span class="annot"><a href="#local-6989586621679753645"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753644"><span class="annot"><a href="#local-6989586621679753644"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-209"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-211"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679753643"><span class="annot"><a href="#local-6989586621679753643"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753642"><span class="annot"><a href="#local-6989586621679753642"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753641"><span class="annot"><a href="#local-6989586621679753641"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753640"><span class="annot"><a href="#local-6989586621679753640"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithoutBias"><span class="hs-identifier hs-type">WithoutBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753643"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753642"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753641"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753640"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-212"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753639"><span class="annot"><a href="#local-6989586621679753639"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753638"><span class="annot"><a href="#local-6989586621679753638"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753637"><span class="annot"><a href="#local-6989586621679753637"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753636"><span class="annot"><a href="#local-6989586621679753636"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-type">FFNLayerNormF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753639"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753638"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753637"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753636"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span id="FFNLayerNormF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-var">FFNLayerNormF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679753635"><span class="annot"><a href="#local-6989586621679753635"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753634"><span class="annot"><a href="#local-6989586621679753634"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753633"><span class="annot"><a href="#local-6989586621679753633"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753632"><span class="annot"><a href="#local-6989586621679753632"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Normalization.html#LayerNorm"><span class="hs-identifier hs-type">LayerNorm</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Type.html#WithBias"><span class="hs-identifier hs-type">WithBias</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753635"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753634"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753633"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753632"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-216"></span><span>  </span><span id="FFNDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-var">FFNDropoutF</span></a></span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753631"><span class="annot"><a href="#local-6989586621679753631"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753630"><span class="annot"><a href="#local-6989586621679753630"><span class="hs-identifier hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-219"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-221"></span><span>  </span><span id="FFNDropoutF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-var">FFNDropoutF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679753629"><span class="annot"><a href="#local-6989586621679753629"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Dropout.html#Dropout"><span class="hs-identifier hs-type">Dropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753629"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-224"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753628"><span class="annot"><a href="#local-6989586621679753628"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753627"><span class="annot"><a href="#local-6989586621679753627"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753626"><span class="annot"><a href="#local-6989586621679753626"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753625"><span class="annot"><a href="#local-6989586621679753625"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="../../../../hasktorch/html/src"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753624"><span class="annot"><a href="#local-6989586621679753624"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753623"><span class="annot"><a href="#local-6989586621679753623"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-232"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-233"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753622"><span class="annot"><a href="#local-6989586621679753622"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753621"><span class="annot"><a href="#local-6989586621679753621"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753620"><span class="annot"><a href="#local-6989586621679753620"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753619"><span class="annot"><a href="#local-6989586621679753619"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753618"><span class="annot"><a href="#local-6989586621679753618"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753622"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753621"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753620"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753619"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753618"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679753617"><span class="annot"><a href="#local-6989586621679753617"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753616"><span class="annot"><a href="#local-6989586621679753616"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753615"><span class="annot"><a href="#local-6989586621679753615"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753614"><span class="annot"><a href="#local-6989586621679753614"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753613"><span class="annot"><a href="#local-6989586621679753613"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-type">HasInitializeFFNInputWeight2InputF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753617"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753616"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753615"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753614"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753613"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679753612"><span class="annot"><a href="#local-6989586621679753612"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753611"><span class="annot"><a href="#local-6989586621679753611"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753610"><span class="annot"><a href="#local-6989586621679753610"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753609"><span class="annot"><a href="#local-6989586621679753609"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753608"><span class="annot"><a href="#local-6989586621679753608"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-type">HasInitializeFFNInputWeight2InputF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753612"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753611"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753610"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753609"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753608"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-239"></span><span>  </span><span id="HasInitializeFFNInputWeight2InputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-var">HasInitializeFFNInputWeight2InputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679753607"><span class="annot"><a href="#local-6989586621679753607"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679753606"><span class="annot"><a href="#local-6989586621679753606"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679753605"><span class="annot"><a href="#local-6989586621679753605"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679753604"><span class="annot"><a href="#local-6989586621679753604"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753603"><span class="annot"><a href="#local-6989586621679753603"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-type">HasInitializeFFNInputWeight2InputF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753607"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753606"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753605"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753604"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753603"><span class="hs-identifier hs-type">ffnDim</span></a></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-242"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753602"><span class="annot"><a href="#local-6989586621679753602"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753601"><span class="annot"><a href="#local-6989586621679753601"><span class="hs-identifier hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-245"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-247"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679753600"><span class="annot"><a href="#local-6989586621679753600"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679753600"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753599"><span class="annot"><a href="#local-6989586621679753599"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-type">HasInitializeFFNActivationDropoutInputF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753599"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-249"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span id="local-6989586621679753598"><span class="annot"><a href="#local-6989586621679753598"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679753598"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MBART"><span class="hs-identifier hs-type">MBART</span></a></span><span> </span><span id="local-6989586621679753597"><span class="annot"><a href="#local-6989586621679753597"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-type">HasInitializeFFNActivationDropoutInputF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753597"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679753596"><span class="annot"><a href="#local-6989586621679753596"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-type">HasInitializeFFNActivationDropoutInputF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753596"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-252"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>  </span><span id="HasInitializeFFNActivationDropoutInputF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-var">HasInitializeFFNActivationDropoutInputF</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span id="local-6989586621679753595"><span class="annot"><a href="#local-6989586621679753595"><span class="hs-identifier hs-type hs-type">dropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-type">HasInitializeFFNActivationDropoutInputF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753595"><span class="hs-identifier hs-type">dropoutP</span></a></span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span id="local-6989586621679753577"><span id="local-6989586621679753578"><span id="local-6989586621679753579"><span id="local-6989586621679753580"><span id="local-6989586621679753581"><span id="local-6989586621679753582"><span id="local-6989586621679753583"><span id="local-6989586621679753584"><span id="local-6989586621679753585"><span id="local-6989586621679753586"><span id="local-6989586621679753587"><span id="local-6989586621679753588"><span id="local-6989586621679753589"><span id="local-6989586621679753590"><span id="local-6989586621679753591"><span id="local-6989586621679753592"><span id="local-6989586621679753593"><span id="local-6989586621679753594"><span class="hs-keyword">instance</span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-257"></span><span>    </span><span class="annot"><a href="#local-6989586621679753593"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight1F"><span class="hs-identifier hs-type">FFNInputWeight1F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753593"><span class="hs-identifier hs-type">inputWeight1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679753587"><span class="hs-identifier hs-type">generator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753586"><span class="hs-identifier hs-type">generator'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-259"></span><span>    </span><span class="annot"><a href="#local-6989586621679753585"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNInputWeight2F"><span class="hs-identifier hs-type">FFNInputWeight2F</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-260"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753585"><span class="hs-identifier hs-type">inputWeight2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNInputWeight2InputF"><span class="hs-identifier hs-type">HasInitializeFFNInputWeight2InputF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679753586"><span class="hs-identifier hs-type">generator'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753584"><span class="hs-identifier hs-type">generator''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-261"></span><span>    </span><span class="annot"><a href="#local-6989586621679753583"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNOutputWeightF"><span class="hs-identifier hs-type">FFNOutputWeightF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-262"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753583"><span class="hs-identifier hs-type">outputWeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679753584"><span class="hs-identifier hs-type">generator''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><a href="#local-6989586621679753581"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationF"><span class="hs-identifier hs-type">FFNActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753581"><span class="hs-identifier hs-type">activation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><a href="#local-6989586621679753580"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNActivationDropoutF"><span class="hs-identifier hs-type">FFNActivationDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753579"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753580"><span class="hs-identifier hs-type">activationDropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#HasInitializeFFNActivationDropoutInputF"><span class="hs-identifier hs-type">HasInitializeFFNActivationDropoutInputF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753579"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-267"></span><span>    </span><span class="annot"><a href="#local-6989586621679753578"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNLayerNormF"><span class="hs-identifier hs-type">FFNLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753578"><span class="hs-identifier hs-type">layerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-type">SShape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><a href="#local-6989586621679753577"><span class="hs-identifier hs-type">dropout</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FFNDropoutF"><span class="hs-identifier hs-type">FFNDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753579"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753577"><span class="hs-identifier hs-type">dropout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753579"><span class="hs-identifier hs-type">dropoutP</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753579"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753592"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-275"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753591"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753590"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-277"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753589"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753588"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>      </span><span class="annot"><a href="#local-6989586621679753579"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="#local-6989586621679753587"><span class="hs-identifier hs-type">generator</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="#local-6989586621679753582"><span class="hs-identifier hs-type">generator'''</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679753574"><span class="annot"><span class="annottext">initialize :: (SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim, dropoutP, Double)
-&gt; generator
-&gt; (TransformerFeedForwardNetwork
      style gradient device dataType queryEmbedDim ffnDim dropoutP,
    generator''')
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679753572"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753572"><span class="hs-identifier hs-var">gradient</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753571"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753571"><span class="hs-identifier hs-var">device</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753570"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753570"><span class="hs-identifier hs-var">dataType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753569"><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753569"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753568"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753568"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753567"><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753567"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753566"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753566"><span class="hs-identifier hs-var">eps</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679753565"><span class="annot"><span class="annottext">inputWeight1 :: IxState generator generator' inputWeight1
</span><a href="#local-6989586621679753565"><span class="hs-identifier hs-var hs-var">inputWeight1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(generator -&gt; (inputWeight1, generator'))
-&gt; IxState generator generator' inputWeight1
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((generator -&gt; (inputWeight1, generator'))
 -&gt; IxState generator generator' inputWeight1)
-&gt; ((SGradient gradient, SDevice device, SDataType dataType,
     SDim queryEmbedDim, SDim ffnDim)
    -&gt; generator -&gt; (inputWeight1, generator'))
-&gt; (SGradient gradient, SDevice device, SDataType dataType,
    SDim queryEmbedDim, SDim ffnDim)
-&gt; IxState generator generator' inputWeight1
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; generator -&gt; (inputWeight1, generator')
forall model input generator generatorOutput.
HasInitialize model input generator generatorOutput =&gt;
input -&gt; generator -&gt; (model, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">((SGradient gradient, SDevice device, SDataType dataType,
  SDim queryEmbedDim, SDim ffnDim)
 -&gt; IxState generator generator' inputWeight1)
-&gt; (SGradient gradient, SDevice device, SDataType dataType,
    SDim queryEmbedDim, SDim ffnDim)
-&gt; IxState generator generator' inputWeight1
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753572"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753571"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753570"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753569"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753568"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>        </span><span id="local-6989586621679753562"><span class="annot"><span class="annottext">inputWeight2 :: IxState generator' generator'' inputWeight2
</span><a href="#local-6989586621679753562"><span class="hs-identifier hs-var hs-var">inputWeight2</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(generator' -&gt; (inputWeight2, generator''))
-&gt; IxState generator' generator'' inputWeight2
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((generator' -&gt; (inputWeight2, generator''))
 -&gt; IxState generator' generator'' inputWeight2)
-&gt; (HasInitializeFFNInputWeight2InputF
      style gradient device dataType queryEmbedDim ffnDim
    -&gt; generator' -&gt; (inputWeight2, generator''))
-&gt; HasInitializeFFNInputWeight2InputF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; IxState generator' generator'' inputWeight2
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasInitializeFFNInputWeight2InputF
  style gradient device dataType queryEmbedDim ffnDim
-&gt; generator' -&gt; (inputWeight2, generator'')
forall model input generator generatorOutput.
HasInitialize model input generator generatorOutput =&gt;
input -&gt; generator -&gt; (model, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(HasInitializeFFNInputWeight2InputF
   style gradient device dataType queryEmbedDim ffnDim
 -&gt; IxState generator' generator'' inputWeight2)
-&gt; HasInitializeFFNInputWeight2InputF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; IxState generator' generator'' inputWeight2
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-288"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-289"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753572"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753571"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753570"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753569"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753568"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-292"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-294"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-296"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasInitializeFFNInputWeight2InputF
  style gradient device dataType queryEmbedDim ffnDim
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-297"></span><span>        </span><span id="local-6989586621679753552"><span class="annot"><span class="annottext">outputWeight :: IxState generator'' generator''' outputWeight
</span><a href="#local-6989586621679753552"><span class="hs-identifier hs-var hs-var">outputWeight</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(generator'' -&gt; (outputWeight, generator'''))
-&gt; IxState generator'' generator''' outputWeight
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((generator'' -&gt; (outputWeight, generator'''))
 -&gt; IxState generator'' generator''' outputWeight)
-&gt; ((SGradient gradient, SDevice device, SDataType dataType,
     SDim ffnDim, SDim queryEmbedDim)
    -&gt; generator'' -&gt; (outputWeight, generator'''))
-&gt; (SGradient gradient, SDevice device, SDataType dataType,
    SDim ffnDim, SDim queryEmbedDim)
-&gt; IxState generator'' generator''' outputWeight
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; generator'' -&gt; (outputWeight, generator''')
forall model input generator generatorOutput.
HasInitialize model input generator generatorOutput =&gt;
input -&gt; generator -&gt; (model, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">((SGradient gradient, SDevice device, SDataType dataType,
  SDim ffnDim, SDim queryEmbedDim)
 -&gt; IxState generator'' generator''' outputWeight)
-&gt; (SGradient gradient, SDevice device, SDataType dataType,
    SDim ffnDim, SDim queryEmbedDim)
-&gt; IxState generator'' generator''' outputWeight
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753572"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753571"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753570"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753568"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753569"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>        </span><span id="local-6989586621679753551"><span class="annot"><span class="annottext">activation :: IxState generator''' generator''' activation
</span><a href="#local-6989586621679753551"><span class="hs-identifier hs-var hs-var">activation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(generator''' -&gt; (activation, generator'''))
-&gt; IxState generator''' generator''' activation
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((generator''' -&gt; (activation, generator'''))
 -&gt; IxState generator''' generator''' activation)
-&gt; (() -&gt; generator''' -&gt; (activation, generator'''))
-&gt; ()
-&gt; IxState generator''' generator''' activation
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">() -&gt; generator''' -&gt; (activation, generator''')
forall model input generator generatorOutput.
HasInitialize model input generator generatorOutput =&gt;
input -&gt; generator -&gt; (model, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(() -&gt; IxState generator''' generator''' activation)
-&gt; () -&gt; IxState generator''' generator''' activation
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>        </span><span id="local-6989586621679753550"><span class="annot"><span class="annottext">activationDropout :: IxState generator''' generator''' activationDropout
</span><a href="#local-6989586621679753550"><span class="hs-identifier hs-var hs-var">activationDropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(generator''' -&gt; (activationDropout, generator'''))
-&gt; IxState generator''' generator''' activationDropout
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((generator''' -&gt; (activationDropout, generator'''))
 -&gt; IxState generator''' generator''' activationDropout)
-&gt; (HasInitializeFFNActivationDropoutInputF style dropoutP
    -&gt; generator''' -&gt; (activationDropout, generator'''))
-&gt; HasInitializeFFNActivationDropoutInputF style dropoutP
-&gt; IxState generator''' generator''' activationDropout
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">HasInitializeFFNActivationDropoutInputF style dropoutP
-&gt; generator''' -&gt; (activationDropout, generator''')
forall model input generator generatorOutput.
HasInitialize model input generator generatorOutput =&gt;
input -&gt; generator -&gt; (model, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(HasInitializeFFNActivationDropoutInputF style dropoutP
 -&gt; IxState generator''' generator''' activationDropout)
-&gt; HasInitializeFFNActivationDropoutInputF style dropoutP
-&gt; IxState generator''' generator''' activationDropout
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-300"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753594"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-301"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">dropoutP
HasInitializeFFNActivationDropoutInputF style dropoutP
</span><a href="#local-6989586621679753567"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-302"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">dropoutP
HasInitializeFFNActivationDropoutInputF style dropoutP
</span><a href="#local-6989586621679753567"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">dropoutP
HasInitializeFFNActivationDropoutInputF style dropoutP
</span><a href="#local-6989586621679753567"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-304"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">dropoutP
HasInitializeFFNActivationDropoutInputF style dropoutP
</span><a href="#local-6989586621679753567"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-305"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">dropoutP
HasInitializeFFNActivationDropoutInputF style dropoutP
</span><a href="#local-6989586621679753567"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-306"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>            </span><span class="annot"><span class="annottext">Sing style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">HasInitializeFFNActivationDropoutInputF style dropoutP
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-309"></span><span>        </span><span id="local-6989586621679753549"><span class="annot"><span class="annottext">layerNorm :: IxState generator''' generator''' layerNorm
</span><a href="#local-6989586621679753549"><span class="hs-identifier hs-var hs-var">layerNorm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(generator''' -&gt; (layerNorm, generator'''))
-&gt; IxState generator''' generator''' layerNorm
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((generator''' -&gt; (layerNorm, generator'''))
 -&gt; IxState generator''' generator''' layerNorm)
-&gt; ((SGradient gradient, SDevice device, SDataType dataType,
     SShape ('Shape '[queryEmbedDim]), Double)
    -&gt; generator''' -&gt; (layerNorm, generator'''))
-&gt; (SGradient gradient, SDevice device, SDataType dataType,
    SShape ('Shape '[queryEmbedDim]), Double)
-&gt; IxState generator''' generator''' layerNorm
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; generator''' -&gt; (layerNorm, generator''')
forall model input generator generatorOutput.
HasInitialize model input generator generatorOutput =&gt;
input -&gt; generator -&gt; (model, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">((SGradient gradient, SDevice device, SDataType dataType,
  SShape ('Shape '[queryEmbedDim]), Double)
 -&gt; IxState generator''' generator''' layerNorm)
-&gt; (SGradient gradient, SDevice device, SDataType dataType,
    SShape ('Shape '[queryEmbedDim]), Double)
-&gt; IxState generator''' generator''' layerNorm
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753572"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753571"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753570"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753569"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753566"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>        </span><span id="local-6989586621679753546"><span class="annot"><span class="annottext">dropout :: IxState generator''' generator''' (Dropout dropoutP)
</span><a href="#local-6989586621679753546"><span class="hs-identifier hs-var hs-var">dropout</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(generator''' -&gt; (Dropout dropoutP, generator'''))
-&gt; IxState generator''' generator''' (Dropout dropoutP)
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((generator''' -&gt; (Dropout dropoutP, generator'''))
 -&gt; IxState generator''' generator''' (Dropout dropoutP))
-&gt; (dropoutP -&gt; generator''' -&gt; (Dropout dropoutP, generator'''))
-&gt; dropoutP
-&gt; IxState generator''' generator''' (Dropout dropoutP)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">dropoutP -&gt; generator''' -&gt; (Dropout dropoutP, generator''')
forall model input generator generatorOutput.
HasInitialize model input generator generatorOutput =&gt;
input -&gt; generator -&gt; (model, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(dropoutP -&gt; IxState generator''' generator''' (Dropout dropoutP))
-&gt; dropoutP -&gt; IxState generator''' generator''' (Dropout dropoutP)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753567"><span class="hs-identifier hs-var">dropoutP</span></a></span><span>
</span><span id="line-311"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxState
  generator
  generator'''
  (TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim dropoutP)
-&gt; generator
-&gt; (TransformerFeedForwardNetwork
      style gradient device dataType queryEmbedDim ffnDim dropoutP,
    generator''')
forall i j a. IxState i j a -&gt; i -&gt; (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxState</span></a></span><span> </span><span class="annot"><span class="annottext">(IxState
   generator
   generator'''
   (TransformerFeedForwardNetwork
      style gradient device dataType queryEmbedDim ffnDim dropoutP)
 -&gt; generator
 -&gt; (TransformerFeedForwardNetwork
       style gradient device dataType queryEmbedDim ffnDim dropoutP,
     generator'''))
-&gt; IxState
     generator
     generator'''
     (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim dropoutP)
-&gt; generator
-&gt; (TransformerFeedForwardNetwork
      style gradient device dataType queryEmbedDim ffnDim dropoutP,
    generator''')
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-312"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">inputWeight1
-&gt; inputWeight2
-&gt; outputWeight
-&gt; activation
-&gt; activationDropout
-&gt; layerNorm
-&gt; Dropout dropoutP
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     (Dropout dropoutP)
forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
inputWeight1
-&gt; inputWeight2
-&gt; outputWeight
-&gt; activation
-&gt; activationDropout
-&gt; layerNorm
-&gt; dropout
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     dropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-313"></span><span>              </span><span class="annot"><span class="annottext">(inputWeight1
 -&gt; inputWeight2
 -&gt; outputWeight
 -&gt; activation
 -&gt; activationDropout
 -&gt; layerNorm
 -&gt; Dropout dropoutP
 -&gt; GTransformerFeedForwardNetwork
      inputWeight1
      inputWeight2
      outputWeight
      activation
      activationDropout
      layerNorm
      (Dropout dropoutP))
-&gt; IxState generator generator' inputWeight1
-&gt; IxState
     generator
     generator'
     (inputWeight2
      -&gt; outputWeight
      -&gt; activation
      -&gt; activationDropout
      -&gt; layerNorm
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           (Dropout dropoutP))
forall k1 k2 (f :: k1 -&gt; k2 -&gt; Type -&gt; Type) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxState generator generator' inputWeight1
</span><a href="#local-6989586621679753565"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span>
</span><span id="line-314"></span><span>              </span><span class="annot"><span class="annottext">IxState
  generator
  generator'
  (inputWeight2
   -&gt; outputWeight
   -&gt; activation
   -&gt; activationDropout
   -&gt; layerNorm
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        (Dropout dropoutP))
-&gt; IxState generator' generator'' inputWeight2
-&gt; IxState
     generator
     generator''
     (outputWeight
      -&gt; activation
      -&gt; activationDropout
      -&gt; layerNorm
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           (Dropout dropoutP))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxState generator' generator'' inputWeight2
</span><a href="#local-6989586621679753562"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span>
</span><span id="line-315"></span><span>              </span><span class="annot"><span class="annottext">IxState
  generator
  generator''
  (outputWeight
   -&gt; activation
   -&gt; activationDropout
   -&gt; layerNorm
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        (Dropout dropoutP))
-&gt; IxState generator'' generator''' outputWeight
-&gt; IxState
     generator
     generator'''
     (activation
      -&gt; activationDropout
      -&gt; layerNorm
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           (Dropout dropoutP))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxState generator'' generator''' outputWeight
</span><a href="#local-6989586621679753552"><span class="hs-identifier hs-var">outputWeight</span></a></span><span>
</span><span id="line-316"></span><span>              </span><span class="annot"><span class="annottext">IxState
  generator
  generator'''
  (activation
   -&gt; activationDropout
   -&gt; layerNorm
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        (Dropout dropoutP))
-&gt; IxState generator''' generator''' activation
-&gt; IxState
     generator
     generator'''
     (activationDropout
      -&gt; layerNorm
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           (Dropout dropoutP))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxState generator''' generator''' activation
</span><a href="#local-6989586621679753551"><span class="hs-identifier hs-var">activation</span></a></span><span>
</span><span id="line-317"></span><span>              </span><span class="annot"><span class="annottext">IxState
  generator
  generator'''
  (activationDropout
   -&gt; layerNorm
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        (Dropout dropoutP))
-&gt; IxState generator''' generator''' activationDropout
-&gt; IxState
     generator
     generator'''
     (layerNorm
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           (Dropout dropoutP))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxState generator''' generator''' activationDropout
</span><a href="#local-6989586621679753550"><span class="hs-identifier hs-var">activationDropout</span></a></span><span>
</span><span id="line-318"></span><span>              </span><span class="annot"><span class="annottext">IxState
  generator
  generator'''
  (layerNorm
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        (Dropout dropoutP))
-&gt; IxState generator''' generator''' layerNorm
-&gt; IxState
     generator
     generator'''
     (Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           inputWeight1
           inputWeight2
           outputWeight
           activation
           activationDropout
           layerNorm
           (Dropout dropoutP))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxState generator''' generator''' layerNorm
</span><a href="#local-6989586621679753549"><span class="hs-identifier hs-var">layerNorm</span></a></span><span>
</span><span id="line-319"></span><span>              </span><span class="annot"><span class="annottext">IxState
  generator
  generator'''
  (Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        (Dropout dropoutP))
-&gt; IxState generator''' generator''' (Dropout dropoutP)
-&gt; IxState
     generator
     generator'''
     (GTransformerFeedForwardNetwork
        inputWeight1
        inputWeight2
        outputWeight
        activation
        activationDropout
        layerNorm
        (Dropout dropoutP))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxState generator''' generator''' (Dropout dropoutP)
</span><a href="#local-6989586621679753546"><span class="hs-identifier hs-var">dropout</span></a></span><span>
</span><span id="line-320"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>            </span><span class="annot"><span class="annottext">IxState
  generator
  generator'''
  (GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     (Dropout dropoutP))
-&gt; (GTransformerFeedForwardNetwork
      inputWeight1
      inputWeight2
      outputWeight
      activation
      activationDropout
      layerNorm
      (Dropout dropoutP)
    -&gt; IxState
         generator'''
         generator'''
         (TransformerFeedForwardNetwork
            style gradient device dataType queryEmbedDim ffnDim dropoutP))
-&gt; IxState
     generator
     generator'''
     (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim dropoutP)
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TransformerFeedForwardNetwork
  style gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; IxState
     generator'''
     generator'''
     (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim dropoutP)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(TransformerFeedForwardNetwork
   style gradient device dataType queryEmbedDim ffnDim dropoutP
 -&gt; IxState
      generator'''
      generator'''
      (TransformerFeedForwardNetwork
         style gradient device dataType queryEmbedDim ffnDim dropoutP))
-&gt; (GTransformerFeedForwardNetwork
      inputWeight1
      inputWeight2
      outputWeight
      activation
      activationDropout
      layerNorm
      (Dropout dropoutP)
    -&gt; TransformerFeedForwardNetwork
         style gradient device dataType queryEmbedDim ffnDim dropoutP)
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     (Dropout dropoutP)
-&gt; IxState
     generator'''
     generator'''
     (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim dropoutP)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  (Dropout dropoutP)
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim dropoutP
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)) dropoutP.
GTransformerFeedForwardNetwork
  (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNActivationF style)
  (FFNActivationDropoutF style dropoutP)
  (FFNLayerNormF style gradient device dataType queryEmbedDim)
  (FFNDropoutF style dropoutP)
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim dropoutP
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span id="local-6989586621679753538"><span id="local-6989586621679753539"><span id="local-6989586621679753540"><span id="local-6989586621679753541"><span id="local-6989586621679753542"><span id="local-6989586621679753543"><span id="local-6989586621679753544"><span class="hs-keyword">instance</span><span>
</span><span id="line-324"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753543"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753542"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753541"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753540"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753539"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753538"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753543"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753542"><span class="hs-identifier hs-type">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753541"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753540"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753539"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679753538"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621679753534"><span class="annot"><span class="annottext">fromStateDict :: (SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim, dropoutP, Double)
-&gt; StateDictKey
-&gt; m (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim dropoutP)
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679753532"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753531"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753530"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753529"><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753528"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753527"><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753527"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679753526"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679753525"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679753524"><span class="annot"><span class="annottext">inputWeight1 :: STransformerStyle style
-&gt; m (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679753524"><span class="hs-identifier hs-var hs-var">inputWeight1</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_0.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>        </span><span class="annot"><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>        </span><span class="annot"><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>        </span><span class="annot"><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>        </span><span class="annot"><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>        </span><span class="annot"><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-338"></span><span>        </span><span id="local-6989586621679753523"><span class="annot"><span class="annottext">inputWeight2 :: STransformerStyle style
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679753523"><span class="hs-identifier hs-var hs-var">inputWeight2</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-339"></span><span>        </span><span class="annot"><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim queryEmbedDim, SDim ffnDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType queryEmbedDim ffnDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>        </span><span class="annot"><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-341"></span><span>        </span><span class="annot"><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-342"></span><span>        </span><span class="annot"><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-344"></span><span>        </span><span class="annot"><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-345"></span><span>        </span><span class="annot"><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-346"></span><span>        </span><span id="local-6989586621679753522"><span class="annot"><span class="annottext">outputWeight :: STransformerStyle style
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679753522"><span class="hs-identifier hs-var hs-var">outputWeight</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType ffnDim queryEmbedDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>        </span><span class="annot"><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithoutBias gradient device dataType ffnDim queryEmbedDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>        </span><span class="annot"><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-349"></span><span>        </span><span class="annot"><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-350"></span><span>        </span><span class="annot"><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>        </span><span class="annot"><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>        </span><span class="annot"><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SDim ffnDim, SDim queryEmbedDim)
-&gt; StateDictKey
-&gt; m (Linear
        'WithBias gradient device dataType ffnDim queryEmbedDim)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679753528"><span class="hs-identifier hs-var">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>        </span><span class="annot"><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-354"></span><span>        </span><span id="local-6989586621679753521"><span class="annot"><span class="annottext">activation :: STransformerStyle style -&gt; m (FFNActivationF style)
</span><a href="#local-6989586621679753521"><span class="hs-identifier hs-var hs-var">activation</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m Relu
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-355"></span><span>        </span><span class="annot"><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m GeluNew
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m Gelu
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-357"></span><span>        </span><span class="annot"><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m Gelu
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-358"></span><span>        </span><span class="annot"><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m Relu
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m Gelu
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-360"></span><span>        </span><span class="annot"><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m Gelu
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNActivationF style)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-362"></span><span>        </span><span id="local-6989586621679753520"><span class="annot"><span class="annottext">activationDropout :: STransformerStyle style -&gt; m (FFNActivationDropoutF style dropoutP)
</span><a href="#local-6989586621679753520"><span class="hs-identifier hs-var hs-var">activationDropout</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dropoutP -&gt; StateDictKey -&gt; m (Dropout dropoutP)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753527"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-363"></span><span>        </span><span class="annot"><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dropoutP -&gt; StateDictKey -&gt; m (Dropout dropoutP)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753527"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dropoutP -&gt; StateDictKey -&gt; m (Dropout dropoutP)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753527"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-365"></span><span>        </span><span class="annot"><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dropoutP -&gt; StateDictKey -&gt; m (Dropout dropoutP)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753527"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-366"></span><span>        </span><span class="annot"><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dropoutP -&gt; StateDictKey -&gt; m (Dropout dropoutP)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753527"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-368"></span><span>        </span><span class="annot"><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">() -&gt; StateDictKey -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNActivationDropoutF style dropoutP)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-370"></span><span>        </span><span id="local-6989586621679753519"><span class="annot"><span class="annottext">layerNorm :: STransformerStyle style
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679753519"><span class="hs-identifier hs-var hs-var">layerNorm</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithoutBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>        </span><span class="annot"><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-374"></span><span>        </span><span class="annot"><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>        </span><span class="annot"><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(SGradient gradient, SDevice device, SDataType dataType,
 SShape ('Shape '[queryEmbedDim]), Double)
-&gt; StateDictKey
-&gt; m (LayerNorm
        'WithBias gradient device dataType ('Shape '[queryEmbedDim]))
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679753532"><span class="hs-identifier hs-var">gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679753531"><span class="hs-identifier hs-var">device</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679753530"><span class="hs-identifier hs-var">dataType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall (dims :: [Dim (Name Symbol) (Size Nat)]).
SList dims -&gt; SShape ('Shape dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#SShape"><span class="hs-identifier hs-var">SShape</span></a></span><span> </span><span class="annot"><span class="annottext">(SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim]))
-&gt; SList '[queryEmbedDim] -&gt; SShape ('Shape '[queryEmbedDim])
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim
</span><a href="#local-6989586621679753529"><span class="hs-identifier hs-var">queryEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim queryEmbedDim -&gt; SList '[] -&gt; SList '[queryEmbedDim]
forall (dim :: Dim (Name Symbol) (Size Nat))
       (dims :: [Dim (Name Symbol) (Size Nat)]).
SDim dim -&gt; SList dims -&gt; SList (dim : dims)
</span><a href="Torch.GraduallyTyped.Shape.Type.html#%3A%7C%3A"><span class="hs-operator hs-var">:|:</span></a></span><span> </span><span class="annot"><span class="annottext">SList '[]
forall a. SList '[]
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNil</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679753526"><span class="hs-identifier hs-var">eps</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m (FFNLayerNormF style gradient device dataType queryEmbedDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-378"></span><span>        </span><span id="local-6989586621679753518"><span class="annot"><span class="annottext">dropout :: STransformerStyle style -&gt; m (Dropout dropoutP)
</span><a href="#local-6989586621679753518"><span class="hs-identifier hs-var hs-var">dropout</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">dropoutP -&gt; StateDictKey -&gt; m (Dropout dropoutP)
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
input -&gt; StateDictKey -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">dropoutP
</span><a href="#local-6989586621679753527"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753525"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-379"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">GTransformerFeedForwardNetwork
  (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNActivationF style)
  (FFNActivationDropoutF style dropoutP)
  (FFNLayerNormF style gradient device dataType queryEmbedDim)
  (Dropout dropoutP)
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim dropoutP
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (queryEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat)) dropoutP.
GTransformerFeedForwardNetwork
  (FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim)
  (FFNActivationF style)
  (FFNActivationDropoutF style dropoutP)
  (FFNLayerNormF style gradient device dataType queryEmbedDim)
  (FFNDropoutF style dropoutP)
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim dropoutP
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-var">TransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-380"></span><span>          </span><span class="annot"><span class="annottext">(GTransformerFeedForwardNetwork
   (FFNInputWeight1F
      style gradient device dataType queryEmbedDim ffnDim)
   (FFNInputWeight2F
      style gradient device dataType queryEmbedDim ffnDim)
   (FFNOutputWeightF
      style gradient device dataType queryEmbedDim ffnDim)
   (FFNActivationF style)
   (FFNActivationDropoutF style dropoutP)
   (FFNLayerNormF style gradient device dataType queryEmbedDim)
   (Dropout dropoutP)
 -&gt; TransformerFeedForwardNetwork
      style gradient device dataType queryEmbedDim ffnDim dropoutP)
-&gt; m (GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
-&gt; m (TransformerFeedForwardNetwork
        style gradient device dataType queryEmbedDim ffnDim dropoutP)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
-&gt; FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; FFNActivationF style
-&gt; FFNActivationDropoutF style dropoutP
-&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
-&gt; Dropout dropoutP
-&gt; GTransformerFeedForwardNetwork
     (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
     (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
     (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
     (FFNActivationF style)
     (FFNActivationDropoutF style dropoutP)
     (FFNLayerNormF style gradient device dataType queryEmbedDim)
     (Dropout dropoutP)
forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
inputWeight1
-&gt; inputWeight2
-&gt; outputWeight
-&gt; activation
-&gt; activationDropout
-&gt; layerNorm
-&gt; dropout
-&gt; GTransformerFeedForwardNetwork
     inputWeight1
     inputWeight2
     outputWeight
     activation
     activationDropout
     layerNorm
     dropout
</span><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-var">GTransformerFeedForwardNetwork</span></a></span><span>
</span><span id="line-381"></span><span>                  </span><span class="annot"><span class="annottext">(FFNInputWeight1F
   style gradient device dataType queryEmbedDim ffnDim
 -&gt; FFNInputWeight2F
      style gradient device dataType queryEmbedDim ffnDim
 -&gt; FFNOutputWeightF
      style gradient device dataType queryEmbedDim ffnDim
 -&gt; FFNActivationF style
 -&gt; FFNActivationDropoutF style dropoutP
 -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
 -&gt; Dropout dropoutP
 -&gt; GTransformerFeedForwardNetwork
      (FFNInputWeight1F
         style gradient device dataType queryEmbedDim ffnDim)
      (FFNInputWeight2F
         style gradient device dataType queryEmbedDim ffnDim)
      (FFNOutputWeightF
         style gradient device dataType queryEmbedDim ffnDim)
      (FFNActivationF style)
      (FFNActivationDropoutF style dropoutP)
      (FFNLayerNormF style gradient device dataType queryEmbedDim)
      (Dropout dropoutP))
-&gt; m (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim
      -&gt; FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim
      -&gt; FFNActivationF style
      -&gt; FFNActivationDropoutF style dropoutP
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style dropoutP)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           (Dropout dropoutP))
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNInputWeight1F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679753524"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-382"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
   -&gt; FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim
   -&gt; FFNActivationF style
   -&gt; FFNActivationDropoutF style dropoutP
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim
      -&gt; FFNActivationF style
      -&gt; FFNActivationDropoutF style dropoutP
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style dropoutP)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           (Dropout dropoutP))
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNInputWeight2F
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679753523"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-383"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
   -&gt; FFNActivationF style
   -&gt; FFNActivationDropoutF style dropoutP
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
-&gt; m (FFNActivationF style
      -&gt; FFNActivationDropoutF style dropoutP
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style dropoutP)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           (Dropout dropoutP))
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNOutputWeightF
        style gradient device dataType queryEmbedDim ffnDim)
</span><a href="#local-6989586621679753522"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNActivationF style
   -&gt; FFNActivationDropoutF style dropoutP
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
-&gt; m (FFNActivationF style)
-&gt; m (FFNActivationDropoutF style dropoutP
      -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style dropoutP)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           (Dropout dropoutP))
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style -&gt; m (FFNActivationF style)
</span><a href="#local-6989586621679753521"><span class="hs-identifier hs-var">activation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNActivationDropoutF style dropoutP
   -&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
-&gt; m (FFNActivationDropoutF style dropoutP)
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim
      -&gt; Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style dropoutP)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           (Dropout dropoutP))
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style -&gt; m (FFNActivationDropoutF style dropoutP)
</span><a href="#local-6989586621679753520"><span class="hs-identifier hs-var">activationDropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>                  </span><span class="annot"><span class="annottext">m (FFNLayerNormF style gradient device dataType queryEmbedDim
   -&gt; Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim)
-&gt; m (Dropout dropoutP
      -&gt; GTransformerFeedForwardNetwork
           (FFNInputWeight1F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNInputWeight2F
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNOutputWeightF
              style gradient device dataType queryEmbedDim ffnDim)
           (FFNActivationF style)
           (FFNActivationDropoutF style dropoutP)
           (FFNLayerNormF style gradient device dataType queryEmbedDim)
           (Dropout dropoutP))
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; m (FFNLayerNormF style gradient device dataType queryEmbedDim)
</span><a href="#local-6989586621679753519"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>                  </span><span class="annot"><span class="annottext">m (Dropout dropoutP
   -&gt; GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
-&gt; m (Dropout dropoutP)
-&gt; m (GTransformerFeedForwardNetwork
        (FFNInputWeight1F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNInputWeight2F
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNOutputWeightF
           style gradient device dataType queryEmbedDim ffnDim)
        (FFNActivationF style)
        (FFNActivationDropoutF style dropoutP)
        (FFNLayerNormF style gradient device dataType queryEmbedDim)
        (Dropout dropoutP))
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style -&gt; m (Dropout dropoutP)
</span><a href="#local-6989586621679753518"><span class="hs-identifier hs-var">dropout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>  </span><span id="local-6989586621679753516"><span class="annot"><span class="annottext">toStateDict :: StateDictKey
-&gt; TransformerFeedForwardNetwork
     style gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679753514"><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679753507"><span id="local-6989586621679753508"><span id="local-6989586621679753509"><span id="local-6989586621679753510"><span id="local-6989586621679753511"><span id="local-6989586621679753512"><span id="local-6989586621679753513"><span class="annot"><span class="annottext">FFNDropoutF style dropoutP
FFNLayerNormF style gradient device dataType queryEmbedDim
FFNActivationDropoutF style dropoutP
FFNActivationF style
FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF style dropoutP
ffnLayerNorm :: FFNLayerNormF style gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF style dropoutP
ffnActivation :: FFNActivationF style
ffnOutputWeight :: FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679753507"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-390"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679753506"><span class="annot"><span class="annottext">inputWeight1 :: STransformerStyle style
-&gt; FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679753506"><span class="hs-identifier hs-var hs-var">inputWeight1</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>        </span><span class="annot"><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_0.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span>        </span><span class="annot"><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>        </span><span class="annot"><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>        </span><span class="annot"><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>        </span><span class="annot"><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span>        </span><span class="annot"><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;intermediate.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-397"></span><span>        </span><span class="annot"><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-398"></span><span>        </span><span id="local-6989586621679753505"><span class="annot"><span class="annottext">inputWeight2 :: STransformerStyle style
-&gt; FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679753505"><span class="hs-identifier hs-var hs-var">inputWeight2</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wi_1.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-400"></span><span>        </span><span class="annot"><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-402"></span><span>        </span><span class="annot"><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-403"></span><span>        </span><span class="annot"><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-404"></span><span>        </span><span class="annot"><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; () -&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-405"></span><span>        </span><span class="annot"><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-406"></span><span>        </span><span id="local-6989586621679753504"><span class="annot"><span class="annottext">outputWeight :: STransformerStyle style
-&gt; FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679753504"><span class="hs-identifier hs-var hs-var">outputWeight</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>        </span><span class="annot"><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear
     'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;DenseReluDense.wo.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-408"></span><span>        </span><span class="annot"><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>        </span><span class="annot"><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>        </span><span class="annot"><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;fc2.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>        </span><span class="annot"><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>        </span><span class="annot"><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.dense.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>        </span><span class="annot"><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-414"></span><span>        </span><span id="local-6989586621679753503"><span class="annot"><span class="annottext">layerNorm :: STransformerStyle style
-&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
-&gt; m ()
</span><a href="#local-6989586621679753503"><span class="hs-identifier hs-var hs-var">layerNorm</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>        </span><span class="annot"><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>        </span><span class="annot"><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>        </span><span class="annot"><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>        </span><span class="annot"><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;final_layer_norm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-419"></span><span>        </span><span class="annot"><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>        </span><span class="annot"><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateDictKey
-&gt; LayerNorm
     'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; m ()
forall model input (m :: Type -&gt; Type).
(HasStateDict model input, MonadThrow m, MonadState StateDict m) =&gt;
StateDictKey -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StateDictKey
</span><a href="#local-6989586621679753514"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">StateDictKey -&gt; StateDictKey -&gt; StateDictKey
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">StateDictKey
</span><span class="hs-string">&quot;output.LayerNorm.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>        </span><span class="annot"><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">FFNLayerNormF style gradient device dataType queryEmbedDim -&gt; m ()
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-422"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-423"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNInputWeight1F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679753506"><span class="hs-identifier hs-var">inputWeight1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight1F
  style gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753513"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-424"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNInputWeight2F
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679753505"><span class="hs-identifier hs-var">inputWeight2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNInputWeight2F
  style gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753512"><span class="hs-identifier hs-var">ffnInputWeight2</span></a></span><span>
</span><span id="line-425"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNOutputWeightF
     style gradient device dataType queryEmbedDim ffnDim
-&gt; m ()
</span><a href="#local-6989586621679753504"><span class="hs-identifier hs-var">outputWeight</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNOutputWeightF
  style gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753511"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-426"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; FFNLayerNormF style gradient device dataType queryEmbedDim
-&gt; m ()
</span><a href="#local-6989586621679753503"><span class="hs-identifier hs-var">layerNorm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI style =&gt; Sing style
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679753544"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">FFNLayerNormF style gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679753508"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-427"></span><span>          </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-428"></span><span>
</span><span id="line-429"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-430"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753502"><span class="annot"><a href="#local-6989586621679753502"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753501"><span class="annot"><a href="#local-6989586621679753501"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753500"><span class="annot"><a href="#local-6989586621679753500"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679753499"><span class="annot"><a href="#local-6989586621679753499"><span class="hs-identifier hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-437"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span id="local-6989586621679753498"><span class="annot"><a href="#local-6989586621679753498"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753497"><span class="annot"><a href="#local-6989586621679753497"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679753496"><span class="annot"><a href="#local-6989586621679753496"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-438"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><a href="#local-6989586621679753496"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-440"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-type">LinearWithoutBiasF</span></a></span><span>
</span><span id="line-441"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753498"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679753497"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-442"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithoutBiasF"><span class="hs-identifier hs-type">LinearWithoutBiasF</span></a></span><span>
</span><span id="line-443"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753497"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679753498"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithoutBiasF"><span class="hs-identifier hs-type">LayerNormWithoutBiasF</span></a></span><span>
</span><span id="line-445"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753498"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>                  </span><span class="annot"><a href="#local-6989586621679753496"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-447"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-448"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span id="local-6989586621679753495"><span class="annot"><a href="#local-6989586621679753495"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753494"><span class="annot"><a href="#local-6989586621679753494"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679753493"><span class="annot"><a href="#local-6989586621679753493"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753495"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753494"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753493"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span id="local-6989586621679753492"><span class="annot"><a href="#local-6989586621679753492"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753491"><span class="annot"><a href="#local-6989586621679753491"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679753490"><span class="annot"><a href="#local-6989586621679753490"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-452"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-453"></span><span>      </span><span class="annot"><a href="#local-6989586621679753490"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-454"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-455"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753492"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679753491"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753492"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-458"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753491"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679753492"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753491"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithBiasF"><span class="hs-identifier hs-type">LayerNormWithBiasF</span></a></span><span>
</span><span id="line-461"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753492"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753492"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>                  </span><span class="annot"><a href="#local-6989586621679753490"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-464"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-465"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>  </span><span id="FeedForwardNetworkOutputShape"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-var">FeedForwardNetworkOutputShape</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679753489"><span class="annot"><a href="#local-6989586621679753489"><span class="hs-identifier hs-type hs-type">queryEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679753488"><span class="annot"><a href="#local-6989586621679753488"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679753487"><span class="annot"><a href="#local-6989586621679753487"><span class="hs-identifier hs-type hs-type">queryShape</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-468"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Normalization.html#LayerNormWithBiasF"><span class="hs-identifier hs-type">LayerNormWithBiasF</span></a></span><span>
</span><span id="line-469"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753489"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753489"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Class.html#BroadcastShapesF"><span class="hs-identifier hs-type">BroadcastShapesF</span></a></span><span>
</span><span id="line-472"></span><span>          </span><span class="annot"><a href="#local-6989586621679753487"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-473"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-474"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753489"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679753488"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753489"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Functional.Linear.html#LinearWithBiasF"><span class="hs-identifier hs-type">LinearWithBiasF</span></a></span><span>
</span><span id="line-477"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753488"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679753489"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>                  </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679753488"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>                  </span><span class="annot"><a href="#local-6989586621679753487"><span class="hs-identifier hs-type">queryShape</span></a></span><span>
</span><span id="line-480"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>
</span><span id="line-484"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'T5@.</span><span>
</span><span id="line-485"></span><span class="hs-comment">--</span><span>
</span><span id="line-486"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-487"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-488"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-489"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-490"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-491"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-492"></span><span class="hs-comment">--      ffnLayerNorm     &#9474;</span><span>
</span><span id="line-493"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-494"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-495"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-496"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-497"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-498"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-499"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-500"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-501"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-502"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-503"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-504"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-505"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-506"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-507"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-508"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-509"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-510"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-511"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-512"></span><span id="local-6989586621679753473"><span id="local-6989586621679753474"><span id="local-6989586621679753475"><span id="local-6989586621679753476"><span id="local-6989586621679753477"><span id="local-6989586621679753478"><span id="local-6989586621679753479"><span id="local-6989586621679753480"><span id="local-6989586621679753481"><span id="local-6989586621679753482"><span id="local-6989586621679753483"><span id="local-6989586621679753484"><span id="local-6989586621679753485"><span id="local-6989586621679753486"><span class="hs-keyword">instance</span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753486"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-514"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753485"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-515"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753484"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><a href="#local-6989586621679753483"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-517"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-518"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753482"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753481"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-519"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753480"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-520"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753479"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753478"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753477"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753476"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753475"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-522"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753485"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753474"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753486"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-523"></span><span>    </span><span class="annot"><a href="#local-6989586621679753473"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753478"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753479"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753477"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-526"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#T5"><span class="hs-identifier hs-type">T5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753481"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753478"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753475"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753485"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753474"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753484"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753482"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753480"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753479"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753476"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753486"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753477"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><a href="#local-6989586621679753483"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-530"></span><span>    </span><span class="annot"><a href="#local-6989586621679753473"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-532"></span><span>  </span><span id="local-6989586621679753470"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'T5 gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679753462"><span id="local-6989586621679753463"><span id="local-6989586621679753464"><span id="local-6989586621679753465"><span id="local-6989586621679753466"><span id="local-6989586621679753467"><span id="local-6989586621679753468"><span class="annot"><span class="annottext">FFNDropoutF 'T5 dropoutP
FFNLayerNormF 'T5 gradient device dataType queryEmbedDim
FFNActivationDropoutF 'T5 dropoutP
FFNActivationF 'T5
FFNOutputWeightF 'T5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F 'T5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F 'T5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'T5 dropoutP
ffnLayerNorm :: FFNLayerNormF 'T5 gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'T5 dropoutP
ffnActivation :: FFNActivationF 'T5
ffnOutputWeight :: FFNOutputWeightF 'T5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F 'T5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F 'T5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679753462"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679753461"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753461"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-533"></span><span>    </span><span class="annot"><span class="annottext">IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice -&gt; (output, generatorOutput)
forall i j a. IxState i j a -&gt; i -&gt; (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxState</span></a></span><span> </span><span class="annot"><span class="annottext">(IxState (Generator generatorDevice) generatorOutput output
 -&gt; Generator generatorDevice -&gt; (output, generatorOutput))
-&gt; IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-534"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753461"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-535"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'T5 gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679753463"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-536"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F 'T5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753468"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-537"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Relu
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Relu
FFNActivationF 'T5
</span><a href="#local-6989586621679753465"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-538"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNActivationDropoutF 'T5 dropoutP
</span><a href="#local-6989586621679753464"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-539"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient)))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType)))
       (LinearWithoutBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify
                   (Device (DeviceType Nat))
                   device
                   (Unify (Device (DeviceType Nat)) device queryDevice))
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF 'T5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753466"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-540"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         generatorOutput
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient)))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType)))
       (LinearWithoutBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
     generatorOutput))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      generatorOutput))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      generatorOutput
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        generatorOutput))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
    generatorOutput)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNDropoutF 'T5 dropoutP
</span><a href="#local-6989586621679753462"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-541"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  generatorOutput
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxState generatorOutput generatorOutput output)
-&gt; IxState (Generator generatorDevice) generatorOutput output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">output -&gt; IxState generatorOutput generatorOutput output
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(output -&gt; IxState generatorOutput generatorOutput output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; output)
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState generatorOutput generatorOutput output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753461"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (queryDevice
      &lt;+&gt; Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-542"></span><span>
</span><span id="line-543"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'ByT5@.</span><span>
</span><span id="line-544"></span><span class="hs-comment">--</span><span>
</span><span id="line-545"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-546"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-547"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-548"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-549"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-550"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-551"></span><span class="hs-comment">--      ffnLayerNorm     &#9474;</span><span>
</span><span id="line-552"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-553"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-554"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-555"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-556"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-557"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-558"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-559"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-560"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-561"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-562"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-563"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-564"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-565"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-566"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-567"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-568"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-569"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-570"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-571"></span><span id="local-6989586621679753447"><span id="local-6989586621679753448"><span id="local-6989586621679753449"><span id="local-6989586621679753450"><span id="local-6989586621679753451"><span id="local-6989586621679753452"><span id="local-6989586621679753453"><span id="local-6989586621679753454"><span id="local-6989586621679753455"><span id="local-6989586621679753456"><span id="local-6989586621679753457"><span id="local-6989586621679753458"><span id="local-6989586621679753459"><span id="local-6989586621679753460"><span class="hs-keyword">instance</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753460"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-573"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753459"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-574"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753458"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="#local-6989586621679753457"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-576"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-577"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753456"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753455"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-578"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753454"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753453"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753452"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753451"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-580"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753450"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753449"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753459"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753448"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753460"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><a href="#local-6989586621679753447"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753452"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753453"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753451"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-584"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-585"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ByT5"><span class="hs-identifier hs-type">ByT5</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753455"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753452"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753449"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753459"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753448"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753458"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753456"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753454"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753453"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753450"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753460"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753451"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="#local-6989586621679753457"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><a href="#local-6989586621679753447"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-591"></span><span>  </span><span id="local-6989586621679753445"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'ByT5 gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
</span><a href="#local-6989586621679753445"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679753438"><span id="local-6989586621679753439"><span id="local-6989586621679753440"><span id="local-6989586621679753441"><span id="local-6989586621679753442"><span id="local-6989586621679753443"><span id="local-6989586621679753444"><span class="annot"><span class="annottext">FFNDropoutF 'ByT5 dropoutP
FFNLayerNormF 'ByT5 gradient device dataType queryEmbedDim
FFNActivationDropoutF 'ByT5 dropoutP
FFNActivationF 'ByT5
FFNOutputWeightF
  'ByT5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'ByT5 dropoutP
ffnLayerNorm :: FFNLayerNormF 'ByT5 gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'ByT5 dropoutP
ffnActivation :: FFNActivationF 'ByT5
ffnOutputWeight :: FFNOutputWeightF
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679753438"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679753437"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753437"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-592"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679753436"><span class="annot"><span class="annottext">activate :: Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679753436"><span class="hs-identifier hs-var hs-var">activate</span></a></span></span><span> </span><span id="local-6989586621679753435"><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679753435"><span class="hs-identifier hs-var">query'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-593"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679753435"><span class="hs-identifier hs-var">query'</span></a></span><span>
</span><span id="line-594"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753444"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-595"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GeluNew
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GeluNew
FFNActivationF 'ByT5
</span><a href="#local-6989586621679753441"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-596"></span><span>        </span><span id="local-6989586621679753434"><span class="annot"><span class="annottext">gate :: Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679753434"><span class="hs-identifier hs-var hs-var">gate</span></a></span></span><span> </span><span id="local-6989586621679753433"><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679753433"><span class="hs-identifier hs-var">query'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     gradient
     (Or (Gradient RequiresGradient) gradient queryGradient))
  (Unify
     (Layout LayoutType)
     ('Layout 'Dense)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
  (Unify
     (Device (DeviceType Nat))
     device
     (Unify (Device (DeviceType Nat)) device queryDevice))
  (Unify
     (DataType DType)
     dataType
     (Unify (DataType DType) dataType queryDataType))
  (LinearWithoutBiasF
     ('Shape '[ffnDim, queryEmbedDim])
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(*)</span></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      gradient
      (Or (Gradient RequiresGradient) gradient queryGradient))
   (Unify
      (Layout LayoutType)
      ('Layout 'Dense)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
   (Unify
      (Device (DeviceType Nat))
      device
      (Unify (Device (DeviceType Nat)) device queryDevice))
   (Unify
      (DataType DType)
      dataType
      (Unify (DataType DType) dataType queryDataType))
   (LinearWithoutBiasF
      ('Shape '[ffnDim, queryEmbedDim])
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
 -&gt; Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
 -&gt; Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
      -&gt; Tensor
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient))
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType))
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 k2 (f :: k1 -&gt; k2 -&gt; Type -&gt; Type) a b (j :: k1)
       (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679753436"><span class="hs-identifier hs-var">activate</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679753433"><span class="hs-identifier hs-var">query'</span></a></span><span> </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
   -&gt; Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (f :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'ByT5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753443"><span class="hs-identifier hs-var">ffnInputWeight2</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or (Gradient RequiresGradient) gradient queryGradient)
   (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
   (Unify (Device (DeviceType Nat)) device queryDevice)
   (Unify (DataType DType) dataType queryDataType)
   (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
</span><a href="#local-6989586621679753433"><span class="hs-identifier hs-var">query'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice -&gt; (output, generatorOutput)
forall i j a. IxState i j a -&gt; i -&gt; (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxState</span></a></span><span> </span><span class="annot"><span class="annottext">(IxState (Generator generatorDevice) generatorOutput output
 -&gt; Generator generatorDevice -&gt; (output, generatorOutput))
-&gt; IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-598"></span><span>          </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753437"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-599"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithoutBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'ByT5 gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679753439"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-600"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or (Gradient RequiresGradient) gradient queryGradient)
  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
  (Unify (Device (DeviceType Nat)) device queryDevice)
  (Unify (DataType DType) dataType queryDataType)
  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
</span><a href="#local-6989586621679753434"><span class="hs-identifier hs-var">gate</span></a></span><span>
</span><span id="line-601"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">GeluNew
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">GeluNew
FFNActivationF 'ByT5
</span><a href="#local-6989586621679753441"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-602"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithoutBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNActivationDropoutF 'ByT5 dropoutP
</span><a href="#local-6989586621679753440"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-603"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient)))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType)))
       (LinearWithoutBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithoutBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify
                   (Device (DeviceType Nat))
                   device
                   (Unify (Device (DeviceType Nat)) device queryDevice))
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithoutBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithoutBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'ByT5 gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753442"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-604"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         generatorOutput
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithoutBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               (LinearWithoutBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient)))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType)))
       (LinearWithoutBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          (LinearWithoutBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
     generatorOutput))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
      generatorOutput))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      generatorOutput
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithoutBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            (LinearWithoutBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithoutBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             (LinearWithoutBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
        generatorOutput))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))),
    generatorOutput)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNDropoutF 'ByT5 dropoutP
</span><a href="#local-6989586621679753438"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-605"></span><span>            </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  generatorOutput
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxState generatorOutput generatorOutput output)
-&gt; IxState (Generator generatorDevice) generatorOutput output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">output -&gt; IxState generatorOutput generatorOutput output
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(output -&gt; IxState generatorOutput generatorOutput output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithoutBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         (LinearWithoutBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; output)
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState generatorOutput generatorOutput output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753437"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithoutBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        (LinearWithoutBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (queryDevice
      &lt;+&gt; Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithoutBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           (LinearWithoutBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              (LayerNormWithoutBiasF ('Shape '[queryEmbedDim]) queryShape))))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-606"></span><span>
</span><span id="line-607"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'BART@.</span><span>
</span><span id="line-608"></span><span class="hs-comment">--</span><span>
</span><span id="line-609"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-610"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-611"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-612"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-613"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-614"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-615"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-616"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-617"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-618"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-619"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-620"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-621"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-622"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-623"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-624"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-625"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-626"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-627"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-628"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-629"></span><span class="hs-comment">--      ffnLayerNorm</span><span>
</span><span id="line-630"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-631"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-632"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-633"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-634"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-636"></span><span id="local-6989586621679753418"><span id="local-6989586621679753419"><span id="local-6989586621679753420"><span id="local-6989586621679753421"><span id="local-6989586621679753422"><span id="local-6989586621679753423"><span id="local-6989586621679753424"><span id="local-6989586621679753425"><span id="local-6989586621679753426"><span id="local-6989586621679753427"><span id="local-6989586621679753428"><span id="local-6989586621679753429"><span id="local-6989586621679753430"><span id="local-6989586621679753431"><span class="hs-keyword">instance</span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753431"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-638"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753430"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-639"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753429"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-640"></span><span>    </span><span class="annot"><a href="#local-6989586621679753428"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-641"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-642"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753427"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753426"><span class="hs-identifier hs-type">queryGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-643"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753425"><span class="hs-identifier hs-type">queryLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753424"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753423"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753422"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-645"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753421"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753420"><span class="hs-identifier hs-type">queryDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-646"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753430"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753419"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753431"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-647"></span><span>    </span><span class="annot"><a href="#local-6989586621679753418"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-648"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753424"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753424"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753423"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753422"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753424"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753423"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753422"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-650"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-651"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BART"><span class="hs-identifier hs-type">BART</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753427"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753424"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753421"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753430"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753419"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753429"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753426"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753425"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753423"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753420"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753431"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753422"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>    </span><span class="annot"><a href="#local-6989586621679753428"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-655"></span><span>    </span><span class="annot"><a href="#local-6989586621679753418"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-657"></span><span>  </span><span id="local-6989586621679753416"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'BART gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
</span><a href="#local-6989586621679753416"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679753409"><span id="local-6989586621679753410"><span id="local-6989586621679753411"><span id="local-6989586621679753412"><span id="local-6989586621679753413"><span id="local-6989586621679753414"><span id="local-6989586621679753415"><span class="annot"><span class="annottext">FFNDropoutF 'BART dropoutP
FFNLayerNormF 'BART gradient device dataType queryEmbedDim
FFNActivationDropoutF 'BART dropoutP
FFNActivationF 'BART
FFNOutputWeightF
  'BART gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'BART gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BART gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'BART dropoutP
ffnLayerNorm :: FFNLayerNormF 'BART gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'BART dropoutP
ffnActivation :: FFNActivationF 'BART
ffnOutputWeight :: FFNOutputWeightF
  'BART gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'BART gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'BART gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679753409"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679753408"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753408"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-658"></span><span>    </span><span class="annot"><span class="annottext">IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice -&gt; (output, generatorOutput)
forall i j a. IxState i j a -&gt; i -&gt; (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxState</span></a></span><span> </span><span class="annot"><span class="annottext">(IxState (Generator generatorDevice) generatorOutput output
 -&gt; Generator generatorDevice -&gt; (output, generatorOutput))
-&gt; IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-659"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753408"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-660"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BART gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753415"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-661"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gelu
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Gelu
FFNActivationF 'BART
</span><a href="#local-6989586621679753412"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-662"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify
          (Device (DeviceType Nat))
          (Unify (Device (DeviceType Nat)) device queryDevice)
          generatorDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify (Device (DeviceType Nat)) device queryDevice)
          generatorDevice)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice)))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNActivationDropoutF 'BART dropoutP
</span><a href="#local-6989586621679753411"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-663"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice))
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify (Device (DeviceType Nat)) device queryDevice)
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify (Device (DeviceType Nat)) device queryDevice)
          generatorDevice)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify (Device (DeviceType Nat)) device queryDevice)
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify (Device (DeviceType Nat)) device queryDevice)
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice)))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'BART gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753413"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-664"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice))
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice)))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice))
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify (Device (DeviceType Nat)) device queryDevice)
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify (Device (DeviceType Nat)) device queryDevice)
                generatorDevice))
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify (Device (DeviceType Nat)) device queryDevice)
                generatorDevice))
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice))))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify (Device (DeviceType Nat)) device queryDevice)
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify
                   (Device (DeviceType Nat))
                   (Unify (Device (DeviceType Nat)) device queryDevice)
                   generatorDevice))
             (Unify
                (Device (DeviceType Nat))
                (Unify (Device (DeviceType Nat)) device queryDevice)
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify
                   (Device (DeviceType Nat))
                   (Unify (Device (DeviceType Nat)) device queryDevice)
                   generatorDevice))
             (Unify
                (Device (DeviceType Nat))
                (Unify (Device (DeviceType Nat)) device queryDevice)
                generatorDevice))))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify (Device (DeviceType Nat)) device queryDevice)
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNDropoutF 'BART dropoutP
</span><a href="#local-6989586621679753409"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-665"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice))
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice)))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice))
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice)))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               queryGradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               queryLayout
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               queryDevice
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify
                        (Device (DeviceType Nat))
                        (Unify (Device (DeviceType Nat)) device queryDevice)
                        generatorDevice))
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice)))
            (Unify
               (DataType DType)
               queryDataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (BroadcastShapesF
               queryShape
               (LinearWithBiasF
                  ('Shape '[queryEmbedDim, ffnDim])
                  ('Shape '[queryEmbedDim])
                  (LinearWithBiasF
                     ('Shape '[ffnDim, queryEmbedDim])
                     ('Shape '[ffnDim])
                     queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify (Device (DeviceType Nat)) device queryDevice)
                    generatorDevice))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice)))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     queryGradient
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient)))
  (Unify
     (Layout LayoutType)
     queryLayout
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
  (Unify
     (Device (DeviceType Nat))
     queryDevice
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)))
  (Unify
     (DataType DType)
     queryDataType
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType)))
  (BroadcastShapesF
     queryShape
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify (Device (DeviceType Nat)) device queryDevice)
                    generatorDevice))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice)))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      queryGradient
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient)))
   (Unify
      (Layout LayoutType)
      queryLayout
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
   (Unify
      (Device (DeviceType Nat))
      queryDevice
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice)))
   (Unify
      (DataType DType)
      queryDataType
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType)))
   (BroadcastShapesF
      queryShape
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            queryDevice
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice))
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice)))
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            queryDevice
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice))
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice)))
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify
                    (Device (DeviceType Nat))
                    (Unify (Device (DeviceType Nat)) device queryDevice)
                    generatorDevice))
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice)))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753408"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (queryDevice
      &lt;+&gt; Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice)))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         queryDevice
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify
                     (Device (DeviceType Nat))
                     (Unify (Device (DeviceType Nat)) device queryDevice)
                     generatorDevice))
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice)))
         generatorOutput
         output)
-&gt; IxState (Generator generatorDevice) generatorOutput output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify (Device (DeviceType Nat)) device queryDevice)
            generatorDevice))
      (Unify
         (Device (DeviceType Nat))
         (Unify (Device (DeviceType Nat)) device queryDevice)
         generatorDevice))
 -&gt; (output, generatorOutput))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     generatorOutput
     output
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify
             (Device (DeviceType Nat))
             (Unify (Device (DeviceType Nat)) device queryDevice)
             generatorDevice))
       (Unify
          (Device (DeviceType Nat))
          (Unify (Device (DeviceType Nat)) device queryDevice)
          generatorDevice))
  -&gt; (output, generatorOutput))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
      generatorOutput
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         queryDevice
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice)))
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify (Device (DeviceType Nat)) device queryDevice)
                  generatorDevice))
            (Unify
               (Device (DeviceType Nat))
               (Unify (Device (DeviceType Nat)) device queryDevice)
               generatorDevice))
    -&gt; (output, generatorOutput))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     generatorOutput
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify
                 (Device (DeviceType Nat))
                 (Unify (Device (DeviceType Nat)) device queryDevice)
                 generatorDevice))
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice)))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify (Device (DeviceType Nat)) device queryDevice)
              generatorDevice))
        (Unify
           (Device (DeviceType Nat))
           (Unify (Device (DeviceType Nat)) device queryDevice)
           generatorDevice))
-&gt; (output, generatorOutput)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'BART gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679753410"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-667"></span><span>
</span><span id="line-668"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'BERT@.</span><span>
</span><span id="line-669"></span><span class="hs-comment">--</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-671"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-672"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-673"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-674"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-675"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-676"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-677"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-678"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-679"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-680"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-681"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-682"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-683"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-684"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-685"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-686"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-687"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-688"></span><span class="hs-comment">--      ffnLayerNorm</span><span>
</span><span id="line-689"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-690"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-691"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-692"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-693"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-694"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-695"></span><span id="local-6989586621679753394"><span id="local-6989586621679753395"><span id="local-6989586621679753396"><span id="local-6989586621679753397"><span id="local-6989586621679753398"><span id="local-6989586621679753399"><span id="local-6989586621679753400"><span id="local-6989586621679753401"><span id="local-6989586621679753402"><span id="local-6989586621679753403"><span id="local-6989586621679753404"><span id="local-6989586621679753405"><span id="local-6989586621679753406"><span id="local-6989586621679753407"><span class="hs-keyword">instance</span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753407"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-697"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753406"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-698"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753405"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-699"></span><span>    </span><span class="annot"><a href="#local-6989586621679753404"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-700"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-701"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753403"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753402"><span class="hs-identifier hs-type">queryGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753401"><span class="hs-identifier hs-type">queryLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-703"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753400"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753399"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753398"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-704"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753397"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753396"><span class="hs-identifier hs-type">queryDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-705"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753406"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753395"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753407"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><a href="#local-6989586621679753394"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-707"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753400"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753400"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753399"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753398"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-709"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-710"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#BERT"><span class="hs-identifier hs-type">BERT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753403"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753400"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753397"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753406"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753395"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753405"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753402"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753401"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753399"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753396"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753407"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-712"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753398"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>    </span><span class="annot"><a href="#local-6989586621679753404"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-714"></span><span>    </span><span class="annot"><a href="#local-6989586621679753394"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-716"></span><span>  </span><span id="local-6989586621679753392"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'BERT gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
</span><a href="#local-6989586621679753392"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679753385"><span id="local-6989586621679753386"><span id="local-6989586621679753387"><span id="local-6989586621679753388"><span id="local-6989586621679753389"><span id="local-6989586621679753390"><span id="local-6989586621679753391"><span class="annot"><span class="annottext">FFNDropoutF 'BERT dropoutP
FFNLayerNormF 'BERT gradient device dataType queryEmbedDim
FFNActivationDropoutF 'BERT dropoutP
FFNActivationF 'BERT
FFNOutputWeightF
  'BERT gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'BERT gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'BERT dropoutP
ffnLayerNorm :: FFNLayerNormF 'BERT gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'BERT dropoutP
ffnActivation :: FFNActivationF 'BERT
ffnOutputWeight :: FFNOutputWeightF
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'BERT gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679753385"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679753384"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753384"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-717"></span><span>    </span><span class="annot"><span class="annottext">IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice -&gt; (output, generatorOutput)
forall i j a. IxState i j a -&gt; i -&gt; (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxState</span></a></span><span> </span><span class="annot"><span class="annottext">(IxState (Generator generatorDevice) generatorOutput output
 -&gt; Generator generatorDevice -&gt; (output, generatorOutput))
-&gt; IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-718"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753384"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-719"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'BERT gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753391"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-720"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gelu
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Gelu
FFNActivationF 'BERT
</span><a href="#local-6989586621679753388"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-721"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'BERT gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753389"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-722"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNDropoutF 'BERT dropoutP
</span><a href="#local-6989586621679753385"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-723"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               queryGradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               queryLayout
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               queryDevice
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               queryDataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (BroadcastShapesF
               queryShape
               (LinearWithBiasF
                  ('Shape '[queryEmbedDim, ffnDim])
                  ('Shape '[queryEmbedDim])
                  (LinearWithBiasF
                     ('Shape '[ffnDim, queryEmbedDim])
                     ('Shape '[ffnDim])
                     queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     queryGradient
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient)))
  (Unify
     (Layout LayoutType)
     queryLayout
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
  (Unify
     (Device (DeviceType Nat))
     queryDevice
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Unify
     (DataType DType)
     queryDataType
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType)))
  (BroadcastShapesF
     queryShape
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      queryGradient
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient)))
   (Unify
      (Layout LayoutType)
      queryLayout
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
   (Unify
      (Device (DeviceType Nat))
      queryDevice
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
   (Unify
      (DataType DType)
      queryDataType
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType)))
   (BroadcastShapesF
      queryShape
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            queryDevice
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            queryDevice
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753384"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (queryDevice
      &lt;+&gt; Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-724"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         queryDevice
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         generatorOutput
         output)
-&gt; IxState (Generator generatorDevice) generatorOutput output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (output, generatorOutput))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     output
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (output, generatorOutput))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      generatorOutput
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         queryDevice
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (output, generatorOutput))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (output, generatorOutput)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'BERT gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679753386"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-725"></span><span>
</span><span id="line-726"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'RoBERTa@.</span><span>
</span><span id="line-727"></span><span class="hs-comment">--</span><span>
</span><span id="line-728"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-729"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-730"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-731"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-732"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-733"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-734"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-735"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-736"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-737"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-738"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-739"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-740"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-741"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-742"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-743"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-744"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-745"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-746"></span><span class="hs-comment">--      ffnLayerNorm</span><span>
</span><span id="line-747"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-748"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-749"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-750"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-751"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-753"></span><span id="local-6989586621679753370"><span id="local-6989586621679753371"><span id="local-6989586621679753372"><span id="local-6989586621679753373"><span id="local-6989586621679753374"><span id="local-6989586621679753375"><span id="local-6989586621679753376"><span id="local-6989586621679753377"><span id="local-6989586621679753378"><span id="local-6989586621679753379"><span id="local-6989586621679753380"><span id="local-6989586621679753381"><span id="local-6989586621679753382"><span id="local-6989586621679753383"><span class="hs-keyword">instance</span><span>
</span><span id="line-754"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753383"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753382"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-756"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753381"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-757"></span><span>    </span><span class="annot"><a href="#local-6989586621679753380"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-758"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-759"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753378"><span class="hs-identifier hs-type">queryGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753377"><span class="hs-identifier hs-type">queryLayout</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-761"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753376"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753375"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753374"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-762"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753373"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753372"><span class="hs-identifier hs-type">queryDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-763"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753382"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753371"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753383"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-764"></span><span>    </span><span class="annot"><a href="#local-6989586621679753370"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-765"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753376"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753376"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753375"><span class="hs-identifier hs-type">queryDevice</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753374"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-767"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-768"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#RoBERTa"><span class="hs-identifier hs-type">RoBERTa</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753379"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753376"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753373"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753382"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753371"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753381"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-769"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753378"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753377"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753375"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753372"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753383"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-770"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753374"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>    </span><span class="annot"><a href="#local-6989586621679753380"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-772"></span><span>    </span><span class="annot"><a href="#local-6989586621679753370"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-773"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-774"></span><span>  </span><span id="local-6989586621679753368"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'RoBERTa gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
</span><a href="#local-6989586621679753368"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679753361"><span id="local-6989586621679753362"><span id="local-6989586621679753363"><span id="local-6989586621679753364"><span id="local-6989586621679753365"><span id="local-6989586621679753366"><span id="local-6989586621679753367"><span class="annot"><span class="annottext">FFNDropoutF 'RoBERTa dropoutP
FFNLayerNormF 'RoBERTa gradient device dataType queryEmbedDim
FFNActivationDropoutF 'RoBERTa dropoutP
FFNActivationF 'RoBERTa
FFNOutputWeightF
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'RoBERTa dropoutP
ffnLayerNorm :: FFNLayerNormF 'RoBERTa gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'RoBERTa dropoutP
ffnActivation :: FFNActivationF 'RoBERTa
ffnOutputWeight :: FFNOutputWeightF
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679753361"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679753360"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753360"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-775"></span><span>    </span><span class="annot"><span class="annottext">IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice -&gt; (output, generatorOutput)
forall i j a. IxState i j a -&gt; i -&gt; (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxState</span></a></span><span> </span><span class="annot"><span class="annottext">(IxState (Generator generatorDevice) generatorOutput output
 -&gt; Generator generatorDevice -&gt; (output, generatorOutput))
-&gt; IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-776"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753360"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-777"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753367"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Gelu
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Gelu
FFNActivationF 'RoBERTa
</span><a href="#local-6989586621679753364"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-779"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'RoBERTa gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753365"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-780"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNDropoutF 'RoBERTa dropoutP
</span><a href="#local-6989586621679753361"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-781"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               queryGradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               queryLayout
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               queryDevice
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               queryDataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (BroadcastShapesF
               queryShape
               (LinearWithBiasF
                  ('Shape '[queryEmbedDim, ffnDim])
                  ('Shape '[queryEmbedDim])
                  (LinearWithBiasF
                     ('Shape '[ffnDim, queryEmbedDim])
                     ('Shape '[ffnDim])
                     queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  (Or
     (Gradient RequiresGradient)
     queryGradient
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient)))
  (Unify
     (Layout LayoutType)
     queryLayout
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
  (Unify
     (Device (DeviceType Nat))
     queryDevice
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Unify
     (DataType DType)
     queryDataType
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType)))
  (BroadcastShapesF
     queryShape
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(Tensor
   (Or
      (Gradient RequiresGradient)
      queryGradient
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient)))
   (Unify
      (Layout LayoutType)
      queryLayout
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
   (Unify
      (Device (DeviceType Nat))
      queryDevice
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
   (Unify
      (DataType DType)
      queryDataType
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType)))
   (BroadcastShapesF
      queryShape
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            queryDevice
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
    -&gt; Tensor
         (Or
            (Gradient RequiresGradient)
            queryGradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            queryLayout
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            queryDevice
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            queryDataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (BroadcastShapesF
            queryShape
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           queryGradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           queryLayout
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           queryDevice
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           queryDataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (BroadcastShapesF
           queryShape
           (LinearWithBiasF
              ('Shape '[queryEmbedDim, ffnDim])
              ('Shape '[queryEmbedDim])
              (LinearWithBiasF
                 ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753360"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (queryDevice
      &lt;+&gt; Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         queryDevice
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         generatorOutput
         output)
-&gt; IxState (Generator generatorDevice) generatorOutput output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (output, generatorOutput))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     output
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (output, generatorOutput))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      generatorOutput
      output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         queryGradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         queryLayout
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         queryDevice
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         queryDataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (BroadcastShapesF
         queryShape
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (output, generatorOutput))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        queryGradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        queryLayout
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        queryDevice
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        queryDataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim]) ('Shape '[ffnDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (output, generatorOutput)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'RoBERTa gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679753362"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-783"></span><span>
</span><span id="line-784"></span><span class="hs-comment">-- | 'HasForward' instance for @TransformerFeedForwardNetwork 'Pegasus@.</span><span>
</span><span id="line-785"></span><span class="hs-comment">--</span><span>
</span><span id="line-786"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-787"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-788"></span><span class="hs-comment">--       &#9474; query &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-789"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;       &#9474;</span><span>
</span><span id="line-790"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-791"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-792"></span><span class="hs-comment">--      ffnLayerNorm     &#9474;</span><span>
</span><span id="line-793"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-794"></span><span class="hs-comment">--     ffnInputWeight    &#9474;</span><span>
</span><span id="line-795"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-796"></span><span class="hs-comment">--     ffnActivation     &#9474;</span><span>
</span><span id="line-797"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-798"></span><span class="hs-comment">--  ffnActivationDropout &#9474;</span><span>
</span><span id="line-799"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-800"></span><span class="hs-comment">--    ffnOutputWeight    &#9474;</span><span>
</span><span id="line-801"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-802"></span><span class="hs-comment">--       ffnDropout      &#9474;</span><span>
</span><span id="line-803"></span><span class="hs-comment">--           &#9474;           &#9474;</span><span>
</span><span id="line-804"></span><span class="hs-comment">--           &#9660;           &#9474;</span><span>
</span><span id="line-805"></span><span class="hs-comment">--          add&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-806"></span><span class="hs-comment">--           &#9474;</span><span>
</span><span id="line-807"></span><span class="hs-comment">--           &#9660;</span><span>
</span><span id="line-808"></span><span class="hs-comment">--       &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-809"></span><span class="hs-comment">--       &#9474; query &#9474;</span><span>
</span><span id="line-810"></span><span class="hs-comment">--       &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-812"></span><span id="local-6989586621679753346"><span id="local-6989586621679753347"><span id="local-6989586621679753348"><span id="local-6989586621679753349"><span id="local-6989586621679753350"><span id="local-6989586621679753351"><span id="local-6989586621679753352"><span id="local-6989586621679753353"><span id="local-6989586621679753354"><span id="local-6989586621679753355"><span id="local-6989586621679753356"><span id="local-6989586621679753357"><span id="local-6989586621679753358"><span id="local-6989586621679753359"><span class="hs-keyword">instance</span><span>
</span><span id="line-813"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetShape"><span class="hs-identifier hs-type">SGetShape</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753359"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-814"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753358"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-815"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Scalar.html#Scalar"><span class="hs-identifier hs-type">Scalar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753357"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-816"></span><span>    </span><span class="annot"><a href="#local-6989586621679753356"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-817"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-818"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753355"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%7C%3E"><span class="hs-operator hs-type">&lt;|&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753354"><span class="hs-identifier hs-type">gradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-819"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753353"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753352"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753351"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753350"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753349"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753348"><span class="hs-identifier hs-type">dataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#FeedForwardNetworkOutputShape"><span class="hs-identifier hs-type">FeedForwardNetworkOutputShape</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753358"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753347"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753359"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-823"></span><span>    </span><span class="annot"><a href="#local-6989586621679753346"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679753351"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753352"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753350"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-824"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-825"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-826"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753354"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753351"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753348"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753358"><span class="hs-identifier hs-type">queryEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753347"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753357"><span class="hs-identifier hs-type">dropoutP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-827"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753355"><span class="hs-identifier hs-type">queryGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753353"><span class="hs-identifier hs-type">queryLayout</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753352"><span class="hs-identifier hs-type">queryDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753349"><span class="hs-identifier hs-type">queryDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753359"><span class="hs-identifier hs-type">queryShape</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-828"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Random.html#Generator"><span class="hs-identifier hs-type">Generator</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679753350"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-829"></span><span>    </span><span class="annot"><a href="#local-6989586621679753356"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-830"></span><span>    </span><span class="annot"><a href="#local-6989586621679753346"><span class="hs-identifier hs-type">generatorOutput</span></a></span><span>
</span><span id="line-831"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-832"></span><span>  </span><span id="local-6989586621679753344"><span class="annot"><span class="annottext">forward :: TransformerFeedForwardNetwork
  'Pegasus gradient device dataType queryEmbedDim ffnDim dropoutP
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
</span><a href="#local-6989586621679753344"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#TransformerFeedForwardNetwork"><span class="hs-identifier hs-type">TransformerFeedForwardNetwork</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.FeedForwardNetwork.html#GTransformerFeedForwardNetwork"><span class="hs-identifier hs-type">GTransformerFeedForwardNetwork</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679753337"><span id="local-6989586621679753338"><span id="local-6989586621679753339"><span id="local-6989586621679753340"><span id="local-6989586621679753341"><span id="local-6989586621679753342"><span id="local-6989586621679753343"><span class="annot"><span class="annottext">FFNDropoutF 'Pegasus dropoutP
FFNLayerNormF 'Pegasus gradient device dataType queryEmbedDim
FFNActivationDropoutF 'Pegasus dropoutP
FFNActivationF 'Pegasus
FFNOutputWeightF
  'Pegasus gradient device dataType queryEmbedDim ffnDim
FFNInputWeight2F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnDropout :: FFNDropoutF 'Pegasus dropoutP
ffnLayerNorm :: FFNLayerNormF 'Pegasus gradient device dataType queryEmbedDim
ffnActivationDropout :: FFNActivationDropoutF 'Pegasus dropoutP
ffnActivation :: FFNActivationF 'Pegasus
ffnOutputWeight :: FFNOutputWeightF
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnInputWeight2 :: FFNInputWeight2F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnInputWeight1 :: FFNInputWeight1F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
ffnDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; dropout
ffnLayerNorm :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; layerNorm
ffnActivationDropout :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activationDropout
ffnActivation :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; activation
ffnOutputWeight :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; outputWeight
ffnInputWeight2 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight2
ffnInputWeight1 :: forall inputWeight1 inputWeight2 outputWeight activation
       activationDropout layerNorm dropout.
GTransformerFeedForwardNetwork
  inputWeight1
  inputWeight2
  outputWeight
  activation
  activationDropout
  layerNorm
  dropout
-&gt; inputWeight1
</span><a href="#local-6989586621679753337"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679753336"><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753336"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-833"></span><span>    </span><span class="annot"><span class="annottext">IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice -&gt; (output, generatorOutput)
forall i j a. IxState i j a -&gt; i -&gt; (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxState</span></a></span><span> </span><span class="annot"><span class="annottext">(IxState (Generator generatorDevice) generatorOutput output
 -&gt; Generator generatorDevice -&gt; (output, generatorOutput))
-&gt; IxState (Generator generatorDevice) generatorOutput output
-&gt; Generator generatorDevice
-&gt; (output, generatorOutput)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-834"></span><span>      </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        queryGradient queryLayout queryDevice queryDataType queryShape)
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753336"><span class="hs-identifier hs-var">query</span></a></span><span>
</span><span id="line-835"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape)
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or (Gradient RequiresGradient) gradient queryGradient)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
            (Unify (Device (DeviceType Nat)) device queryDevice)
            (Unify (DataType DType) dataType queryDataType)
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or (Gradient RequiresGradient) gradient queryGradient)
       (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
       (Unify (Device (DeviceType Nat)) device queryDevice)
       (Unify (DataType DType) dataType queryDataType)
       (LayerNormWithBiasF
          ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or (Gradient RequiresGradient) gradient queryGradient)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
         (Unify (Device (DeviceType Nat)) device queryDevice)
         (Unify (DataType DType) dataType queryDataType)
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      queryGradient queryLayout queryDevice queryDataType queryShape
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or (Gradient RequiresGradient) gradient queryGradient)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
          (Unify (Device (DeviceType Nat)) device queryDevice)
          (Unify (DataType DType) dataType queryDataType)
          (LayerNormWithBiasF
             ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
        Generator generatorDevice))
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or (Gradient RequiresGradient) gradient queryGradient)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
        (Unify (Device (DeviceType Nat)) device queryDevice)
        (Unify (DataType DType) dataType queryDataType)
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
-&gt; Tensor
     queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithBiasF
         ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">LayerNorm
  'WithBias gradient device dataType ('Shape '[queryEmbedDim])
FFNLayerNormF 'Pegasus gradient device dataType queryEmbedDim
</span><a href="#local-6989586621679753338"><span class="hs-identifier hs-var">ffnLayerNorm</span></a></span><span>
</span><span id="line-836"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithBiasF
        ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithBiasF
         ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          ('Shape '[ffnDim])
          (LayerNormWithBiasF
             ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or (Gradient RequiresGradient) gradient queryGradient)
      (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
      (Unify (Device (DeviceType Nat)) device queryDevice)
      (Unify (DataType DType) dataType queryDataType)
      (LayerNormWithBiasF
         ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithBiasF
        ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
-&gt; Tensor
     (Or (Gradient RequiresGradient) gradient queryGradient)
     (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)
     (Unify (Device (DeviceType Nat)) device queryDevice)
     (Unify (DataType DType) dataType queryDataType)
     (LayerNormWithBiasF
        ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType queryEmbedDim ffnDim
FFNInputWeight1F
  'Pegasus gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753343"><span class="hs-identifier hs-var">ffnInputWeight1</span></a></span><span>
</span><span id="line-837"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator generatorDevice)
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          ('Shape '[ffnDim])
          (LayerNormWithBiasF
             ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
     Generator generatorDevice))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
      Generator generatorDevice))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator generatorDevice)
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
        Generator generatorDevice))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator generatorDevice)
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Relu
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
    Generator generatorDevice)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Relu
FFNActivationF 'Pegasus
</span><a href="#local-6989586621679753340"><span class="hs-identifier hs-var">ffnActivation</span></a></span><span>
</span><span id="line-838"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator generatorDevice)
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator generatorDevice)
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice)
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType))
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or (Gradient RequiresGradient) gradient queryGradient))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)
       (Unify
          (DataType DType)
          dataType
          (Unify (DataType DType) dataType queryDataType))
       (LinearWithBiasF
          ('Shape '[ffnDim, queryEmbedDim])
          ('Shape '[ffnDim])
          (LayerNormWithBiasF
             ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator generatorDevice)
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType))
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator generatorDevice
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType))
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType))
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) device queryDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator generatorDevice
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNActivationDropoutF 'Pegasus dropoutP
</span><a href="#local-6989586621679753339"><span class="hs-identifier hs-var">ffnActivationDropout</span></a></span><span>
</span><span id="line-839"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify
                  (Device (DeviceType Nat))
                  (Unify
                     (Device (DeviceType Nat))
                     device
                     (Unify (Device (DeviceType Nat)) device queryDevice))
                  generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  (LayerNormWithBiasF
                     ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient)))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType)))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
     Generator
       (Unify
          (Device (DeviceType Nat))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) device queryDevice))
          generatorDevice)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
      Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice)))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or (Gradient RequiresGradient) gradient queryGradient))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice)
      (Unify
         (DataType DType)
         dataType
         (Unify (DataType DType) dataType queryDataType))
      (LinearWithBiasF
         ('Shape '[ffnDim, queryEmbedDim])
         ('Shape '[ffnDim])
         (LayerNormWithBiasF
            ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify
                (Device (DeviceType Nat))
                (Unify
                   (Device (DeviceType Nat))
                   device
                   (Unify (Device (DeviceType Nat)) device queryDevice))
                generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                ('Shape '[ffnDim])
                (LayerNormWithBiasF
                   ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
        Generator
          (Unify
             (Device (DeviceType Nat))
             (Unify
                (Device (DeviceType Nat))
                device
                (Unify (Device (DeviceType Nat)) device queryDevice))
             generatorDevice)))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify
              (Device (DeviceType Nat))
              (Unify
                 (Device (DeviceType Nat))
                 device
                 (Unify (Device (DeviceType Nat)) device queryDevice))
              generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or (Gradient RequiresGradient) gradient queryGradient))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout))
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
     (Unify
        (DataType DType)
        dataType
        (Unify (DataType DType) dataType queryDataType))
     (LinearWithBiasF
        ('Shape '[ffnDim, queryEmbedDim])
        ('Shape '[ffnDim])
        (LayerNormWithBiasF
           ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
    Generator
      (Unify
         (Device (DeviceType Nat))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) device queryDevice))
         generatorDevice))
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Linear 'WithBias gradient device dataType ffnDim queryEmbedDim
FFNOutputWeightF
  'Pegasus gradient device dataType queryEmbedDim ffnDim
</span><a href="#local-6989586621679753341"><span class="hs-identifier hs-var">ffnOutputWeight</span></a></span><span>
</span><span id="line-840"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  (Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice))
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxState
         (Generator
            (Unify
               (Device (DeviceType Nat))
               (Unify
                  (Device (DeviceType Nat))
                  device
                  (Unify (Device (DeviceType Nat)) device queryDevice))
               generatorDevice))
         generatorOutput
         (Tensor
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or
                  (Gradient RequiresGradient)
                  gradient
                  (Or (Gradient RequiresGradient) gradient queryGradient)))
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify
                  (Layout LayoutType)
                  ('Layout 'Dense)
                  (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
            (Unify
               (DataType DType)
               dataType
               (Unify
                  (DataType DType)
                  dataType
                  (Unify (DataType DType) dataType queryDataType)))
            (LinearWithBiasF
               ('Shape '[queryEmbedDim, ffnDim])
               ('Shape '[queryEmbedDim])
               (LinearWithBiasF
                  ('Shape '[ffnDim, queryEmbedDim])
                  ('Shape '[ffnDim])
                  (LayerNormWithBiasF
                     ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; IxState
     (Generator generatorDevice)
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator
   (Unify
      (Device (DeviceType Nat))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) device queryDevice))
      generatorDevice)
 -&gt; (Tensor
       (Or
          (Gradient RequiresGradient)
          gradient
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or (Gradient RequiresGradient) gradient queryGradient)))
       (Unify
          (Layout LayoutType)
          ('Layout 'Dense)
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
       (Unify
          (DataType DType)
          dataType
          (Unify
             (DataType DType)
             dataType
             (Unify (DataType DType) dataType queryDataType)))
       (LinearWithBiasF
          ('Shape '[queryEmbedDim, ffnDim])
          ('Shape '[queryEmbedDim])
          (LinearWithBiasF
             ('Shape '[ffnDim, queryEmbedDim])
             ('Shape '[ffnDim])
             (LayerNormWithBiasF
                ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
     generatorOutput))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall i j a. (i -&gt; (a, j)) -&gt; IxState i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxState</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator
    (Unify
       (Device (DeviceType Nat))
       (Unify
          (Device (DeviceType Nat))
          device
          (Unify (Device (DeviceType Nat)) device queryDevice))
       generatorDevice)
  -&gt; (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
      generatorOutput))
 -&gt; IxState
      (Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      generatorOutput
      (Tensor
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
         (Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
         (Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
         (LinearWithBiasF
            ('Shape '[queryEmbedDim, ffnDim])
            ('Shape '[queryEmbedDim])
            (LinearWithBiasF
               ('Shape '[ffnDim, queryEmbedDim])
               ('Shape '[ffnDim])
               (LayerNormWithBiasF
                  ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; Generator
         (Unify
            (Device (DeviceType Nat))
            (Unify
               (Device (DeviceType Nat))
               device
               (Unify (Device (DeviceType Nat)) device queryDevice))
            generatorDevice)
    -&gt; (Tensor
          (Or
             (Gradient RequiresGradient)
             gradient
             (Or
                (Gradient RequiresGradient)
                gradient
                (Or (Gradient RequiresGradient) gradient queryGradient)))
          (Unify
             (Layout LayoutType)
             ('Layout 'Dense)
             (Unify
                (Layout LayoutType)
                ('Layout 'Dense)
                (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
          (Unify
             (Device (DeviceType Nat))
             device
             (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
          (Unify
             (DataType DType)
             dataType
             (Unify
                (DataType DType)
                dataType
                (Unify (DataType DType) dataType queryDataType)))
          (LinearWithBiasF
             ('Shape '[queryEmbedDim, ffnDim])
             ('Shape '[queryEmbedDim])
             (LinearWithBiasF
                ('Shape '[ffnDim, queryEmbedDim])
                ('Shape '[ffnDim])
                (LayerNormWithBiasF
                   ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
        generatorOutput))
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState
     (Generator
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     generatorOutput
     (Tensor
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or
              (Gradient RequiresGradient)
              gradient
              (Or (Gradient RequiresGradient) gradient queryGradient)))
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify
              (Layout LayoutType)
              ('Layout 'Dense)
              (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
        (Unify
           (DataType DType)
           dataType
           (Unify
              (DataType DType)
              dataType
              (Unify (DataType DType) dataType queryDataType)))
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify
           (Device (DeviceType Nat))
           (Unify
              (Device (DeviceType Nat))
              device
              (Unify (Device (DeviceType Nat)) device queryDevice))
           generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Generator
     (Unify
        (Device (DeviceType Nat))
        (Unify
           (Device (DeviceType Nat))
           device
           (Unify (Device (DeviceType Nat)) device queryDevice))
        generatorDevice)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))),
    generatorOutput)
forall model input generator output generatorOutput.
HasForward model input generator output generatorOutput =&gt;
model -&gt; input -&gt; generator -&gt; (output, generatorOutput)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">Dropout dropoutP
FFNDropoutF 'Pegasus dropoutP
</span><a href="#local-6989586621679753337"><span class="hs-identifier hs-var">ffnDropout</span></a></span><span>
</span><span id="line-841"></span><span>        </span><span class="annot"><span class="annottext">IxState
  (Generator generatorDevice)
  generatorOutput
  (Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; IxState generatorOutput generatorOutput output)
-&gt; IxState (Generator generatorDevice) generatorOutput output
forall k1 (m :: k1 -&gt; k1 -&gt; Type -&gt; Type) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">output -&gt; IxState generatorOutput generatorOutput output
forall k (m :: k -&gt; k -&gt; Type -&gt; Type) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(output -&gt; IxState generatorOutput generatorOutput output)
-&gt; (Tensor
      (Or
         (Gradient RequiresGradient)
         gradient
         (Or
            (Gradient RequiresGradient)
            gradient
            (Or (Gradient RequiresGradient) gradient queryGradient)))
      (Unify
         (Layout LayoutType)
         ('Layout 'Dense)
         (Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
      (Unify
         (Device (DeviceType Nat))
         device
         (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
      (Unify
         (DataType DType)
         dataType
         (Unify
            (DataType DType)
            dataType
            (Unify (DataType DType) dataType queryDataType)))
      (LinearWithBiasF
         ('Shape '[queryEmbedDim, ffnDim])
         ('Shape '[queryEmbedDim])
         (LinearWithBiasF
            ('Shape '[ffnDim, queryEmbedDim])
            ('Shape '[ffnDim])
            (LayerNormWithBiasF
               ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
    -&gt; output)
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; IxState generatorOutput generatorOutput output
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
</span><a href="#local-6989586621679753336"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor
  queryGradient queryLayout queryDevice queryDataType queryShape
-&gt; Tensor
     (Or
        (Gradient RequiresGradient)
        gradient
        (Or
           (Gradient RequiresGradient)
           gradient
           (Or (Gradient RequiresGradient) gradient queryGradient)))
     (Unify
        (Layout LayoutType)
        ('Layout 'Dense)
        (Unify
           (Layout LayoutType)
           ('Layout 'Dense)
           (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (Unify
        (Device (DeviceType Nat))
        device
        (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (Unify
        (DataType DType)
        dataType
        (Unify
           (DataType DType)
           dataType
           (Unify (DataType DType) dataType queryDataType)))
     (LinearWithBiasF
        ('Shape '[queryEmbedDim, ffnDim])
        ('Shape '[queryEmbedDim])
        (LinearWithBiasF
           ('Shape '[ffnDim, queryEmbedDim])
           ('Shape '[ffnDim])
           (LayerNormWithBiasF
              ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape)))
-&gt; Tensor
     (queryGradient
      &lt;|&gt; Or
            (Gradient RequiresGradient)
            gradient
            (Or
               (Gradient RequiresGradient)
               gradient
               (Or (Gradient RequiresGradient) gradient queryGradient)))
     (queryLayout
      &lt;+&gt; Unify
            (Layout LayoutType)
            ('Layout 'Dense)
            (Unify
               (Layout LayoutType)
               ('Layout 'Dense)
               (Unify (Layout LayoutType) ('Layout 'Dense) queryLayout)))
     (queryDevice
      &lt;+&gt; Unify
            (Device (DeviceType Nat))
            device
            (Unify (Device (DeviceType Nat)) queryDevice generatorDevice))
     (queryDataType
      &lt;+&gt; Unify
            (DataType DType)
            dataType
            (Unify
               (DataType DType)
               dataType
               (Unify (DataType DType) dataType queryDataType)))
     (BroadcastShapesF
        queryShape
        (LinearWithBiasF
           ('Shape '[queryEmbedDim, ffnDim])
           ('Shape '[queryEmbedDim])
           (LinearWithBiasF
              ('Shape '[ffnDim, queryEmbedDim])
              ('Shape '[ffnDim])
              (LayerNormWithBiasF
                 ('Shape '[queryEmbedDim]) ('Shape '[queryEmbedDim]) queryShape))))
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)])
       (gradient' :: Gradient RequiresGradient)
       (layout' :: Layout LayoutType) (device' :: Device (DeviceType Nat))
       (dataType' :: DataType DType)
       (shape' :: Shape [Dim (Name Symbol) (Size Nat)]).
Tensor gradient layout device dataType shape
-&gt; Tensor gradient' layout' device' dataType' shape'
-&gt; Tensor
     (gradient &lt;|&gt; gradient')
     (layout &lt;+&gt; layout')
     (device &lt;+&gt; device')
     (dataType &lt;+&gt; dataType')
     (BroadcastShapesF shape shape')
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#add"><span class="hs-operator hs-var">`add`</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-842"></span></pre></body></html>