<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Pegasus.Common</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">Control.Monad.Catch</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier">MonadThrow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingI</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier">SDType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier">EDTDecoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier">EDTEncoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier">EDTHeadF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier">EDTSharedEmbeddingF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier">GEncoderDecoderTransformer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier">encoderDecoderTransformerSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier">MkAbsPos</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier">MkTransformerAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier">MkTransformerPaddingMask</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier">SPegasus</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier">ShiftRight</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier">Pegasus</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier">mkTransformerInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier">Catch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier">Shape</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier">SGetDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html"><span class="hs-identifier">Torch.GraduallyTyped.Unify</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator">(&lt;+&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span>
</span><span id="line-27"></span><span class="hs-comment">-- | Pegasus dType.</span><span>
</span><span id="line-28"></span><span class="hs-keyword">type</span><span> </span><span id="PegasusDType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDType"><span class="hs-identifier hs-var">PegasusDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Float"><span class="hs-identifier hs-type">Float</span></a></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-comment">-- | Pegasus dType singleton.</span><span>
</span><span id="line-31"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDType"><span class="hs-identifier hs-type">pegasusDType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDType"><span class="hs-identifier hs-type">SDType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDType"><span class="hs-identifier hs-type">PegasusDType</span></a></span><span>
</span><span id="line-32"></span><span id="pegasusDType"><span class="annot"><span class="annottext">pegasusDType :: SDType PegasusDType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDType"><span class="hs-identifier hs-var hs-var">pegasusDType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI PegasusDType =&gt; Sing PegasusDType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDType"><span class="hs-identifier hs-type">PegasusDType</span></a></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | Pegasus data type.</span><span>
</span><span id="line-35"></span><span class="hs-keyword">type</span><span> </span><span id="PegasusDataType"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-var">PegasusDataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDType"><span class="hs-identifier hs-type">PegasusDType</span></a></span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span class="hs-comment">-- | Pegasus data type singleton.</span><span>
</span><span id="line-38"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDataType"><span class="hs-identifier hs-type">pegasusDataType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span>
</span><span id="line-39"></span><span id="pegasusDataType"><span class="annot"><span class="annottext">pegasusDataType :: SDataType PegasusDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDataType"><span class="hs-identifier hs-var hs-var">pegasusDataType</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI PegasusDataType =&gt; Sing PegasusDataType
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-comment">-- | Pegasus dropout rate.</span><span>
</span><span id="line-42"></span><span class="hs-comment">-- 'dropout_rate = 0.1'</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDropoutP"><span class="hs-identifier hs-type">pegasusDropoutP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-44"></span><span id="pegasusDropoutP"><span class="annot"><span class="annottext">pegasusDropoutP :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDropoutP"><span class="hs-identifier hs-var hs-var">pegasusDropoutP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-45"></span><span>
</span><span id="line-46"></span><span class="hs-comment">-- | Pegasus positional encoding dimension.</span><span>
</span><span id="line-47"></span><span class="hs-keyword">type</span><span> </span><span id="PegasusPosEncDim"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusPosEncDim"><span class="hs-identifier hs-var">PegasusPosEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-number">512</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Pegasus positional encoding dimension singleton.</span><span>
</span><span id="line-50"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPosEncDim"><span class="hs-identifier hs-type">pegasusPosEncDim</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusPosEncDim"><span class="hs-identifier hs-type">PegasusPosEncDim</span></a></span><span>
</span><span id="line-51"></span><span id="pegasusPosEncDim"><span class="annot"><span class="annottext">pegasusPosEncDim :: SDim PegasusPosEncDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPosEncDim"><span class="hs-identifier hs-var hs-var">pegasusPosEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SingI PegasusPosEncDim =&gt; Sing PegasusPosEncDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusPosEncDim"><span class="hs-identifier hs-type">PegasusPosEncDim</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">-- | Pegasus layer-norm epsilon.</span><span>
</span><span id="line-54"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusEps"><span class="hs-identifier hs-type">pegasusEps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-55"></span><span id="pegasusEps"><span class="annot"><span class="annottext">pegasusEps :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusEps"><span class="hs-identifier hs-var hs-var">pegasusEps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1e-5</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-comment">-- | Pegasus maximum number of position embeddings.</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- 'max_position_embeddings = 512'</span><span>
</span><span id="line-59"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusMaxPositionEmbeddings"><span class="hs-identifier hs-type">pegasusMaxPositionEmbeddings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-60"></span><span id="pegasusMaxPositionEmbeddings"><span class="annot"><span class="annottext">pegasusMaxPositionEmbeddings :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusMaxPositionEmbeddings"><span class="hs-identifier hs-var hs-var">pegasusMaxPositionEmbeddings</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">512</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-comment">-- | Pegasus padding token id.</span><span>
</span><span id="line-63"></span><span class="hs-comment">-- 'pad_token_id = 0'</span><span>
</span><span id="line-64"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPadTokenId"><span class="hs-identifier hs-type">pegasusPadTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-65"></span><span id="pegasusPadTokenId"><span class="annot"><span class="annottext">pegasusPadTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPadTokenId"><span class="hs-identifier hs-var hs-var">pegasusPadTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-comment">-- | Pegasus begin-of-sentence token id.</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- 'bos_token_id = 0'</span><span>
</span><span id="line-69"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusBOSTokenId"><span class="hs-identifier hs-type">pegasusBOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-70"></span><span id="pegasusBOSTokenId"><span class="annot"><span class="annottext">pegasusBOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusBOSTokenId"><span class="hs-identifier hs-var hs-var">pegasusBOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPadTokenId"><span class="hs-identifier hs-var">pegasusPadTokenId</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-comment">-- | Pegasus end-of-sentence token id.</span><span>
</span><span id="line-73"></span><span class="hs-comment">-- 'eos_token_id = 0'</span><span>
</span><span id="line-74"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusEOSTokenId"><span class="hs-identifier hs-type">pegasusEOSTokenId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-75"></span><span id="pegasusEOSTokenId"><span class="annot"><span class="annottext">pegasusEOSTokenId :: Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusEOSTokenId"><span class="hs-identifier hs-var hs-var">pegasusEOSTokenId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-76"></span><span>
</span><span id="line-77"></span><span class="hs-comment">-- | Pegasus attention mask bias</span><span>
</span><span id="line-78"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusAttentionMaskBias"><span class="hs-identifier hs-type">pegasusAttentionMaskBias</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-79"></span><span id="pegasusAttentionMaskBias"><span class="annot"><span class="annottext">pegasusAttentionMaskBias :: Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusAttentionMaskBias"><span class="hs-identifier hs-var hs-var">pegasusAttentionMaskBias</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">10000</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-comment">-- | Specifies the Pegasus model.</span><span>
</span><span id="line-82"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-83"></span><span>  </span><span id="PegasusModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusModelF"><span class="hs-identifier hs-var">PegasusModelF</span></a></span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660132"><span class="annot"><a href="#local-6989586621679660132"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660131"><span class="annot"><a href="#local-6989586621679660131"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660130"><span class="annot"><a href="#local-6989586621679660130"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660129"><span class="annot"><a href="#local-6989586621679660129"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660128"><span class="annot"><a href="#local-6989586621679660128"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660127"><span class="annot"><a href="#local-6989586621679660127"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660126"><span class="annot"><a href="#local-6989586621679660126"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660125"><span class="annot"><a href="#local-6989586621679660125"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660124"><span class="annot"><a href="#local-6989586621679660124"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679660123"><span class="annot"><a href="#local-6989586621679660123"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-96"></span><span>  </span><span id="PegasusModelF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusModelF"><span class="hs-identifier hs-var">PegasusModelF</span></a></span></span><span> </span><span id="local-6989586621679660122"><span class="annot"><a href="#local-6989586621679660122"><span class="hs-identifier hs-type hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679660121"><span class="annot"><a href="#local-6989586621679660121"><span class="hs-identifier hs-type hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679660120"><span class="annot"><a href="#local-6989586621679660120"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679660119"><span class="annot"><a href="#local-6989586621679660119"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679660118"><span class="annot"><a href="#local-6989586621679660118"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679660117"><span class="annot"><a href="#local-6989586621679660117"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679660116"><span class="annot"><a href="#local-6989586621679660116"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679660115"><span class="annot"><a href="#local-6989586621679660115"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679660114"><span class="annot"><a href="#local-6989586621679660114"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679660113"><span class="annot"><a href="#local-6989586621679660113"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-97"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-98"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-99"></span><span>          </span><span class="annot"><a href="#local-6989586621679660115"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-type">EDTEncoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660121"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660120"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660119"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660118"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660117"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660116"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660115"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660114"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusPosEncDim"><span class="hs-identifier hs-type">PegasusPosEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-type">EDTDecoderF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660121"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660120"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660119"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660118"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660117"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660116"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660115"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660114"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusPosEncDim"><span class="hs-identifier hs-type">PegasusPosEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-type">EDTSharedEmbeddingF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660120"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660119"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660115"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660113"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-type">EDTHeadF</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#Pegasus"><span class="hs-identifier hs-type">Pegasus</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660122"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660120"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660119"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660115"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660113"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier hs-type">MkAbsPos</span></a></span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier hs-type">MkAbsPos</span></a></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-type">MkTransformerPaddingMask</span></a></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-type">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-type">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-type">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusDataType"><span class="hs-identifier hs-type">PegasusDataType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- | Specifies the parameters of a Pegasus model.</span><span>
</span><span id="line-113"></span><span class="hs-comment">--</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- - @transformerHead@: the head of the Pegasus model.</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- - @numLayers@: the number of layers in the Pegasus model.</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the Pegasus model.</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- - @device@: the computational device on which the Pegasus model parameters are to be allocated.</span><span>
</span><span id="line-118"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusModelSpec"><span class="hs-identifier hs-type">pegasusModelSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679660111"><span class="annot"><a href="#local-6989586621679660111"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679660110"><span class="annot"><a href="#local-6989586621679660110"><span class="hs-identifier hs-type">numLayers</span></a></span></span><span> </span><span id="local-6989586621679660109"><span class="annot"><a href="#local-6989586621679660109"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679660108"><span class="annot"><a href="#local-6989586621679660108"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679660107"><span class="annot"><a href="#local-6989586621679660107"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679660106"><span class="annot"><a href="#local-6989586621679660106"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679660105"><span class="annot"><a href="#local-6989586621679660105"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679660104"><span class="annot"><a href="#local-6989586621679660104"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679660103"><span class="annot"><a href="#local-6989586621679660103"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679660102"><span class="annot"><a href="#local-6989586621679660102"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660107"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660106"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660105"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660104"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660103"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SingI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660102"><span class="hs-identifier hs-type">vocabDim</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-127"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660111"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660110"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-129"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660109"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-130"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660108"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#PegasusModelF"><span class="hs-identifier hs-type">PegasusModelF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660111"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660110"><span class="hs-identifier hs-type">numLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660109"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660108"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660107"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660106"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660105"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660104"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660103"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660102"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span id="pegasusModelSpec"><span class="annot"><span class="annottext">pegasusModelSpec :: STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; ModelSpec
     (PegasusModelF
        transformerHead
        numLayers
        gradient
        device
        headDim
        headEmbedDim
        embedDim
        inputEmbedDim
        ffnDim
        vocabDim)
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusModelSpec"><span class="hs-identifier hs-var hs-var">pegasusModelSpec</span></a></span></span><span> </span><span id="local-6989586621679660101"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679660101"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679660100"><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679660100"><span class="hs-identifier hs-var">numLayers</span></a></span></span><span> </span><span id="local-6989586621679660099"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679660099"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679660098"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679660098"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim
  (NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              PegasusDataType
              PegasusPosEncDim
              inputEmbedDim
              'Nothing))
        ()
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                PegasusDataType
                                ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                PegasusDataType
                                ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[ffnDim])))))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithBias
              gradient
              device
              PegasusDataType
              ('Shape '[inputEmbedDim])))
        ()))
  (NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              PegasusDataType
              PegasusPosEncDim
              inputEmbedDim
              'Nothing))
        ()
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                PegasusDataType
                                ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                PegasusDataType
                                ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                PegasusDataType
                                ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[ffnDim])))))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithBias
              gradient
              device
              PegasusDataType
              ('Shape '[inputEmbedDim])))
        ()))
  (NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        PegasusDataType
        vocabDim
        inputEmbedDim
        'Nothing))
  (ModelSpec
     (EDTHeadF
        'Pegasus
        transformerHead
        gradient
        device
        PegasusDataType
        inputEmbedDim
        vocabDim))
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; MkAbsPos
-&gt; MkAbsPos
-&gt; MkTransformerPaddingMask
-&gt; MkTransformerAttentionMask PegasusDataType
-&gt; MkTransformerCrossAttentionMask PegasusDataType
-&gt; MkTransformerDecoderAttentionMask PegasusDataType
-&gt; GSimplifiedEncoderDecoderTransformer
     (GEncoderDecoderTransformer
        inputEmbedDim
        (NamedModel
           (GTransformer
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    PegasusDataType
                    PegasusPosEncDim
                    inputEmbedDim
                    'Nothing))
              ()
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                ()))
                          ()
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[ffnDim])))))
                                Relu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithBias
                    gradient
                    device
                    PegasusDataType
                    ('Shape '[inputEmbedDim])))
              ()))
        (NamedModel
           (GTransformer
              (NamedModel
                 (EmbeddingSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    PegasusDataType
                    PegasusPosEncDim
                    inputEmbedDim
                    'Nothing))
              ()
              ()
              Dropout
              (NamedModel
                 (GTransformerStack
                    (VectorSpec
                       numLayers
                       (GTransformerBlock
                          (NamedModel
                             (GSelfAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GCrossAttention
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GMultiHeadAttention
                                      headDim
                                      headEmbedDim
                                      embedDim
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim, inputEmbedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[embedDim])))))
                                      (NamedModel
                                         (GLinear
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[inputEmbedDim, embedDim])))
                                            (NamedModel
                                               (Tensor
                                                  gradient
                                                  ('Layout 'Dense)
                                                  device
                                                  PegasusDataType
                                                  ('Shape '[inputEmbedDim])))))
                                      Dropout))
                                Dropout
                                ()))
                          (NamedModel
                             (GTransformerFeedForwardNetwork
                                (NamedModel
                                   (LayerNorm
                                      'WithBias
                                      gradient
                                      device
                                      PegasusDataType
                                      ('Shape '[inputEmbedDim])))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[ffnDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[ffnDim])))))
                                Relu
                                Dropout
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim, ffnDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            PegasusDataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout
                                ()))))))
              (NamedModel
                 (LayerNormSpec
                    'WithBias
                    gradient
                    device
                    PegasusDataType
                    ('Shape '[inputEmbedDim])))
              ()))
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              PegasusDataType
              vocabDim
              inputEmbedDim
              'Nothing))
        (ModelSpec
           (EDTHeadF
              'Pegasus
              transformerHead
              gradient
              device
              PegasusDataType
              inputEmbedDim
              vocabDim)))
     MkAbsPos
     MkAbsPos
     MkTransformerPaddingMask
     (MkTransformerAttentionMask PegasusDataType)
     (MkTransformerCrossAttentionMask PegasusDataType)
     (MkTransformerDecoderAttentionMask PegasusDataType)
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; STransformerHead transformerHead
-&gt; SNat numLayers
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType PegasusDataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim PegasusPosEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           'Pegasus
           numLayers
           gradient
           device
           PegasusDataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           PegasusPosEncDim)
        (EDTDecoderF
           'Pegasus
           numLayers
           gradient
           device
           PegasusDataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           PegasusPosEncDim)
        (EDTSharedEmbeddingF
           'Pegasus gradient device PegasusDataType inputEmbedDim vocabDim)
        (EDTHeadF
           'Pegasus
           transformerHead
           gradient
           device
           PegasusDataType
           inputEmbedDim
           vocabDim))
forall (style :: TransformerStyle)
       (transformerHead :: TransformerHead) (numEncoderLayers :: Nat)
       (numDecoderLayers :: Nat) (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           style
           numEncoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTDecoderF
           style
           numDecoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTSharedEmbeddingF
           style gradient device dataType inputEmbedDim vocabDim)
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var">encoderDecoderTransformerSpec</span></a></span><span>
</span><span id="line-135"></span><span>        </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679660101"><span class="hs-identifier hs-var">transformerHead</span></a></span><span>
</span><span id="line-137"></span><span>        </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679660100"><span class="hs-identifier hs-var">numLayers</span></a></span><span>
</span><span id="line-138"></span><span>        </span><span class="annot"><span class="annottext">SNat numLayers
</span><a href="#local-6989586621679660100"><span class="hs-identifier hs-var">numLayers</span></a></span><span>
</span><span id="line-139"></span><span>        </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679660099"><span class="hs-identifier hs-var">gradient</span></a></span><span>
</span><span id="line-140"></span><span>        </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679660098"><span class="hs-identifier hs-var">device</span></a></span><span>
</span><span id="line-141"></span><span>        </span><span class="annot"><span class="annottext">SDataType PegasusDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDataType"><span class="hs-identifier hs-var">pegasusDataType</span></a></span><span>
</span><span id="line-142"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headDim =&gt; Sing headDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679660107"><span class="hs-identifier hs-type">headDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI headEmbedDim =&gt; Sing headEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679660106"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI embedDim =&gt; Sing embedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679660105"><span class="hs-identifier hs-type">embedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI inputEmbedDim =&gt; Sing inputEmbedDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679660104"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI ffnDim =&gt; Sing ffnDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679660103"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>        </span><span class="annot"><span class="annottext">SDim PegasusPosEncDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPosEncDim"><span class="hs-identifier hs-var">pegasusPosEncDim</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SingI vocabDim =&gt; Sing vocabDim
forall k (a :: k). SingI a =&gt; Sing a
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">sing</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679660102"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDropoutP"><span class="hs-identifier hs-var">pegasusDropoutP</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusEps"><span class="hs-identifier hs-var">pegasusEps</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusBOSTokenId"><span class="hs-identifier hs-var">pegasusBOSTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ShiftRight Int
forall fillValue. fillValue -&gt; ShiftRight fillValue
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-var">ShiftRight</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><span class="annottext">MkAbsPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier hs-var">MkAbsPos</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">MkAbsPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkAbsPos"><span class="hs-identifier hs-var">MkAbsPos</span></a></span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; MkTransformerPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerPaddingMask"><span class="hs-identifier hs-var">MkTransformerPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPadTokenId"><span class="hs-identifier hs-var">pegasusPadTokenId</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType PegasusDataType
-&gt; Double -&gt; MkTransformerAttentionMask PegasusDataType
forall (dataType :: DataType DType).
SDataType dataType -&gt; Double -&gt; MkTransformerAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerAttentionMask"><span class="hs-identifier hs-var">MkTransformerAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType PegasusDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDataType"><span class="hs-identifier hs-var">pegasusDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusAttentionMaskBias"><span class="hs-identifier hs-var">pegasusAttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType PegasusDataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask PegasusDataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerCrossAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerCrossAttentionMask"><span class="hs-identifier hs-var">MkTransformerCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType PegasusDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDataType"><span class="hs-identifier hs-var">pegasusDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusAttentionMaskBias"><span class="hs-identifier hs-var">pegasusAttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SDataType PegasusDataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask PegasusDataType
forall (dataType :: DataType DType).
SDataType dataType
-&gt; Double -&gt; MkTransformerDecoderAttentionMask dataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#MkTransformerDecoderAttentionMask"><span class="hs-identifier hs-var">MkTransformerDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType PegasusDataType
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusDataType"><span class="hs-identifier hs-var">pegasusDataType</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusAttentionMaskBias"><span class="hs-identifier hs-var">pegasusAttentionMaskBias</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#mkPegasusInput"><span class="hs-identifier hs-type">mkPegasusInput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-162"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679660089"><span class="annot"><a href="#local-6989586621679660089"><span class="hs-identifier hs-type">batchDim</span></a></span></span><span> </span><span id="local-6989586621679660088"><span class="annot"><a href="#local-6989586621679660088"><span class="hs-identifier hs-type">seqDim</span></a></span></span><span> </span><span id="local-6989586621679660087"><span class="annot"><a href="#local-6989586621679660087"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679660086"><span class="annot"><a href="#local-6989586621679660086"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679660085"><span class="annot"><a href="#local-6989586621679660085"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="../file:///nix/store/ifacyhfpnb9wrd20q18ymi87z39k1h67-exceptions-lib-exceptions-0.10.4-haddock-doc/share/doc/exceptions/html/src"><span class="hs-identifier hs-type">MonadThrow</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660086"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660089"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#SGetDim"><span class="hs-identifier hs-type">SGetDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660088"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#Catch"><span class="hs-identifier hs-type">Catch</span></a></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">'</span><span class="hs-special">[</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>             </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-string">&quot;*&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#UncheckedSize"><span class="hs-identifier hs-type">UncheckedSize</span></a></span><span>
</span><span id="line-170"></span><span>           </span><span class="hs-special">]</span><span>
</span><span id="line-171"></span><span>          </span><span class="annot"><a href="Torch.GraduallyTyped.Unify.html#%3C%2B%3E"><span class="hs-operator hs-type">&lt;+&gt;</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679660089"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679660088"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="#local-6989586621679660085"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span>
</span><span id="line-175"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#WithoutGradient"><span class="hs-identifier hs-type">WithoutGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>          </span><span class="annot"><a href="#local-6989586621679660087"><span class="hs-identifier hs-type">device</span></a></span><span>
</span><span id="line-178"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-179"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Shape"><span class="hs-identifier hs-type">Shape</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679660089"><span class="hs-identifier hs-type">batchDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679660088"><span class="hs-identifier hs-type">seqDim</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-181"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660089"><span class="hs-identifier hs-type">batchDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660088"><span class="hs-identifier hs-type">seqDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660087"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-185"></span><span>  </span><span class="annot"><a href="#local-6989586621679660086"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679660085"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-186"></span><span id="mkPegasusInput"><span class="annot"><span class="annottext">mkPegasusInput :: SDim batchDim
-&gt; SDim seqDim -&gt; SDevice device -&gt; [[Int]] -&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#mkPegasusInput"><span class="hs-identifier hs-var hs-var">mkPegasusInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
forall (batchDim :: Dim (Name Symbol) (Size Nat))
       (seqDim :: Dim (Name Symbol) (Size Nat))
       (device :: Device (DeviceType Nat)) (m :: * -&gt; *) output.
(MonadThrow m, SGetDim batchDim, SGetDim seqDim,
 Catch
   ('Shape
      '[ 'Dim ('Name &quot;*&quot;) 'UncheckedSize,
         'Dim ('Name &quot;*&quot;) 'UncheckedSize]
    &lt;+&gt; 'Shape '[batchDim, seqDim]),
 output
 ~ Tensor
     ('Gradient 'WithoutGradient)
     ('Layout 'Dense)
     device
     ('DataType 'Int64)
     ('Shape '[batchDim, seqDim])) =&gt;
Int
-&gt; SDim batchDim
-&gt; SDim seqDim
-&gt; SDevice device
-&gt; [[Int]]
-&gt; m output
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#mkTransformerInput"><span class="hs-identifier hs-var">mkTransformerInput</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.Pegasus.Common.html#pegasusPadTokenId"><span class="hs-identifier hs-var">pegasusPadTokenId</span></a></span><span>
</span><span id="line-187"></span></pre></body></html>