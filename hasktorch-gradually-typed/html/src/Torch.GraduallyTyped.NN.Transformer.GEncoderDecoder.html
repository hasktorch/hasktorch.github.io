<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-partial-type-signatures #-}</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Control.Monad.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">ireturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&gt;&gt;&gt;=)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">Control.Monad.Indexed.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier">IxStateT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier">Data.Functor.Indexed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;$&gt;&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator">(&lt;&lt;*&gt;&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SingKind</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">fromSing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.Prelude.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNothing</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">Data.Singletons.TypeLits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier">SNat</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeLits</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Nat</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Symbol</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html"><span class="hs-identifier">Torch.GraduallyTyped.DType</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier">DType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier">DataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier">SDataType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html"><span class="hs-identifier">Torch.GraduallyTyped.Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier">DeviceType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier">SDevice</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html"><span class="hs-identifier">Torch.GraduallyTyped.Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier">Layout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#LayoutType"><span class="hs-identifier">LayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier">SLayout</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#SLayoutType"><span class="hs-identifier">SLayoutType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Class</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier">HasForward</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier">HasInitialize</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier">ModelSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Sparse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier">Embedding</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier">EmbeddingSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GLMHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#GLMHead"><span class="hs-identifier">GLMHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadActivationF"><span class="hs-identifier">LMHeadActivationF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadBiasF"><span class="hs-identifier">LMHeadBiasF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadDecoderF"><span class="hs-identifier">LMHeadDecoderF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadDenseF"><span class="hs-identifier">LMHeadDenseF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadLayerNormF"><span class="hs-identifier">LMHeadLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#lmHeadSpec"><span class="hs-identifier">lmHeadSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.GTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier">GTransformer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier">TDFinalDropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier">TDFinalLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier">TDInitialDropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier">TDInitialLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier">TDPosEncF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier">TDRelPosEncF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier">TDStackF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier">TEFinalDropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier">TEFinalLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier">TEInitialDropoutF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier">TEInitialLayerNormF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier">TEPosEncF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier">TERelPosEncF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier">TEStackF</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier">transformerDecoderSpec</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier">transformerEncoderSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.NN.Transformer.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier">STransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier">STransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier">ShiftRight</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier">TransformerHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithLMHead"><span class="hs-identifier">WithLMHead</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithoutHead"><span class="hs-identifier">WithoutHead</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier">TransformerStyle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html"><span class="hs-identifier">Torch.GraduallyTyped.Prelude</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier">forgetIsChecked</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html"><span class="hs-identifier">Torch.GraduallyTyped.RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier">Gradient</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier">RequiresGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier">SGradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Shape.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier">Name</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier">SDim</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier">Size</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.MathOperations.Pointwise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier">mulScalar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html"><span class="hs-identifier">Torch.GraduallyTyped.Tensor.Type</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier">Tensor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">head</span></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span class="hs-comment">-- | Data type that is used to represent whether the encoder-decoder transformer model has a scaled embedding.</span><span>
</span><span id="line-41"></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerHasEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerHasEmbedScaling</span></a></span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="EncoderDecoderTransformerWithEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="EncoderDecoderTransformerWithoutEmbedScaling"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-comment">-- | Generic encoder-decoder transformer model.</span><span>
</span><span id="line-46"></span><span class="hs-comment">-- This is a model that can be used to encode and decode sequences of variable length.</span><span>
</span><span id="line-47"></span><span class="hs-comment">--</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- - @inputEmbedDim@: the dimension of the input embedding.</span><span>
</span><span id="line-49"></span><span class="hs-comment">-- - @encoder@: a transformer encoder.</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- - @decoder@: a transformer decoder.</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- - @sharedEmbedding@: a shared embedding layer.</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- - @head@: a head layer for the output.</span><span>
</span><span id="line-53"></span><span class="hs-keyword">data</span><span>
</span><span id="line-54"></span><span>  </span><span id="GEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span></span><span>
</span><span id="line-55"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557739"><span class="annot"><a href="#local-6989586621679557739"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557738"><span class="annot"><a href="#local-6989586621679557738"><span class="hs-identifier hs-type">encoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557737"><span class="annot"><a href="#local-6989586621679557737"><span class="hs-identifier hs-type">decoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557736"><span class="annot"><a href="#local-6989586621679557736"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557735"><span class="annot"><a href="#local-6989586621679557735"><span class="hs-identifier hs-type">head</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>  </span><span id="GEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679558259"><span class="annot"><a href="#local-6989586621679558259"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679558258"><span class="annot"><a href="#local-6989586621679558258"><span class="hs-identifier hs-type">encoder</span></a></span></span><span> </span><span id="local-6989586621679558257"><span class="annot"><a href="#local-6989586621679558257"><span class="hs-identifier hs-type">decoder</span></a></span></span><span> </span><span id="local-6989586621679558256"><span class="annot"><a href="#local-6989586621679558256"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span></span><span> </span><span id="local-6989586621679558255"><span class="annot"><a href="#local-6989586621679558255"><span class="hs-identifier hs-type">head</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | input embedding dim for scaling</span><span>
</span><span id="line-64"></span><span>      </span><span id="edtInputEmbedDim"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtInputEmbedDim"><span class="hs-identifier hs-var hs-var">edtInputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558259"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-65"></span><span>      </span><span class="hs-comment">-- | encoder</span><span>
</span><span id="line-66"></span><span>      </span><span id="edtEncoder"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; encoder
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtEncoder"><span class="hs-identifier hs-var hs-var">edtEncoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558258"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>      </span><span class="hs-comment">-- | decoder</span><span>
</span><span id="line-68"></span><span>      </span><span id="edtDecoder"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; decoder
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoder"><span class="hs-identifier hs-var hs-var">edtDecoder</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558257"><span class="hs-identifier hs-type">decoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>      </span><span class="hs-comment">-- | embedding shared between encoder and decoder</span><span>
</span><span id="line-70"></span><span>      </span><span id="edtSharedEmbedding"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; sharedEmbedding
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtSharedEmbedding"><span class="hs-identifier hs-var hs-var">edtSharedEmbedding</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558256"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>      </span><span class="hs-comment">-- | transformer head</span><span>
</span><span id="line-72"></span><span>      </span><span id="edtHead"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtHead"><span class="hs-identifier hs-var hs-var">edtHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558255"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>      </span><span class="hs-comment">-- | embedding scaling</span><span>
</span><span id="line-74"></span><span>      </span><span id="edtEmbedScaling"><span class="annot"><span class="annottext">GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtEmbedScaling"><span class="hs-identifier hs-var hs-var">edtEmbedScaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558259"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558258"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558257"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558256"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558255"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-79"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span id="local-6989586621679557727"><span class="annot"><a href="#local-6989586621679557727"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557726"><span class="annot"><a href="#local-6989586621679557726"><span class="hs-identifier hs-type hs-type">encoder</span></a></span></span><span> </span><span id="local-6989586621679557725"><span class="annot"><a href="#local-6989586621679557725"><span class="hs-identifier hs-type hs-type">decoder</span></a></span></span><span> </span><span id="local-6989586621679557724"><span class="annot"><a href="#local-6989586621679557724"><span class="hs-identifier hs-type hs-type">sharedEmbedding</span></a></span></span><span> </span><span id="local-6989586621679557723"><span class="annot"><a href="#local-6989586621679557723"><span class="hs-identifier hs-type hs-type">head</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557727"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557726"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557725"><span class="hs-identifier hs-type">decoder</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557724"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557723"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Specifies the encoder of the encoder-decoder transformer model.</span><span>
</span><span id="line-83"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-84"></span><span>  </span><span id="EDTEncoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-var">EDTEncoderF</span></a></span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557722"><span class="annot"><a href="#local-6989586621679557722"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557721"><span class="annot"><a href="#local-6989586621679557721"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557720"><span class="annot"><a href="#local-6989586621679557720"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557719"><span class="annot"><a href="#local-6989586621679557719"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557718"><span class="annot"><a href="#local-6989586621679557718"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557717"><span class="annot"><a href="#local-6989586621679557717"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557716"><span class="annot"><a href="#local-6989586621679557716"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557715"><span class="annot"><a href="#local-6989586621679557715"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557714"><span class="annot"><a href="#local-6989586621679557714"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557713"><span class="annot"><a href="#local-6989586621679557713"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557712"><span class="annot"><a href="#local-6989586621679557712"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="EDTEncoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-var">EDTEncoderF</span></a></span></span><span> </span><span id="local-6989586621679557711"><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679557710"><span class="annot"><a href="#local-6989586621679557710"><span class="hs-identifier hs-type hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679557709"><span class="annot"><a href="#local-6989586621679557709"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679557708"><span class="annot"><a href="#local-6989586621679557708"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679557707"><span class="annot"><a href="#local-6989586621679557707"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679557706"><span class="annot"><a href="#local-6989586621679557706"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679557705"><span class="annot"><a href="#local-6989586621679557705"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557704"><span class="annot"><a href="#local-6989586621679557704"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679557703"><span class="annot"><a href="#local-6989586621679557703"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557702"><span class="annot"><a href="#local-6989586621679557702"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679557701"><span class="annot"><a href="#local-6989586621679557701"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span>
</span><span id="line-100"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEPosEncF"><span class="hs-identifier hs-type">TEPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557709"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557708"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557707"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557703"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557701"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TERelPosEncF"><span class="hs-identifier hs-type">TERelPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557709"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557708"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557707"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557706"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557701"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-102"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialLayerNormF"><span class="hs-identifier hs-type">TEInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557709"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557708"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557707"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557703"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEInitialDropoutF"><span class="hs-identifier hs-type">TEInitialDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEStackF"><span class="hs-identifier hs-type">TEStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557710"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557709"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557708"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557707"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557706"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557705"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557704"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557703"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557702"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalLayerNormF"><span class="hs-identifier hs-type">TEFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557709"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557708"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557707"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557703"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TEFinalDropoutF"><span class="hs-identifier hs-type">TEFinalDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557711"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="hs-comment">-- | Specifies the decoder of the encoder-decoder transformer model.</span><span>
</span><span id="line-110"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-111"></span><span>  </span><span id="EDTDecoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-var">EDTDecoderF</span></a></span></span><span>
</span><span id="line-112"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557700"><span class="annot"><a href="#local-6989586621679557700"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557699"><span class="annot"><a href="#local-6989586621679557699"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557698"><span class="annot"><a href="#local-6989586621679557698"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557697"><span class="annot"><a href="#local-6989586621679557697"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557696"><span class="annot"><a href="#local-6989586621679557696"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557695"><span class="annot"><a href="#local-6989586621679557695"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557694"><span class="annot"><a href="#local-6989586621679557694"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557693"><span class="annot"><a href="#local-6989586621679557693"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557692"><span class="annot"><a href="#local-6989586621679557692"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-121"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557691"><span class="annot"><a href="#local-6989586621679557691"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557690"><span class="annot"><a href="#local-6989586621679557690"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-124"></span><span>  </span><span id="EDTDecoderF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-var">EDTDecoderF</span></a></span></span><span> </span><span id="local-6989586621679557689"><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679557688"><span class="annot"><a href="#local-6989586621679557688"><span class="hs-identifier hs-type hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679557687"><span class="annot"><a href="#local-6989586621679557687"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679557686"><span class="annot"><a href="#local-6989586621679557686"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679557685"><span class="annot"><a href="#local-6989586621679557685"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679557684"><span class="annot"><a href="#local-6989586621679557684"><span class="hs-identifier hs-type hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679557683"><span class="annot"><a href="#local-6989586621679557683"><span class="hs-identifier hs-type hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557682"><span class="annot"><a href="#local-6989586621679557682"><span class="hs-identifier hs-type hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679557681"><span class="annot"><a href="#local-6989586621679557681"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557680"><span class="annot"><a href="#local-6989586621679557680"><span class="hs-identifier hs-type hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679557679"><span class="annot"><a href="#local-6989586621679557679"><span class="hs-identifier hs-type hs-type">posEncDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#GTransformer"><span class="hs-identifier hs-type">GTransformer</span></a></span><span>
</span><span id="line-127"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDPosEncF"><span class="hs-identifier hs-type">TDPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557687"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557686"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557685"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557681"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557679"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDRelPosEncF"><span class="hs-identifier hs-type">TDRelPosEncF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557687"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557686"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557685"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557684"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557679"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialLayerNormF"><span class="hs-identifier hs-type">TDInitialLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557687"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557686"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557685"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557681"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDInitialDropoutF"><span class="hs-identifier hs-type">TDInitialDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDStackF"><span class="hs-identifier hs-type">TDStackF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557688"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557687"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557686"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557685"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557684"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557683"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557682"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557681"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557681"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557680"><span class="hs-identifier hs-type">ffnDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalLayerNormF"><span class="hs-identifier hs-type">TDFinalLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557687"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557686"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557685"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557681"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#TDFinalDropoutF"><span class="hs-identifier hs-type">TDFinalDropoutF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557689"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="hs-comment">-- | Specifies the shared embedding layer of the encoder-decoder transformer model.</span><span>
</span><span id="line-137"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-138"></span><span>  </span><span id="EDTSharedEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-var">EDTSharedEmbeddingF</span></a></span></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557678"><span class="annot"><a href="#local-6989586621679557678"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557677"><span class="annot"><a href="#local-6989586621679557677"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557676"><span class="annot"><a href="#local-6989586621679557676"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557675"><span class="annot"><a href="#local-6989586621679557675"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557674"><span class="annot"><a href="#local-6989586621679557674"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557673"><span class="annot"><a href="#local-6989586621679557673"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-146"></span><span>  </span><span id="EDTSharedEmbeddingF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-var">EDTSharedEmbeddingF</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679557672"><span class="annot"><a href="#local-6989586621679557672"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679557671"><span class="annot"><a href="#local-6989586621679557671"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679557670"><span class="annot"><a href="#local-6989586621679557670"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679557669"><span class="annot"><a href="#local-6989586621679557669"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557668"><span class="annot"><a href="#local-6989586621679557668"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-147"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Sparse.html#Embedding"><span class="hs-identifier hs-type">Embedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557672"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Layout"><span class="hs-identifier hs-type">Layout</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.Layout.html#Dense"><span class="hs-identifier hs-type">Dense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679557671"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557670"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557668"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557669"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Specifies the head of the encoder-decoder transformer model.</span><span>
</span><span id="line-150"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span>
</span><span id="line-151"></span><span>  </span><span id="EDTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-var">EDTHeadF</span></a></span></span><span>
</span><span id="line-152"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557667"><span class="annot"><a href="#local-6989586621679557667"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerStyle"><span class="hs-identifier hs-type">TransformerStyle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557666"><span class="annot"><a href="#local-6989586621679557666"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#TransformerHead"><span class="hs-identifier hs-type">TransformerHead</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557665"><span class="annot"><a href="#local-6989586621679557665"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#Gradient"><span class="hs-identifier hs-type">Gradient</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#RequiresGradient"><span class="hs-identifier hs-type">RequiresGradient</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557664"><span class="annot"><a href="#local-6989586621679557664"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#Device"><span class="hs-identifier hs-type">Device</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#DeviceType"><span class="hs-identifier hs-type">DeviceType</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-156"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557663"><span class="annot"><a href="#local-6989586621679557663"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DataType"><span class="hs-identifier hs-type">DataType</span></a></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#DType"><span class="hs-identifier hs-type">DType</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557662"><span class="annot"><a href="#local-6989586621679557662"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557661"><span class="annot"><a href="#local-6989586621679557661"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Dim"><span class="hs-identifier hs-type">Dim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Name"><span class="hs-identifier hs-type">Name</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Symbol</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#Size"><span class="hs-identifier hs-type">Size</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span id="EDTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-var">EDTHeadF</span></a></span></span><span> </span><span id="local-6989586621679557660"><span class="annot"><a href="#local-6989586621679557660"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithoutHead"><span class="hs-identifier hs-type">WithoutHead</span></a></span><span> </span><span id="local-6989586621679557659"><span class="annot"><a href="#local-6989586621679557659"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679557658"><span class="annot"><a href="#local-6989586621679557658"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679557657"><span class="annot"><a href="#local-6989586621679557657"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679557656"><span class="annot"><a href="#local-6989586621679557656"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557655"><span class="annot"><a href="#local-6989586621679557655"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span id="EDTHeadF"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-var">EDTHeadF</span></a></span></span><span> </span><span id="local-6989586621679557654"><span class="annot"><a href="#local-6989586621679557654"><span class="hs-identifier hs-type hs-type">style</span></a></span></span><span> </span><span class="hs-special">'</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#WithLMHead"><span class="hs-identifier hs-type">WithLMHead</span></a></span><span> </span><span id="local-6989586621679557653"><span class="annot"><a href="#local-6989586621679557653"><span class="hs-identifier hs-type hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679557652"><span class="annot"><a href="#local-6989586621679557652"><span class="hs-identifier hs-type hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679557651"><span class="annot"><a href="#local-6989586621679557651"><span class="hs-identifier hs-type hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679557650"><span class="annot"><a href="#local-6989586621679557650"><span class="hs-identifier hs-type hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557649"><span class="annot"><a href="#local-6989586621679557649"><span class="hs-identifier hs-type hs-type">vocabDim</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-164"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-type">NamedModel</span></a></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#GLMHead"><span class="hs-identifier hs-type">GLMHead</span></a></span><span>
</span><span id="line-166"></span><span>          </span><span class="annot"><a href="#local-6989586621679557650"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-167"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadDenseF"><span class="hs-identifier hs-type">LMHeadDenseF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557654"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557653"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557652"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557651"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557650"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadActivationF"><span class="hs-identifier hs-type">LMHeadActivationF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557654"><span class="hs-identifier hs-type">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadLayerNormF"><span class="hs-identifier hs-type">LMHeadLayerNormF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557654"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557653"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557652"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557651"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557650"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadDecoderF"><span class="hs-identifier hs-type">LMHeadDecoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557654"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557653"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557652"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557651"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557650"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557649"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#LMHeadBiasF"><span class="hs-identifier hs-type">LMHeadBiasF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557654"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557653"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557652"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557651"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557649"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- | Specifies the parameters of an encoder-decoder transformer model.</span><span>
</span><span id="line-175"></span><span class="hs-comment">--</span><span>
</span><span id="line-176"></span><span class="hs-comment">-- - @style@: the style of the encoder-decoder transformer model, e.g. 'ST5', 'SBART', etc.</span><span>
</span><span id="line-177"></span><span class="hs-comment">-- - @transformerHead@: the head of the encoder-decoder transformer model.</span><span>
</span><span id="line-178"></span><span class="hs-comment">-- - @numEncoderLayers@: the number of encoder layers of the encoder-decoder transformer model.</span><span>
</span><span id="line-179"></span><span class="hs-comment">-- - @numDecoderLayers@: the number of decoder layers of the encoder-decoder transformer model.</span><span>
</span><span id="line-180"></span><span class="hs-comment">-- - @gradient@: whether to compute the gradient of the model parameters</span><span>
</span><span id="line-181"></span><span class="hs-comment">-- - @device@: the computational device on which the model is allocated.</span><span>
</span><span id="line-182"></span><span class="hs-comment">-- - @dataType@: the data type of the model parameters.</span><span>
</span><span id="line-183"></span><span class="hs-comment">-- - @headDim@: the dimension of all transformer heads in the encoder-decoder transformer model.</span><span>
</span><span id="line-184"></span><span class="hs-comment">-- - @headEmbedDim@: the dimension of the transformer head embeddings.</span><span>
</span><span id="line-185"></span><span class="hs-comment">-- - @embedDim@: the dimension of the transformer embeddings.</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- - @inputEmbedDim@: the dimension of the input embeddings for both the encoder and the decoder.</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- - @ffnDim@: the dimension of the feed-forward network.</span><span>
</span><span id="line-188"></span><span class="hs-comment">-- - @posEncDim@: the dimension of the positional embeddings.</span><span>
</span><span id="line-189"></span><span class="hs-comment">-- - @vocabDim@: the dimension of the vocabulary.</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- - @typeVocabDim@: the dimension of the type vocabulary.</span><span>
</span><span id="line-191"></span><span class="hs-comment">-- - @dropoutP@: the dropout rate.</span><span>
</span><span id="line-192"></span><span class="hs-comment">-- - @eps@: the epsilon value for numerical stability of the layer normalization.</span><span>
</span><span id="line-193"></span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-type">encoderDecoderTransformerSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679557647"><span class="annot"><a href="#local-6989586621679557647"><span class="hs-identifier hs-type">style</span></a></span></span><span> </span><span id="local-6989586621679557646"><span class="annot"><a href="#local-6989586621679557646"><span class="hs-identifier hs-type">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679557645"><span class="annot"><a href="#local-6989586621679557645"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679557644"><span class="annot"><a href="#local-6989586621679557644"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679557643"><span class="annot"><a href="#local-6989586621679557643"><span class="hs-identifier hs-type">gradient</span></a></span></span><span> </span><span id="local-6989586621679557642"><span class="annot"><a href="#local-6989586621679557642"><span class="hs-identifier hs-type">device</span></a></span></span><span> </span><span id="local-6989586621679557641"><span class="annot"><a href="#local-6989586621679557641"><span class="hs-identifier hs-type">dataType</span></a></span></span><span> </span><span id="local-6989586621679557640"><span class="annot"><a href="#local-6989586621679557640"><span class="hs-identifier hs-type">headDim</span></a></span></span><span> </span><span id="local-6989586621679557639"><span class="annot"><a href="#local-6989586621679557639"><span class="hs-identifier hs-type">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557638"><span class="annot"><a href="#local-6989586621679557638"><span class="hs-identifier hs-type">embedDim</span></a></span></span><span> </span><span id="local-6989586621679557637"><span class="annot"><a href="#local-6989586621679557637"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557636"><span class="annot"><a href="#local-6989586621679557636"><span class="hs-identifier hs-type">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679557635"><span class="annot"><a href="#local-6989586621679557635"><span class="hs-identifier hs-type">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679557634"><span class="annot"><a href="#local-6989586621679557634"><span class="hs-identifier hs-type">vocabDim</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557647"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerHead"><span class="hs-identifier hs-type">STransformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557646"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-197"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557645"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-type">SNat</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557644"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.RequiresGradient.html#SGradient"><span class="hs-identifier hs-type">SGradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557643"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Device.html#SDevice"><span class="hs-identifier hs-type">SDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557642"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-201"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.DType.html#SDataType"><span class="hs-identifier hs-type">SDataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557641"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557640"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557639"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-204"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557638"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557637"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-206"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557636"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557635"><span class="hs-identifier hs-type">posEncDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.Shape.Type.html#SDim"><span class="hs-identifier hs-type">SDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557634"><span class="hs-identifier hs-type">vocabDim</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-213"></span><span>        </span><span class="annot"><a href="#local-6989586621679557637"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span>
</span><span id="line-214"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTEncoderF"><span class="hs-identifier hs-type">EDTEncoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557647"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557645"><span class="hs-identifier hs-type">numEncoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557643"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557642"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557641"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557640"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557639"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557638"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557637"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557636"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557635"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTDecoderF"><span class="hs-identifier hs-type">EDTDecoderF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557647"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557644"><span class="hs-identifier hs-type">numDecoderLayers</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557643"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557642"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557641"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557640"><span class="hs-identifier hs-type">headDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557639"><span class="hs-identifier hs-type">headEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557638"><span class="hs-identifier hs-type">embedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557637"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557636"><span class="hs-identifier hs-type">ffnDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557635"><span class="hs-identifier hs-type">posEncDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTSharedEmbeddingF"><span class="hs-identifier hs-type">EDTSharedEmbeddingF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557647"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557643"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557642"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557641"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557637"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557634"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EDTHeadF"><span class="hs-identifier hs-type">EDTHeadF</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557647"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557646"><span class="hs-identifier hs-type">transformerHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557643"><span class="hs-identifier hs-type">gradient</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557642"><span class="hs-identifier hs-type">device</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557641"><span class="hs-identifier hs-type">dataType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557637"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557634"><span class="hs-identifier hs-type">vocabDim</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-219"></span><span id="encoderDecoderTransformerSpec"><span class="annot"><span class="annottext">encoderDecoderTransformerSpec :: STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; SNat numEncoderLayers
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GEncoderDecoderTransformer
        inputEmbedDim
        (EDTEncoderF
           style
           numEncoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTDecoderF
           style
           numDecoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim
           posEncDim)
        (EDTSharedEmbeddingF
           style gradient device dataType inputEmbedDim vocabDim)
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#encoderDecoderTransformerSpec"><span class="hs-identifier hs-var hs-var">encoderDecoderTransformerSpec</span></a></span></span><span> </span><span id="local-6989586621679557633"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557633"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679557632"><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679557632"><span class="hs-identifier hs-var">transformerHead</span></a></span></span><span> </span><span id="local-6989586621679557631"><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679557631"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span></span><span> </span><span id="local-6989586621679557630"><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679557630"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span></span><span> </span><span id="local-6989586621679557629"><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679557629"><span class="hs-identifier hs-var">gradient</span></a></span></span><span> </span><span id="local-6989586621679557628"><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679557628"><span class="hs-identifier hs-var">device</span></a></span></span><span> </span><span id="local-6989586621679557627"><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679557627"><span class="hs-identifier hs-var">dataType</span></a></span></span><span> </span><span id="local-6989586621679557626"><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679557626"><span class="hs-identifier hs-var">headDim</span></a></span></span><span> </span><span id="local-6989586621679557625"><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679557625"><span class="hs-identifier hs-var">headEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557624"><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679557624"><span class="hs-identifier hs-var">embedDim</span></a></span></span><span> </span><span id="local-6989586621679557623"><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557623"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557622"><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679557622"><span class="hs-identifier hs-var">ffnDim</span></a></span></span><span> </span><span id="local-6989586621679557621"><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679557621"><span class="hs-identifier hs-var">posEncDim</span></a></span></span><span> </span><span id="local-6989586621679557620"><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679557620"><span class="hs-identifier hs-var">vocabDim</span></a></span></span><span> </span><span id="local-6989586621679557619"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557619"><span class="hs-identifier hs-var">dropoutP</span></a></span></span><span> </span><span id="local-6989586621679557618"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557618"><span class="hs-identifier hs-var">eps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557617"><span class="annot"><span class="annottext">encoderSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TERelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEInitialDropoutF style))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          Dropout
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEFinalDropoutF style)))
</span><a href="#local-6989586621679557617"><span class="hs-identifier hs-var hs-var">encoderSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   ()
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         headDim
         'Nothing))
   ()
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numEncoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel ())))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
 -&gt; NamedModel
      (GTransformer
         ()
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               headDim
               'Nothing))
         ()
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numEncoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel ())))
                                 Dropout))
                           Dropout
                           ()))
                     ()
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel ())))
                           Relu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel ())))
                           Dropout
                           ()))))))
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout))
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF 'T5 gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF 'T5 gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF 'T5 gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF 'T5))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'T5 gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'T5 gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'T5 gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'T5 gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'T5 gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'T5)
                       (FFNActivationDropoutF 'T5)
                       (FFNOutputProjectionF
                          'T5 gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'T5 gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF 'T5 gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF 'T5))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style))
</span><a href="#local-6989586621679557614"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-221"></span><span>      </span><span class="annot"><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (GGate
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          GeluNew
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ()))))
                       GeluNew
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   ()
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         headDim
         'Nothing))
   ()
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numEncoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (GGate
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ())))
                        GeluNew
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ()))))
                     GeluNew
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
 -&gt; NamedModel
      (GTransformer
         ()
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               headDim
               'Nothing))
         ()
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numEncoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel ())))
                                 Dropout))
                           Dropout
                           ()))
                     ()
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (GGate
                              (NamedModel
                                 (GLinear
                                    (NamedModel
                                       (Tensor
                                          gradient
                                          ('Layout 'Dense)
                                          device
                                          dataType
                                          ('Shape '[ffnDim, inputEmbedDim])))
                                    (NamedModel ())))
                              GeluNew
                              (NamedModel
                                 (GLinear
                                    (NamedModel
                                       (Tensor
                                          gradient
                                          ('Layout 'Dense)
                                          device
                                          dataType
                                          ('Shape '[ffnDim, inputEmbedDim])))
                                    (NamedModel ()))))
                           GeluNew
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel ())))
                           Dropout
                           ()))))))
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout))
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (GGate
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          GeluNew
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ()))))
                       GeluNew
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF 'ByT5 gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF 'ByT5 gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF 'ByT5 gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF 'ByT5))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'ByT5 gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'ByT5 gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'ByT5 gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'ByT5)
                       (FFNActivationDropoutF 'ByT5)
                       (FFNOutputProjectionF
                          'ByT5 gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'ByT5 gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF 'ByT5 gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF 'ByT5))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style))
</span><a href="#local-6989586621679557614"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-222"></span><span>      </span><span class="annot"><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         inputEmbedDim
         'Nothing))
   ()
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numEncoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
   ()
   ()
 -&gt; NamedModel
      (GTransformer
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               inputEmbedDim
               'Nothing))
         ()
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numEncoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           ()
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                     ()
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           ()
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim])))))
                           Gelu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias
                                 gradient
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))))))
         ()
         ()))
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF 'BART gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF 'BART gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF 'BART gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF 'BART))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'BART gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'BART gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'BART gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'BART gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'BART gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'BART)
                       (FFNActivationDropoutF 'BART)
                       (FFNOutputProjectionF
                          'BART gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'BART gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF 'BART gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF 'BART))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style))
</span><a href="#local-6989586621679557614"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-223"></span><span>      </span><span class="annot"><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         inputEmbedDim
         'Nothing))
   ()
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numEncoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
   ()
   ()
 -&gt; NamedModel
      (GTransformer
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               inputEmbedDim
               'Nothing))
         ()
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numEncoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           ()
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                     ()
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           ()
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim])))))
                           Gelu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias
                                 gradient
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))))))
         ()
         ()))
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF
           'MBART gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF 'MBART gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF
           'MBART gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF 'MBART))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'MBART gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'MBART gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'MBART gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'MBART gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'MBART gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'MBART)
                       (FFNActivationDropoutF 'MBART)
                       (FFNOutputProjectionF
                          'MBART gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'MBART gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF 'MBART gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF 'MBART))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style))
</span><a href="#local-6989586621679557614"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-224"></span><span>      </span><span class="annot"><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       ()))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.encoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         inputEmbedDim
         'Nothing))
   ()
   ()
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numEncoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     ()))
               ()
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     ()))))))
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
   ()
 -&gt; NamedModel
      (GTransformer
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               inputEmbedDim
               'Nothing))
         ()
         ()
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numEncoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           ()))
                     ()
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim])))))
                           Relu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout
                           ()))))))
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
         ()))
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       ()))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF
           'Pegasus gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF 'Pegasus gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF
           'Pegasus gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF 'Pegasus))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'Pegasus gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'Pegasus gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'Pegasus)
                       (FFNActivationDropoutF 'Pegasus)
                       (FFNOutputProjectionF
                          'Pegasus gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF
           'Pegasus gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF 'Pegasus))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style))
</span><a href="#local-6989586621679557614"><span class="hs-identifier hs-var">encoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="annot"><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-226"></span><span>      </span><span class="annot"><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-227"></span><span>      </span><span class="annot"><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-228"></span><span>      </span><span id="local-6989586621679557605"><span class="annot"><span class="annottext">decoderSpec :: STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TDRelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDInitialDropoutF style))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GCrossAttention
                          (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          Dropout
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDFinalDropoutF style)))
</span><a href="#local-6989586621679557605"><span class="hs-identifier hs-var hs-var">decoderSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GCrossAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   ()
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         headDim
         'Nothing))
   ()
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numDecoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel ())))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
 -&gt; NamedModel
      (GTransformer
         ()
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               headDim
               'Nothing))
         ()
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numDecoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel ())))
                                 Dropout))
                           Dropout
                           ()))
                     (NamedModel
                        (GCrossAttention
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel ())))
                                 Dropout))
                           Dropout
                           ()))
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel ())))
                           Relu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel ())))
                           Dropout
                           ()))))))
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout))
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GCrossAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel ())))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF 'T5 gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF 'T5 gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF 'T5 gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF 'T5))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'T5 gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'T5 gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'T5 gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF 'T5 gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'T5 gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'T5 gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF 'T5 gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'T5 gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'T5 gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'T5)
                       (FFNActivationDropoutF 'T5)
                       (FFNOutputProjectionF
                          'T5 gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'T5 gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF 'T5 gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF 'T5))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style))
</span><a href="#local-6989586621679557604"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-229"></span><span>      </span><span class="annot"><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GCrossAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (GGate
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          GeluNew
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ()))))
                       GeluNew
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   ()
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         headDim
         'Nothing))
   ()
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numDecoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel ())))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel ())))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (GGate
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ())))
                        GeluNew
                        (NamedModel
                           (GLinear
                              (NamedModel
                                 (Tensor
                                    gradient
                                    ('Layout 'Dense)
                                    device
                                    dataType
                                    ('Shape '[ffnDim, inputEmbedDim])))
                              (NamedModel ()))))
                     GeluNew
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel ())))
                     Dropout
                     ()))))))
   (NamedModel
      (LayerNormSpec
         'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
 -&gt; NamedModel
      (GTransformer
         ()
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               headDim
               'Nothing))
         ()
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numDecoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel ())))
                                 Dropout))
                           Dropout
                           ()))
                     (NamedModel
                        (GCrossAttention
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel ())))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel ())))
                                 Dropout))
                           Dropout
                           ()))
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           (NamedModel
                              (LayerNorm
                                 'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (GGate
                              (NamedModel
                                 (GLinear
                                    (NamedModel
                                       (Tensor
                                          gradient
                                          ('Layout 'Dense)
                                          device
                                          dataType
                                          ('Shape '[ffnDim, inputEmbedDim])))
                                    (NamedModel ())))
                              GeluNew
                              (NamedModel
                                 (GLinear
                                    (NamedModel
                                       (Tensor
                                          gradient
                                          ('Layout 'Dense)
                                          device
                                          dataType
                                          ('Shape '[ffnDim, inputEmbedDim])))
                                    (NamedModel ()))))
                           GeluNew
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel ())))
                           Dropout
                           ()))))))
         (NamedModel
            (LayerNormSpec
               'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout))
-&gt; GTransformer
     ()
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           headDim
           'Nothing))
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GCrossAttention
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel ())))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel ())))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (GGate
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ())))
                          GeluNew
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel ()))))
                       GeluNew
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel ())))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
-&gt; NamedModel
     (GTransformer
        ()
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              headDim
              'Nothing))
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel ())))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel ())))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (GGate
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ())))
                             GeluNew
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[ffnDim, inputEmbedDim])))
                                   (NamedModel ()))))
                          GeluNew
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel ())))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithoutBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF 'ByT5 gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF 'ByT5 gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF 'ByT5 gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF 'ByT5))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'ByT5 gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'ByT5 gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'ByT5 gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'ByT5 gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF 'ByT5 gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'ByT5 gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'ByT5 gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'ByT5)
                       (FFNActivationDropoutF 'ByT5)
                       (FFNOutputProjectionF
                          'ByT5 gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'ByT5 gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF 'ByT5 gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF 'ByT5))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style))
</span><a href="#local-6989586621679557604"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-230"></span><span>      </span><span class="annot"><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GCrossAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         inputEmbedDim
         'Nothing))
   ()
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numDecoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               (NamedModel
                  (GCrossAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
   ()
   ()
 -&gt; NamedModel
      (GTransformer
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               inputEmbedDim
               'Nothing))
         ()
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numDecoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           ()
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                     (NamedModel
                        (GCrossAttention
                           ()
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           ()
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim])))))
                           Gelu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias
                                 gradient
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))))))
         ()
         ()))
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GCrossAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF 'BART gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF 'BART gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF 'BART gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF 'BART))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'BART gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'BART gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'BART gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF 'BART gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'BART gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'BART gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF 'BART gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'BART gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'BART gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'BART)
                       (FFNActivationDropoutF 'BART)
                       (FFNOutputProjectionF
                          'BART gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'BART gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF 'BART gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF 'BART))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style))
</span><a href="#local-6989586621679557604"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-231"></span><span>      </span><span class="annot"><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GCrossAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         inputEmbedDim
         'Nothing))
   ()
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numDecoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               (NamedModel
                  (GCrossAttention
                     ()
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     ()
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Gelu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     (NamedModel
                        (LayerNorm
                           'WithBias
                           gradient
                           device
                           dataType
                           ('Shape '[inputEmbedDim])))))))))
   ()
   ()
 -&gt; NamedModel
      (GTransformer
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               inputEmbedDim
               'Nothing))
         ()
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numDecoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           ()
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                     (NamedModel
                        (GCrossAttention
                           ()
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           ()
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim])))))
                           Gelu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout
                           (NamedModel
                              (LayerNorm
                                 'WithBias
                                 gradient
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))))))
         ()
         ()))
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GCrossAttention
                       ()
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       ()
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Gelu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       (NamedModel
                          (LayerNorm
                             'WithBias
                             gradient
                             device
                             dataType
                             ('Shape '[inputEmbedDim])))))))))
     ()
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GCrossAttention
                          ()
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          ()
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Gelu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          (NamedModel
                             (LayerNorm
                                'WithBias
                                gradient
                                device
                                dataType
                                ('Shape '[inputEmbedDim])))))))))
        ()
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF
           'MBART gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF 'MBART gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF
           'MBART gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF 'MBART))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF 'MBART gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'MBART gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF 'MBART gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF 'MBART gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'MBART gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'MBART gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF 'MBART gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF 'MBART gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'MBART gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'MBART)
                       (FFNActivationDropoutF 'MBART)
                       (FFNOutputProjectionF
                          'MBART gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'MBART gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF 'MBART gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF 'MBART))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style))
</span><a href="#local-6989586621679557604"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-232"></span><span>      </span><span class="annot"><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GCrossAttention
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        ())
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.decoder.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GTransformer
   (NamedModel
      (EmbeddingSpec
         gradient
         ('Layout 'Dense)
         device
         dataType
         posEncDim
         inputEmbedDim
         'Nothing))
   ()
   ()
   Dropout
   (NamedModel
      (GTransformerStack
         (VectorSpec
            numDecoderLayers
            (GTransformerBlock
               (NamedModel
                  (GSelfAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GCrossAttention
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GMultiHeadAttention
                           headDim
                           headEmbedDim
                           embedDim
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[embedDim])))))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, embedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout))
                     Dropout
                     ()))
               (NamedModel
                  (GTransformerFeedForwardNetwork
                     (NamedModel
                        (LayerNorm
                           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[ffnDim, inputEmbedDim])))
                           (NamedModel
                              (Tensor
                                 gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                     Relu
                     Dropout
                     (NamedModel
                        (GLinear
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim, ffnDim])))
                           (NamedModel
                              (Tensor
                                 gradient
                                 ('Layout 'Dense)
                                 device
                                 dataType
                                 ('Shape '[inputEmbedDim])))))
                     Dropout
                     ()))))))
   (NamedModel
      (LayerNormSpec
         'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
   ()
 -&gt; NamedModel
      (GTransformer
         (NamedModel
            (EmbeddingSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               posEncDim
               inputEmbedDim
               'Nothing))
         ()
         ()
         Dropout
         (NamedModel
            (GTransformerStack
               (VectorSpec
                  numDecoderLayers
                  (GTransformerBlock
                     (NamedModel
                        (GSelfAttention
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           ()))
                     (NamedModel
                        (GCrossAttention
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GMultiHeadAttention
                                 headDim
                                 headEmbedDim
                                 embedDim
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim, inputEmbedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[embedDim])))))
                                 (NamedModel
                                    (GLinear
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim, embedDim])))
                                       (NamedModel
                                          (Tensor
                                             gradient
                                             ('Layout 'Dense)
                                             device
                                             dataType
                                             ('Shape '[inputEmbedDim])))))
                                 Dropout))
                           Dropout
                           ()))
                     (NamedModel
                        (GTransformerFeedForwardNetwork
                           (NamedModel
                              (LayerNorm
                                 'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim, inputEmbedDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[ffnDim])))))
                           Relu
                           Dropout
                           (NamedModel
                              (GLinear
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim, ffnDim])))
                                 (NamedModel
                                    (Tensor
                                       gradient
                                       ('Layout 'Dense)
                                       device
                                       dataType
                                       ('Shape '[inputEmbedDim])))))
                           Dropout
                           ()))))))
         (NamedModel
            (LayerNormSpec
               'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
         ()))
-&gt; GTransformer
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           posEncDim
           inputEmbedDim
           'Nothing))
     ()
     ()
     Dropout
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GCrossAttention
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim, inputEmbedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[embedDim])))))
                             (NamedModel
                                (GLinear
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim, embedDim])))
                                   (NamedModel
                                      (Tensor
                                         gradient
                                         ('Layout 'Dense)
                                         device
                                         dataType
                                         ('Shape '[inputEmbedDim])))))
                             Dropout))
                       Dropout
                       ()))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (NamedModel
                          (LayerNorm
                             'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[ffnDim, inputEmbedDim])))
                             (NamedModel
                                (Tensor
                                   gradient ('Layout 'Dense) device dataType ('Shape '[ffnDim])))))
                       Relu
                       Dropout
                       (NamedModel
                          (GLinear
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim, ffnDim])))
                             (NamedModel
                                (Tensor
                                   gradient
                                   ('Layout 'Dense)
                                   device
                                   dataType
                                   ('Shape '[inputEmbedDim])))))
                       Dropout
                       ()))))))
     (NamedModel
        (LayerNormSpec
           'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
     ()
-&gt; NamedModel
     (GTransformer
        (NamedModel
           (EmbeddingSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              posEncDim
              inputEmbedDim
              'Nothing))
        ()
        ()
        Dropout
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GCrossAttention
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim, inputEmbedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[embedDim])))))
                                (NamedModel
                                   (GLinear
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim, embedDim])))
                                      (NamedModel
                                         (Tensor
                                            gradient
                                            ('Layout 'Dense)
                                            device
                                            dataType
                                            ('Shape '[inputEmbedDim])))))
                                Dropout))
                          Dropout
                          ()))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (NamedModel
                             (LayerNorm
                                'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim, inputEmbedDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[ffnDim])))))
                          Relu
                          Dropout
                          (NamedModel
                             (GLinear
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim, ffnDim])))
                                (NamedModel
                                   (Tensor
                                      gradient
                                      ('Layout 'Dense)
                                      device
                                      dataType
                                      ('Shape '[inputEmbedDim])))))
                          Dropout
                          ()))))))
        (NamedModel
           (LayerNormSpec
              'WithBias gradient device dataType ('Shape '[inputEmbedDim])))
        ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF
           'Pegasus gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF 'Pegasus gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF
           'Pegasus gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF 'Pegasus))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'Pegasus gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (KInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (VInProjF 'Pegasus gradient device dataType inputEmbedDim embedDim)
                             (OutProjF 'Pegasus gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          'Pegasus gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF 'Pegasus)
                       (FFNActivationDropoutF 'Pegasus)
                       (FFNOutputProjectionF
                          'Pegasus gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          'Pegasus gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF
           'Pegasus gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF 'Pegasus))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style))
</span><a href="#local-6989586621679557604"><span class="hs-identifier hs-var">decoderSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-233"></span><span>      </span><span class="annot"><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-234"></span><span>      </span><span class="annot"><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-235"></span><span>      </span><span class="annot"><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style)))
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-236"></span><span>      </span><span id="local-6989586621679557603"><span class="annot"><span class="annottext">sharedEmbeddingSpec :: STransformerStyle style
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
</span><a href="#local-6989586621679557603"><span class="hs-identifier hs-var hs-var">sharedEmbeddingSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679557602"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-237"></span><span>      </span><span class="annot"><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679557602"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-238"></span><span>      </span><span class="annot"><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679557602"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-239"></span><span>      </span><span class="annot"><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679557602"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;model.shared.&quot;</span></span><span> </span><span class="annot"><span class="annottext">EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679557602"><span class="hs-identifier hs-var">sharedEmbeddingSpec'</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-242"></span><span>      </span><span class="annot"><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-243"></span><span>      </span><span class="annot"><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NamedModel
  (EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-244"></span><span>      </span><span id="local-6989586621679557601"><span class="annot"><span class="annottext">headSpec :: STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; ModelSpec
     (EDTHeadF
        style
        transformerHead
        gradient
        device
        dataType
        inputEmbedDim
        vocabDim)
</span><a href="#local-6989586621679557601"><span class="hs-identifier hs-var hs-var">headSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias ())
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias ()))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;lm_head.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLMHead
   inputEmbedDim
   ()
   ()
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[vocabDim, inputEmbedDim])))
         (NamedModel ())))
   (GBias ())
 -&gt; NamedModel
      (GLMHead
         inputEmbedDim
         ()
         ()
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[vocabDim, inputEmbedDim])))
               (NamedModel ())))
         (GBias ())))
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias ())
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF 'T5 gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF 'T5))
     (ModelSpec
        (LMHeadLayerNormF 'T5 gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           'T5 gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF 'T5 gradient device dataType vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679557598"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'T5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span>
</span><span id="line-246"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias ())
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias ()))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;lm_head.&quot;</span></span><span> </span><span class="annot"><span class="annottext">(GLMHead
   inputEmbedDim
   ()
   ()
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[vocabDim, inputEmbedDim])))
         (NamedModel ())))
   (GBias ())
 -&gt; NamedModel
      (GLMHead
         inputEmbedDim
         ()
         ()
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[vocabDim, inputEmbedDim])))
               (NamedModel ())))
         (GBias ())))
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias ())
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias ()))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF 'ByT5 gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF 'ByT5))
     (ModelSpec
        (LMHeadLayerNormF 'ByT5 gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           'ByT5 gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF 'ByT5 gradient device dataType vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679557598"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'ByT5
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span>
</span><span id="line-248"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-249"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim])))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GLMHead
   inputEmbedDim
   ()
   ()
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[vocabDim, inputEmbedDim])))
         (NamedModel ())))
   (GBias
      (NamedModel
         (TensorSpec
            gradient
            ('Layout 'Dense)
            device
            dataType
            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
 -&gt; NamedModel
      (GLMHead
         inputEmbedDim
         ()
         ()
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[vocabDim, inputEmbedDim])))
               (NamedModel ())))
         (GBias
            (NamedModel
               (TensorSpec
                  gradient
                  ('Layout 'Dense)
                  device
                  dataType
                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))))
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim])))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF 'BART gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF 'BART))
     (ModelSpec
        (LMHeadLayerNormF 'BART gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           'BART gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF 'BART gradient device dataType vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679557598"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'BART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span>
</span><span id="line-250"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim])))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GLMHead
   inputEmbedDim
   ()
   ()
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[vocabDim, inputEmbedDim])))
         (NamedModel ())))
   (GBias
      (NamedModel
         (TensorSpec
            gradient
            ('Layout 'Dense)
            device
            dataType
            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
 -&gt; NamedModel
      (GLMHead
         inputEmbedDim
         ()
         ()
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[vocabDim, inputEmbedDim])))
               (NamedModel ())))
         (GBias
            (NamedModel
               (TensorSpec
                  gradient
                  ('Layout 'Dense)
                  device
                  dataType
                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))))
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim])))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF 'MBART gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF 'MBART))
     (ModelSpec
        (LMHeadLayerNormF 'MBART gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           'MBART gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF 'MBART gradient device dataType vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679557598"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'MBART
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithoutHead"><span class="hs-identifier hs-var">SWithoutHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SWithLMHead"><span class="hs-identifier hs-var">SWithLMHead</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim])))))
forall model. Text -&gt; model -&gt; NamedModel model
</span><a href="Torch.GraduallyTyped.NN.Class.html#NamedModel"><span class="hs-identifier hs-var">NamedModel</span></a></span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">(GLMHead
   inputEmbedDim
   ()
   ()
   ()
   (NamedModel
      (GLinear
         (NamedModel
            (TensorSpec
               gradient
               ('Layout 'Dense)
               device
               dataType
               ('Shape '[vocabDim, inputEmbedDim])))
         (NamedModel ())))
   (GBias
      (NamedModel
         (TensorSpec
            gradient
            ('Layout 'Dense)
            device
            dataType
            ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
 -&gt; NamedModel
      (GLMHead
         inputEmbedDim
         ()
         ()
         ()
         (NamedModel
            (GLinear
               (NamedModel
                  (TensorSpec
                     gradient
                     ('Layout 'Dense)
                     device
                     dataType
                     ('Shape '[vocabDim, inputEmbedDim])))
               (NamedModel ())))
         (GBias
            (NamedModel
               (TensorSpec
                  gradient
                  ('Layout 'Dense)
                  device
                  dataType
                  ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))))
-&gt; GLMHead
     inputEmbedDim
     ()
     ()
     ()
     (NamedModel
        (GLinear
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[vocabDim, inputEmbedDim])))
           (NamedModel ())))
     (GBias
        (NamedModel
           (TensorSpec
              gradient
              ('Layout 'Dense)
              device
              dataType
              ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim]))))
-&gt; NamedModel
     (GLMHead
        inputEmbedDim
        ()
        ()
        ()
        (NamedModel
           (GLinear
              (NamedModel
                 (TensorSpec
                    gradient
                    ('Layout 'Dense)
                    device
                    dataType
                    ('Shape '[vocabDim, inputEmbedDim])))
              (NamedModel ())))
        (GBias
           (NamedModel
              (TensorSpec
                 gradient
                 ('Layout 'Dense)
                 device
                 dataType
                 ('Shape '[ 'Dim ('Name &quot;*&quot;) ('Size 1), vocabDim])))))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF 'Pegasus gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF 'Pegasus))
     (ModelSpec
        (LMHeadLayerNormF 'Pegasus gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           'Pegasus gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec
        (LMHeadBiasF 'Pegasus gradient device dataType vocabDim))
forall (style :: TransformerStyle).
STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679557598"><span class="hs-identifier hs-var">headSpec'</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle 'Pegasus
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span>
</span><span id="line-254"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (EDTHeadF
     style
     transformerHead
     gradient
     device
     dataType
     inputEmbedDim
     vocabDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-255"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (EDTHeadF
     style
     transformerHead
     gradient
     device
     dataType
     inputEmbedDim
     vocabDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-256"></span><span>      </span><span class="annot"><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ModelSpec
  (EDTHeadF
     style
     transformerHead
     gradient
     device
     dataType
     inputEmbedDim
     vocabDim)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-257"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-type">embedScalingSpec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#STransformerStyle"><span class="hs-identifier hs-type">STransformerStyle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557647"><span class="hs-identifier hs-type">style</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerHasEmbedScaling"><span class="hs-identifier hs-type">EncoderDecoderTransformerHasEmbedScaling</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span id="local-6989586621679557597"><span class="annot"><span class="annottext">embedScalingSpec :: STransformerStyle style -&gt; EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679557597"><span class="hs-identifier hs-var hs-var">embedScalingSpec</span></a></span></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ST5"><span class="hs-identifier hs-var">ST5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-259"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SByT5"><span class="hs-identifier hs-var">SByT5</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-260"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBART"><span class="hs-identifier hs-var">SBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-261"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SMBART"><span class="hs-identifier hs-var">SMBART</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SPegasus"><span class="hs-identifier hs-var">SPegasus</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SBERT"><span class="hs-identifier hs-var">SBERT</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SRoBERTa"><span class="hs-identifier hs-var">SRoBERTa</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-265"></span><span>      </span><span class="annot"><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#SGPT2"><span class="hs-identifier hs-var">SGPT2</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-266"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TERelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEInitialDropoutF style))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          Dropout
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEFinalDropoutF style)))
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TDRelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDInitialDropoutF style))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GCrossAttention
                          (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          Dropout
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDFinalDropoutF style)))
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
-&gt; ModelSpec
     (EDTHeadF
        style
        transformerHead
        gradient
        device
        dataType
        inputEmbedDim
        vocabDim)
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; GEncoderDecoderTransformer
     inputEmbedDim
     (NamedModel
        (GTransformer
           (ModelSpec
              (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
           (ModelSpec
              (TERelPosEncF style gradient device dataType headDim posEncDim))
           (ModelSpec
              (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
           (ModelSpec (TEInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numEncoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                       ()
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device dataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device dataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device dataType inputEmbedDim)))))))
           (ModelSpec
              (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
           (ModelSpec (TEFinalDropoutF style))))
     (NamedModel
        (GTransformer
           (ModelSpec
              (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
           (ModelSpec
              (TDRelPosEncF style gradient device dataType headDim posEncDim))
           (ModelSpec
              (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
           (ModelSpec (TDInitialDropoutF style))
           (NamedModel
              (GTransformerStack
                 (VectorSpec
                    numDecoderLayers
                    (GTransformerBlock
                       (NamedModel
                          (GSelfAttention
                             (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                       (NamedModel
                          (GCrossAttention
                             (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                             (NamedModel
                                (GMultiHeadAttention
                                   headDim
                                   headEmbedDim
                                   embedDim
                                   (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                   (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                   Dropout))
                             Dropout
                             (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                       (NamedModel
                          (GTransformerFeedForwardNetwork
                             (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                             (FFNInputTransformationF
                                style gradient device dataType inputEmbedDim ffnDim)
                             (FFNActivationF style)
                             (FFNActivationDropoutF style)
                             (FFNOutputProjectionF
                                style gradient device dataType inputEmbedDim ffnDim)
                             Dropout
                             (FFNOutputLayerNormF
                                style gradient device dataType inputEmbedDim)))))))
           (ModelSpec
              (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
           (ModelSpec (TDFinalDropoutF style))))
     (NamedModel
        (EmbeddingSpec
           gradient
           ('Layout 'Dense)
           device
           dataType
           vocabDim
           inputEmbedDim
           'Nothing))
     (ModelSpec
        (EDTHeadF
           style
           transformerHead
           gradient
           device
           dataType
           inputEmbedDim
           vocabDim))
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
SDim inputEmbedDim
-&gt; encoder
-&gt; decoder
-&gt; sharedEmbedding
-&gt; head
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557623"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TERelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEInitialDropoutF style))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numEncoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    ()
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          Dropout
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TEFinalDropoutF style)))
</span><a href="#local-6989586621679557617"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557633"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (GTransformer
        (ModelSpec
           (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
        (ModelSpec
           (TDRelPosEncF style gradient device dataType headDim posEncDim))
        (ModelSpec
           (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDInitialDropoutF style))
        (NamedModel
           (GTransformerStack
              (VectorSpec
                 numDecoderLayers
                 (GTransformerBlock
                    (NamedModel
                       (GSelfAttention
                          (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GCrossAttention
                          (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                          (NamedModel
                             (GMultiHeadAttention
                                headDim
                                headEmbedDim
                                embedDim
                                (QInProjF style gradient device dataType inputEmbedDim embedDim)
                                (KInProjF style gradient device dataType inputEmbedDim embedDim)
                                (VInProjF style gradient device dataType inputEmbedDim embedDim)
                                (OutProjF style gradient device dataType embedDim inputEmbedDim)
                                Dropout))
                          Dropout
                          (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                    (NamedModel
                       (GTransformerFeedForwardNetwork
                          (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                          (FFNInputTransformationF
                             style gradient device dataType inputEmbedDim ffnDim)
                          (FFNActivationF style)
                          (FFNActivationDropoutF style)
                          (FFNOutputProjectionF
                             style gradient device dataType inputEmbedDim ffnDim)
                          Dropout
                          (FFNOutputLayerNormF
                             style gradient device dataType inputEmbedDim)))))))
        (ModelSpec
           (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
        (ModelSpec (TDFinalDropoutF style)))
</span><a href="#local-6989586621679557605"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557633"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; NamedModel
     (EmbeddingSpec
        gradient
        ('Layout 'Dense)
        device
        dataType
        vocabDim
        inputEmbedDim
        'Nothing)
</span><a href="#local-6989586621679557603"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557633"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; STransformerHead transformerHead
-&gt; ModelSpec
     (EDTHeadF
        style
        transformerHead
        gradient
        device
        dataType
        inputEmbedDim
        vocabDim)
</span><a href="#local-6989586621679557601"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557633"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerHead transformerHead
</span><a href="#local-6989586621679557632"><span class="hs-identifier hs-var">transformerHead</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">STransformerStyle style -&gt; EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679557597"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557633"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-267"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><a href="#local-6989586621679557614"><span class="hs-identifier hs-type">encoderSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621679557614"><span class="annot"><span class="annottext">encoderSpec' :: STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TERelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numEncoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 ()
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TEFinalDropoutF style))
</span><a href="#local-6989586621679557614"><span class="hs-identifier hs-var hs-var">encoderSpec'</span></a></span></span><span> </span><span id="local-6989586621679557596"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557596"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SNat numEncoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformer
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
        (TERelPosEncF style gradient device dataType headDim posEncDim)
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
        (TEInitialDropoutF style)
        (TEStackF
           style
           numEncoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim)
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
        (TEFinalDropoutF style))
forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformer
        (TEPosEncF style gradient device dataType inputEmbedDim posEncDim)
        (TERelPosEncF style gradient device dataType headDim posEncDim)
        (TEInitialLayerNormF style gradient device dataType inputEmbedDim)
        (TEInitialDropoutF style)
        (TEStackF
           style
           numLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           ffnDim)
        (TEFinalLayerNormF style gradient device dataType inputEmbedDim)
        (TEFinalDropoutF style))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerEncoderSpec"><span class="hs-identifier hs-var">transformerEncoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557596"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numEncoderLayers
</span><a href="#local-6989586621679557631"><span class="hs-identifier hs-var">numEncoderLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679557629"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679557628"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679557627"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679557626"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679557625"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679557624"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557623"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679557622"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679557621"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557619"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557618"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="annot"><a href="#local-6989586621679557604"><span class="hs-identifier hs-type">decoderSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679557604"><span class="annot"><span class="annottext">decoderSpec' :: STransformerStyle style
-&gt; GTransformer
     (ModelSpec
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim))
     (ModelSpec
        (TDRelPosEncF style gradient device dataType headDim posEncDim))
     (ModelSpec
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDInitialDropoutF style))
     (NamedModel
        (GTransformerStack
           (VectorSpec
              numDecoderLayers
              (GTransformerBlock
                 (NamedModel
                    (GSelfAttention
                       (SAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (SAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GCrossAttention
                       (CAInitialLayerNormF style gradient device dataType inputEmbedDim)
                       (NamedModel
                          (GMultiHeadAttention
                             headDim
                             headEmbedDim
                             embedDim
                             (QInProjF style gradient device dataType inputEmbedDim embedDim)
                             (KInProjF style gradient device dataType inputEmbedDim embedDim)
                             (VInProjF style gradient device dataType inputEmbedDim embedDim)
                             (OutProjF style gradient device dataType embedDim inputEmbedDim)
                             Dropout))
                       Dropout
                       (CAFinalLayerNormF style gradient device dataType inputEmbedDim)))
                 (NamedModel
                    (GTransformerFeedForwardNetwork
                       (FFNInputLayerNormF style gradient device dataType inputEmbedDim)
                       (FFNInputTransformationF
                          style gradient device dataType inputEmbedDim ffnDim)
                       (FFNActivationF style)
                       (FFNActivationDropoutF style)
                       (FFNOutputProjectionF
                          style gradient device dataType inputEmbedDim ffnDim)
                       Dropout
                       (FFNOutputLayerNormF
                          style gradient device dataType inputEmbedDim)))))))
     (ModelSpec
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec (TDFinalDropoutF style))
</span><a href="#local-6989586621679557604"><span class="hs-identifier hs-var hs-var">decoderSpec'</span></a></span></span><span> </span><span id="local-6989586621679557595"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557595"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SNat numDecoderLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim inputEmbedDim
-&gt; SDim inputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformer
        (TDPosEncF style gradient device dataType inputEmbedDim posEncDim)
        (TDRelPosEncF style gradient device dataType headDim posEncDim)
        (TDInitialLayerNormF style gradient device dataType inputEmbedDim)
        (TDInitialDropoutF style)
        (TDStackF
           style
           numDecoderLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           inputEmbedDim
           inputEmbedDim
           ffnDim)
        (TDFinalLayerNormF style gradient device dataType inputEmbedDim)
        (TDFinalDropoutF style))
forall (style :: TransformerStyle) (numLayers :: Nat)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (headDim :: Dim (Name Symbol) (Size Nat))
       (headEmbedDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (decoderInputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (encoderOutputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (ffnDim :: Dim (Name Symbol) (Size Nat))
       (posEncDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SNat numLayers
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim headDim
-&gt; SDim headEmbedDim
-&gt; SDim embedDim
-&gt; SDim decoderInputEmbedDim
-&gt; SDim encoderOutputEmbedDim
-&gt; SDim ffnDim
-&gt; SDim posEncDim
-&gt; Double
-&gt; Double
-&gt; ModelSpec
     (GTransformer
        (TDPosEncF
           style gradient device dataType decoderInputEmbedDim posEncDim)
        (TDRelPosEncF style gradient device dataType headDim posEncDim)
        (TDInitialLayerNormF
           style gradient device dataType decoderInputEmbedDim)
        (TDInitialDropoutF style)
        (TDStackF
           style
           numLayers
           gradient
           device
           dataType
           headDim
           headEmbedDim
           embedDim
           decoderInputEmbedDim
           encoderOutputEmbedDim
           ffnDim)
        (TDFinalLayerNormF
           style gradient device dataType decoderInputEmbedDim)
        (TDFinalDropoutF style))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GTransformer.html#transformerDecoderSpec"><span class="hs-identifier hs-var">transformerDecoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557595"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SNat numDecoderLayers
</span><a href="#local-6989586621679557630"><span class="hs-identifier hs-var">numDecoderLayers</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679557629"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679557628"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679557627"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headDim
</span><a href="#local-6989586621679557626"><span class="hs-identifier hs-var">headDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim headEmbedDim
</span><a href="#local-6989586621679557625"><span class="hs-identifier hs-var">headEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim embedDim
</span><a href="#local-6989586621679557624"><span class="hs-identifier hs-var">embedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557623"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557623"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim ffnDim
</span><a href="#local-6989586621679557622"><span class="hs-identifier hs-var">ffnDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim posEncDim
</span><a href="#local-6989586621679557621"><span class="hs-identifier hs-var">posEncDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557619"><span class="hs-identifier hs-var">dropoutP</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557618"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span id="local-6989586621679557602"><span class="annot"><span class="annottext">sharedEmbeddingSpec' :: EmbeddingSpec
  gradient
  ('Layout 'Dense)
  device
  dataType
  vocabDim
  inputEmbedDim
  'Nothing
</span><a href="#local-6989586621679557602"><span class="hs-identifier hs-var hs-var">sharedEmbeddingSpec'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">SGradient gradient
-&gt; SLayout ('Layout 'Dense)
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim vocabDim
-&gt; SDim inputEmbedDim
-&gt; SMaybe 'Nothing
-&gt; EmbeddingSpec
     gradient
     ('Layout 'Dense)
     device
     dataType
     vocabDim
     inputEmbedDim
     'Nothing
forall (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (embedNumDim :: Dim (Name Symbol) (Size Nat))
       (embedDim :: Dim (Name Symbol) (Size Nat))
       (paddingIdx :: Maybe Nat).
SGradient gradient
-&gt; SLayout layout
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim embedNumDim
-&gt; SDim embedDim
-&gt; SMaybe paddingIdx
-&gt; EmbeddingSpec
     gradient layout device dataType embedNumDim embedDim paddingIdx
</span><a href="Torch.GraduallyTyped.NN.Sparse.html#EmbeddingSpec"><span class="hs-identifier hs-var">EmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679557629"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SLayoutType 'Dense -&gt; SLayout ('Layout 'Dense)
forall (layoutType :: LayoutType).
SLayoutType layoutType -&gt; SLayout ('Layout layoutType)
</span><a href="Torch.GraduallyTyped.Layout.html#SLayout"><span class="hs-identifier hs-var">SLayout</span></a></span><span> </span><span class="annot"><span class="annottext">SLayoutType 'Dense
</span><a href="Torch.GraduallyTyped.Layout.html#SDense"><span class="hs-identifier hs-var">SDense</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679557628"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679557627"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679557620"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557623"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SMaybe 'Nothing
forall a. SMaybe 'Nothing
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">SNothing</span></a></span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><a href="#local-6989586621679557598"><span class="hs-identifier hs-type">headSpec'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span>
</span><span id="line-274"></span><span>    </span><span id="local-6989586621679557598"><span class="annot"><span class="annottext">headSpec' :: STransformerStyle style
-&gt; GLMHead
     inputEmbedDim
     (ModelSpec
        (LMHeadDenseF style gradient device dataType inputEmbedDim))
     (ModelSpec (LMHeadActivationF style))
     (ModelSpec
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim))
     (ModelSpec
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim))
     (ModelSpec (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="#local-6989586621679557598"><span class="hs-identifier hs-var hs-var">headSpec'</span></a></span></span><span> </span><span id="local-6989586621679557591"><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557591"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputEmbedDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; ModelSpec
     (GLMHead
        inputEmbedDim
        (LMHeadDenseF style gradient device dataType inputEmbedDim)
        (LMHeadActivationF style)
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim)
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim)
        (LMHeadBiasF style gradient device dataType vocabDim))
forall (style :: TransformerStyle)
       (gradient :: Gradient RequiresGradient)
       (device :: Device (DeviceType Nat)) (dataType :: DataType DType)
       (inputEmbedDim :: Dim (Name Symbol) (Size Nat))
       (vocabDim :: Dim (Name Symbol) (Size Nat)).
STransformerStyle style
-&gt; SGradient gradient
-&gt; SDevice device
-&gt; SDataType dataType
-&gt; SDim inputEmbedDim
-&gt; SDim vocabDim
-&gt; Double
-&gt; ModelSpec
     (GLMHead
        inputEmbedDim
        (LMHeadDenseF style gradient device dataType inputEmbedDim)
        (LMHeadActivationF style)
        (LMHeadLayerNormF style gradient device dataType inputEmbedDim)
        (LMHeadDecoderF
           style gradient device dataType inputEmbedDim vocabDim)
        (LMHeadBiasF style gradient device dataType vocabDim))
</span><a href="Torch.GraduallyTyped.NN.Transformer.GLMHead.html#lmHeadSpec"><span class="hs-identifier hs-var">lmHeadSpec</span></a></span><span> </span><span class="annot"><span class="annottext">STransformerStyle style
</span><a href="#local-6989586621679557591"><span class="hs-identifier hs-var">style'</span></a></span><span> </span><span class="annot"><span class="annottext">SGradient gradient
</span><a href="#local-6989586621679557629"><span class="hs-identifier hs-var">gradient</span></a></span><span> </span><span class="annot"><span class="annottext">SDevice device
</span><a href="#local-6989586621679557628"><span class="hs-identifier hs-var">device</span></a></span><span> </span><span class="annot"><span class="annottext">SDataType dataType
</span><a href="#local-6989586621679557627"><span class="hs-identifier hs-var">dataType</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557623"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span> </span><span class="annot"><span class="annottext">SDim vocabDim
</span><a href="#local-6989586621679557620"><span class="hs-identifier hs-var">vocabDim</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557618"><span class="hs-identifier hs-var">eps</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621679557585"><span id="local-6989586621679557586"><span id="local-6989586621679557587"><span id="local-6989586621679557588"><span id="local-6989586621679557589"><span id="local-6989586621679557590"><span class="hs-keyword">instance</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557590"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557590"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557588"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557588"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557587"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557587"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557586"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557586"><span class="hs-identifier hs-type">head</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-283"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557585"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557590"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557588"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557587"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557586"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557585"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557590"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557588"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557587"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557586"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>    </span><span class="annot"><a href="#local-6989586621679557589"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-287"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679557582"><span class="annot"><span class="annottext">initialize :: ModelSpec
  (GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; Generator generatorDevice
-&gt; m (GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head,
      Generator generatorDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span id="local-6989586621679557580"><span class="annot"><a href="#local-6989586621679557580"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557579"><span class="annot"><a href="#local-6989586621679557579"><span class="hs-identifier hs-var">encoderSpec</span></a></span></span><span> </span><span id="local-6989586621679557578"><span class="annot"><a href="#local-6989586621679557578"><span class="hs-identifier hs-var">decoderSpec</span></a></span></span><span> </span><span id="local-6989586621679557577"><span class="annot"><a href="#local-6989586621679557577"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span></span><span> </span><span id="local-6989586621679557576"><span class="annot"><a href="#local-6989586621679557576"><span class="hs-identifier hs-var">headSpec</span></a></span></span><span> </span><span id="local-6989586621679557575"><span class="annot"><a href="#local-6989586621679557575"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557574"><span class="annot"><span class="annottext">encoder :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) encoder
</span><a href="#local-6989586621679557574"><span class="hs-identifier hs-var hs-var">encoder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (encoder, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) encoder
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (encoder, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) encoder)
-&gt; (ModelSpec encoder
    -&gt; Generator generatorDevice
    -&gt; m (encoder, Generator generatorDevice))
-&gt; ModelSpec encoder
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) encoder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec encoder
-&gt; Generator generatorDevice
-&gt; m (encoder, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec encoder
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) encoder)
-&gt; ModelSpec encoder
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) encoder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec encoder
</span><a href="#local-6989586621679557579"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span>
</span><span id="line-290"></span><span>        </span><span id="local-6989586621679557571"><span class="annot"><span class="annottext">decoder :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) decoder
</span><a href="#local-6989586621679557571"><span class="hs-identifier hs-var hs-var">decoder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (decoder, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) decoder
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (decoder, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) decoder)
-&gt; (ModelSpec decoder
    -&gt; Generator generatorDevice
    -&gt; m (decoder, Generator generatorDevice))
-&gt; ModelSpec decoder
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) decoder
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec decoder
-&gt; Generator generatorDevice
-&gt; m (decoder, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec decoder
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) decoder)
-&gt; ModelSpec decoder
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) decoder
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec decoder
</span><a href="#local-6989586621679557578"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span>
</span><span id="line-291"></span><span>        </span><span id="local-6989586621679557570"><span class="annot"><span class="annottext">sharedEmbedding :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  sharedEmbedding
</span><a href="#local-6989586621679557570"><span class="hs-identifier hs-var hs-var">sharedEmbedding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (sharedEmbedding, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     sharedEmbedding
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (sharedEmbedding, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      sharedEmbedding)
-&gt; (ModelSpec sharedEmbedding
    -&gt; Generator generatorDevice
    -&gt; m (sharedEmbedding, Generator generatorDevice))
-&gt; ModelSpec sharedEmbedding
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     sharedEmbedding
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec sharedEmbedding
-&gt; Generator generatorDevice
-&gt; m (sharedEmbedding, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec sharedEmbedding
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      sharedEmbedding)
-&gt; ModelSpec sharedEmbedding
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     sharedEmbedding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec sharedEmbedding
</span><a href="#local-6989586621679557577"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span>
</span><span id="line-292"></span><span>        </span><span id="local-6989586621679557569"><span class="annot"><span class="annottext">head :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) head
</span><a href="#local-6989586621679557569"><span class="hs-identifier hs-var hs-var">head</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice -&gt; m (head, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) head
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice -&gt; m (head, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) head)
-&gt; (ModelSpec head
    -&gt; Generator generatorDevice
    -&gt; m (head, Generator generatorDevice))
-&gt; ModelSpec head
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) head
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec head
-&gt; Generator generatorDevice -&gt; m (head, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec head
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) head)
-&gt; ModelSpec head
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) head
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec head
</span><a href="#local-6989586621679557576"><span class="hs-identifier hs-var">headSpec</span></a></span><span>
</span><span id="line-293"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; Generator generatorDevice
-&gt; m (GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head,
      Generator generatorDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span>
</span><span id="line-294"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
-&gt; encoder
-&gt; decoder
-&gt; sharedEmbedding
-&gt; head
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
SDim inputEmbedDim
-&gt; encoder
-&gt; decoder
-&gt; sharedEmbedding
-&gt; head
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557580"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span>
</span><span id="line-295"></span><span>              </span><span class="annot"><span class="annottext">(encoder
 -&gt; decoder
 -&gt; sharedEmbedding
 -&gt; head
 -&gt; EncoderDecoderTransformerHasEmbedScaling
 -&gt; GEncoderDecoderTransformer
      inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) encoder
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (decoder
      -&gt; sharedEmbedding
      -&gt; head
      -&gt; EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) encoder
</span><a href="#local-6989586621679557574"><span class="hs-identifier hs-var">encoder</span></a></span><span>
</span><span id="line-296"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (decoder
   -&gt; sharedEmbedding
   -&gt; head
   -&gt; EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) decoder
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (sharedEmbedding
      -&gt; head
      -&gt; EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) decoder
</span><a href="#local-6989586621679557571"><span class="hs-identifier hs-var">decoder</span></a></span><span>
</span><span id="line-297"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (sharedEmbedding
   -&gt; head
   -&gt; EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     sharedEmbedding
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (head
      -&gt; EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  sharedEmbedding
</span><a href="#local-6989586621679557570"><span class="hs-identifier hs-var">sharedEmbedding</span></a></span><span>
</span><span id="line-298"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (head
   -&gt; EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) head
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) head
</span><a href="#local-6989586621679557569"><span class="hs-identifier hs-var">head</span></a></span><span>
</span><span id="line-299"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     EncoderDecoderTransformerHasEmbedScaling
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     EncoderDecoderTransformerHasEmbedScaling
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679557575"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span>
</span><span id="line-300"></span><span>          </span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621679557563"><span id="local-6989586621679557564"><span id="local-6989586621679557565"><span id="local-6989586621679557566"><span id="local-6989586621679557567"><span class="hs-keyword">instance</span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557567"><span class="hs-identifier hs-type">encoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557566"><span class="hs-identifier hs-type">decoder</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557565"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557564"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-307"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-308"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557563"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557567"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557566"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557565"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557564"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679557559"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec
  (GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; Text
-&gt; m (GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span id="local-6989586621679557557"><span class="annot"><a href="#local-6989586621679557557"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span></span><span> </span><span id="local-6989586621679557556"><span class="annot"><a href="#local-6989586621679557556"><span class="hs-identifier hs-var">encoderSpec</span></a></span></span><span> </span><span id="local-6989586621679557555"><span class="annot"><a href="#local-6989586621679557555"><span class="hs-identifier hs-var">decoderSpec</span></a></span></span><span> </span><span id="local-6989586621679557554"><span class="annot"><a href="#local-6989586621679557554"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span></span><span> </span><span id="local-6989586621679557553"><span class="annot"><a href="#local-6989586621679557553"><span class="hs-identifier hs-var">headSpec</span></a></span></span><span> </span><span id="local-6989586621679557552"><span class="annot"><a href="#local-6989586621679557552"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679557551"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557551"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-311"></span><span>    </span><span class="annot"><span class="annottext">SDim inputEmbedDim
-&gt; encoder
-&gt; decoder
-&gt; sharedEmbedding
-&gt; head
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
SDim inputEmbedDim
-&gt; encoder
-&gt; decoder
-&gt; sharedEmbedding
-&gt; head
-&gt; EncoderDecoderTransformerHasEmbedScaling
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-var">GEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-312"></span><span>      </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557557"><span class="hs-identifier hs-var">inputEmbedDim</span></a></span><span>
</span><span id="line-313"></span><span>      </span><span class="annot"><span class="annottext">(encoder
 -&gt; decoder
 -&gt; sharedEmbedding
 -&gt; head
 -&gt; EncoderDecoderTransformerHasEmbedScaling
 -&gt; GEncoderDecoderTransformer
      inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; m encoder
-&gt; m (decoder
      -&gt; sharedEmbedding
      -&gt; head
      -&gt; EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec encoder -&gt; Text -&gt; m encoder
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec encoder
</span><a href="#local-6989586621679557556"><span class="hs-identifier hs-var">encoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557551"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-314"></span><span>      </span><span class="annot"><span class="annottext">m (decoder
   -&gt; sharedEmbedding
   -&gt; head
   -&gt; EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; m decoder
-&gt; m (sharedEmbedding
      -&gt; head
      -&gt; EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec decoder -&gt; Text -&gt; m decoder
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec decoder
</span><a href="#local-6989586621679557555"><span class="hs-identifier hs-var">decoderSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557551"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-315"></span><span>      </span><span class="annot"><span class="annottext">m (sharedEmbedding
   -&gt; head
   -&gt; EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; m sharedEmbedding
-&gt; m (head
      -&gt; EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec sharedEmbedding -&gt; Text -&gt; m sharedEmbedding
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec sharedEmbedding
</span><a href="#local-6989586621679557554"><span class="hs-identifier hs-var">sharedEmbeddingSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557551"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-316"></span><span>      </span><span class="annot"><span class="annottext">m (head
   -&gt; EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; m head
-&gt; m (EncoderDecoderTransformerHasEmbedScaling
      -&gt; GEncoderDecoderTransformer
           inputEmbedDim encoder decoder sharedEmbedding head)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec head -&gt; Text -&gt; m head
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec head
</span><a href="#local-6989586621679557553"><span class="hs-identifier hs-var">headSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557551"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><span class="annottext">m (EncoderDecoderTransformerHasEmbedScaling
   -&gt; GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
-&gt; m EncoderDecoderTransformerHasEmbedScaling
-&gt; m (GEncoderDecoderTransformer
        inputEmbedDim encoder decoder sharedEmbedding head)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
-&gt; m EncoderDecoderTransformerHasEmbedScaling
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679557552"><span class="hs-identifier hs-var">embedScalingSpec</span></a></span><span>
</span><span id="line-318"></span><span>  </span><span id="local-6989586621679557549"><span class="annot"><span class="annottext">toStateDict :: Text
-&gt; GEncoderDecoderTransformer
     inputEmbedDim encoder decoder sharedEmbedding head
-&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679557547"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557547"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557541"><span id="local-6989586621679557542"><span id="local-6989586621679557543"><span id="local-6989586621679557544"><span id="local-6989586621679557545"><span id="local-6989586621679557546"><span class="annot"><span class="annottext">encoder
decoder
sharedEmbedding
head
SDim inputEmbedDim
EncoderDecoderTransformerHasEmbedScaling
edtEmbedScaling :: EncoderDecoderTransformerHasEmbedScaling
edtHead :: head
edtSharedEmbedding :: sharedEmbedding
edtDecoder :: decoder
edtEncoder :: encoder
edtInputEmbedDim :: SDim inputEmbedDim
edtEmbedScaling :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerHasEmbedScaling
edtHead :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; head
edtSharedEmbedding :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; sharedEmbedding
edtDecoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; decoder
edtEncoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; encoder
edtInputEmbedDim :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="#local-6989586621679557541"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; encoder -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557547"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">encoder
</span><a href="#local-6989586621679557545"><span class="hs-identifier hs-var">edtEncoder</span></a></span><span>
</span><span id="line-320"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; decoder -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557547"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">decoder
</span><a href="#local-6989586621679557544"><span class="hs-identifier hs-var">edtDecoder</span></a></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; sharedEmbedding -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557547"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
</span><a href="#local-6989586621679557543"><span class="hs-identifier hs-var">edtSharedEmbedding</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; head -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557547"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679557542"><span class="hs-identifier hs-var">edtHead</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-keyword">data</span><span>
</span><span id="line-326"></span><span>  </span><span id="GSimplifiedEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span></span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557540"><span class="annot"><a href="#local-6989586621679557540"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557539"><span class="annot"><a href="#local-6989586621679557539"><span class="hs-identifier hs-type">mkPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557538"><span class="annot"><a href="#local-6989586621679557538"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557537"><span class="annot"><a href="#local-6989586621679557537"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557536"><span class="annot"><a href="#local-6989586621679557536"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557535"><span class="annot"><a href="#local-6989586621679557535"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679557534"><span class="annot"><a href="#local-6989586621679557534"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-335"></span><span>  </span><span id="GSimplifiedEncoderDecoderTransformer"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679558061"><span class="annot"><a href="#local-6989586621679558061"><span class="hs-identifier hs-type">model</span></a></span></span><span> </span><span id="local-6989586621679558060"><span class="annot"><a href="#local-6989586621679558060"><span class="hs-identifier hs-type">mkPos</span></a></span></span><span> </span><span id="local-6989586621679558059"><span class="annot"><a href="#local-6989586621679558059"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span></span><span> </span><span id="local-6989586621679558058"><span class="annot"><a href="#local-6989586621679558058"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span></span><span> </span><span id="local-6989586621679558057"><span class="annot"><a href="#local-6989586621679558057"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679558056"><span class="annot"><a href="#local-6989586621679558056"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679558055"><span class="annot"><a href="#local-6989586621679558055"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | encoder-decoder model</span><span>
</span><span id="line-338"></span><span>      </span><span id="sedtModel"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; model
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtModel"><span class="hs-identifier hs-var hs-var">sedtModel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558061"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-339"></span><span>      </span><span class="hs-comment">-- | shift for decoder input</span><span>
</span><span id="line-340"></span><span>      </span><span id="sedtDecoderInputShift"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtDecoderInputShift"><span class="hs-identifier hs-var hs-var">sedtDecoderInputShift</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-341"></span><span>      </span><span class="hs-comment">-- | shift for padding mask</span><span>
</span><span id="line-342"></span><span>      </span><span id="sedtPaddingMaskShift"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtPaddingMaskShift"><span class="hs-identifier hs-var hs-var">sedtPaddingMaskShift</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span>
</span><span id="line-343"></span><span>      </span><span class="hs-comment">-- | make encoder input positions</span><span>
</span><span id="line-344"></span><span>      </span><span id="sedtMkPos"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkPos"><span class="hs-identifier hs-var hs-var">sedtMkPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558060"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-345"></span><span>      </span><span class="hs-comment">-- | make decoder input position</span><span>
</span><span id="line-346"></span><span>      </span><span id="sedtMkDecoderPos"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkDecoderPos"><span class="hs-identifier hs-var hs-var">sedtMkDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558059"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-347"></span><span>      </span><span class="hs-comment">-- | make padding mask</span><span>
</span><span id="line-348"></span><span>      </span><span id="sedtMkPaddingMask"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkPaddingMask"><span class="hs-identifier hs-var hs-var">sedtMkPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558058"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-349"></span><span>      </span><span class="hs-comment">-- | make attention mask</span><span>
</span><span id="line-350"></span><span>      </span><span id="sedtMkAttentionMask"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkAttentionMask"><span class="hs-identifier hs-var hs-var">sedtMkAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558057"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-351"></span><span>      </span><span class="hs-comment">-- | make cross-attention mask</span><span>
</span><span id="line-352"></span><span>      </span><span id="sedtMkCrossAttentionMask"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkCrossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkCrossAttentionMask"><span class="hs-identifier hs-var hs-var">sedtMkCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558056"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-353"></span><span>      </span><span class="hs-comment">-- | make decoder attention mask</span><span>
</span><span id="line-354"></span><span>      </span><span id="sedtMkDecoderAttentionMask"><span class="annot"><span class="annottext">GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtMkDecoderAttentionMask"><span class="hs-identifier hs-var hs-var">sedtMkDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679558055"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558061"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558060"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558059"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558058"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558057"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558056"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679558055"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-359"></span><span>  </span><span id="ModelSpec"><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-var">ModelSpec</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span id="local-6989586621679557523"><span class="annot"><a href="#local-6989586621679557523"><span class="hs-identifier hs-type hs-type">model</span></a></span></span><span> </span><span id="local-6989586621679557522"><span class="annot"><a href="#local-6989586621679557522"><span class="hs-identifier hs-type hs-type">mkPos</span></a></span></span><span> </span><span id="local-6989586621679557521"><span class="annot"><a href="#local-6989586621679557521"><span class="hs-identifier hs-type hs-type">mkDecoderPos</span></a></span></span><span> </span><span id="local-6989586621679557520"><span class="annot"><a href="#local-6989586621679557520"><span class="hs-identifier hs-type hs-type">mkPaddingMask</span></a></span></span><span> </span><span id="local-6989586621679557519"><span class="annot"><a href="#local-6989586621679557519"><span class="hs-identifier hs-type hs-type">mkAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679557518"><span class="annot"><a href="#local-6989586621679557518"><span class="hs-identifier hs-type hs-type">mkCrossAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679557517"><span class="annot"><a href="#local-6989586621679557517"><span class="hs-identifier hs-type hs-type">mkDecoderAttentionMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557523"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557522"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557521"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557520"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557519"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557518"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#ModelSpec"><span class="hs-identifier hs-type">ModelSpec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557517"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span id="local-6989586621679557509"><span id="local-6989586621679557510"><span id="local-6989586621679557511"><span id="local-6989586621679557512"><span id="local-6989586621679557513"><span id="local-6989586621679557514"><span id="local-6989586621679557515"><span id="local-6989586621679557516"><span class="hs-keyword">instance</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-364"></span><span>      </span><span class="annot"><a href="#local-6989586621679557516"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-365"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-366"></span><span>      </span><span class="annot"><a href="#local-6989586621679557516"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-367"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-369"></span><span>      </span><span class="annot"><a href="#local-6989586621679557514"><span class="hs-identifier hs-type">mkPos</span></a></span><span>
</span><span id="line-370"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-371"></span><span>      </span><span class="annot"><a href="#local-6989586621679557514"><span class="hs-identifier hs-type">mkPos</span></a></span><span>
</span><span id="line-372"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-373"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-374"></span><span>      </span><span class="annot"><a href="#local-6989586621679557513"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span>
</span><span id="line-375"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-376"></span><span>      </span><span class="annot"><a href="#local-6989586621679557513"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span>
</span><span id="line-377"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-379"></span><span>      </span><span class="annot"><a href="#local-6989586621679557512"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-381"></span><span>      </span><span class="annot"><a href="#local-6989586621679557512"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-382"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-383"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-384"></span><span>      </span><span class="annot"><a href="#local-6989586621679557511"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span>
</span><span id="line-385"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><a href="#local-6989586621679557511"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span>
</span><span id="line-387"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-388"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-389"></span><span>      </span><span class="annot"><a href="#local-6989586621679557510"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span>
</span><span id="line-390"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-391"></span><span>      </span><span class="annot"><a href="#local-6989586621679557510"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span>
</span><span id="line-392"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-393"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-394"></span><span>      </span><span class="annot"><a href="#local-6989586621679557509"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-395"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-396"></span><span>      </span><span class="annot"><a href="#local-6989586621679557509"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-397"></span><span>      </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasInitialize"><span class="hs-identifier hs-type">HasInitialize</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557516"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557514"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557513"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557512"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557511"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557510"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557509"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557516"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557514"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557513"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557512"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557511"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557510"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557509"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><a href="#local-6989586621679557515"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-404"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-405"></span><span>  </span><span id="local-6989586621679557507"><span class="annot"><span class="annottext">initialize :: ModelSpec
  (GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask)
-&gt; Generator generatorDevice
-&gt; m (GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask,
      Generator generatorDevice)
</span><a href="#local-6989586621679557507"><span class="hs-identifier hs-var hs-var hs-var hs-var">initialize</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span id="local-6989586621679557506"><span class="annot"><a href="#local-6989586621679557506"><span class="hs-identifier hs-var">modelSpec</span></a></span></span><span> </span><span id="local-6989586621679557505"><span class="annot"><a href="#local-6989586621679557505"><span class="hs-identifier hs-var">decoderInputShiftSpec</span></a></span></span><span> </span><span id="local-6989586621679557504"><span class="annot"><a href="#local-6989586621679557504"><span class="hs-identifier hs-var">paddingMaskShiftSpec</span></a></span></span><span> </span><span id="local-6989586621679557503"><span class="annot"><a href="#local-6989586621679557503"><span class="hs-identifier hs-var">mkPosSpec</span></a></span></span><span> </span><span id="local-6989586621679557502"><span class="annot"><a href="#local-6989586621679557502"><span class="hs-identifier hs-var">mkDecoderPosSpec</span></a></span></span><span> </span><span id="local-6989586621679557501"><span class="annot"><a href="#local-6989586621679557501"><span class="hs-identifier hs-var">mkPaddingMaskSpec</span></a></span></span><span> </span><span id="local-6989586621679557500"><span class="annot"><a href="#local-6989586621679557500"><span class="hs-identifier hs-var">mkAttentionMaskSpec</span></a></span></span><span> </span><span id="local-6989586621679557499"><span class="annot"><a href="#local-6989586621679557499"><span class="hs-identifier hs-var">mkCrossAttentionMaskSpec</span></a></span></span><span> </span><span id="local-6989586621679557498"><span class="annot"><a href="#local-6989586621679557498"><span class="hs-identifier hs-var">mkDecoderAttentionMaskSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-406"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask)
-&gt; Generator generatorDevice
-&gt; m (GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask,
      Generator generatorDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span>
</span><span id="line-407"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-408"></span><span>          </span><span class="annot"><span class="annottext">(model
 -&gt; ShiftRight Int
 -&gt; ShiftRight Int
 -&gt; mkPos
 -&gt; mkDecoderPos
 -&gt; mkPaddingMask
 -&gt; mkAttentionMask
 -&gt; mkCrossAttentionMask
 -&gt; mkDecoderAttentionMask
 -&gt; GSimplifiedEncoderDecoderTransformer
      model
      mkPos
      mkDecoderPos
      mkPaddingMask
      mkAttentionMask
      mkCrossAttentionMask
      mkDecoderAttentionMask)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) model
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int
      -&gt; ShiftRight Int
      -&gt; mkPos
      -&gt; mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice -&gt; m (model, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) model
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (model, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) model)
-&gt; (ModelSpec model
    -&gt; Generator generatorDevice
    -&gt; m (model, Generator generatorDevice))
-&gt; ModelSpec model
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) model
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (model, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec model
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) model)
-&gt; ModelSpec model
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) model
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec model
</span><a href="#local-6989586621679557506"><span class="hs-identifier hs-var">modelSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (ShiftRight Int
   -&gt; ShiftRight Int
   -&gt; mkPos
   -&gt; mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int
      -&gt; mkPos
      -&gt; mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (ShiftRight Int, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (ShiftRight Int, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (ShiftRight Int))
-&gt; (ShiftRight Int
    -&gt; Generator generatorDevice
    -&gt; m (ShiftRight Int, Generator generatorDevice))
-&gt; ShiftRight Int
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
-&gt; Generator generatorDevice
-&gt; m (ShiftRight Int, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ShiftRight Int
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (ShiftRight Int))
-&gt; ShiftRight Int
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557505"><span class="hs-identifier hs-var">decoderInputShiftSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-410"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (ShiftRight Int
   -&gt; mkPos
   -&gt; mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (mkPos
      -&gt; mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (ShiftRight Int, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (ShiftRight Int, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (ShiftRight Int))
-&gt; (ShiftRight Int
    -&gt; Generator generatorDevice
    -&gt; m (ShiftRight Int, Generator generatorDevice))
-&gt; ShiftRight Int
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
-&gt; Generator generatorDevice
-&gt; m (ShiftRight Int, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ShiftRight Int
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      (ShiftRight Int))
-&gt; ShiftRight Int
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (ShiftRight Int)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557504"><span class="hs-identifier hs-var">paddingMaskShiftSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (mkPos
   -&gt; mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) mkPos
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice -&gt; m (mkPos, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) mkPos
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (mkPos, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) mkPos)
-&gt; (ModelSpec mkPos
    -&gt; Generator generatorDevice
    -&gt; m (mkPos, Generator generatorDevice))
-&gt; ModelSpec mkPos
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) mkPos
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPos
-&gt; Generator generatorDevice
-&gt; m (mkPos, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec mkPos
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) mkPos)
-&gt; ModelSpec mkPos
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) mkPos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPos
</span><a href="#local-6989586621679557503"><span class="hs-identifier hs-var">mkPosSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderPos
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (mkDecoderPos, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderPos
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (mkDecoderPos, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkDecoderPos)
-&gt; (ModelSpec mkDecoderPos
    -&gt; Generator generatorDevice
    -&gt; m (mkDecoderPos, Generator generatorDevice))
-&gt; ModelSpec mkDecoderPos
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderPos
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderPos
-&gt; Generator generatorDevice
-&gt; m (mkDecoderPos, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec mkDecoderPos
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkDecoderPos)
-&gt; ModelSpec mkDecoderPos
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderPos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderPos
</span><a href="#local-6989586621679557502"><span class="hs-identifier hs-var">mkDecoderPosSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (mkPaddingMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkPaddingMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (mkPaddingMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkPaddingMask)
-&gt; (ModelSpec mkPaddingMask
    -&gt; Generator generatorDevice
    -&gt; m (mkPaddingMask, Generator generatorDevice))
-&gt; ModelSpec mkPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkPaddingMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPaddingMask
-&gt; Generator generatorDevice
-&gt; m (mkPaddingMask, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec mkPaddingMask
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkPaddingMask)
-&gt; ModelSpec mkPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkPaddingMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPaddingMask
</span><a href="#local-6989586621679557501"><span class="hs-identifier hs-var">mkPaddingMaskSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-414"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (mkAttentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkAttentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (mkAttentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkAttentionMask)
-&gt; (ModelSpec mkAttentionMask
    -&gt; Generator generatorDevice
    -&gt; m (mkAttentionMask, Generator generatorDevice))
-&gt; ModelSpec mkAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkAttentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkAttentionMask
-&gt; Generator generatorDevice
-&gt; m (mkAttentionMask, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec mkAttentionMask
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkAttentionMask)
-&gt; ModelSpec mkAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkAttentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkAttentionMask
</span><a href="#local-6989586621679557500"><span class="hs-identifier hs-var">mkAttentionMaskSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkCrossAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (mkCrossAttentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkCrossAttentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (mkCrossAttentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkCrossAttentionMask)
-&gt; (ModelSpec mkCrossAttentionMask
    -&gt; Generator generatorDevice
    -&gt; m (mkCrossAttentionMask, Generator generatorDevice))
-&gt; ModelSpec mkCrossAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkCrossAttentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkCrossAttentionMask
-&gt; Generator generatorDevice
-&gt; m (mkCrossAttentionMask, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec mkCrossAttentionMask
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkCrossAttentionMask)
-&gt; ModelSpec mkCrossAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkCrossAttentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkCrossAttentionMask
</span><a href="#local-6989586621679557499"><span class="hs-identifier hs-var">mkCrossAttentionMaskSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>          </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (mkDecoderAttentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderAttentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (mkDecoderAttentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkDecoderAttentionMask)
-&gt; (ModelSpec mkDecoderAttentionMask
    -&gt; Generator generatorDevice
    -&gt; m (mkDecoderAttentionMask, Generator generatorDevice))
-&gt; ModelSpec mkDecoderAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderAttentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderAttentionMask
-&gt; Generator generatorDevice
-&gt; m (mkDecoderAttentionMask, Generator generatorDevice)
forall model (generatorDevice :: Device (DeviceType Nat)) output
       (generatorOutputDevice :: Device (DeviceType Nat)) (m :: * -&gt; *).
(HasInitialize model generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
ModelSpec model
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#initialize"><span class="hs-identifier hs-var">initialize</span></a></span><span> </span><span class="annot"><span class="annottext">(ModelSpec mkDecoderAttentionMask
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      mkDecoderAttentionMask)
-&gt; ModelSpec mkDecoderAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     mkDecoderAttentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderAttentionMask
</span><a href="#local-6989586621679557498"><span class="hs-identifier hs-var">mkDecoderAttentionMaskSpec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-417"></span><span>      </span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-418"></span><span>
</span><span id="line-419"></span><span id="local-6989586621679557491"><span id="local-6989586621679557492"><span id="local-6989586621679557493"><span id="local-6989586621679557494"><span id="local-6989586621679557495"><span id="local-6989586621679557496"><span id="local-6989586621679557497"><span class="hs-keyword">instance</span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557497"><span class="hs-identifier hs-type">model</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557496"><span class="hs-identifier hs-type">mkPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557495"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-423"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557494"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-424"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557493"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-425"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557492"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-426"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557491"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-427"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-428"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasStateDict"><span class="hs-identifier hs-type">HasStateDict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557497"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557496"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557495"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557494"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557493"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557492"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557491"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-430"></span><span>  </span><span id="local-6989586621679557488"><span class="annot"><span class="annottext">fromStateDict :: ModelSpec
  (GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask)
-&gt; Text
-&gt; m (GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
</span><a href="#local-6989586621679557488"><span class="hs-identifier hs-var hs-var hs-var hs-var">fromStateDict</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span id="local-6989586621679557487"><span class="annot"><a href="#local-6989586621679557487"><span class="hs-identifier hs-var">modelSpec</span></a></span></span><span> </span><span id="local-6989586621679557486"><span class="annot"><a href="#local-6989586621679557486"><span class="hs-identifier hs-var">decoderInputShiftSpec</span></a></span></span><span> </span><span id="local-6989586621679557485"><span class="annot"><a href="#local-6989586621679557485"><span class="hs-identifier hs-var">paddingMaskShiftSpec</span></a></span></span><span> </span><span id="local-6989586621679557484"><span class="annot"><a href="#local-6989586621679557484"><span class="hs-identifier hs-var">mkPosSpec</span></a></span></span><span> </span><span id="local-6989586621679557483"><span class="annot"><a href="#local-6989586621679557483"><span class="hs-identifier hs-var">mkDecoderPosSpec</span></a></span></span><span> </span><span id="local-6989586621679557482"><span class="annot"><a href="#local-6989586621679557482"><span class="hs-identifier hs-var">mkPaddingMaskSpec</span></a></span></span><span> </span><span id="local-6989586621679557481"><span class="annot"><a href="#local-6989586621679557481"><span class="hs-identifier hs-var">mkAttentionMaskSpec</span></a></span></span><span> </span><span id="local-6989586621679557480"><span class="annot"><a href="#local-6989586621679557480"><span class="hs-identifier hs-var">mkCrossAttentionMaskSpec</span></a></span></span><span> </span><span id="local-6989586621679557479"><span class="annot"><a href="#local-6989586621679557479"><span class="hs-identifier hs-var">mkDecoderAttentionMaskSpec</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679557478"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><span class="annottext">model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
model
-&gt; ShiftRight Int
-&gt; ShiftRight Int
-&gt; mkPos
-&gt; mkDecoderPos
-&gt; mkPaddingMask
-&gt; mkAttentionMask
-&gt; mkCrossAttentionMask
-&gt; mkDecoderAttentionMask
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-var">GSimplifiedEncoderDecoderTransformer</span></a></span><span>
</span><span id="line-432"></span><span>      </span><span class="annot"><span class="annottext">(model
 -&gt; ShiftRight Int
 -&gt; ShiftRight Int
 -&gt; mkPos
 -&gt; mkDecoderPos
 -&gt; mkPaddingMask
 -&gt; mkAttentionMask
 -&gt; mkCrossAttentionMask
 -&gt; mkDecoderAttentionMask
 -&gt; GSimplifiedEncoderDecoderTransformer
      model
      mkPos
      mkDecoderPos
      mkPaddingMask
      mkAttentionMask
      mkCrossAttentionMask
      mkDecoderAttentionMask)
-&gt; m model
-&gt; m (ShiftRight Int
      -&gt; ShiftRight Int
      -&gt; mkPos
      -&gt; mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec model -&gt; Text -&gt; m model
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec model
</span><a href="#local-6989586621679557487"><span class="hs-identifier hs-var">modelSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-433"></span><span>      </span><span class="annot"><span class="annottext">m (ShiftRight Int
   -&gt; ShiftRight Int
   -&gt; mkPos
   -&gt; mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m (ShiftRight Int)
-&gt; m (ShiftRight Int
      -&gt; mkPos
      -&gt; mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec (ShiftRight Int) -&gt; Text -&gt; m (ShiftRight Int)
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec (ShiftRight Int)
ShiftRight Int
</span><a href="#local-6989586621679557486"><span class="hs-identifier hs-var">decoderInputShiftSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-434"></span><span>      </span><span class="annot"><span class="annottext">m (ShiftRight Int
   -&gt; mkPos
   -&gt; mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m (ShiftRight Int)
-&gt; m (mkPos
      -&gt; mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec (ShiftRight Int) -&gt; Text -&gt; m (ShiftRight Int)
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec (ShiftRight Int)
ShiftRight Int
</span><a href="#local-6989586621679557485"><span class="hs-identifier hs-var">paddingMaskShiftSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-435"></span><span>      </span><span class="annot"><span class="annottext">m (mkPos
   -&gt; mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m mkPos
-&gt; m (mkDecoderPos
      -&gt; mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPos -&gt; Text -&gt; m mkPos
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPos
</span><a href="#local-6989586621679557484"><span class="hs-identifier hs-var">mkPosSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-436"></span><span>      </span><span class="annot"><span class="annottext">m (mkDecoderPos
   -&gt; mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m mkDecoderPos
-&gt; m (mkPaddingMask
      -&gt; mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderPos -&gt; Text -&gt; m mkDecoderPos
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderPos
</span><a href="#local-6989586621679557483"><span class="hs-identifier hs-var">mkDecoderPosSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-437"></span><span>      </span><span class="annot"><span class="annottext">m (mkPaddingMask
   -&gt; mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m mkPaddingMask
-&gt; m (mkAttentionMask
      -&gt; mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPaddingMask -&gt; Text -&gt; m mkPaddingMask
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkPaddingMask
</span><a href="#local-6989586621679557482"><span class="hs-identifier hs-var">mkPaddingMaskSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-438"></span><span>      </span><span class="annot"><span class="annottext">m (mkAttentionMask
   -&gt; mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m mkAttentionMask
-&gt; m (mkCrossAttentionMask
      -&gt; mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkAttentionMask -&gt; Text -&gt; m mkAttentionMask
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkAttentionMask
</span><a href="#local-6989586621679557481"><span class="hs-identifier hs-var">mkAttentionMaskSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-439"></span><span>      </span><span class="annot"><span class="annottext">m (mkCrossAttentionMask
   -&gt; mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m mkCrossAttentionMask
-&gt; m (mkDecoderAttentionMask
      -&gt; GSimplifiedEncoderDecoderTransformer
           model
           mkPos
           mkDecoderPos
           mkPaddingMask
           mkAttentionMask
           mkCrossAttentionMask
           mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkCrossAttentionMask -&gt; Text -&gt; m mkCrossAttentionMask
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkCrossAttentionMask
</span><a href="#local-6989586621679557480"><span class="hs-identifier hs-var">mkCrossAttentionMaskSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="annottext">m (mkDecoderAttentionMask
   -&gt; GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
-&gt; m mkDecoderAttentionMask
-&gt; m (GSimplifiedEncoderDecoderTransformer
        model
        mkPos
        mkDecoderPos
        mkPaddingMask
        mkAttentionMask
        mkCrossAttentionMask
        mkDecoderAttentionMask)
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderAttentionMask
-&gt; Text -&gt; m mkDecoderAttentionMask
forall model (m :: * -&gt; *).
(HasStateDict model, MonadIO m, MonadThrow m,
 MonadState StateDict m) =&gt;
ModelSpec model -&gt; Text -&gt; m model
</span><a href="Torch.GraduallyTyped.NN.Class.html#fromStateDict"><span class="hs-identifier hs-var">fromStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">ModelSpec mkDecoderAttentionMask
</span><a href="#local-6989586621679557479"><span class="hs-identifier hs-var">mkDecoderAttentionMaskSpec</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-441"></span><span>  </span><span id="local-6989586621679557477"><span class="annot"><span class="annottext">toStateDict :: Text
-&gt; GSimplifiedEncoderDecoderTransformer
     model
     mkPos
     mkDecoderPos
     mkPaddingMask
     mkAttentionMask
     mkCrossAttentionMask
     mkDecoderAttentionMask
-&gt; m ()
</span><a href="#local-6989586621679557477"><span class="hs-identifier hs-var hs-var hs-var hs-var">toStateDict</span></a></span></span><span> </span><span id="local-6989586621679557476"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557467"><span id="local-6989586621679557468"><span id="local-6989586621679557469"><span id="local-6989586621679557470"><span id="local-6989586621679557471"><span id="local-6989586621679557472"><span id="local-6989586621679557473"><span id="local-6989586621679557474"><span id="local-6989586621679557475"><span class="annot"><span class="annottext">model
mkPos
mkDecoderPos
mkPaddingMask
mkAttentionMask
mkCrossAttentionMask
mkDecoderAttentionMask
ShiftRight Int
sedtMkDecoderAttentionMask :: mkDecoderAttentionMask
sedtMkCrossAttentionMask :: mkCrossAttentionMask
sedtMkAttentionMask :: mkAttentionMask
sedtMkPaddingMask :: mkPaddingMask
sedtMkDecoderPos :: mkDecoderPos
sedtMkPos :: mkPos
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: model
sedtMkDecoderAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderAttentionMask
sedtMkCrossAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkCrossAttentionMask
sedtMkAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkAttentionMask
sedtMkPaddingMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPaddingMask
sedtMkDecoderPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderPos
sedtMkPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPos
sedtPaddingMaskShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtDecoderInputShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtModel :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; model
</span><a href="#local-6989586621679557467"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; model -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679557475"><span class="hs-identifier hs-var">sedtModel</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ShiftRight Int -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557474"><span class="hs-identifier hs-var">sedtDecoderInputShift</span></a></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; ShiftRight Int -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557473"><span class="hs-identifier hs-var">sedtPaddingMaskShift</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; mkPos -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mkPos
</span><a href="#local-6989586621679557472"><span class="hs-identifier hs-var">sedtMkPos</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; mkDecoderPos -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderPos
</span><a href="#local-6989586621679557471"><span class="hs-identifier hs-var">sedtMkDecoderPos</span></a></span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; mkPaddingMask -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
</span><a href="#local-6989586621679557470"><span class="hs-identifier hs-var">sedtMkPaddingMask</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; mkAttentionMask -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mkAttentionMask
</span><a href="#local-6989586621679557469"><span class="hs-identifier hs-var">sedtMkAttentionMask</span></a></span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; mkCrossAttentionMask -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mkCrossAttentionMask
</span><a href="#local-6989586621679557468"><span class="hs-identifier hs-var">sedtMkCrossAttentionMask</span></a></span><span>
</span><span id="line-450"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Text -&gt; mkDecoderAttentionMask -&gt; m ()
forall model (m :: * -&gt; *).
(HasStateDict model, MonadThrow m, MonadState StateDict m) =&gt;
Text -&gt; model -&gt; m ()
</span><a href="Torch.GraduallyTyped.NN.Class.html#toStateDict"><span class="hs-identifier hs-var">toStateDict</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679557476"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderAttentionMask
</span><a href="#local-6989586621679557467"><span class="hs-identifier hs-var">sedtMkDecoderAttentionMask</span></a></span><span>
</span><span id="line-451"></span><span>    </span><span class="annot"><span class="annottext">() -&gt; m ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | Input data type for use with an encoder-decoder transformer.</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- Use this for training.</span><span>
</span><span id="line-455"></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput</span></a></span></span><span> </span><span id="local-6989586621679557466"><span class="annot"><a href="#local-6989586621679557466"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679557465"><span class="annot"><a href="#local-6989586621679557465"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679557464"><span class="annot"><a href="#local-6989586621679557464"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679557463"><span class="annot"><a href="#local-6989586621679557463"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679557462"><span class="annot"><a href="#local-6989586621679557462"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span> </span><span id="local-6989586621679557461"><span class="annot"><a href="#local-6989586621679557461"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679557460"><span class="annot"><a href="#local-6989586621679557460"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-456"></span><span>  </span><span id="EncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679557880"><span class="annot"><a href="#local-6989586621679557880"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679557879"><span class="annot"><a href="#local-6989586621679557879"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679557878"><span class="annot"><a href="#local-6989586621679557878"><span class="hs-identifier hs-type">pos</span></a></span></span><span> </span><span id="local-6989586621679557877"><span class="annot"><a href="#local-6989586621679557877"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679557876"><span class="annot"><a href="#local-6989586621679557876"><span class="hs-identifier hs-type">attentionMask</span></a></span></span><span> </span><span id="local-6989586621679557875"><span class="annot"><a href="#local-6989586621679557875"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679557874"><span class="annot"><a href="#local-6989586621679557874"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-458"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtInput"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtInput"><span class="hs-identifier hs-var hs-var">edtInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557880"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-459"></span><span>      </span><span id="edtDecoderInput"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderInput"><span class="hs-identifier hs-var hs-var">edtDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557879"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-460"></span><span>      </span><span id="edtPos"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; pos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtPos"><span class="hs-identifier hs-var hs-var">edtPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557878"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-461"></span><span>      </span><span id="edtDecoderPos"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderPos"><span class="hs-identifier hs-var hs-var">edtDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557877"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-462"></span><span>      </span><span id="edtAttentionMask"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; attentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtAttentionMask"><span class="hs-identifier hs-var hs-var">edtAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557876"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-463"></span><span>      </span><span id="edtDecoderAttentionMask"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderAttentionMask"><span class="hs-identifier hs-var hs-var">edtDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557875"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-464"></span><span>      </span><span id="edtCrossAttentionMask"><span class="annot"><span class="annottext">EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtCrossAttentionMask"><span class="hs-identifier hs-var hs-var">edtCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557874"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-465"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-466"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557880"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557879"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557878"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557877"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557876"><span class="hs-identifier hs-type">attentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557875"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557874"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span id="local-6989586621679557439"><span id="local-6989586621679557441"><span id="local-6989586621679557443"><span id="local-6989586621679557445"><span id="local-6989586621679557446"><span id="local-6989586621679557447"><span id="local-6989586621679557448"><span id="local-6989586621679557449"><span id="local-6989586621679557450"><span id="local-6989586621679557451"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557451"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-470"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557450"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557449"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-472"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557448"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-473"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557447"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-474"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557446"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557445"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-476"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-477"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557451"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557450"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557449"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557448"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557447"><span class="hs-identifier hs-type">attentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557446"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557445"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-478"></span><span>
</span><span id="line-479"></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput</span></a></span></span><span> </span><span id="local-6989586621679557437"><span class="annot"><a href="#local-6989586621679557437"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679557436"><span class="annot"><a href="#local-6989586621679557436"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-480"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679557789"><span class="annot"><a href="#local-6989586621679557789"><span class="hs-identifier hs-type">input</span></a></span></span><span> </span><span id="local-6989586621679557788"><span class="annot"><a href="#local-6989586621679557788"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtInput"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; input
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInput"><span class="hs-identifier hs-var hs-var">sedtInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557789"><span class="hs-identifier hs-type">input</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-483"></span><span>      </span><span id="sedtDecoderInput"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtDecoderInput"><span class="hs-identifier hs-var hs-var">sedtDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557788"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-484"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-485"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557789"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557788"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-comment">-- | Output data type for use with an encoder-decoder transformer.</span><span>
</span><span id="line-488"></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput</span></a></span></span><span> </span><span id="local-6989586621679557432"><span class="annot"><a href="#local-6989586621679557432"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557431"><span class="annot"><a href="#local-6989586621679557431"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-489"></span><span>  </span><span id="EncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679557842"><span class="annot"><a href="#local-6989586621679557842"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557841"><span class="annot"><a href="#local-6989586621679557841"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-491"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtDecoderOutput"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; decoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtDecoderOutput"><span class="hs-identifier hs-var hs-var">edtDecoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557842"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-492"></span><span>      </span><span id="edtEncoderOutput"><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput decoderOutput encoderOutput
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtEncoderOutput"><span class="hs-identifier hs-var hs-var">edtEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557841"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-493"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-494"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557842"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557841"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span id="local-6989586621679557420"><span id="local-6989586621679557422"><span id="local-6989586621679557424"><span id="local-6989586621679557426"><span id="local-6989586621679557427"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-497"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557427"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-498"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557426"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-499"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-500"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557427"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557426"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span>
</span><span id="line-501"></span><span>
</span><span id="line-502"></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput</span></a></span></span><span> </span><span id="local-6989586621679557419"><span class="annot"><a href="#local-6989586621679557419"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557418"><span class="annot"><a href="#local-6989586621679557418"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557417"><span class="annot"><a href="#local-6989586621679557417"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-503"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerOutput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679557783"><span class="annot"><a href="#local-6989586621679557783"><span class="hs-identifier hs-type">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557782"><span class="annot"><a href="#local-6989586621679557782"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557781"><span class="annot"><a href="#local-6989586621679557781"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtDecoderOutput"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput inputPaddingMask
-&gt; decoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtDecoderOutput"><span class="hs-identifier hs-var hs-var">sedtDecoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557783"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-506"></span><span>      </span><span id="sedtEncoderOutput"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput inputPaddingMask
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtEncoderOutput"><span class="hs-identifier hs-var hs-var">sedtEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557782"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-507"></span><span>      </span><span id="sedtInputPaddingMask"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput inputPaddingMask
-&gt; inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtInputPaddingMask"><span class="hs-identifier hs-var hs-var">sedtInputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557781"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-508"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-509"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557783"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557782"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557781"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="hs-comment">-- | Input data type for use with an encoder-decoder transformer.</span><span>
</span><span id="line-512"></span><span class="hs-comment">-- Use this for inference.</span><span>
</span><span id="line-513"></span><span class="hs-keyword">data</span><span> </span><span id="EncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span id="local-6989586621679557412"><span class="annot"><a href="#local-6989586621679557412"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679557411"><span class="annot"><a href="#local-6989586621679557411"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557410"><span class="annot"><a href="#local-6989586621679557410"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679557409"><span class="annot"><a href="#local-6989586621679557409"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679557408"><span class="annot"><a href="#local-6989586621679557408"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-514"></span><span>  </span><span id="EncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-515"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679557817"><span class="annot"><a href="#local-6989586621679557817"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679557816"><span class="annot"><a href="#local-6989586621679557816"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557815"><span class="annot"><a href="#local-6989586621679557815"><span class="hs-identifier hs-type">decoderPos</span></a></span></span><span> </span><span id="local-6989586621679557814"><span class="annot"><a href="#local-6989586621679557814"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span></span><span> </span><span id="local-6989586621679557813"><span class="annot"><a href="#local-6989586621679557813"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-516"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="edtGenerationDecoderInput"><span class="annot"><span class="annottext">EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderInput"><span class="hs-identifier hs-var hs-var">edtGenerationDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557817"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-517"></span><span>      </span><span id="edtGenerationEncoderOutput"><span class="annot"><span class="annottext">EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationEncoderOutput"><span class="hs-identifier hs-var hs-var">edtGenerationEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557816"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-518"></span><span>      </span><span id="edtGenerationDecoderPos"><span class="annot"><span class="annottext">EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderPos"><span class="hs-identifier hs-var hs-var">edtGenerationDecoderPos</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557815"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-519"></span><span>      </span><span id="edtGenerationDecoderAttentionMask"><span class="annot"><span class="annottext">EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationDecoderAttentionMask"><span class="hs-identifier hs-var hs-var">edtGenerationDecoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557814"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-520"></span><span>      </span><span id="edtGenerationCrossAttentionMask"><span class="annot"><span class="annottext">EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#edtGenerationCrossAttentionMask"><span class="hs-identifier hs-var hs-var">edtGenerationCrossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557813"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-521"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-522"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557817"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557816"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557815"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557814"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557813"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span id="local-6989586621679557391"><span id="local-6989586621679557393"><span id="local-6989586621679557395"><span id="local-6989586621679557397"><span id="local-6989586621679557398"><span id="local-6989586621679557399"><span id="local-6989586621679557400"><span id="local-6989586621679557401"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span>
</span><span id="line-525"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557401"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-526"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557400"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557399"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-528"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557398"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-529"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679557397"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-530"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-531"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557401"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557400"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557399"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557398"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557397"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-532"></span><span>
</span><span id="line-533"></span><span class="hs-keyword">data</span><span> </span><span id="SimplifiedEncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span id="local-6989586621679557390"><span class="annot"><a href="#local-6989586621679557390"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679557389"><span class="annot"><a href="#local-6989586621679557389"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557388"><span class="annot"><a href="#local-6989586621679557388"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-534"></span><span>  </span><span id="SimplifiedEncoderDecoderTransformerGenerationInput"><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679557760"><span class="annot"><a href="#local-6989586621679557760"><span class="hs-identifier hs-type">decoderInput</span></a></span></span><span> </span><span id="local-6989586621679557759"><span class="annot"><a href="#local-6989586621679557759"><span class="hs-identifier hs-type">encoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557758"><span class="annot"><a href="#local-6989586621679557758"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="sedtGenerationDecoderInput"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; decoderInput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationDecoderInput"><span class="hs-identifier hs-var hs-var">sedtGenerationDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557760"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-537"></span><span>      </span><span id="sedtGenerationEncoderOutput"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationEncoderOutput"><span class="hs-identifier hs-var hs-var">sedtGenerationEncoderOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557759"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-538"></span><span>      </span><span id="sedtGenerationInputPaddingMask"><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#sedtGenerationInputPaddingMask"><span class="hs-identifier hs-var hs-var">sedtGenerationInputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679557758"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-540"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557760"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557759"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557758"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-541"></span><span>
</span><span id="line-542"></span><span class="hs-comment">-- | 'HasForward' instance for encoder-decoder transformers with optional head.</span><span>
</span><span id="line-543"></span><span class="hs-comment">--</span><span>
</span><span id="line-544"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-545"></span><span class="hs-comment">--     &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-546"></span><span class="hs-comment">--     &#9474; input &#9474;  &#9474; pos &#9474;  &#9474; attentionMask &#9474;  &#9474; decoderInput &#9474;  &#9474; decoderPos &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-547"></span><span class="hs-comment">--     &#9492;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9516;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-548"></span><span class="hs-comment">--         &#9474;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-549"></span><span class="hs-comment">--         &#9660;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- edtSharedEmbedding&#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-551"></span><span class="hs-comment">--         &#9660;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-552"></span><span class="hs-comment">--   (embedScaling)  &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-553"></span><span class="hs-comment">--         &#9660;         &#9474;            &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-554"></span><span class="hs-comment">--     edtEncoder&#9668;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-555"></span><span class="hs-comment">--         &#9474;                                 edtSharedEmbedding       &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-556"></span><span class="hs-comment">--         &#9474;                                         &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-557"></span><span class="hs-comment">--         &#9474;                                   (embedScaling)         &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-558"></span><span class="hs-comment">--         &#9474;                                         &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-559"></span><span class="hs-comment">--         &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;edtDecoder&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-560"></span><span class="hs-comment">--         &#9474;                                         &#9660;</span><span>
</span><span id="line-561"></span><span class="hs-comment">--         &#9474;                                     (edtHead)</span><span>
</span><span id="line-562"></span><span class="hs-comment">--         &#9474;                                         &#9474;</span><span>
</span><span id="line-563"></span><span class="hs-comment">--         &#9660;                                         &#9660;</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;                         &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-565"></span><span class="hs-comment">-- &#9474; encoderOutput &#9474;                         &#9474; decoderOutput &#9474;</span><span>
</span><span id="line-566"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;                         &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-567"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-568"></span><span id="local-6989586621679557351"><span id="local-6989586621679557352"><span id="local-6989586621679557353"><span id="local-6989586621679557354"><span id="local-6989586621679557355"><span id="local-6989586621679557356"><span id="local-6989586621679557357"><span id="local-6989586621679557358"><span id="local-6989586621679557359"><span id="local-6989586621679557360"><span id="local-6989586621679557361"><span id="local-6989586621679557362"><span id="local-6989586621679557363"><span id="local-6989586621679557364"><span id="local-6989586621679557365"><span id="local-6989586621679557366"><span id="local-6989586621679557367"><span id="local-6989586621679557368"><span id="local-6989586621679557369"><span id="local-6989586621679557370"><span id="local-6989586621679557371"><span id="local-6989586621679557372"><span id="local-6989586621679557373"><span id="local-6989586621679557374"><span id="local-6989586621679557375"><span id="local-6989586621679557376"><span id="local-6989586621679557377"><span id="local-6989586621679557378"><span id="local-6989586621679557379"><span id="local-6989586621679557380"><span id="local-6989586621679557381"><span id="local-6989586621679557382"><span id="local-6989586621679557383"><span class="hs-keyword">instance</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-570"></span><span>      </span><span class="annot"><a href="#local-6989586621679557383"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span>
</span><span id="line-571"></span><span>      </span><span class="annot"><a href="#local-6989586621679557382"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-572"></span><span>      </span><span class="annot"><a href="#local-6989586621679557381"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-573"></span><span>      </span><span class="annot"><a href="#local-6989586621679557380"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span>
</span><span id="line-574"></span><span>      </span><span class="annot"><a href="#local-6989586621679557379"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><a href="#local-6989586621679557380"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557378"><span class="hs-identifier hs-type">requiresGradient'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557377"><span class="hs-identifier hs-type">layout'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557376"><span class="hs-identifier hs-type">device'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557375"><span class="hs-identifier hs-type">dataType'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557374"><span class="hs-identifier hs-type">shape'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span class="annot"><a href="#local-6989586621679557373"><span class="hs-identifier hs-type">encoder</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679557380"><span class="hs-identifier hs-type">embeddingOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679557372"><span class="hs-identifier hs-type">pos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679557371"><span class="hs-identifier hs-type">attentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>      </span><span class="annot"><a href="#local-6989586621679557379"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice</span></a></span><span>
</span><span id="line-580"></span><span>      </span><span class="annot"><a href="#local-6989586621679557370"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><a href="#local-6989586621679557369"><span class="hs-identifier hs-type">encoderGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-583"></span><span>      </span><span class="annot"><a href="#local-6989586621679557383"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span>
</span><span id="line-584"></span><span>      </span><span class="annot"><a href="#local-6989586621679557368"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-585"></span><span>      </span><span class="annot"><a href="#local-6989586621679557369"><span class="hs-identifier hs-type">encoderGeneratorOutputDevice</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><a href="#local-6989586621679557367"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span>
</span><span id="line-587"></span><span>      </span><span class="annot"><a href="#local-6989586621679557366"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-588"></span><span>    </span><span class="annot"><a href="#local-6989586621679557367"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557365"><span class="hs-identifier hs-type">requiresGradient''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557364"><span class="hs-identifier hs-type">layout''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557363"><span class="hs-identifier hs-type">device''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557362"><span class="hs-identifier hs-type">dataType''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557361"><span class="hs-identifier hs-type">shape''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-589"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-590"></span><span>      </span><span class="annot"><a href="#local-6989586621679557360"><span class="hs-identifier hs-type">decoder</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679557367"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-592"></span><span>        </span><span class="annot"><a href="#local-6989586621679557370"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-593"></span><span>        </span><span class="annot"><a href="#local-6989586621679557359"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-594"></span><span>        </span><span class="annot"><a href="#local-6989586621679557358"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-595"></span><span>        </span><span class="annot"><a href="#local-6989586621679557357"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-596"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-597"></span><span>      </span><span class="annot"><a href="#local-6989586621679557366"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice'</span></a></span><span>
</span><span id="line-598"></span><span>      </span><span class="annot"><a href="#local-6989586621679557356"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span>
</span><span id="line-599"></span><span>      </span><span class="annot"><a href="#local-6989586621679557355"><span class="hs-identifier hs-type">decoderGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-600"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-601"></span><span>      </span><span class="annot"><a href="#local-6989586621679557354"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><a href="#local-6989586621679557356"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span>
</span><span id="line-603"></span><span>      </span><span class="annot"><a href="#local-6989586621679557355"><span class="hs-identifier hs-type">decoderGeneratorOutputDevice</span></a></span><span>
</span><span id="line-604"></span><span>      </span><span class="annot"><a href="#local-6989586621679557353"><span class="hs-identifier hs-type">headOutput</span></a></span><span>
</span><span id="line-605"></span><span>      </span><span class="annot"><a href="#local-6989586621679557352"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-608"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557351"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557373"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557360"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557383"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557354"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-609"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557382"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557368"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557372"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557359"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557371"><span class="hs-identifier hs-type">attentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557358"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557357"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>    </span><span class="annot"><a href="#local-6989586621679557381"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557353"><span class="hs-identifier hs-type">headOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557370"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>    </span><span class="annot"><a href="#local-6989586621679557352"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-614"></span><span>  </span><span id="local-6989586621679557348"><span class="annot"><span class="annottext">forward :: GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557341"><span id="local-6989586621679557342"><span id="local-6989586621679557343"><span id="local-6989586621679557344"><span id="local-6989586621679557345"><span id="local-6989586621679557346"><span class="annot"><span class="annottext">sharedEmbedding
encoder
decoder
head
SDim inputEmbedDim
EncoderDecoderTransformerHasEmbedScaling
edtEmbedScaling :: EncoderDecoderTransformerHasEmbedScaling
edtHead :: head
edtSharedEmbedding :: sharedEmbedding
edtDecoder :: decoder
edtEncoder :: encoder
edtInputEmbedDim :: SDim inputEmbedDim
edtEmbedScaling :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerHasEmbedScaling
edtHead :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; head
edtSharedEmbedding :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; sharedEmbedding
edtDecoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; decoder
edtEncoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; encoder
edtInputEmbedDim :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="#local-6989586621679557341"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557334"><span id="local-6989586621679557335"><span id="local-6989586621679557336"><span id="local-6989586621679557337"><span id="local-6989586621679557338"><span id="local-6989586621679557339"><span id="local-6989586621679557340"><span class="annot"><span class="annottext">input
pos
attentionMask
decoderInput
decoderPos
decoderAttentionMask
crossAttentionMask
edtCrossAttentionMask :: crossAttentionMask
edtDecoderAttentionMask :: decoderAttentionMask
edtAttentionMask :: attentionMask
edtDecoderPos :: decoderPos
edtPos :: pos
edtDecoderInput :: decoderInput
edtInput :: input
edtCrossAttentionMask :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
edtDecoderAttentionMask :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
edtAttentionMask :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; attentionMask
edtDecoderPos :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
edtPos :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; pos
edtDecoderInput :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
edtInput :: forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
EncoderDecoderTransformerInput
  input
  decoderInput
  pos
  decoderPos
  attentionMask
  decoderAttentionMask
  crossAttentionMask
-&gt; input
</span><a href="#local-6989586621679557334"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-615"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557333"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557333"><span class="hs-identifier hs-var">scaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; (SDim inputEmbedDim -&gt; Double) -&gt; SDim inputEmbedDim -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Double)
-&gt; (SDim inputEmbedDim -&gt; Integer) -&gt; SDim inputEmbedDim -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IsChecked Integer -&gt; Integer
forall a. IsChecked a -&gt; a
</span><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier hs-var">forgetIsChecked</span></a></span><span> </span><span class="annot"><span class="annottext">(IsChecked Integer -&gt; Integer)
-&gt; (SDim inputEmbedDim -&gt; IsChecked Integer)
-&gt; SDim inputEmbedDim
-&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dim (IsChecked String) (IsChecked Integer) -&gt; IsChecked Integer
forall name size. Dim name size -&gt; size
</span><a href="Torch.GraduallyTyped.Shape.Type.html#dimSize"><span class="hs-identifier hs-var hs-var">dimSize</span></a></span><span> </span><span class="annot"><span class="annottext">(Dim (IsChecked String) (IsChecked Integer) -&gt; IsChecked Integer)
-&gt; (SDim inputEmbedDim
    -&gt; Dim (IsChecked String) (IsChecked Integer))
-&gt; SDim inputEmbedDim
-&gt; IsChecked Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim -&gt; Dim (IsChecked String) (IsChecked Integer)
forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">fromSing</span></a></span><span> </span><span class="annot"><span class="annottext">(SDim inputEmbedDim -&gt; Double) -&gt; SDim inputEmbedDim -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557346"><span class="hs-identifier hs-var">edtInputEmbedDim</span></a></span><span>
</span><span id="line-616"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (EncoderDecoderTransformerOutput headOutput encoderOutput)
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   (EncoderDecoderTransformerOutput headOutput encoderOutput)
 -&gt; Generator generatorDevice
 -&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput headOutput encoderOutput)
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-617"></span><span>          </span><span class="annot"><span class="annottext">input
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) input
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679557340"><span class="hs-identifier hs-var">edtInput</span></a></span><span>
</span><span id="line-618"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) input
-&gt; (input
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator embeddingGeneratorOutputDevice)
         (Tensor requiresGradient' layout' device' dataType' shape'))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice)
     (Tensor requiresGradient' layout' device' dataType' shape')
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor requiresGradient' layout' device' dataType' shape',
       Generator embeddingGeneratorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice)
     (Tensor requiresGradient' layout' device' dataType' shape')
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor requiresGradient' layout' device' dataType' shape',
        Generator embeddingGeneratorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator embeddingGeneratorOutputDevice)
      (Tensor requiresGradient' layout' device' dataType' shape'))
-&gt; (input
    -&gt; Generator generatorDevice
    -&gt; m (Tensor requiresGradient' layout' device' dataType' shape',
          Generator embeddingGeneratorOutputDevice))
-&gt; input
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice)
     (Tensor requiresGradient' layout' device' dataType' shape')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (Tensor requiresGradient' layout' device' dataType' shape',
      Generator embeddingGeneratorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
</span><a href="#local-6989586621679557343"><span class="hs-identifier hs-var">edtSharedEmbedding</span></a></span><span>
</span><span id="line-619"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator embeddingGeneratorOutputDevice)
  (Tensor requiresGradient' layout' device' dataType' shape')
-&gt; (Tensor requiresGradient' layout' device' dataType' shape'
    -&gt; IxStateT
         m
         (Generator embeddingGeneratorOutputDevice)
         (Generator embeddingGeneratorOutputDevice)
         (Tensor requiresGradient' layout' device' dataType' shape'))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice)
     (Tensor requiresGradient' layout' device' dataType' shape')
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient' layout' device' dataType' shape'
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice)
     (Generator embeddingGeneratorOutputDevice)
     (Tensor requiresGradient' layout' device' dataType' shape')
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span>
</span><span id="line-620"></span><span>              </span><span class="annot"><span class="annottext">(Tensor requiresGradient' layout' device' dataType' shape'
 -&gt; IxStateT
      m
      (Generator embeddingGeneratorOutputDevice)
      (Generator embeddingGeneratorOutputDevice)
      (Tensor requiresGradient' layout' device' dataType' shape'))
-&gt; (Tensor requiresGradient' layout' device' dataType' shape'
    -&gt; Tensor requiresGradient' layout' device' dataType' shape')
-&gt; Tensor requiresGradient' layout' device' dataType' shape'
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice)
     (Generator embeddingGeneratorOutputDevice)
     (Tensor requiresGradient' layout' device' dataType' shape')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-621"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient' layout' device' dataType' shape'
-&gt; Tensor requiresGradient' layout' device' dataType' shape'
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-622"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Tensor requiresGradient' layout' device' dataType' shape'
 -&gt; Double
 -&gt; Tensor requiresGradient' layout' device' dataType' shape')
-&gt; Double
-&gt; Tensor requiresGradient' layout' device' dataType' shape'
-&gt; Tensor requiresGradient' layout' device' dataType' shape'
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient' layout' device' dataType' shape'
-&gt; Double
-&gt; Tensor requiresGradient' layout' device' dataType' shape'
forall other (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
Scalar other =&gt;
Tensor gradient layout device dataType shape
-&gt; other -&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier hs-var">mulScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557333"><span class="hs-identifier hs-var">scaling</span></a></span><span>
</span><span id="line-623"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>                </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679557341"><span class="hs-identifier hs-var">edtEmbedScaling</span></a></span><span>
</span><span id="line-625"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator embeddingGeneratorOutputDevice)
  (Tensor requiresGradient' layout' device' dataType' shape')
-&gt; (Tensor requiresGradient' layout' device' dataType' shape'
    -&gt; IxStateT
         m
         (Generator embeddingGeneratorOutputDevice)
         (Generator encoderGeneratorOutputDevice)
         encoderOutput)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator encoderGeneratorOutputDevice)
     encoderOutput
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679557328"><span class="annot"><span class="annottext">Tensor requiresGradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679557328"><span class="hs-identifier hs-var">input'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Generator embeddingGeneratorOutputDevice
 -&gt; m (encoderOutput, Generator encoderGeneratorOutputDevice))
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice)
     (Generator encoderGeneratorOutputDevice)
     encoderOutput
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator embeddingGeneratorOutputDevice
  -&gt; m (encoderOutput, Generator encoderGeneratorOutputDevice))
 -&gt; IxStateT
      m
      (Generator embeddingGeneratorOutputDevice)
      (Generator encoderGeneratorOutputDevice)
      encoderOutput)
-&gt; (Generator embeddingGeneratorOutputDevice
    -&gt; m (encoderOutput, Generator encoderGeneratorOutputDevice))
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice)
     (Generator encoderGeneratorOutputDevice)
     encoderOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">encoder
-&gt; (Tensor requiresGradient' layout' device' dataType' shape', pos,
    attentionMask)
-&gt; Generator embeddingGeneratorOutputDevice
-&gt; m (encoderOutput, Generator encoderGeneratorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">encoder
</span><a href="#local-6989586621679557345"><span class="hs-identifier hs-var">edtEncoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor requiresGradient' layout' device' dataType' shape'
</span><a href="#local-6989586621679557328"><span class="hs-identifier hs-var">input'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679557338"><span class="hs-identifier hs-var">edtPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">attentionMask
</span><a href="#local-6989586621679557336"><span class="hs-identifier hs-var">edtAttentionMask</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-626"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator encoderGeneratorOutputDevice)
  encoderOutput
-&gt; (encoderOutput
    -&gt; IxStateT
         m
         (Generator encoderGeneratorOutputDevice)
         (Generator generatorOutputDevice)
         (EncoderDecoderTransformerOutput headOutput encoderOutput))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput headOutput encoderOutput)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679557327"><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557327"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-627"></span><span>                     </span><span class="annot"><span class="annottext">decoderInput
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator encoderGeneratorOutputDevice)
     decoderInput
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679557339"><span class="hs-identifier hs-var">edtDecoderInput</span></a></span><span>
</span><span id="line-628"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator encoderGeneratorOutputDevice)
  (Generator encoderGeneratorOutputDevice)
  decoderInput
-&gt; (decoderInput
    -&gt; IxStateT
         m
         (Generator encoderGeneratorOutputDevice)
         (Generator embeddingGeneratorOutputDevice')
         (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator encoderGeneratorOutputDevice
 -&gt; m (Tensor
         requiresGradient'' layout'' device'' dataType'' shape'',
       Generator embeddingGeneratorOutputDevice'))
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator encoderGeneratorOutputDevice
  -&gt; m (Tensor
          requiresGradient'' layout'' device'' dataType'' shape'',
        Generator embeddingGeneratorOutputDevice'))
 -&gt; IxStateT
      m
      (Generator encoderGeneratorOutputDevice)
      (Generator embeddingGeneratorOutputDevice')
      (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; (decoderInput
    -&gt; Generator encoderGeneratorOutputDevice
    -&gt; m (Tensor
            requiresGradient'' layout'' device'' dataType'' shape'',
          Generator embeddingGeneratorOutputDevice'))
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
-&gt; decoderInput
-&gt; Generator encoderGeneratorOutputDevice
-&gt; m (Tensor
        requiresGradient'' layout'' device'' dataType'' shape'',
      Generator embeddingGeneratorOutputDevice')
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
</span><a href="#local-6989586621679557343"><span class="hs-identifier hs-var">edtSharedEmbedding</span></a></span><span>
</span><span id="line-629"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator encoderGeneratorOutputDevice)
  (Generator embeddingGeneratorOutputDevice')
  (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape''
    -&gt; IxStateT
         m
         (Generator embeddingGeneratorOutputDevice')
         (Generator embeddingGeneratorOutputDevice')
         (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span>
</span><span id="line-630"></span><span>                         </span><span class="annot"><span class="annottext">(Tensor requiresGradient'' layout'' device'' dataType'' shape''
 -&gt; IxStateT
      m
      (Generator embeddingGeneratorOutputDevice')
      (Generator embeddingGeneratorOutputDevice')
      (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape''
    -&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-631"></span><span>                               </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-632"></span><span>                               </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Tensor requiresGradient'' layout'' device'' dataType'' shape''
 -&gt; Double
 -&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; Double
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; Double
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
forall other (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
Scalar other =&gt;
Tensor gradient layout device dataType shape
-&gt; other -&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier hs-var">mulScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557333"><span class="hs-identifier hs-var">scaling</span></a></span><span>
</span><span id="line-633"></span><span>                           </span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>                           </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679557341"><span class="hs-identifier hs-var">edtEmbedScaling</span></a></span><span>
</span><span id="line-635"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator encoderGeneratorOutputDevice)
  (Generator embeddingGeneratorOutputDevice')
  (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape''
    -&gt; IxStateT
         m
         (Generator embeddingGeneratorOutputDevice')
         (Generator decoderGeneratorOutputDevice)
         decoderOutput)
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator decoderGeneratorOutputDevice)
     decoderOutput
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679557326"><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679557326"><span class="hs-identifier hs-var">decoderInput'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-636"></span><span>                                </span><span class="annot"><span class="annottext">(Generator embeddingGeneratorOutputDevice'
 -&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice))
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator decoderGeneratorOutputDevice)
     decoderOutput
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator embeddingGeneratorOutputDevice'
  -&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice))
 -&gt; IxStateT
      m
      (Generator embeddingGeneratorOutputDevice')
      (Generator decoderGeneratorOutputDevice)
      decoderOutput)
-&gt; (Generator embeddingGeneratorOutputDevice'
    -&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice))
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator decoderGeneratorOutputDevice)
     decoderOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">decoder
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape'',
    encoderOutput, decoderPos, decoderAttentionMask,
    crossAttentionMask)
-&gt; Generator embeddingGeneratorOutputDevice'
-&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">decoder
</span><a href="#local-6989586621679557344"><span class="hs-identifier hs-var">edtDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679557326"><span class="hs-identifier hs-var">decoderInput'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557327"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decoderPos
</span><a href="#local-6989586621679557337"><span class="hs-identifier hs-var">edtDecoderPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decoderAttentionMask
</span><a href="#local-6989586621679557335"><span class="hs-identifier hs-var">edtDecoderAttentionMask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">crossAttentionMask
</span><a href="#local-6989586621679557334"><span class="hs-identifier hs-var">edtCrossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-637"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator encoderGeneratorOutputDevice)
  (Generator decoderGeneratorOutputDevice)
  decoderOutput
-&gt; (decoderOutput
    -&gt; IxStateT
         m
         (Generator decoderGeneratorOutputDevice)
         (Generator generatorOutputDevice)
         headOutput)
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator generatorOutputDevice)
     headOutput
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator decoderGeneratorOutputDevice
 -&gt; m (headOutput, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator decoderGeneratorOutputDevice)
     (Generator generatorOutputDevice)
     headOutput
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator decoderGeneratorOutputDevice
  -&gt; m (headOutput, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator decoderGeneratorOutputDevice)
      (Generator generatorOutputDevice)
      headOutput)
-&gt; (decoderOutput
    -&gt; Generator decoderGeneratorOutputDevice
    -&gt; m (headOutput, Generator generatorOutputDevice))
-&gt; decoderOutput
-&gt; IxStateT
     m
     (Generator decoderGeneratorOutputDevice)
     (Generator generatorOutputDevice)
     headOutput
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">head
-&gt; decoderOutput
-&gt; Generator decoderGeneratorOutputDevice
-&gt; m (headOutput, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679557342"><span class="hs-identifier hs-var">edtHead</span></a></span><span>
</span><span id="line-639"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator encoderGeneratorOutputDevice)
  (Generator generatorOutputDevice)
  headOutput
-&gt; (headOutput
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         (EncoderDecoderTransformerOutput headOutput encoderOutput))
-&gt; IxStateT
     m
     (Generator encoderGeneratorOutputDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput headOutput encoderOutput)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679557325"><span class="annot"><span class="annottext">headOutput
</span><a href="#local-6989586621679557325"><span class="hs-identifier hs-var">decoderOutput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput headOutput encoderOutput
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput headOutput encoderOutput)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">headOutput
-&gt; encoderOutput
-&gt; EncoderDecoderTransformerOutput headOutput encoderOutput
forall decoderOutput encoderOutput.
decoderOutput
-&gt; encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><span class="annottext">headOutput
</span><a href="#local-6989586621679557325"><span class="hs-identifier hs-var">decoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557327"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>                 </span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="hs-comment">-- | 'HasForward' instance for encoder-decoder transformers with optional head.</span><span>
</span><span id="line-643"></span><span class="hs-comment">-- Use this instance for sequence generation once the encoder's output is available.</span><span>
</span><span id="line-644"></span><span class="hs-comment">--</span><span>
</span><span id="line-645"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-646"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- &#9474; encoderOutput &#9474;  &#9474; decoderInput &#9474;  &#9474; decoderPos &#9474;  &#9474; decoderAttentionMask &#9474;  &#9474; crossAttentionMask &#9474;</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9516;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-649"></span><span class="hs-comment">--         &#9474;                  &#9474;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-650"></span><span class="hs-comment">--         &#9474;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-651"></span><span class="hs-comment">--         &#9474;          edtSharedEmbedding       &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-652"></span><span class="hs-comment">--         &#9474;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-653"></span><span class="hs-comment">--         &#9474;            (embedScaling)         &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-654"></span><span class="hs-comment">--         &#9474;                  &#9660;                &#9474;                    &#9474;                        &#9474;</span><span>
</span><span id="line-655"></span><span class="hs-comment">--         &#9500;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9658;edtDecoder&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;&#9668;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-656"></span><span class="hs-comment">--         &#9474;                  &#9474;</span><span>
</span><span id="line-657"></span><span class="hs-comment">--         &#9474;              (edtHead)</span><span>
</span><span id="line-658"></span><span class="hs-comment">--         &#9474;                  &#9474;</span><span>
</span><span id="line-659"></span><span class="hs-comment">--         &#9660;                  &#9660;</span><span>
</span><span id="line-660"></span><span class="hs-comment">-- &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;  &#9484;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9488;</span><span>
</span><span id="line-661"></span><span class="hs-comment">-- &#9474; encoderOutput &#9474;  &#9474; decoderOutput &#9474;</span><span>
</span><span id="line-662"></span><span class="hs-comment">-- &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;  &#9492;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9472;&#9496;</span><span>
</span><span id="line-663"></span><span class="hs-comment">-- @</span><span>
</span><span id="line-664"></span><span id="local-6989586621679557303"><span id="local-6989586621679557304"><span id="local-6989586621679557305"><span id="local-6989586621679557306"><span id="local-6989586621679557307"><span id="local-6989586621679557308"><span id="local-6989586621679557309"><span id="local-6989586621679557310"><span id="local-6989586621679557311"><span id="local-6989586621679557312"><span id="local-6989586621679557313"><span id="local-6989586621679557314"><span id="local-6989586621679557315"><span id="local-6989586621679557316"><span id="local-6989586621679557317"><span id="local-6989586621679557318"><span id="local-6989586621679557319"><span id="local-6989586621679557320"><span id="local-6989586621679557321"><span id="local-6989586621679557322"><span id="local-6989586621679557323"><span id="local-6989586621679557324"><span class="hs-keyword">instance</span><span>
</span><span id="line-665"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span class="annot"><a href="#local-6989586621679557324"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span>
</span><span id="line-667"></span><span>      </span><span class="annot"><a href="#local-6989586621679557323"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-668"></span><span>      </span><span class="annot"><a href="#local-6989586621679557322"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-669"></span><span>      </span><span class="annot"><a href="#local-6989586621679557321"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span>
</span><span id="line-670"></span><span>      </span><span class="annot"><a href="#local-6989586621679557320"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-671"></span><span>    </span><span class="annot"><a href="#local-6989586621679557321"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.Tensor.Type.html#Tensor"><span class="hs-identifier hs-type">Tensor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557319"><span class="hs-identifier hs-type">requiresGradient''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557318"><span class="hs-identifier hs-type">layout''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557317"><span class="hs-identifier hs-type">device''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557316"><span class="hs-identifier hs-type">dataType''</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557315"><span class="hs-identifier hs-type">shape''</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-673"></span><span>      </span><span class="annot"><a href="#local-6989586621679557314"><span class="hs-identifier hs-type">decoder</span></a></span><span>
</span><span id="line-674"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="#local-6989586621679557321"><span class="hs-identifier hs-type">embeddingOutput'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-675"></span><span>        </span><span class="annot"><a href="#local-6989586621679557313"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-676"></span><span>        </span><span class="annot"><a href="#local-6989586621679557312"><span class="hs-identifier hs-type">decoderPos</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-677"></span><span>        </span><span class="annot"><a href="#local-6989586621679557311"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-678"></span><span>        </span><span class="annot"><a href="#local-6989586621679557310"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-680"></span><span>      </span><span class="annot"><a href="#local-6989586621679557320"><span class="hs-identifier hs-type">embeddingGeneratorOutputDevice'</span></a></span><span>
</span><span id="line-681"></span><span>      </span><span class="annot"><a href="#local-6989586621679557309"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span>
</span><span id="line-682"></span><span>      </span><span class="annot"><a href="#local-6989586621679557308"><span class="hs-identifier hs-type">decoderGeneratorOutputDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-683"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-684"></span><span>      </span><span class="annot"><a href="#local-6989586621679557307"><span class="hs-identifier hs-type">head</span></a></span><span>
</span><span id="line-685"></span><span>      </span><span class="annot"><a href="#local-6989586621679557309"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span>
</span><span id="line-686"></span><span>      </span><span class="annot"><a href="#local-6989586621679557308"><span class="hs-identifier hs-type">decoderGeneratorOutputDevice</span></a></span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><a href="#local-6989586621679557306"><span class="hs-identifier hs-type">headOutput</span></a></span><span>
</span><span id="line-688"></span><span>      </span><span class="annot"><a href="#local-6989586621679557305"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-690"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-691"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557304"><span class="hs-identifier hs-type">inputEmbedDim</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557303"><span class="hs-identifier hs-type">encoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557314"><span class="hs-identifier hs-type">decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557324"><span class="hs-identifier hs-type">sharedEmbedding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557307"><span class="hs-identifier hs-type">head</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557323"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557313"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557312"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557311"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557310"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-693"></span><span>    </span><span class="annot"><a href="#local-6989586621679557322"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-694"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557306"><span class="hs-identifier hs-type">headOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557313"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>    </span><span class="annot"><a href="#local-6989586621679557305"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-696"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-697"></span><span>  </span><span id="local-6989586621679557301"><span class="annot"><span class="annottext">forward :: GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679557301"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GEncoderDecoderTransformer"><span class="hs-identifier hs-type">GEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557295"><span id="local-6989586621679557296"><span id="local-6989586621679557297"><span id="local-6989586621679557298"><span id="local-6989586621679557299"><span id="local-6989586621679557300"><span class="annot"><span class="annottext">sharedEmbedding
decoder
head
encoder
SDim inputEmbedDim
EncoderDecoderTransformerHasEmbedScaling
edtEmbedScaling :: EncoderDecoderTransformerHasEmbedScaling
edtHead :: head
edtSharedEmbedding :: sharedEmbedding
edtDecoder :: decoder
edtEncoder :: encoder
edtInputEmbedDim :: SDim inputEmbedDim
edtEmbedScaling :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; EncoderDecoderTransformerHasEmbedScaling
edtHead :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; head
edtSharedEmbedding :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; sharedEmbedding
edtDecoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; decoder
edtEncoder :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; encoder
edtInputEmbedDim :: forall (inputEmbedDim :: Dim (Name Symbol) (Size Nat)) encoder
       decoder sharedEmbedding head.
GEncoderDecoderTransformer
  inputEmbedDim encoder decoder sharedEmbedding head
-&gt; SDim inputEmbedDim
</span><a href="#local-6989586621679557295"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557290"><span id="local-6989586621679557291"><span id="local-6989586621679557292"><span id="local-6989586621679557293"><span id="local-6989586621679557294"><span class="annot"><span class="annottext">decoderInput
encoderOutput
decoderPos
decoderAttentionMask
crossAttentionMask
edtGenerationCrossAttentionMask :: crossAttentionMask
edtGenerationDecoderAttentionMask :: decoderAttentionMask
edtGenerationDecoderPos :: decoderPos
edtGenerationEncoderOutput :: encoderOutput
edtGenerationDecoderInput :: decoderInput
edtGenerationCrossAttentionMask :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; crossAttentionMask
edtGenerationDecoderAttentionMask :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderAttentionMask
edtGenerationDecoderPos :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderPos
edtGenerationEncoderOutput :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; encoderOutput
edtGenerationDecoderInput :: forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
EncoderDecoderTransformerGenerationInput
  decoderInput
  encoderOutput
  decoderPos
  decoderAttentionMask
  crossAttentionMask
-&gt; decoderInput
</span><a href="#local-6989586621679557290"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-698"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557289"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557289"><span class="hs-identifier hs-var">scaling</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">sqrt</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double)
-&gt; (SDim inputEmbedDim -&gt; Double) -&gt; SDim inputEmbedDim -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Double)
-&gt; (SDim inputEmbedDim -&gt; Integer) -&gt; SDim inputEmbedDim -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">IsChecked Integer -&gt; Integer
forall a. IsChecked a -&gt; a
</span><a href="Torch.GraduallyTyped.Prelude.html#forgetIsChecked"><span class="hs-identifier hs-var">forgetIsChecked</span></a></span><span> </span><span class="annot"><span class="annottext">(IsChecked Integer -&gt; Integer)
-&gt; (SDim inputEmbedDim -&gt; IsChecked Integer)
-&gt; SDim inputEmbedDim
-&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Dim (IsChecked String) (IsChecked Integer) -&gt; IsChecked Integer
forall name size. Dim name size -&gt; size
</span><a href="Torch.GraduallyTyped.Shape.Type.html#dimSize"><span class="hs-identifier hs-var hs-var">dimSize</span></a></span><span> </span><span class="annot"><span class="annottext">(Dim (IsChecked String) (IsChecked Integer) -&gt; IsChecked Integer)
-&gt; (SDim inputEmbedDim
    -&gt; Dim (IsChecked String) (IsChecked Integer))
-&gt; SDim inputEmbedDim
-&gt; IsChecked Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim -&gt; Dim (IsChecked String) (IsChecked Integer)
forall k (a :: k). SingKind k =&gt; Sing a -&gt; Demote k
</span><a href="../file:///nix/store/lnxln0gj8camy4zp976hwp5qw721jzi5-singletons-lib-singletons-2.7-haddock-doc/share/doc/singletons/html/src"><span class="hs-identifier hs-var">fromSing</span></a></span><span> </span><span class="annot"><span class="annottext">(SDim inputEmbedDim -&gt; Double) -&gt; SDim inputEmbedDim -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SDim inputEmbedDim
</span><a href="#local-6989586621679557300"><span class="hs-identifier hs-var">edtInputEmbedDim</span></a></span><span>
</span><span id="line-699"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (EncoderDecoderTransformerOutput headOutput encoderOutput)
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   (EncoderDecoderTransformerOutput headOutput encoderOutput)
 -&gt; Generator generatorDevice
 -&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput headOutput encoderOutput)
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput headOutput encoderOutput,
      Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-700"></span><span>          </span><span class="annot"><span class="annottext">decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInput
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679557294"><span class="hs-identifier hs-var">edtGenerationDecoderInput</span></a></span><span>
</span><span id="line-701"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderInput
-&gt; (decoderInput
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator embeddingGeneratorOutputDevice')
         (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (Tensor
         requiresGradient'' layout'' device'' dataType'' shape'',
       Generator embeddingGeneratorOutputDevice'))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (Tensor
          requiresGradient'' layout'' device'' dataType'' shape'',
        Generator embeddingGeneratorOutputDevice'))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator embeddingGeneratorOutputDevice')
      (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; (decoderInput
    -&gt; Generator generatorDevice
    -&gt; m (Tensor
            requiresGradient'' layout'' device'' dataType'' shape'',
          Generator embeddingGeneratorOutputDevice'))
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
-&gt; decoderInput
-&gt; Generator generatorDevice
-&gt; m (Tensor
        requiresGradient'' layout'' device'' dataType'' shape'',
      Generator embeddingGeneratorOutputDevice')
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">sharedEmbedding
</span><a href="#local-6989586621679557297"><span class="hs-identifier hs-var">edtSharedEmbedding</span></a></span><span>
</span><span id="line-702"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator embeddingGeneratorOutputDevice')
  (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape''
    -&gt; IxStateT
         m
         (Generator embeddingGeneratorOutputDevice')
         (Generator embeddingGeneratorOutputDevice')
         (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span>
</span><span id="line-703"></span><span>              </span><span class="annot"><span class="annottext">(Tensor requiresGradient'' layout'' device'' dataType'' shape''
 -&gt; IxStateT
      m
      (Generator embeddingGeneratorOutputDevice')
      (Generator embeddingGeneratorOutputDevice')
      (Tensor requiresGradient'' layout'' device'' dataType'' shape''))
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape''
    -&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator embeddingGeneratorOutputDevice')
     (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-704"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithoutEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithoutEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-705"></span><span>                    </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerWithEmbedScaling"><span class="hs-identifier hs-var">EncoderDecoderTransformerWithEmbedScaling</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Tensor requiresGradient'' layout'' device'' dataType'' shape''
 -&gt; Double
 -&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; Double
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
-&gt; Double
-&gt; Tensor requiresGradient'' layout'' device'' dataType'' shape''
forall other (gradient :: Gradient RequiresGradient)
       (layout :: Layout LayoutType) (device :: Device (DeviceType Nat))
       (dataType :: DataType DType)
       (shape :: Shape [Dim (Name Symbol) (Size Nat)]).
Scalar other =&gt;
Tensor gradient layout device dataType shape
-&gt; other -&gt; Tensor gradient layout device dataType shape
</span><a href="Torch.GraduallyTyped.Tensor.MathOperations.Pointwise.html#mulScalar"><span class="hs-identifier hs-var">mulScalar</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679557289"><span class="hs-identifier hs-var">scaling</span></a></span><span>
</span><span id="line-706"></span><span>                </span><span class="hs-special">)</span><span>
</span><span id="line-707"></span><span>                </span><span class="annot"><span class="annottext">EncoderDecoderTransformerHasEmbedScaling
</span><a href="#local-6989586621679557295"><span class="hs-identifier hs-var">edtEmbedScaling</span></a></span><span>
</span><span id="line-708"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator embeddingGeneratorOutputDevice')
  (Tensor requiresGradient'' layout'' device'' dataType'' shape'')
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape''
    -&gt; IxStateT
         m
         (Generator embeddingGeneratorOutputDevice')
         (Generator decoderGeneratorOutputDevice)
         decoderOutput)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator decoderGeneratorOutputDevice)
     decoderOutput
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679557288"><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679557288"><span class="hs-identifier hs-var">decoderInput'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-709"></span><span>                     </span><span class="annot"><span class="annottext">(Generator embeddingGeneratorOutputDevice'
 -&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice))
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator decoderGeneratorOutputDevice)
     decoderOutput
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator embeddingGeneratorOutputDevice'
  -&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice))
 -&gt; IxStateT
      m
      (Generator embeddingGeneratorOutputDevice')
      (Generator decoderGeneratorOutputDevice)
      decoderOutput)
-&gt; (Generator embeddingGeneratorOutputDevice'
    -&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice))
-&gt; IxStateT
     m
     (Generator embeddingGeneratorOutputDevice')
     (Generator decoderGeneratorOutputDevice)
     decoderOutput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">decoder
-&gt; (Tensor requiresGradient'' layout'' device'' dataType'' shape'',
    encoderOutput, decoderPos, decoderAttentionMask,
    crossAttentionMask)
-&gt; Generator embeddingGeneratorOutputDevice'
-&gt; m (decoderOutput, Generator decoderGeneratorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">decoder
</span><a href="#local-6989586621679557298"><span class="hs-identifier hs-var">edtDecoder</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tensor requiresGradient'' layout'' device'' dataType'' shape''
</span><a href="#local-6989586621679557288"><span class="hs-identifier hs-var">decoderInput'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557293"><span class="hs-identifier hs-var">edtGenerationEncoderOutput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decoderPos
</span><a href="#local-6989586621679557292"><span class="hs-identifier hs-var">edtGenerationDecoderPos</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">decoderAttentionMask
</span><a href="#local-6989586621679557291"><span class="hs-identifier hs-var">edtGenerationDecoderAttentionMask</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">crossAttentionMask
</span><a href="#local-6989586621679557290"><span class="hs-identifier hs-var">edtGenerationCrossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>                 </span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator decoderGeneratorOutputDevice)
  decoderOutput
-&gt; (decoderOutput
    -&gt; IxStateT
         m
         (Generator decoderGeneratorOutputDevice)
         (Generator generatorOutputDevice)
         headOutput)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     headOutput
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator decoderGeneratorOutputDevice
 -&gt; m (headOutput, Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator decoderGeneratorOutputDevice)
     (Generator generatorOutputDevice)
     headOutput
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator decoderGeneratorOutputDevice
  -&gt; m (headOutput, Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator decoderGeneratorOutputDevice)
      (Generator generatorOutputDevice)
      headOutput)
-&gt; (decoderOutput
    -&gt; Generator decoderGeneratorOutputDevice
    -&gt; m (headOutput, Generator generatorOutputDevice))
-&gt; decoderOutput
-&gt; IxStateT
     m
     (Generator decoderGeneratorOutputDevice)
     (Generator generatorOutputDevice)
     headOutput
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">head
-&gt; decoderOutput
-&gt; Generator decoderGeneratorOutputDevice
-&gt; m (headOutput, Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">head
</span><a href="#local-6989586621679557296"><span class="hs-identifier hs-var">edtHead</span></a></span><span>
</span><span id="line-712"></span><span>            </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  headOutput
-&gt; (headOutput
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         (EncoderDecoderTransformerOutput headOutput encoderOutput))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput headOutput encoderOutput)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679557287"><span class="annot"><span class="annottext">headOutput
</span><a href="#local-6989586621679557287"><span class="hs-identifier hs-var">decoderOutput</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EncoderDecoderTransformerOutput headOutput encoderOutput
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput headOutput encoderOutput)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">headOutput
-&gt; encoderOutput
-&gt; EncoderDecoderTransformerOutput headOutput encoderOutput
forall decoderOutput encoderOutput.
decoderOutput
-&gt; encoderOutput
-&gt; EncoderDecoderTransformerOutput decoderOutput encoderOutput
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><span class="annottext">headOutput
</span><a href="#local-6989586621679557287"><span class="hs-identifier hs-var">decoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557293"><span class="hs-identifier hs-var">edtGenerationEncoderOutput</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-713"></span><span>
</span><span id="line-714"></span><span class="hs-comment">-- | 'HasForward' instance for simplified encoder-decoder models.</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">-- This instance shifts decoder inputs by one token to the right by adding</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- a model-specific sequence initialization token at the beginning.</span><span>
</span><span id="line-718"></span><span id="local-6989586621679557265"><span id="local-6989586621679557266"><span id="local-6989586621679557267"><span id="local-6989586621679557268"><span id="local-6989586621679557269"><span id="local-6989586621679557270"><span id="local-6989586621679557271"><span id="local-6989586621679557272"><span id="local-6989586621679557273"><span id="local-6989586621679557274"><span id="local-6989586621679557275"><span id="local-6989586621679557276"><span id="local-6989586621679557277"><span id="local-6989586621679557278"><span id="local-6989586621679557279"><span id="local-6989586621679557280"><span id="local-6989586621679557281"><span id="local-6989586621679557282"><span id="local-6989586621679557283"><span id="local-6989586621679557284"><span id="local-6989586621679557285"><span id="local-6989586621679557286"><span class="hs-keyword">instance</span><span>
</span><span id="line-719"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-720"></span><span>      </span><span class="annot"><a href="#local-6989586621679557286"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-721"></span><span>      </span><span class="annot"><a href="#local-6989586621679557285"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-722"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-723"></span><span>      </span><span class="annot"><a href="#local-6989586621679557283"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-724"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-726"></span><span>      </span><span class="annot"><a href="#local-6989586621679557286"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-727"></span><span>      </span><span class="annot"><a href="#local-6989586621679557282"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-728"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-729"></span><span>      </span><span class="annot"><a href="#local-6989586621679557281"><span class="hs-identifier hs-type">decoderInputPaddingMask</span></a></span><span>
</span><span id="line-730"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-731"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-732"></span><span>      </span><span class="annot"><a href="#local-6989586621679557280"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span>
</span><span id="line-733"></span><span>      </span><span class="annot"><a href="#local-6989586621679557283"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span>
</span><span id="line-734"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-735"></span><span>      </span><span class="annot"><a href="#local-6989586621679557279"><span class="hs-identifier hs-type">attentionMask</span></a></span><span>
</span><span id="line-736"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-737"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-738"></span><span>      </span><span class="annot"><a href="#local-6989586621679557278"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span>
</span><span id="line-739"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679557277"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679557283"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-741"></span><span>      </span><span class="annot"><a href="#local-6989586621679557276"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-742"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-743"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-744"></span><span>      </span><span class="annot"><a href="#local-6989586621679557275"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-745"></span><span>      </span><span class="annot"><a href="#local-6989586621679557274"><span class="hs-identifier hs-type">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-746"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-747"></span><span>      </span><span class="annot"><a href="#local-6989586621679557273"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span>
</span><span id="line-748"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-749"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-750"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>      </span><span class="annot"><a href="#local-6989586621679557282"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-752"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-753"></span><span>      </span><span class="annot"><a href="#local-6989586621679557277"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-754"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-755"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-756"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-757"></span><span>      </span><span class="annot"><a href="#local-6989586621679557281"><span class="hs-identifier hs-type">decoderInputPaddingMask</span></a></span><span>
</span><span id="line-758"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-759"></span><span>      </span><span class="annot"><a href="#local-6989586621679557274"><span class="hs-identifier hs-type">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-760"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-761"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-762"></span><span>      </span><span class="annot"><a href="#local-6989586621679557272"><span class="hs-identifier hs-type">mkPos</span></a></span><span>
</span><span id="line-763"></span><span>      </span><span class="annot"><a href="#local-6989586621679557285"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-764"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-765"></span><span>      </span><span class="annot"><a href="#local-6989586621679557271"><span class="hs-identifier hs-type">pos</span></a></span><span>
</span><span id="line-766"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-767"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-768"></span><span>      </span><span class="annot"><a href="#local-6989586621679557270"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span>
</span><span id="line-769"></span><span>      </span><span class="annot"><a href="#local-6989586621679557277"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-770"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-771"></span><span>      </span><span class="annot"><a href="#local-6989586621679557269"><span class="hs-identifier hs-type">decoderPos</span></a></span><span>
</span><span id="line-772"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-773"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-774"></span><span>      </span><span class="annot"><a href="#local-6989586621679557268"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-775"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557285"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557277"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557271"><span class="hs-identifier hs-type">pos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557269"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557279"><span class="hs-identifier hs-type">attentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557273"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557276"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-776"></span><span>      </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-777"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557267"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557266"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-778"></span><span>      </span><span class="annot"><a href="#local-6989586621679557265"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-779"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-780"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-781"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557268"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557272"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557270"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557286"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557280"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557278"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557275"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-782"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557285"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557282"><span class="hs-identifier hs-type">decoderInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-783"></span><span>    </span><span class="annot"><a href="#local-6989586621679557284"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-784"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557267"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557266"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557283"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span>    </span><span class="annot"><a href="#local-6989586621679557265"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-787"></span><span>  </span><span id="local-6989586621679557263"><span class="annot"><span class="annottext">forward :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679557263"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557254"><span id="local-6989586621679557255"><span id="local-6989586621679557256"><span id="local-6989586621679557257"><span id="local-6989586621679557258"><span id="local-6989586621679557259"><span id="local-6989586621679557260"><span id="local-6989586621679557261"><span id="local-6989586621679557262"><span class="annot"><span class="annottext">mkPaddingMask
mkAttentionMask
mkCrossAttentionMask
mkDecoderAttentionMask
mkPos
mkDecoderPos
model
ShiftRight Int
sedtMkDecoderAttentionMask :: mkDecoderAttentionMask
sedtMkCrossAttentionMask :: mkCrossAttentionMask
sedtMkAttentionMask :: mkAttentionMask
sedtMkPaddingMask :: mkPaddingMask
sedtMkDecoderPos :: mkDecoderPos
sedtMkPos :: mkPos
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: model
sedtMkDecoderAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderAttentionMask
sedtMkCrossAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkCrossAttentionMask
sedtMkAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkAttentionMask
sedtMkPaddingMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPaddingMask
sedtMkDecoderPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderPos
sedtMkPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPos
sedtPaddingMaskShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtDecoderInputShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtModel :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; model
</span><a href="#local-6989586621679557254"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557252"><span id="local-6989586621679557253"><span class="annot"><span class="annottext">input
decoderInput
sedtDecoderInput :: decoderInput
sedtInput :: input
sedtDecoderInput :: forall input decoderInput.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; decoderInput
sedtInput :: forall input decoderInput.
SimplifiedEncoderDecoderTransformerInput input decoderInput
-&gt; input
</span><a href="#local-6989586621679557252"><span class="hs-glyph hs-var hs-var hs-var hs-var">..</span></a></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-788"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask)
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask,
      Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   (SimplifiedEncoderDecoderTransformerOutput
      decoderOutput encoderOutput inputPaddingMask)
 -&gt; Generator generatorDevice
 -&gt; m (SimplifiedEncoderDecoderTransformerOutput
         decoderOutput encoderOutput inputPaddingMask,
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask,
      Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-789"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557251"><span class="annot"><span class="annottext">inputPaddingMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  inputPaddingMask
</span><a href="#local-6989586621679557251"><span class="hs-identifier hs-var hs-var">inputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (inputPaddingMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputPaddingMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (inputPaddingMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      inputPaddingMask)
-&gt; (input
    -&gt; Generator generatorDevice
    -&gt; m (inputPaddingMask, Generator generatorDevice))
-&gt; input
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputPaddingMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (inputPaddingMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
</span><a href="#local-6989586621679557257"><span class="hs-identifier hs-var">sedtMkPaddingMask</span></a></span><span> </span><span class="annot"><span class="annottext">(input
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      inputPaddingMask)
-&gt; input
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputPaddingMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679557253"><span class="hs-identifier hs-var">sedtInput</span></a></span><span>
</span><span id="line-790"></span><span>            </span><span id="local-6989586621679557250"><span class="annot"><span class="annottext">pos :: IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) pos
</span><a href="#local-6989586621679557250"><span class="hs-identifier hs-var hs-var">pos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice -&gt; m (pos, Generator generatorDevice))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) pos
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice -&gt; m (pos, Generator generatorDevice))
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) pos)
-&gt; (input
    -&gt; Generator generatorDevice -&gt; m (pos, Generator generatorDevice))
-&gt; input
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) pos
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkPos
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (pos, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPos
</span><a href="#local-6989586621679557259"><span class="hs-identifier hs-var">sedtMkPos</span></a></span><span> </span><span class="annot"><span class="annottext">(input
 -&gt; IxStateT
      m (Generator generatorDevice) (Generator generatorDevice) pos)
-&gt; input
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) pos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679557253"><span class="hs-identifier hs-var">sedtInput</span></a></span><span>
</span><span id="line-791"></span><span>            </span><span id="local-6989586621679557249"><span class="annot"><span class="annottext">rightShiftedDecoderInput :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInput
</span><a href="#local-6989586621679557249"><span class="hs-identifier hs-var hs-var">rightShiftedDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (rightShiftedDecoderInput, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (rightShiftedDecoderInput, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      rightShiftedDecoderInput)
-&gt; (decoderInput
    -&gt; Generator generatorDevice
    -&gt; m (rightShiftedDecoderInput, Generator generatorDevice))
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
-&gt; decoderInput
-&gt; Generator generatorDevice
-&gt; m (rightShiftedDecoderInput, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557261"><span class="hs-identifier hs-var">sedtDecoderInputShift</span></a></span><span> </span><span class="annot"><span class="annottext">(decoderInput
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      rightShiftedDecoderInput)
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679557252"><span class="hs-identifier hs-var">sedtDecoderInput</span></a></span><span>
</span><span id="line-792"></span><span>            </span><span id="local-6989586621679557248"><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557248"><span class="hs-identifier hs-var hs-var">rightShiftedDecoderInputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-793"></span><span>              </span><span class="annot"><span class="annottext">decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInput
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679557252"><span class="hs-identifier hs-var">sedtDecoderInput</span></a></span><span>
</span><span id="line-794"></span><span>                </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderInput
-&gt; (decoderInput
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         decoderInputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInputPaddingMask
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (decoderInputPaddingMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInputPaddingMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (decoderInputPaddingMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderInputPaddingMask)
-&gt; (decoderInput
    -&gt; Generator generatorDevice
    -&gt; m (decoderInputPaddingMask, Generator generatorDevice))
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInputPaddingMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
-&gt; decoderInput
-&gt; Generator generatorDevice
-&gt; m (decoderInputPaddingMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
</span><a href="#local-6989586621679557257"><span class="hs-identifier hs-var">sedtMkPaddingMask</span></a></span><span>
</span><span id="line-795"></span><span>                </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderInputPaddingMask
-&gt; (decoderInputPaddingMask
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         rightShiftedDecoderInputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (rightShiftedDecoderInputPaddingMask,
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (rightShiftedDecoderInputPaddingMask,
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      rightShiftedDecoderInputPaddingMask)
-&gt; (decoderInputPaddingMask
    -&gt; Generator generatorDevice
    -&gt; m (rightShiftedDecoderInputPaddingMask,
          Generator generatorDevice))
-&gt; decoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
-&gt; decoderInputPaddingMask
-&gt; Generator generatorDevice
-&gt; m (rightShiftedDecoderInputPaddingMask,
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557260"><span class="hs-identifier hs-var">sedtPaddingMaskShift</span></a></span><span>
</span><span id="line-796"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>              </span><span class="annot"><span class="annottext">(inputPaddingMask
 -&gt; pos
 -&gt; rightShiftedDecoderInput
 -&gt; rightShiftedDecoderInputPaddingMask
 -&gt; (inputPaddingMask, pos, rightShiftedDecoderInput,
     rightShiftedDecoderInputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     inputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (pos
      -&gt; rightShiftedDecoderInput
      -&gt; rightShiftedDecoderInputPaddingMask
      -&gt; (inputPaddingMask, pos, rightShiftedDecoderInput,
          rightShiftedDecoderInputPaddingMask))
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  inputPaddingMask
</span><a href="#local-6989586621679557251"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span><span>
</span><span id="line-798"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (pos
   -&gt; rightShiftedDecoderInput
   -&gt; rightShiftedDecoderInputPaddingMask
   -&gt; (inputPaddingMask, pos, rightShiftedDecoderInput,
       rightShiftedDecoderInputPaddingMask))
-&gt; IxStateT
     m (Generator generatorDevice) (Generator generatorDevice) pos
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (rightShiftedDecoderInput
      -&gt; rightShiftedDecoderInputPaddingMask
      -&gt; (inputPaddingMask, pos, rightShiftedDecoderInput,
          rightShiftedDecoderInputPaddingMask))
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m (Generator generatorDevice) (Generator generatorDevice) pos
</span><a href="#local-6989586621679557250"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-799"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (rightShiftedDecoderInput
   -&gt; rightShiftedDecoderInputPaddingMask
   -&gt; (inputPaddingMask, pos, rightShiftedDecoderInput,
       rightShiftedDecoderInputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (rightShiftedDecoderInputPaddingMask
      -&gt; (inputPaddingMask, pos, rightShiftedDecoderInput,
          rightShiftedDecoderInputPaddingMask))
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInput
</span><a href="#local-6989586621679557249"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-800"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (rightShiftedDecoderInputPaddingMask
   -&gt; (inputPaddingMask, pos, rightShiftedDecoderInput,
       rightShiftedDecoderInputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (inputPaddingMask, pos, rightShiftedDecoderInput,
      rightShiftedDecoderInputPaddingMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557248"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-801"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-802"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (inputPaddingMask, pos, rightShiftedDecoderInput,
   rightShiftedDecoderInputPaddingMask)
-&gt; ((inputPaddingMask, pos, rightShiftedDecoderInput,
     rightShiftedDecoderInputPaddingMask)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorOutputDevice)
         (SimplifiedEncoderDecoderTransformerOutput
            decoderOutput encoderOutput inputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679557247"><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679557247"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679557246"><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679557246"><span class="hs-identifier hs-var">pos</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679557245"><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557245"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679557244"><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557244"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-803"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557243"><span class="annot"><span class="annottext">decoderPos :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderPos
</span><a href="#local-6989586621679557243"><span class="hs-identifier hs-var hs-var">decoderPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (decoderPos, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (decoderPos, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderPos)
-&gt; (rightShiftedDecoderInput
    -&gt; Generator generatorDevice
    -&gt; m (decoderPos, Generator generatorDevice))
-&gt; rightShiftedDecoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkDecoderPos
-&gt; rightShiftedDecoderInput
-&gt; Generator generatorDevice
-&gt; m (decoderPos, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderPos
</span><a href="#local-6989586621679557258"><span class="hs-identifier hs-var">sedtMkDecoderPos</span></a></span><span> </span><span class="annot"><span class="annottext">(rightShiftedDecoderInput
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderPos)
-&gt; rightShiftedDecoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557245"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-804"></span><span>                     </span><span id="local-6989586621679557242"><span class="annot"><span class="annottext">attentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  attentionMask
</span><a href="#local-6989586621679557242"><span class="hs-identifier hs-var hs-var">attentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (attentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     attentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (attentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      attentionMask)
-&gt; (inputPaddingMask
    -&gt; Generator generatorDevice
    -&gt; m (attentionMask, Generator generatorDevice))
-&gt; inputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     attentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkAttentionMask
-&gt; inputPaddingMask
-&gt; Generator generatorDevice
-&gt; m (attentionMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkAttentionMask
</span><a href="#local-6989586621679557256"><span class="hs-identifier hs-var">sedtMkAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">(inputPaddingMask
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      attentionMask)
-&gt; inputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     attentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679557247"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span><span>
</span><span id="line-805"></span><span>                     </span><span id="local-6989586621679557241"><span class="annot"><span class="annottext">crossAttentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttentionMask
</span><a href="#local-6989586621679557241"><span class="hs-identifier hs-var hs-var">crossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (crossAttentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (crossAttentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      crossAttentionMask)
-&gt; ((rightShiftedDecoderInput, inputPaddingMask)
    -&gt; Generator generatorDevice
    -&gt; m (crossAttentionMask, Generator generatorDevice))
-&gt; (rightShiftedDecoderInput, inputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkCrossAttentionMask
-&gt; (rightShiftedDecoderInput, inputPaddingMask)
-&gt; Generator generatorDevice
-&gt; m (crossAttentionMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkCrossAttentionMask
</span><a href="#local-6989586621679557255"><span class="hs-identifier hs-var">sedtMkCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">((rightShiftedDecoderInput, inputPaddingMask)
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      crossAttentionMask)
-&gt; (rightShiftedDecoderInput, inputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557245"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679557247"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-806"></span><span>                     </span><span id="local-6989586621679557240"><span class="annot"><span class="annottext">decoderAttentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderAttentionMask
</span><a href="#local-6989586621679557240"><span class="hs-identifier hs-var hs-var">decoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (decoderAttentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (decoderAttentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderAttentionMask)
-&gt; (rightShiftedDecoderInputPaddingMask
    -&gt; Generator generatorDevice
    -&gt; m (decoderAttentionMask, Generator generatorDevice))
-&gt; rightShiftedDecoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkDecoderAttentionMask
-&gt; rightShiftedDecoderInputPaddingMask
-&gt; Generator generatorDevice
-&gt; m (decoderAttentionMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderAttentionMask
</span><a href="#local-6989586621679557254"><span class="hs-identifier hs-var">sedtMkDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">(rightShiftedDecoderInputPaddingMask
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderAttentionMask)
-&gt; rightShiftedDecoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557244"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-807"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">input
-&gt; rightShiftedDecoderInput
-&gt; pos
-&gt; decoderPos
-&gt; attentionMask
-&gt; decoderAttentionMask
-&gt; crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     rightShiftedDecoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
forall input decoderInput pos decoderPos attentionMask
       decoderAttentionMask crossAttentionMask.
input
-&gt; decoderInput
-&gt; pos
-&gt; decoderPos
-&gt; attentionMask
-&gt; decoderAttentionMask
-&gt; crossAttentionMask
-&gt; EncoderDecoderTransformerInput
     input
     decoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerInput</span></a></span><span>
</span><span id="line-808"></span><span>                         </span><span class="annot"><span class="annottext">input
</span><a href="#local-6989586621679557253"><span class="hs-identifier hs-var">sedtInput</span></a></span><span>
</span><span id="line-809"></span><span>                         </span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557245"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-810"></span><span>                         </span><span class="annot"><span class="annottext">pos
</span><a href="#local-6989586621679557246"><span class="hs-identifier hs-var">pos</span></a></span><span>
</span><span id="line-811"></span><span>                         </span><span class="annot"><span class="annottext">(decoderPos
 -&gt; attentionMask
 -&gt; decoderAttentionMask
 -&gt; crossAttentionMask
 -&gt; EncoderDecoderTransformerInput
      input
      rightShiftedDecoderInput
      pos
      decoderPos
      attentionMask
      decoderAttentionMask
      crossAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (attentionMask
      -&gt; decoderAttentionMask
      -&gt; crossAttentionMask
      -&gt; EncoderDecoderTransformerInput
           input
           rightShiftedDecoderInput
           pos
           decoderPos
           attentionMask
           decoderAttentionMask
           crossAttentionMask)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderPos
</span><a href="#local-6989586621679557243"><span class="hs-identifier hs-var">decoderPos</span></a></span><span>
</span><span id="line-812"></span><span>                         </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (attentionMask
   -&gt; decoderAttentionMask
   -&gt; crossAttentionMask
   -&gt; EncoderDecoderTransformerInput
        input
        rightShiftedDecoderInput
        pos
        decoderPos
        attentionMask
        decoderAttentionMask
        crossAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     attentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (decoderAttentionMask
      -&gt; crossAttentionMask
      -&gt; EncoderDecoderTransformerInput
           input
           rightShiftedDecoderInput
           pos
           decoderPos
           attentionMask
           decoderAttentionMask
           crossAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  attentionMask
</span><a href="#local-6989586621679557242"><span class="hs-identifier hs-var">attentionMask</span></a></span><span>
</span><span id="line-813"></span><span>                         </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (decoderAttentionMask
   -&gt; crossAttentionMask
   -&gt; EncoderDecoderTransformerInput
        input
        rightShiftedDecoderInput
        pos
        decoderPos
        attentionMask
        decoderAttentionMask
        crossAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (crossAttentionMask
      -&gt; EncoderDecoderTransformerInput
           input
           rightShiftedDecoderInput
           pos
           decoderPos
           attentionMask
           decoderAttentionMask
           crossAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderAttentionMask
</span><a href="#local-6989586621679557240"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span><span>
</span><span id="line-814"></span><span>                         </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (crossAttentionMask
   -&gt; EncoderDecoderTransformerInput
        input
        rightShiftedDecoderInput
        pos
        decoderPos
        attentionMask
        decoderAttentionMask
        crossAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (EncoderDecoderTransformerInput
        input
        rightShiftedDecoderInput
        pos
        decoderPos
        attentionMask
        decoderAttentionMask
        crossAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttentionMask
</span><a href="#local-6989586621679557241"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span><span>
</span><span id="line-815"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-816"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (EncoderDecoderTransformerInput
     input
     rightShiftedDecoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask)
-&gt; (EncoderDecoderTransformerInput
      input
      rightShiftedDecoderInput
      pos
      decoderPos
      attentionMask
      decoderAttentionMask
      crossAttentionMask
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorOutputDevice)
         (EncoderDecoderTransformerOutput decoderOutput encoderOutput))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorOutputDevice)
      (EncoderDecoderTransformerOutput decoderOutput encoderOutput))
-&gt; (EncoderDecoderTransformerInput
      input
      rightShiftedDecoderInput
      pos
      decoderPos
      attentionMask
      decoderAttentionMask
      crossAttentionMask
    -&gt; Generator generatorDevice
    -&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
          Generator generatorOutputDevice))
-&gt; EncoderDecoderTransformerInput
     input
     rightShiftedDecoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">model
-&gt; EncoderDecoderTransformerInput
     input
     rightShiftedDecoderInput
     pos
     decoderPos
     attentionMask
     decoderAttentionMask
     crossAttentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679557262"><span class="hs-identifier hs-var">sedtModel</span></a></span><span>
</span><span id="line-817"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
-&gt; (EncoderDecoderTransformerOutput decoderOutput encoderOutput
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         (SimplifiedEncoderDecoderTransformerOutput
            decoderOutput encoderOutput inputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span id="local-6989586621679557239"><span class="annot"><span class="annottext">decoderOutput
</span><a href="#local-6989586621679557239"><span class="hs-identifier hs-var">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557238"><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557238"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-818"></span><span>                                </span><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput inputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplifiedEncoderDecoderTransformerOutput
   decoderOutput encoderOutput inputPaddingMask
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      (SimplifiedEncoderDecoderTransformerOutput
         decoderOutput encoderOutput inputPaddingMask))
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">decoderOutput
-&gt; encoderOutput
-&gt; inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask
forall decoderOutput encoderOutput inputPaddingMask.
decoderOutput
-&gt; encoderOutput
-&gt; inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><span class="annottext">decoderOutput
</span><a href="#local-6989586621679557239"><span class="hs-identifier hs-var">decoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557238"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679557247"><span class="hs-identifier hs-var">inputPaddingMask</span></a></span><span>
</span><span id="line-819"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>             </span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-821"></span><span>
</span><span id="line-822"></span><span class="hs-comment">-- | 'HasForward' instance for simplified encoder-decoder models.</span><span>
</span><span id="line-823"></span><span class="hs-comment">-- Use this instance for sequence generation once the encoder's output is available.</span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="hs-comment">-- This instance shifts decoder inputs by one token to the right by adding</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- a model-specific sequence initialization token at the beginning.</span><span>
</span><span id="line-827"></span><span id="local-6989586621679557219"><span id="local-6989586621679557220"><span id="local-6989586621679557221"><span id="local-6989586621679557222"><span id="local-6989586621679557223"><span id="local-6989586621679557224"><span id="local-6989586621679557225"><span id="local-6989586621679557226"><span id="local-6989586621679557227"><span id="local-6989586621679557228"><span id="local-6989586621679557229"><span id="local-6989586621679557230"><span id="local-6989586621679557231"><span id="local-6989586621679557232"><span id="local-6989586621679557233"><span id="local-6989586621679557234"><span id="local-6989586621679557235"><span id="local-6989586621679557236"><span id="local-6989586621679557237"><span class="hs-keyword">instance</span><span>
</span><span id="line-828"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-829"></span><span>      </span><span class="annot"><a href="#local-6989586621679557237"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span>
</span><span id="line-830"></span><span>      </span><span class="annot"><a href="#local-6989586621679557236"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-831"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-832"></span><span>      </span><span class="annot"><a href="#local-6989586621679557234"><span class="hs-identifier hs-type">decoderInputPaddingMask</span></a></span><span>
</span><span id="line-833"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-835"></span><span>      </span><span class="annot"><a href="#local-6989586621679557233"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span>
</span><span id="line-836"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679557232"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679557231"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-837"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-838"></span><span>      </span><span class="annot"><a href="#local-6989586621679557230"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span>
</span><span id="line-839"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-840"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-841"></span><span>      </span><span class="annot"><a href="#local-6989586621679557229"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span>
</span><span id="line-842"></span><span>      </span><span class="annot"><a href="#local-6989586621679557228"><span class="hs-identifier hs-type">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-843"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-844"></span><span>      </span><span class="annot"><a href="#local-6989586621679557227"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span>
</span><span id="line-845"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-846"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-847"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>      </span><span class="annot"><a href="#local-6989586621679557236"><span class="hs-identifier hs-type">decoderInput</span></a></span><span>
</span><span id="line-849"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-850"></span><span>      </span><span class="annot"><a href="#local-6989586621679557232"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-851"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-852"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-853"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.Type.html#ShiftRight"><span class="hs-identifier hs-type">ShiftRight</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-854"></span><span>      </span><span class="annot"><a href="#local-6989586621679557234"><span class="hs-identifier hs-type">decoderInputPaddingMask</span></a></span><span>
</span><span id="line-855"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-856"></span><span>      </span><span class="annot"><a href="#local-6989586621679557228"><span class="hs-identifier hs-type">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-857"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-858"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-859"></span><span>      </span><span class="annot"><a href="#local-6989586621679557226"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span>
</span><span id="line-860"></span><span>      </span><span class="annot"><a href="#local-6989586621679557232"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-861"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-862"></span><span>      </span><span class="annot"><a href="#local-6989586621679557225"><span class="hs-identifier hs-type">decoderPos</span></a></span><span>
</span><span id="line-863"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-864"></span><span>    </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-865"></span><span>      </span><span class="annot"><a href="#local-6989586621679557224"><span class="hs-identifier hs-type">model</span></a></span><span>
</span><span id="line-866"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">EncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557232"><span class="hs-identifier hs-type">rightShiftedDecoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557223"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557225"><span class="hs-identifier hs-type">decoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557227"><span class="hs-identifier hs-type">decoderAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557230"><span class="hs-identifier hs-type">crossAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-867"></span><span>      </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-868"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557222"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557223"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-869"></span><span>      </span><span class="annot"><a href="#local-6989586621679557221"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-870"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-871"></span><span>  </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Class.html#HasForward"><span class="hs-identifier hs-type">HasForward</span></a></span><span>
</span><span id="line-872"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557224"><span class="hs-identifier hs-type">model</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557220"><span class="hs-identifier hs-type">mkPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557226"><span class="hs-identifier hs-type">mkDecoderPos</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557237"><span class="hs-identifier hs-type">mkPaddingMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557219"><span class="hs-identifier hs-type">mkAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557233"><span class="hs-identifier hs-type">mkCrossAttentionMask</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557229"><span class="hs-identifier hs-type">mkDecoderAttentionMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-873"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557236"><span class="hs-identifier hs-type">decoderInput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557223"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557231"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-874"></span><span>    </span><span class="annot"><a href="#local-6989586621679557235"><span class="hs-identifier hs-type">generatorDevice</span></a></span><span>
</span><span id="line-875"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557222"><span class="hs-identifier hs-type">decoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557223"><span class="hs-identifier hs-type">encoderOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679557231"><span class="hs-identifier hs-type">inputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-876"></span><span>    </span><span class="annot"><a href="#local-6989586621679557221"><span class="hs-identifier hs-type">generatorOutputDevice</span></a></span><span>
</span><span id="line-877"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-878"></span><span>  </span><span id="local-6989586621679557217"><span class="annot"><span class="annottext">forward :: GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; SimplifiedEncoderDecoderTransformerGenerationInput
     decoderInput encoderOutput inputPaddingMask
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask,
      Generator generatorOutputDevice)
</span><a href="#local-6989586621679557217"><span class="hs-identifier hs-var hs-var hs-var hs-var">forward</span></a></span></span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#GSimplifiedEncoderDecoderTransformer"><span class="hs-identifier hs-type">GSimplifiedEncoderDecoderTransformer</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557208"><span id="local-6989586621679557209"><span id="local-6989586621679557210"><span id="local-6989586621679557211"><span id="local-6989586621679557212"><span id="local-6989586621679557213"><span id="local-6989586621679557214"><span id="local-6989586621679557215"><span id="local-6989586621679557216"><span class="annot"><span class="annottext">mkPaddingMask
mkCrossAttentionMask
mkDecoderAttentionMask
mkDecoderPos
model
mkPos
mkAttentionMask
ShiftRight Int
sedtMkDecoderAttentionMask :: mkDecoderAttentionMask
sedtMkCrossAttentionMask :: mkCrossAttentionMask
sedtMkAttentionMask :: mkAttentionMask
sedtMkPaddingMask :: mkPaddingMask
sedtMkDecoderPos :: mkDecoderPos
sedtMkPos :: mkPos
sedtPaddingMaskShift :: ShiftRight Int
sedtDecoderInputShift :: ShiftRight Int
sedtModel :: model
sedtMkDecoderAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderAttentionMask
sedtMkCrossAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkCrossAttentionMask
sedtMkAttentionMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkAttentionMask
sedtMkPaddingMask :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPaddingMask
sedtMkDecoderPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkDecoderPos
sedtMkPos :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; mkPos
sedtPaddingMaskShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtDecoderInputShift :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; ShiftRight Int
sedtModel :: forall model mkPos mkDecoderPos mkPaddingMask mkAttentionMask
       mkCrossAttentionMask mkDecoderAttentionMask.
GSimplifiedEncoderDecoderTransformer
  model
  mkPos
  mkDecoderPos
  mkPaddingMask
  mkAttentionMask
  mkCrossAttentionMask
  mkDecoderAttentionMask
-&gt; model
</span><a href="#local-6989586621679557208"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-type">SimplifiedEncoderDecoderTransformerGenerationInput</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679557205"><span id="local-6989586621679557206"><span id="local-6989586621679557207"><span class="annot"><span class="annottext">decoderInput
inputPaddingMask
encoderOutput
sedtGenerationInputPaddingMask :: inputPaddingMask
sedtGenerationEncoderOutput :: encoderOutput
sedtGenerationDecoderInput :: decoderInput
sedtGenerationInputPaddingMask :: forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; inputPaddingMask
sedtGenerationEncoderOutput :: forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; encoderOutput
sedtGenerationDecoderInput :: forall decoderInput encoderOutput inputPaddingMask.
SimplifiedEncoderDecoderTransformerGenerationInput
  decoderInput encoderOutput inputPaddingMask
-&gt; decoderInput
</span><a href="#local-6989586621679557205"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-879"></span><span>    </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask)
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask,
      Generator generatorOutputDevice)
forall (m :: * -&gt; *) i j a. IxStateT m i j a -&gt; i -&gt; m (a, j)
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var hs-var">runIxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">(IxStateT
   m
   (Generator generatorDevice)
   (Generator generatorOutputDevice)
   (SimplifiedEncoderDecoderTransformerOutput
      decoderOutput encoderOutput inputPaddingMask)
 -&gt; Generator generatorDevice
 -&gt; m (SimplifiedEncoderDecoderTransformerOutput
         decoderOutput encoderOutput inputPaddingMask,
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
-&gt; Generator generatorDevice
-&gt; m (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask,
      Generator generatorOutputDevice)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-880"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557204"><span class="annot"><span class="annottext">rightShiftedDecoderInput :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInput
</span><a href="#local-6989586621679557204"><span class="hs-identifier hs-var hs-var">rightShiftedDecoderInput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (rightShiftedDecoderInput, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (rightShiftedDecoderInput, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      rightShiftedDecoderInput)
-&gt; (decoderInput
    -&gt; Generator generatorDevice
    -&gt; m (rightShiftedDecoderInput, Generator generatorDevice))
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
-&gt; decoderInput
-&gt; Generator generatorDevice
-&gt; m (rightShiftedDecoderInput, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557215"><span class="hs-identifier hs-var">sedtDecoderInputShift</span></a></span><span> </span><span class="annot"><span class="annottext">(decoderInput
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      rightShiftedDecoderInput)
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679557207"><span class="hs-identifier hs-var">sedtGenerationDecoderInput</span></a></span><span>
</span><span id="line-881"></span><span>            </span><span id="local-6989586621679557203"><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557203"><span class="hs-identifier hs-var hs-var">rightShiftedDecoderInputPaddingMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-882"></span><span>              </span><span class="annot"><span class="annottext">decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInput
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">decoderInput
</span><a href="#local-6989586621679557207"><span class="hs-identifier hs-var">sedtGenerationDecoderInput</span></a></span><span>
</span><span id="line-883"></span><span>                </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderInput
-&gt; (decoderInput
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         decoderInputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInputPaddingMask
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (decoderInputPaddingMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInputPaddingMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (decoderInputPaddingMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderInputPaddingMask)
-&gt; (decoderInput
    -&gt; Generator generatorDevice
    -&gt; m (decoderInputPaddingMask, Generator generatorDevice))
-&gt; decoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderInputPaddingMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
-&gt; decoderInput
-&gt; Generator generatorDevice
-&gt; m (decoderInputPaddingMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkPaddingMask
</span><a href="#local-6989586621679557211"><span class="hs-identifier hs-var">sedtMkPaddingMask</span></a></span><span>
</span><span id="line-884"></span><span>                </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderInputPaddingMask
-&gt; (decoderInputPaddingMask
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorDevice)
         rightShiftedDecoderInputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (rightShiftedDecoderInputPaddingMask,
       Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (rightShiftedDecoderInputPaddingMask,
        Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      rightShiftedDecoderInputPaddingMask)
-&gt; (decoderInputPaddingMask
    -&gt; Generator generatorDevice
    -&gt; m (rightShiftedDecoderInputPaddingMask,
          Generator generatorDevice))
-&gt; decoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
-&gt; decoderInputPaddingMask
-&gt; Generator generatorDevice
-&gt; m (rightShiftedDecoderInputPaddingMask,
      Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">ShiftRight Int
</span><a href="#local-6989586621679557214"><span class="hs-identifier hs-var">sedtPaddingMaskShift</span></a></span><span>
</span><span id="line-885"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span>
</span><span id="line-886"></span><span>              </span><span class="annot"><span class="annottext">(rightShiftedDecoderInput
 -&gt; rightShiftedDecoderInputPaddingMask
 -&gt; (rightShiftedDecoderInput, rightShiftedDecoderInputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (rightShiftedDecoderInputPaddingMask
      -&gt; (rightShiftedDecoderInput, rightShiftedDecoderInputPaddingMask))
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInput
</span><a href="#local-6989586621679557204"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-887"></span><span>              </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (rightShiftedDecoderInputPaddingMask
   -&gt; (rightShiftedDecoderInput, rightShiftedDecoderInputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     rightShiftedDecoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (rightShiftedDecoderInput, rightShiftedDecoderInputPaddingMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557203"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-888"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-889"></span><span>        </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (rightShiftedDecoderInput, rightShiftedDecoderInputPaddingMask)
-&gt; ((rightShiftedDecoderInput, rightShiftedDecoderInputPaddingMask)
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorOutputDevice)
         (SimplifiedEncoderDecoderTransformerOutput
            decoderOutput encoderOutput inputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679557202"><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557202"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679557201"><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557201"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-890"></span><span>                 </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679557200"><span class="annot"><span class="annottext">decoderPos :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderPos
</span><a href="#local-6989586621679557200"><span class="hs-identifier hs-var hs-var">decoderPos</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (decoderPos, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (decoderPos, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderPos)
-&gt; (rightShiftedDecoderInput
    -&gt; Generator generatorDevice
    -&gt; m (decoderPos, Generator generatorDevice))
-&gt; rightShiftedDecoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkDecoderPos
-&gt; rightShiftedDecoderInput
-&gt; Generator generatorDevice
-&gt; m (decoderPos, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderPos
</span><a href="#local-6989586621679557212"><span class="hs-identifier hs-var">sedtMkDecoderPos</span></a></span><span> </span><span class="annot"><span class="annottext">(rightShiftedDecoderInput
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderPos)
-&gt; rightShiftedDecoderInput
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557202"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-891"></span><span>                     </span><span id="local-6989586621679557199"><span class="annot"><span class="annottext">crossAttentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttentionMask
</span><a href="#local-6989586621679557199"><span class="hs-identifier hs-var hs-var">crossAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (crossAttentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (crossAttentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      crossAttentionMask)
-&gt; ((rightShiftedDecoderInput, inputPaddingMask)
    -&gt; Generator generatorDevice
    -&gt; m (crossAttentionMask, Generator generatorDevice))
-&gt; (rightShiftedDecoderInput, inputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkCrossAttentionMask
-&gt; (rightShiftedDecoderInput, inputPaddingMask)
-&gt; Generator generatorDevice
-&gt; m (crossAttentionMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkCrossAttentionMask
</span><a href="#local-6989586621679557209"><span class="hs-identifier hs-var">sedtMkCrossAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">((rightShiftedDecoderInput, inputPaddingMask)
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      crossAttentionMask)
-&gt; (rightShiftedDecoderInput, inputPaddingMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557202"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679557205"><span class="hs-identifier hs-var">sedtGenerationInputPaddingMask</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-892"></span><span>                     </span><span id="local-6989586621679557198"><span class="annot"><span class="annottext">decoderAttentionMask :: IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderAttentionMask
</span><a href="#local-6989586621679557198"><span class="hs-identifier hs-var hs-var">decoderAttentionMask</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (decoderAttentionMask, Generator generatorDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (decoderAttentionMask, Generator generatorDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderAttentionMask)
-&gt; (rightShiftedDecoderInputPaddingMask
    -&gt; Generator generatorDevice
    -&gt; m (decoderAttentionMask, Generator generatorDevice))
-&gt; rightShiftedDecoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">mkDecoderAttentionMask
-&gt; rightShiftedDecoderInputPaddingMask
-&gt; Generator generatorDevice
-&gt; m (decoderAttentionMask, Generator generatorDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">mkDecoderAttentionMask
</span><a href="#local-6989586621679557208"><span class="hs-identifier hs-var">sedtMkDecoderAttentionMask</span></a></span><span> </span><span class="annot"><span class="annottext">(rightShiftedDecoderInputPaddingMask
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorDevice)
      decoderAttentionMask)
-&gt; rightShiftedDecoderInputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">rightShiftedDecoderInputPaddingMask
</span><a href="#local-6989586621679557201"><span class="hs-identifier hs-var">rightShiftedDecoderInputPaddingMask</span></a></span><span>
</span><span id="line-893"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">rightShiftedDecoderInput
-&gt; encoderOutput
-&gt; decoderPos
-&gt; decoderAttentionMask
-&gt; crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     rightShiftedDecoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
forall decoderInput encoderOutput decoderPos decoderAttentionMask
       crossAttentionMask.
decoderInput
-&gt; encoderOutput
-&gt; decoderPos
-&gt; decoderAttentionMask
-&gt; crossAttentionMask
-&gt; EncoderDecoderTransformerGenerationInput
     decoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerGenerationInput"><span class="hs-identifier hs-var">EncoderDecoderTransformerGenerationInput</span></a></span><span>
</span><span id="line-894"></span><span>                         </span><span class="annot"><span class="annottext">rightShiftedDecoderInput
</span><a href="#local-6989586621679557202"><span class="hs-identifier hs-var">rightShiftedDecoderInput</span></a></span><span>
</span><span id="line-895"></span><span>                         </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557206"><span class="hs-identifier hs-var">sedtGenerationEncoderOutput</span></a></span><span>
</span><span id="line-896"></span><span>                         </span><span class="annot"><span class="annottext">(decoderPos
 -&gt; decoderAttentionMask
 -&gt; crossAttentionMask
 -&gt; EncoderDecoderTransformerGenerationInput
      rightShiftedDecoderInput
      encoderOutput
      decoderPos
      decoderAttentionMask
      crossAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderPos
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (decoderAttentionMask
      -&gt; crossAttentionMask
      -&gt; EncoderDecoderTransformerGenerationInput
           rightShiftedDecoderInput
           encoderOutput
           decoderPos
           decoderAttentionMask
           crossAttentionMask)
forall k1 k2 (f :: k1 -&gt; k2 -&gt; * -&gt; *) a b (j :: k1) (k3 :: k2).
IxFunctor f =&gt;
(a -&gt; b) -&gt; f j k3 a -&gt; f j k3 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;$&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderPos
</span><a href="#local-6989586621679557200"><span class="hs-identifier hs-var">decoderPos</span></a></span><span>
</span><span id="line-897"></span><span>                         </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (decoderAttentionMask
   -&gt; crossAttentionMask
   -&gt; EncoderDecoderTransformerGenerationInput
        rightShiftedDecoderInput
        encoderOutput
        decoderPos
        decoderAttentionMask
        crossAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     decoderAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (crossAttentionMask
      -&gt; EncoderDecoderTransformerGenerationInput
           rightShiftedDecoderInput
           encoderOutput
           decoderPos
           decoderAttentionMask
           crossAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  decoderAttentionMask
</span><a href="#local-6989586621679557198"><span class="hs-identifier hs-var">decoderAttentionMask</span></a></span><span>
</span><span id="line-898"></span><span>                         </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (crossAttentionMask
   -&gt; EncoderDecoderTransformerGenerationInput
        rightShiftedDecoderInput
        encoderOutput
        decoderPos
        decoderAttentionMask
        crossAttentionMask)
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     crossAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorDevice)
     (EncoderDecoderTransformerGenerationInput
        rightShiftedDecoderInput
        encoderOutput
        decoderPos
        decoderAttentionMask
        crossAttentionMask)
forall k1 (f :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a b
       (k2 :: k1).
IxApplicative f =&gt;
f i j (a -&gt; b) -&gt; f j k2 a -&gt; f i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&lt;&lt;*&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  crossAttentionMask
</span><a href="#local-6989586621679557199"><span class="hs-identifier hs-var">crossAttentionMask</span></a></span><span>
</span><span id="line-899"></span><span>                     </span><span class="hs-special">)</span><span>
</span><span id="line-900"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorDevice)
  (EncoderDecoderTransformerGenerationInput
     rightShiftedDecoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask)
-&gt; (EncoderDecoderTransformerGenerationInput
      rightShiftedDecoderInput
      encoderOutput
      decoderPos
      decoderAttentionMask
      crossAttentionMask
    -&gt; IxStateT
         m
         (Generator generatorDevice)
         (Generator generatorOutputDevice)
         (EncoderDecoderTransformerOutput decoderOutput encoderOutput))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">(Generator generatorDevice
 -&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
       Generator generatorOutputDevice))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
forall (m :: * -&gt; *) i j a. (i -&gt; m (a, j)) -&gt; IxStateT m i j a
</span><a href="../file:///nix/store/8vjaffqxij7bih93d9mlzmc7ksanlw0i-indexed-extras-lib-indexed-extras-0.2-haddock-doc/share/doc/indexed-extras/html/src"><span class="hs-identifier hs-var">IxStateT</span></a></span><span> </span><span class="annot"><span class="annottext">((Generator generatorDevice
  -&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
        Generator generatorOutputDevice))
 -&gt; IxStateT
      m
      (Generator generatorDevice)
      (Generator generatorOutputDevice)
      (EncoderDecoderTransformerOutput decoderOutput encoderOutput))
-&gt; (EncoderDecoderTransformerGenerationInput
      rightShiftedDecoderInput
      encoderOutput
      decoderPos
      decoderAttentionMask
      crossAttentionMask
    -&gt; Generator generatorDevice
    -&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
          Generator generatorOutputDevice))
-&gt; EncoderDecoderTransformerGenerationInput
     rightShiftedDecoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">model
-&gt; EncoderDecoderTransformerGenerationInput
     rightShiftedDecoderInput
     encoderOutput
     decoderPos
     decoderAttentionMask
     crossAttentionMask
-&gt; Generator generatorDevice
-&gt; m (EncoderDecoderTransformerOutput decoderOutput encoderOutput,
      Generator generatorOutputDevice)
forall model input (generatorDevice :: Device (DeviceType Nat))
       output (generatorOutputDevice :: Device (DeviceType Nat))
       (m :: * -&gt; *).
(HasForward
   model input generatorDevice output generatorOutputDevice,
 MonadThrow m) =&gt;
model
-&gt; input
-&gt; Generator generatorDevice
-&gt; m (output, Generator generatorOutputDevice)
</span><a href="Torch.GraduallyTyped.NN.Class.html#forward"><span class="hs-identifier hs-var">forward</span></a></span><span> </span><span class="annot"><span class="annottext">model
</span><a href="#local-6989586621679557216"><span class="hs-identifier hs-var">sedtModel</span></a></span><span>
</span><span id="line-901"></span><span>                       </span><span class="annot"><span class="annottext">IxStateT
  m
  (Generator generatorDevice)
  (Generator generatorOutputDevice)
  (EncoderDecoderTransformerOutput decoderOutput encoderOutput)
-&gt; (EncoderDecoderTransformerOutput decoderOutput encoderOutput
    -&gt; IxStateT
         m
         (Generator generatorOutputDevice)
         (Generator generatorOutputDevice)
         (SimplifiedEncoderDecoderTransformerOutput
            decoderOutput encoderOutput inputPaddingMask))
-&gt; IxStateT
     m
     (Generator generatorDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall k1 (m :: k1 -&gt; k1 -&gt; * -&gt; *) (i :: k1) (j :: k1) a
       (k2 :: k1) b.
IxMonad m =&gt;
m i j a -&gt; (a -&gt; m j k2 b) -&gt; m i k2 b
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-operator hs-var">&gt;&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#EncoderDecoderTransformerOutput"><span class="hs-identifier hs-type">EncoderDecoderTransformerOutput</span></a></span><span> </span><span id="local-6989586621679557197"><span class="annot"><span class="annottext">decoderOutput
</span><a href="#local-6989586621679557197"><span class="hs-identifier hs-var">decoderOutput</span></a></span></span><span> </span><span id="local-6989586621679557196"><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557196"><span class="hs-identifier hs-var">encoderOutput</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-902"></span><span>                                </span><span class="annot"><span class="annottext">SimplifiedEncoderDecoderTransformerOutput
  decoderOutput encoderOutput inputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall k (m :: k -&gt; k -&gt; * -&gt; *) a (i :: k).
IxPointed m =&gt;
a -&gt; m i i a
</span><a href="../file:///nix/store/y93sl1ahi24xw24f0y8xsbhzkmpzqzqh-indexed-lib-indexed-0.1.3-haddock-doc/share/doc/indexed/html/src"><span class="hs-identifier hs-var">ireturn</span></a></span><span> </span><span class="annot"><span class="annottext">(SimplifiedEncoderDecoderTransformerOutput
   decoderOutput encoderOutput inputPaddingMask
 -&gt; IxStateT
      m
      (Generator generatorOutputDevice)
      (Generator generatorOutputDevice)
      (SimplifiedEncoderDecoderTransformerOutput
         decoderOutput encoderOutput inputPaddingMask))
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask
-&gt; IxStateT
     m
     (Generator generatorOutputDevice)
     (Generator generatorOutputDevice)
     (SimplifiedEncoderDecoderTransformerOutput
        decoderOutput encoderOutput inputPaddingMask)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">decoderOutput
-&gt; encoderOutput
-&gt; inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask
forall decoderOutput encoderOutput inputPaddingMask.
decoderOutput
-&gt; encoderOutput
-&gt; inputPaddingMask
-&gt; SimplifiedEncoderDecoderTransformerOutput
     decoderOutput encoderOutput inputPaddingMask
</span><a href="Torch.GraduallyTyped.NN.Transformer.GEncoderDecoder.html#SimplifiedEncoderDecoderTransformerOutput"><span class="hs-identifier hs-var">SimplifiedEncoderDecoderTransformerOutput</span></a></span><span> </span><span class="annot"><span class="annottext">decoderOutput
</span><a href="#local-6989586621679557197"><span class="hs-identifier hs-var">decoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">encoderOutput
</span><a href="#local-6989586621679557196"><span class="hs-identifier hs-var">encoderOutput</span></a></span><span> </span><span class="annot"><span class="annottext">inputPaddingMask
</span><a href="#local-6989586621679557205"><span class="hs-identifier hs-var">sedtGenerationInputPaddingMask</span></a></span><span>
</span><span id="line-903"></span><span>                            </span><span class="hs-special">)</span><span>
</span><span id="line-904"></span><span>             </span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-905"></span></pre></body></html>